<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ğŸ‚æŠ¢ä¸åˆ°å†°å¢©å¢©ï¼Ÿå¿«ç”¨canvasç”»ä¸€ä¸ªè°ä¹ŸæŠ¢ä¸èµ°çš„å†°å¢©å¢©å§ï¼</title>
    <link href="/2022/02/10/%F0%9F%8F%82%E6%8A%A2%E4%B8%8D%E5%88%B0%E5%86%B0%E5%A2%A9%E5%A2%A9%EF%BC%9F%E5%BF%AB%E7%94%A8canvas%E7%94%BB%E4%B8%80%E4%B8%AA%E8%B0%81%E4%B9%9F%E6%8A%A2%E4%B8%8D%E8%B5%B0%E7%9A%84%E5%86%B0%E5%A2%A9%E5%A2%A9%E5%90%A7%EF%BC%81/"/>
    <url>/2022/02/10/%F0%9F%8F%82%E6%8A%A2%E4%B8%8D%E5%88%B0%E5%86%B0%E5%A2%A9%E5%A2%A9%EF%BC%9F%E5%BF%AB%E7%94%A8canvas%E7%94%BB%E4%B8%80%E4%B8%AA%E8%B0%81%E4%B9%9F%E6%8A%A2%E4%B8%8D%E8%B5%B0%E7%9A%84%E5%86%B0%E5%A2%A9%E5%A2%A9%E5%90%A7%EF%BC%81/</url>
    
    <content type="html"><![CDATA[<p>å†¬å¥¥ä¼šæ­£åœ¨å¦‚ç«å¦‚è¼çš„è¿›è¡Œï¼Œä»ç¬¬ä¸€å¤©çš„å†°å£¶åˆ°ğŸ‘¦çŸ­é“é€Ÿæ»‘é˜ŸæƒŠå¿ƒåŠ¨é­„çš„é‡‘ç‰Œå†åˆ°å‰å‡ å¤©çœ‹åˆ°ğŸ‚è°·çˆ±å‡Œåšå‡ºç¬¬ä¸€ä¸ªåè½´1620æˆ‘ç›´æ¥æ¿€åŠ¨åœ°è·³èµ·æ¥ï¼Œä»Šå¹´å†¬å¥¥çœ‹ç‚¹åè¶³ï¼ä¸å¾—ä¸æçš„å°±æ˜¯ä»Šå¹´å†¬å¥¥çš„å‰ç¥¥ç‰©å†°å¢©å¢©ä¹Ÿæ˜¯æˆäº†æ–°ç½‘çº¢ï¼Œç½‘ç»œä¸Šå…¨æ˜¯ä»–çš„èº«å½±ï¼Œå‰ä¸¤å¤©å¼€å¯çš„è´­ä¹°æˆ‘ä¹Ÿæ˜¯ä¸€ä¸ªéƒ½æ²¡æŠ¢åˆ°â€¦çœŸæ˜¯è¦æ°”æ­»äº†ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6a7679098d041a397aa0d78d8317c22~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>äºæ˜¯æˆ‘å†³å®šè‡ªå·±ç”»ä¸€ä¸ªï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯äººï¼Œæ›¾ç»ä¹Ÿæ˜¯å­¦ç”Ÿä¼šå®£ä¼ éƒ¨éª¨å¹²æˆå‘˜ï¼Œæ€ä¹ˆè¯´ä¹Ÿæ˜¯æœ‰ç‚¹ç¾æœ¯åŠŸåº•åœ¨çš„ï¼ˆè‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ï¼‰ã€‚</p><p>æœ¬ç¯‡æ–‡ç« ä¼šé€šè¿‡ç”»å†°å¢©å¢©çš„æ–¹å¼å¸®åŠ©å¤§å®¶å¤ä¹ ä¸€ä¸‹canvasåŸºæœ¬çš„ä½¿ç”¨åŠç›¸å…³æ–¹æ³•ã€‚</p><h2 id="å®ç°æ•ˆæœ"><a href="#å®ç°æ•ˆæœ" class="headerlink" title="å®ç°æ•ˆæœ"></a>å®ç°æ•ˆæœ</h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/415712400e39484eb0ff1c5a68c77ffc~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="ç»˜åˆ¶æ­¥éª¤"><a href="#ç»˜åˆ¶æ­¥éª¤" class="headerlink" title="ç»˜åˆ¶æ­¥éª¤"></a>ç»˜åˆ¶æ­¥éª¤</h2><h3 id="èº«ä½“"><a href="#èº«ä½“" class="headerlink" title="èº«ä½“"></a>èº«ä½“</h3><p>èº«ä½“éƒ¨åˆ†æˆ‘ä»¬åˆ©ç”¨canvasçš„æ¤­åœ†å’Œcanvaså¡«å……æœªé—­åˆè·¯å¾„çš„ç‰¹ç‚¹æ¥ç»˜åˆ¶ã€‚æˆ‘ä»¬éœ€è¦ä¸¤ä¸ªåŠæ¤­åœ†æ¥ç”Ÿæˆå¦‚ä¸‹å›¾æ‰€ç¤ºçš„å½¢çŠ¶</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/825563fb70db4d889802982c7cc4460f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">150</span>, <span class="hljs-number">160</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>)<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">310</span>, <span class="hljs-number">160</span>, <span class="hljs-number">150</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#fff&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br></code></pre></td></tr></table></figure><blockquote><p>æ¤­åœ†æ–¹æ³•ï¼šellipse(x, y, radiusX, radiusY, rotation, startAngle, endAngle, anticlockwise)</p><p>å¯¹åº”å‚æ•°ï¼šèµ·ç‚¹x.èµ·ç‚¹y,åŠå¾„x,åŠå¾„y,æ—‹è½¬çš„è§’åº¦ï¼Œèµ·å§‹è§’ï¼Œç»“æœè§’ï¼Œé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆ</p></blockquote><h3 id="è€³æœµ"><a href="#è€³æœµ" class="headerlink" title="è€³æœµ"></a>è€³æœµ</h3><p>è€³æœµå¾ˆç®€å•ï¼Œè¿™é‡Œç”¨ä¸€ä¸ªåŠåœ†å’Œä¸€ä¸ªçŸ©å½¢ç»„æˆï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/77a5d8a69956460ca137c6bf652315bc~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript">ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">300</span>, <span class="hljs-number">190</span>, <span class="hljs-number">20</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">280</span>, <span class="hljs-number">190</span>, <span class="hljs-number">40</span>, <span class="hljs-number">40</span>)<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">500</span>, <span class="hljs-number">190</span>, <span class="hljs-number">20</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">480</span>, <span class="hljs-number">190</span>, <span class="hljs-number">40</span>, <span class="hljs-number">40</span>)<br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br></code></pre></td></tr></table></figure><blockquote><p>ç»˜åœ†æ–¹æ³•ï¼šarc(x,y,r,sAngle,eAngle,counterclockwise)</p><p>å¯¹åº”å‚æ•°ï¼šåœ†å¿ƒx,åœ†å¿ƒy,åŠå¾„,èµ·å§‹è§’,ç»“æŸè§’,é¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆ</p></blockquote><p><strong>è€³æœµè¦å…ˆäºèº«ä½“ç»˜åˆ¶ï¼Œè¿™æ ·èº«ä½“å°±ä¼šå°†è€³æœµå¤šä½™éƒ¨åˆ†è¦†ç›–</strong></p><h3 id="æ‰‹ä¸è„š"><a href="#æ‰‹ä¸è„š" class="headerlink" title="æ‰‹ä¸è„š"></a>æ‰‹ä¸è„š</h3><p>æ‰‹è„šä¸ºäº†åšçš„ç”ŸåŠ¨å½¢è±¡ï¼Œè¿™é‡Œä½¿ç”¨è´å¡å°”æ›²çº¿æ¥æ„é€ å¯¹åº”çš„å½¢çŠ¶ï¼Œé¦–å…ˆå…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹canvasä¸­äºŒé˜¶ã€ä¸‰é˜¶è´å¡å°”æ›²çº¿çš„ç”Ÿæˆæ–¹å¼å’Œå¯¹åº”æ–¹æ³•ã€‚</p><blockquote><p>è´å¡å°”æ›²çº¿å›¾ç‰‡æ¥è‡ª<a href="https://www.jianshu.com/p/afccc4642621">https://www.jianshu.com/p/afccc4642621</a></p></blockquote><ul><li>quadraticCurveToï¼ˆäºŒé˜¶è´å¡å°”æ›²çº¿ï¼‰</li></ul><blockquote><p> quadraticCurveTo(cpx,cpy,x,y)</p><p> å‚æ•°ï¼šæ§åˆ¶ç‚¹çš„x,æ§åˆ¶ç‚¹çš„y,ç»“æŸç‚¹x,ç»“æŸç‚¹y</p></blockquote><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/29a9b60077a7451c946fc5af47cebe08~tplv-k3u1fbpfcp-watermark.image" alt="16075459-cf42c00869beb95e.gif"></p><ul><li>bezierCurveToï¼ˆä¸‰é˜¶è´å¡å°”æ›²çº¿ï¼‰</li></ul><blockquote><p> bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)</p><p> å‚æ•°ï¼šæ§åˆ¶ç‚¹1çš„x,æ§åˆ¶ç‚¹1çš„y,æ§åˆ¶ç‚¹2çš„x,æ§åˆ¶ç‚¹2çš„y,ç»“æŸç‚¹x,ç»“æŸç‚¹y</p></blockquote><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/82fa1fa293314069847f7f6328223c4c~tplv-k3u1fbpfcp-watermark.image" alt="16075459-c505dd7f784accfa.gif"></p><p>è´å¡å°”æ›²çº¿åŸç†åœ¨åŠ¨å›¾ä¸­å·²ç»ä½“ç°çš„å¾ˆæ˜æ˜¾äº†ï¼Œæ§åˆ¶ç‚¹èƒ½å¤Ÿä½¿ä¸¤ç‚¹ä¹‹é—´çš„æŠ˜çº¿å˜å¾—åœ†æ»‘ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ©ç”¨å®ƒç”»æ‰‹è„šï¼Œ<strong>æ¯ç”»å®Œä¸€éƒ¨åˆ†è®°å¾—closePath()å…³é—­å½“å‰è·¯å¾„ã€‚</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//   è„š</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">300</span>, <span class="hljs-number">523</span>)<br>ctx.<span class="hljs-title function_">bezierCurveTo</span>(<span class="hljs-number">315</span>, <span class="hljs-number">523</span>, <span class="hljs-number">290</span>, <span class="hljs-number">583</span>, <span class="hljs-number">300</span>, <span class="hljs-number">603</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">325</span>, <span class="hljs-number">613</span>, <span class="hljs-number">370</span>, <span class="hljs-number">603</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">360</span>, <span class="hljs-number">584</span>, <span class="hljs-number">370</span>, <span class="hljs-number">556</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">325</span>, <span class="hljs-number">523</span>, <span class="hljs-number">300</span>, <span class="hljs-number">520</span>)<br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">440</span>, <span class="hljs-number">554</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">445</span>, <span class="hljs-number">575</span>, <span class="hljs-number">438</span>, <span class="hljs-number">600</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">465</span>, <span class="hljs-number">610</span>, <span class="hljs-number">510</span>, <span class="hljs-number">600</span>)<br>ctx.<span class="hljs-title function_">bezierCurveTo</span>(<span class="hljs-number">495</span>, <span class="hljs-number">575</span>, <span class="hljs-number">515</span>, <span class="hljs-number">545</span>, <span class="hljs-number">505</span>, <span class="hljs-number">514</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">470</span>, <span class="hljs-number">546</span>, <span class="hljs-number">440</span>, <span class="hljs-number">553</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br><br><span class="hljs-comment">// æ‰‹</span><br><span class="hljs-comment">// å·¦æ‰‹</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">250</span>, <span class="hljs-number">400</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">245</span>, <span class="hljs-number">330</span>, <span class="hljs-number">241</span>, <span class="hljs-number">300</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">200</span>, <span class="hljs-number">320</span>, <span class="hljs-number">160</span>, <span class="hljs-number">420</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">230</span>, <span class="hljs-number">420</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">245</span>, <span class="hljs-number">400</span>, <span class="hljs-number">250</span>, <span class="hljs-number">400</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">195</span>, <span class="hljs-number">420</span>, <span class="hljs-number">35</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br><br><span class="hljs-comment">// å³æ‰‹</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">559</span>, <span class="hljs-number">300</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">575</span>, <span class="hljs-number">295</span>, <span class="hljs-number">600</span>, <span class="hljs-number">250</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">625</span>, <span class="hljs-number">230</span>, <span class="hljs-number">655</span>, <span class="hljs-number">250</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">680</span>, <span class="hljs-number">330</span>, <span class="hljs-number">550</span>, <span class="hljs-number">400</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">556</span>, <span class="hljs-number">340</span>, <span class="hljs-number">559</span>, <span class="hljs-number">300</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br></code></pre></td></tr></table></figure><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8c60f50e969f4902906167b585a149a3~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="çˆ±å¿ƒåŠè‚šè‚šä¸Šçš„å†¬å¥¥ä¼šlogo"><a href="#çˆ±å¿ƒåŠè‚šè‚šä¸Šçš„å†¬å¥¥ä¼šlogo" class="headerlink" title="çˆ±å¿ƒåŠè‚šè‚šä¸Šçš„å†¬å¥¥ä¼šlogo"></a>çˆ±å¿ƒåŠè‚šè‚šä¸Šçš„å†¬å¥¥ä¼šlogo</h3><p>çˆ±å¿ƒæˆ‘åˆ©ç”¨<a href="https://juejin.cn/post/6844903881713909767">æ˜å‹å·²ç»å®ç°äº†çš„ä»£ç </a>æ·»åŠ ï¼Œè€Œlogoåˆ™åˆ©ç”¨canvaså¯¼å…¥å›¾ç‰‡çš„æ–¹æ³•å®ç°ã€‚logoç½‘ä¸Šä¸€æœå°±æœ‰ã€‚</p><blockquote><p>drawImage(img,sx,sy,swidth,sheight,x,y,width,height);</p><p>å‚æ•°ï¼šè¦ä½¿ç”¨çš„å›¾åƒ,è£å‰ªx,è£å‰ªy,å›¾åƒå®½åº¦,å›¾åƒé«˜åº¦,æ”¾ç½®ç‚¹x,æ”¾ç½®ç‚¹y,ä½¿ç”¨å›¾åƒå®½åº¦,ä½¿ç”¨å›¾åƒé«˜åº¦</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// çˆ±å¿ƒ</span><br><span class="hljs-keyword">let</span> get_arr = <span class="hljs-keyword">function</span> (<span class="hljs-params">a, len</span>) &#123;<br>    <span class="hljs-keyword">let</span> arr = []<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>        <span class="hljs-keyword">let</span> step = (i / len) * (<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>) <span class="hljs-comment">//é€’å¢çš„Î¸</span><br>        <span class="hljs-keyword">let</span> vector = &#123;<br>            <span class="hljs-attr">x</span>: a * (<span class="hljs-number">16</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(step), <span class="hljs-number">3</span>)) + <span class="hljs-number">625</span>,<br>            <span class="hljs-attr">y</span>:<br>            -a *<br>            (<span class="hljs-number">13</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(step) -<br>             <span class="hljs-number">5</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(<span class="hljs-number">2</span> * step) -<br>             <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(<span class="hljs-number">3</span> * step) -<br>             <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">cos</span>(<span class="hljs-number">4</span> * step)) +<br>            <span class="hljs-number">275</span>,<br>        &#125;<br>        arr.<span class="hljs-title function_">push</span>(vector)<br>    &#125;<br>    <span class="hljs-keyword">return</span> arr<br>&#125;<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&#x27;red&#x27;</span><br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">let</span> len = <span class="hljs-number">50</span><br><span class="hljs-keyword">let</span> arr = <span class="hljs-title function_">get_arr</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>)<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) &#123;<br>    ctx.<span class="hljs-title function_">lineTo</span>(arr[i].<span class="hljs-property">x</span>, arr[i].<span class="hljs-property">y</span>) <span class="hljs-comment">//å¿ƒå½¢çš„ç‚¹ä¸€ä¸€è¢«æç»˜å‡ºæ¥</span><br>&#125;<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#f00&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br><span class="hljs-comment">// logo</span><br><span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>()<br>img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>    ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">900</span>, <span class="hljs-number">900</span>, <span class="hljs-number">360</span>, <span class="hljs-number">440</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>)<br>&#125;<br>img.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./logo.jpg&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26902f6dd54d4d0f8740344e7c6954f0~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="é¢éƒ¨"><a href="#é¢éƒ¨" class="headerlink" title="é¢éƒ¨"></a>é¢éƒ¨</h3><p>é¢éƒ¨ç›¸å¯¹å°±æ¯”è¾ƒç®€å•äº†ï¼Œéƒ½æ˜¯è§„åˆ™å›¾å½¢æˆ–æ›²çº¿ï¼Œæ–°çŸ¥è¯†ç‚¹å°±æ˜¯canvasçš„æ¸å˜å¡«å……æ–¹æ³•ã€‚</p><blockquote><p>çº¿æ€§æ¸å˜ï¼šcreateLinearGradient(<em>x0,y0,x1,y1</em>)</p><p>å‚æ•°ï¼šæ¸å˜å¼€å§‹ç‚¹x,æ¸å˜å¼€å§‹ç‚¹y,æ¸å˜ç»“æŸç‚¹x,æ¸å˜ç»“æŸç‚¹y</p></blockquote><blockquote><p>å¾„å‘æ¸å˜ï¼šcreateRadialGradient(x0,y0,r0,x1,y1,r1)</p><p>å‚æ•°ï¼šæ¸å˜å¼€å§‹åœ†å¿ƒx,æ¸å˜å¼€å§‹åœ†å¿ƒy,åŠå¾„,æ¸å˜ç»“æŸåœ†å¿ƒx,æ¸å˜ç»“æŸåœ†å¿ƒy,åŠå¾„</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// å½©è™¹ğŸŒˆåœˆ</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">125</span>, <span class="hljs-number">95</span>, -<span class="hljs-number">0.06</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">95</span>, <span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#dddddd20&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#0000FF&#x27;</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = grd<br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">6</span><br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>, <span class="hljs-number">95</span>, -<span class="hljs-number">0.12</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">95</span>, <span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#dddddd20&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#00FFFF66&#x27;</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = grd<br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">2</span><br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>, <span class="hljs-number">95</span>, <span class="hljs-number">0.06</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">95</span>, <span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#dddddd20&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#FFFF0066&#x27;</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = grd<br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">3</span><br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>, <span class="hljs-number">95</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">95</span>, <span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#dddddd20&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#00FF0066&#x27;</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = grd<br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">3</span><br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>, <span class="hljs-number">95</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">95</span>, <span class="hljs-number">400</span>, <span class="hljs-number">300</span>, <span class="hljs-number">130</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#dddddd20&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#8B00FF66&#x27;</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = grd<br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">4</span><br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br></code></pre></td></tr></table></figure><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ebde97c3db546b98e714c845cc7e7a5~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="çœ¼é¼»å˜´"><a href="#çœ¼é¼»å˜´" class="headerlink" title="çœ¼é¼»å˜´"></a>çœ¼é¼»å˜´</h3><blockquote><p>btwï¼šçœ¼é¼»å˜´è¿™ä¸ªæ ‡é¢˜ä¸€å†™å‡ºæ¥æˆ‘å°±æ²¡å¿ä½å¼€å§‹å”±</p><p>ë¯¸ì•ˆí•´ ë¯¸ì•ˆí•´ í•˜ì§€ë§ˆ</p><p>ë‚´ê°€ ì´ˆë¼í•´ì§€ì–ì•„</p><p>å¥½äº†æ”¶ï¼</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// çœ¼</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">465</span>, <span class="hljs-number">275</span>, <span class="hljs-number">38</span>, <span class="hljs-number">26</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">ellipse</span>(<span class="hljs-number">335</span>, <span class="hljs-number">275</span>, <span class="hljs-number">43</span>, <span class="hljs-number">29</span>, -<span class="hljs-number">0.8</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">22</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">20</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#fff&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">17</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">15</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">0</span>, <span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">20</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#444&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#111&#x27;</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = grd<br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">14</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br><span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">0</span>, <span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">20</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;#444&#x27;</span>)<br>grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;#111&#x27;</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = grd<br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">344</span>, <span class="hljs-number">272</span>, <span class="hljs-number">12</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">458</span>, <span class="hljs-number">270</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">350</span>, <span class="hljs-number">266</span>, <span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-title function_">arc</span>(<span class="hljs-number">452</span>, <span class="hljs-number">266</span>, <span class="hljs-number">3</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#fff&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br><span class="hljs-comment">// é¼»å­</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">380</span>, <span class="hljs-number">280</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">420</span>, <span class="hljs-number">280</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">400</span>, <span class="hljs-number">295</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">380</span>, <span class="hljs-number">280</span>)<br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br><span class="hljs-comment">// å˜´</span><br>ctx.<span class="hljs-title function_">beginPath</span>()<br>ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">370</span>, <span class="hljs-number">323</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">400</span>, <span class="hljs-number">335</span>)<br>ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">430</span>, <span class="hljs-number">323</span>)<br>ctx.<span class="hljs-title function_">quadraticCurveTo</span>(<span class="hljs-number">400</span>, <span class="hljs-number">330</span>, <span class="hljs-number">370</span>, <span class="hljs-number">323</span>)<br>ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&#x27;#000&#x27;</span><br>ctx.<span class="hljs-property">lineWidth</span> = <span class="hljs-number">2</span><br>ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;#f00&#x27;</span><br>ctx.<span class="hljs-title function_">fill</span>()<br>ctx.<span class="hljs-title function_">stroke</span>()<br>ctx.<span class="hljs-title function_">closePath</span>()<br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/415712400e39484eb0ff1c5a68c77ffc~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æˆ‘æœ¬æ¥æƒ³è¦ç»™æ•´ä¸ªå†°å¢©å¢©æä¸ªé»‘è¾¹ï¼Œç”»å‡ºé€æ˜å¤–å¥—çš„æ„Ÿè§‰ï¼Œå› ä¸ºè§‰å¾—é€æ˜å¤–å¥—æ˜¯å†°å¢©å¢©çš„çµé­‚ï¼Œä½†æ˜¯æˆ‘ä¸€ç›´æ²¡æ‰¾åˆ°ä¸€ä¸ªå¥½çš„æ–¹å¼æ¥ç»˜ï¼Œå¦‚æœæœ‰å¤§ç¥èƒ½å¤ŸæŒ‡å¯¼æˆ–æç‚¹ä¸€ä¸‹è€å¼Ÿçš„è¯æˆ‘å®åœ¨æ˜¯æ„Ÿæ¿€ä¸å°½ï¼</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Canvas</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Œæ–°æ˜¥åˆ›æ„ã€å¿«æ‰“å¼€æ‘„åƒå¤´å¬å”¤å±äºä½ çš„è™å¹´å‰ç¥¥ç‰©ğŸ…</title>
    <link href="/2022/01/16/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E5%BF%AB%E6%89%93%E5%BC%80%E6%91%84%E5%83%8F%E5%A4%B4%E5%8F%AC%E5%94%A4%E5%B1%9E%E4%BA%8E%E4%BD%A0%E7%9A%84%E8%99%8E%E5%B9%B4%E5%90%89%E7%A5%A5%E7%89%A9%F0%9F%90%85/"/>
    <url>/2022/01/16/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E5%BF%AB%E6%89%93%E5%BC%80%E6%91%84%E5%83%8F%E5%A4%B4%E5%8F%AC%E5%94%A4%E5%B1%9E%E4%BA%8E%E4%BD%A0%E7%9A%84%E8%99%8E%E5%B9%B4%E5%90%89%E7%A5%A5%E7%89%A9%F0%9F%90%85/</url>
    
    <content type="html"><![CDATA[<h2 id="å®ç°æ•ˆæœ"><a href="#å®ç°æ•ˆæœ" class="headerlink" title="å®ç°æ•ˆæœ"></a>å®ç°æ•ˆæœ</h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d426b51ec3024dc6b5194854b35cca27~tplv-k3u1fbpfcp-watermark.image" alt="7.gif"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬ä¸€ç¯‡ç®€å•å®ç°äº†ä¸€ä¸‹æ”¯ä»˜å®å†™ç¦å­—çš„æ•ˆæœï¼Œå½“æ—¶å°±æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œèƒ½ä¸èƒ½å®ç°æ”¯ä»˜å®çš„æ‰«ç¦å‘¢ï¼ŒæŸ¥æ‰¾äº†è®¸å¤šèµ„æ–™åå‘ç°å•é å‰ç«¯è¿˜æ˜¯æ— æ³•å®ç°ï¼Œäºæ˜¯æˆ‘æ¢äº†ä¸ªæ€è·¯ï¼Œåˆ©ç”¨ ar å»æ‰«ç¦ï¼Œå¬å”¤è™å¹´å‰ç¥¥ç‰©ã€‚æœ¬æ–‡å®ç°æ•ˆæœä¹Ÿè®¸å¾ˆ lowï¼Œä½†æ—¨åœ¨æŠ›ç –å¼•ç‰ï¼Œå¸Œæœ›å„è·¯å¤§ç¥èƒ½è®©æˆ‘å¤§å¼€çœ¼ç•Œï¼ˆæ˜¥èŠ‚ä¼åˆ’çš„æ–‡ç« éƒ½æŒº nb çš„â€¦â€¦å‘ç°å¤§å®¶è„‘æ´å’Œå®åŠ›ç®€ç›´å¤ªå¼ºäº†ï¼‰</p><p>å®ç°çš„æŠ€æœ¯è·¯çº¿ï¼š<code>AR.js</code> + <code>A-Frame</code> + <code>artoolkit</code> + <code>obj2gltf</code></p><h2 id="å…³äº-AR-js-ä¸-A-Frame"><a href="#å…³äº-AR-js-ä¸-A-Frame" class="headerlink" title="å…³äº AR.js ä¸ A Frame"></a>å…³äº AR.js ä¸ A Frame</h2><p>é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ AR.js å’Œ A-Frameï¼Œå› ä¸ºåç»­çœ‹ä¼¼å¾ˆå°‘çš„ä»£ç ä¸­å…¶å® A-Frame å¸®æˆ‘ä»¬åšäº†å¾ˆå¤šäº‹æƒ…ï¼Œè¿™ä¸ªåé¢å†è¯´ã€‚</p><h3 id="AR-js"><a href="#AR-js" class="headerlink" title="AR.js"></a>AR.js</h3><p>AR.js æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¢å¼ºç°å®ç±» JavaScript åº“ï¼Œæ”¯æŒåŸºäºæ ‡è®°å’Œä½ç½®çš„å¢å¼ºç°å®ã€‚AR.js æ¡†æ¶åŒ…æ‹¬è·¨æµè§ˆå™¨å…¼å®¹æ€§ï¼Œå¹¶ä¸”æ”¯æŒ WebGL å’Œ WebRTCï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥åœ¨ iOS 11 ä»¥ä¸Šçš„ Android å’Œ iPhone è®¾å¤‡ä¸Šæ­£å¸¸å·¥ä½œã€‚é€šè¿‡åŒ…è£…è®¸å¤šä¸åŒçš„ AR æ¡†æ¶ï¼ŒåŒ…æ‹¬ three.jsï¼Œa-frame å’Œ ARToolKitï¼ŒAR.js ä½¿å¾—å°† AR å¼•å…¥ Web åº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ ç®€å•é«˜æ•ˆã€‚å®ƒå…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li><p>è·¨æµè§ˆå™¨å…¼å®¹æ€§</p></li><li><p>å³ä½¿åœ¨è¾ƒæ—§çš„è®¾å¤‡ä¸Šä¹Ÿå¯ä»¥è¾¾åˆ° 60fps çš„é«˜æ€§èƒ½</p></li><li><p>åŸºäº Webï¼Œæ— éœ€å®‰è£…</p></li><li><p>å¼€æºï¼Œå¯å…è´¹è®¿é—®</p></li><li><p>ä½¿ç”¨ WebGL å’Œ WebRTC åœ¨æ‰€æœ‰ç§»åŠ¨è®¾å¤‡ä¸Šå‡å¯ä½¿ç”¨</p></li><li><p>æ— éœ€é¢å¤–æˆ–ä¸å¸¸è§çš„ç¡¬ä»¶</p></li><li><p>å¯ä»¥ç”¨ä¸åˆ° 10 è¡Œ HTML æ¥å®Œæˆ</p></li></ul><h3 id="A-Frame"><a href="#A-Frame" class="headerlink" title="A-Frame"></a>A-Frame</h3><p>A-Frame æ˜¯ä¸€ä¸ªç”¨æ¥æ„å»ºè™šæ‹Ÿç°å®ï¼ˆVRï¼‰åº”ç”¨çš„ç½‘é¡µå¼€å‘æ¡†æ¶ã€‚ç”± WebVR çš„å‘èµ·äºº Mozilla VR å›¢é˜Ÿæ‰€å¼€å‘ï¼Œæ˜¯å½“ä¸‹ç”¨æ¥å¼€å‘ WebVR å†…å®¹ä¸»æµæŠ€æœ¯æ–¹æ¡ˆã€‚WebVR æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„é¡¹ç›®ï¼Œå·²æˆé•¿ä¸ºé¢†å…ˆçš„ VR ç¤¾åŒºã€‚</p><p>A-Frame åŸºäº HTMLï¼Œå®¹æ˜“ä¸Šæ‰‹ã€‚ä½†æ˜¯ A-Frame ä¸ä»…ä»…æ˜¯ä¸€ä¸ª 3D åœºæ™¯æ¸²æŸ“å¼•æ“æˆ–è€…ä¸€ä¸ªæ ‡è®°è¯­è¨€ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯åŸºäº Three.js æ¥æä¾›ä¸€ä¸ªå£°æ˜å¼ã€å¯æ‰©å±•ä»¥åŠç»„ä»¶åŒ–çš„ç¼–ç¨‹ç»“æ„ã€‚</p><p>A-Frame è®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨çº¯ html ä¸­ä½¿ç”¨ç»„ä»¶å¼çš„æ ‡ç­¾æ¥å¿«é€Ÿå¼€å‘ï¼Œä¸‹è¾¹è´´ä¸ŠåŸºæœ¬ä»£ç ï¼Œç”¨ vue çš„å…„å¼Ÿä¼šè§‰å¾—å¾ˆèˆ’æœï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><br>Â  Â  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://aframe.io/releases/1.1.0/aframe.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br> <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">a-scene</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a-box</span> <span class="hljs-attr">position</span>=<span class="hljs-string">&quot;-1 0.5 -3&quot;</span> <span class="hljs-attr">rotation</span>=<span class="hljs-string">&quot;0 45 0&quot;</span> <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#4CC3D9&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-box</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a-sphere</span> <span class="hljs-attr">position</span>=<span class="hljs-string">&quot;0 1.25 -5&quot;</span> <span class="hljs-attr">radius</span>=<span class="hljs-string">&quot;1.25&quot;</span> <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#EF2D5E&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-sphere</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a-cylinder</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">position</span>=<span class="hljs-string">&quot;1 0.75 -3&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">radius</span>=<span class="hljs-string">&quot;0.5&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"><span class="hljs-attr">height</span>=<span class="hljs-string">&quot;1.5&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#FFC65D&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">   &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-cylinder</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a-plane</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">position</span>=<span class="hljs-string">&quot;0 0 -4&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">rotation</span>=<span class="hljs-string">&quot;-90 0 0&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;4&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;4&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">    <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#7BC8A4&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">   &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-plane</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">a-sky</span> <span class="hljs-attr">color</span>=<span class="hljs-string">&quot;#ECECEC&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-sky</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">a-scene</span>&gt;</span><br><br> <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ€»ç»“ä¸€ä¸‹ A-Frame çš„ç‰¹æ€§ï¼š</p><ul><li><p>ç®€åŒ– VR åˆ¶ä½œ: åªéœ€è¦å¼•å…¥ <code>&lt;script&gt;</code> æ ‡ç­¾ å’Œ <code>&lt;a-scene&gt;</code>ï¼ŒA-Frame å°†è‡ªåŠ¨ç”Ÿæˆ 3D æ¸²æŸ“çš„æ ·æ¿ä»£ç ï¼ŒVR ç›¸å…³è®¾ç½®å’Œç¼ºçœçš„äº¤äº’æ§åˆ¶ã€‚ä¸éœ€è¦å®‰è£…ä»»ä½•ä¸œè¥¿ä¹Ÿæ— éœ€ç¼–è¯‘æ„å»ºã€‚</p></li><li><p>å£°æ˜å¼ HTML: HTML å¾ˆå®¹æ˜“é˜…è¯»ï¼Œç†è§£å’Œå¤åˆ¶ç²˜è´´ã€‚</p></li><li><p>å®ä½“-ç»„ä»¶æ¶æ„: A-Frame åŸºäºå¼ºå¤§çš„ three.js æ¡†æ¶, åŒæ—¶æä¾›å£°æ˜å¼ã€ç»„ä»¶åŒ–ã€å¯å¤ç”¨çš„å®ä½“ç»„ä»¶ç»“æ„ã€‚HTML åªæ˜¯å†°å±±çš„ä¸€è§’ï¼Œå¼€å‘è€…å¯ä»¥è‡ªç”±çš„ä½¿ç”¨ JavaScriptã€DOM APIï¼ŒThree.jsï¼ŒWebVRï¼Œå’Œ WebGLã€‚</p></li><li><p>é«˜æ€§èƒ½: A-Frame ä»åº•å±‚å¯¹ WebVR åšäº†ä¼˜åŒ–ï¼Œå°½ç®¡ A-Frame ä½¿ç”¨ DOMï¼Œä½†å…¶å…ƒç´ å¹¶ä¸æ¥è§¦æµè§ˆå™¨çš„å¸ƒå±€å¼•æ“ã€‚3D å¯¹è±¡çš„æ›´æ–°å…¨éƒ¨åœ¨ä½å¼€é”€å†…å­˜ä¸­é€šè¿‡å•ä¸ª requestAnimationFrame æ¥è°ƒç”¨ï¼Œç”šè‡³èƒ½å¤Ÿåƒæœ¬åœ°åº”ç”¨ä¸€æ ·æ¥è¿è¡Œ (90+ FPS)ã€‚</p></li><li><p>å·¥å…·æ— å…³æ€§: ç”±äºæ˜¯æ„å»ºåœ¨ HTML ä¹‹ä¸Šï¼Œæ‰€ä»¥ A-Frame å’Œå¤§å¤šæ•°å¼€å‘åº“ã€æ¡†æ¶å’Œå·¥å…·å¦‚ React, Vue.js, Angular, d3.js, Ember.js, jQuery å…¼å®¹ã€‚</p></li></ul><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="å‰ç½®èµ„æºå‡†å¤‡"><a href="#å‰ç½®èµ„æºå‡†å¤‡" class="headerlink" title="å‰ç½®èµ„æºå‡†å¤‡"></a>å‰ç½®èµ„æºå‡†å¤‡</h3><p>é¦–å…ˆå‡†å¤‡å¥½<code>aframe</code>åŠå…¶ç»§æ‰¿äº† ar å’Œ nft çš„ js æ–‡ä»¶ï¼ˆå¯ä»¥ä»æˆ‘çš„é¡¹ç›®ä¸­å–ï¼‰ï¼Œä¸€ä¸ªç”¨æ¥æ‰«çš„å›¾ç‰‡ï¼ˆ<strong>å›¾ç‰‡çš„è¦ç´ å°½é‡å¤šï¼Œjpg æ ¼å¼ï¼Œé•¿å®½ä¸€è‡´</strong>ï¼‰ä»¥åŠä¸€ä¸ªè¯†åˆ«åå¬å”¤çš„å‰ç¥¥ç‰©æ¨¡å‹ï¼ˆobj æ ¼å¼æˆ– gltf æ ¼å¼ï¼‰ã€‚</p><h4 id="æ ‡å¿—å›¾ç‰‡"><a href="#æ ‡å¿—å›¾ç‰‡" class="headerlink" title="æ ‡å¿—å›¾ç‰‡"></a>æ ‡å¿—å›¾ç‰‡</h4><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å¯¹å›¾ç‰‡å¤„ç†ä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬è¯†åˆ«çš„æ˜¯è‡ªç„¶å›¾ç‰‡æ‰€ä»¥éœ€è¦åˆ©ç”¨<code>artoolkit</code>ï¼ˆé¡¹ç›®ä»£ç ä¸­æœ‰å®‰è£…åŒ…ï¼‰å¯¹å›¾ç‰‡è¿›è¡Œç‰¹å¾ç‚¹æå–ï¼Œç‰¹å¾ç‚¹è¶Šå¤šè¯†åˆ«çš„è¶Šå‡†ç¡®ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘æé†’è¦é€‰æ‹©è¦ç´ å¤šçš„å›¾ç‰‡ã€‚</p><p>artoolkit å®‰è£…åçš„æ–‡ä»¶ç›®å½•ä¸º<code>C:\Program Files (x86)\ARToolKit5</code>ï¼Œæˆ‘ä»¬è¿›å…¥<code>bin</code>ç›®å½•ï¼Œæ·»åŠ ä¸€ä¸ª<code>image</code>æ–‡ä»¶å¤¹ï¼Œå°†æˆ‘ä»¬é€‰æ‹©çš„å›¾ç‰‡æ”¾è¿›å»ï¼Œæ¥ç€åœ¨<code>bin</code>ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">$ genTexData.exe å›¾ç‰‡ç›¸å¯¹è·¯å¾„<br><br></code></pre></td></tr></table></figure><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/98e2e17194d243dcaf6dd44f5d4cd5d1~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>æ¥ç€å›è½¦ä¸¤æ¬¡ï¼Œè¿™ä¸¤æ­¥æ˜¯é€‰æ‹©æå–å›¾ç‰‡ç‰¹å¾çš„ç¨‹åº¦ï¼Œæ•°å€¼è¶Šå¤§æå–çš„ç‰¹å¾è¶Šå¤šã€‚å½“ç›¸æœºç¦»å›¾ç‰‡è¶Šè¿‘çš„æ—¶å€™ï¼Œè¿½è¸ªæ•ˆæœä¼šè¶Šå¥½ã€‚æ­¤å¤„ä½¿ç”¨é»˜è®¤å€¼ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦é€‰æ‹©æœ€å¤§æœ€å°åˆ†è¾¨ç‡ï¼Œæ ¹æ®ä¸åŒç›¸æœºåˆ†è¾¨ç‡åŠç›¸æœºè¿œè¿‘æœ‰ä¸åŒå–å€¼ï¼Œä¸€èˆ¬ä½¿ç”¨20åˆ°120æœ€ä¸ºåˆé€‚ã€‚è€Œæˆ‘ä»¬è¿™è¾¹æœ€å¤§åˆ†è¾¨ç‡åªæœ‰96ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©20åˆ°96ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5952b0a8fa13431b96580410b540860a~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>æ¥ç€å›è½¦ï¼Œç­‰å¾…ç”Ÿæˆç‰¹å¾ç‚¹ï¼Œå›¾ç‰‡ç›®å½•ä¸‹ä¼šç”Ÿæˆ<code>.fset</code>,<code>.fset3</code>,<code>.iset</code>ä¸‰ä¸ªæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ dispFeatureSet å·¥å…·å¯ä»¥æ˜¾ç¤ºä¸€ä¸‹çœ‹çœ‹ç‰¹å¾ç‚¹æå–æƒ…å†µï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/370d8899d9054b71ad6663a87429c576~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h4 id="å‰ç¥¥ç‰©æ¨¡å‹"><a href="#å‰ç¥¥ç‰©æ¨¡å‹" class="headerlink" title="å‰ç¥¥ç‰©æ¨¡å‹"></a>å‰ç¥¥ç‰©æ¨¡å‹</h4><p>æ¨¡å‹å°±åœ¨ç½‘ä¸Šæ‰¾å…è´¹çš„æ¨¡å‹å°±å¥½ï¼Œå¦‚æœæ¨¡å‹æ˜¯ glTF æ ¼å¼æ˜¯æœ€å®Œç¾çš„ï¼Œå…¶ä»–æ ¼å¼éœ€è¦è½¬æ¢æˆæ¨¡å‹çš„é€šç”¨ obj æ ¼å¼ï¼Œç„¶ååˆ©ç”¨ obj2gltf å·¥å…·ï¼ˆä»£ç ä»“åº“ä¸­æä¾›ï¼‰å°†å…¶è½¬æ¢æˆ gltf æ¨¡å¼ã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">node bin/obj2gltf.js -i objæ¨¡å‹è·¯å¾„ -o è¾“å‡ºè·¯å¾„/è¾“å‡ºæ¨¡å‹å.gltf<br></code></pre></td></tr></table></figure><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>é¦–å…ˆæˆ‘ä»¬åˆ©ç”¨ a-scene æ­å»ºå‡ºä¸€ä¸ªåœºæ™¯ï¼Œå¼€å¯<code>arjs</code>ï¼Œ<code>gesture-detector</code>æ‰‹åŠ¿æ£€æµ‹ï¼Œ<code>vr-mode-ui=&quot;enabled: false;&quot;</code>ä¸å±•ç¤º vr æŒ‰é’®ï¼Œå¹¶æ”¾ç½®ä¸€ä¸ªç›¸æœºç»„ä»¶ç”¨æ¥è°ƒç”¨æˆ‘ä»¬çš„è®¾å¤‡æ‘„åƒå¤´ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a-scene</span> <span class="hljs-attr">arjs</span> <span class="hljs-attr">vr-mode-ui</span>=<span class="hljs-string">&quot;enabled: false;&quot;</span> <span class="hljs-attr">gesture-detector</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">a-entity</span> <span class="hljs-attr">camera</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a-entity</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">a-scene</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°†æˆ‘ä»¬ç”Ÿæˆçš„æ¨¡å‹ã€å›¾ç‰‡åŠå…¶ç‰¹å¾æ–‡ä»¶æ”¾åˆ°é¡¹ç›®ç›®å½•ä¸­ï¼Œå¹¶ä½¿ç”¨ nft ç»„ä»¶å¹¶è¿›è¡Œç›¸åº”é…ç½®ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a-nft</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;nft&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag"> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;./assets/2&quot;</span></span><br><span class="hljs-tag"></span><br><span class="hljs-tag">&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">a-entity</span> <span class="hljs-attr">gltf-model</span>=<span class="hljs-string">&quot;./assets/tiger.gltf&quot;</span> <span class="hljs-attr">scale</span>=<span class="hljs-string">&quot;1 1 1&quot;</span> <span class="hljs-attr">position</span>=<span class="hljs-string">&quot;0 0 0&quot;</span>&gt;</span><br><br> <span class="hljs-tag">&lt;/<span class="hljs-name">a-entity</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">a-nft</span>&gt;</span><br><br></code></pre></td></tr></table></figure><p>æ³¨æ„nftçš„urlä¸­å†™çš„æ˜¯å›¾ç‰‡çš„åï¼Œä¸éœ€è¦åç¼€ï¼Œåœ¨å®ƒé‡Œé¢æ·»åŠ æˆ‘ä»¬è¯†åˆ«åæƒ³è¦å±•ç¤ºçš„æ¨¡å‹ï¼Œå¹¶è®¾ç½®æ”¾å¤§çº§åˆ«å’Œä½ç½®ã€‚</p><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>åˆ°è¿™é‡Œå…¶å®è¿™ä¸ªä»£ç å°±å®Œæˆäº†ï¼Œæˆ‘ä»¬å…´è‡´å‹ƒå‹ƒçš„å¯¹é¡¹ç›®å¼€å¯live-serverï¼Œç”¨æ‰‹æœºè®¿é—®ä¸€ä¸‹é¡µé¢ã€‚</p><p>å’¦ï¼Œä¸ºä»€ä¹ˆæç¤ºæˆ‘ä»¬çš„æµè§ˆå™¨æ²¡æœ‰<code>navigator.mediaDevices</code>ï¼Œç™¾åº¦äº†ä¸€ä¸‹å‘ç°ï¼Œæµè§ˆå™¨ç«¯æƒ³è¦è°ƒç”¨æ‘„åƒå¤´åªæœ‰å‡ ç§æƒ…å†µï¼š</p><ul><li><p>file</p></li><li><p>localhost</p></li><li><p>https</p></li></ul><p>é‚£æˆ‘ä»¬å¦‚æœåœ¨æœ¬åœ°è¯¥æ€ä¹ˆè°ƒè¯•å‘¢ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªä¸€ç›´åœ¨ç”¨çš„å†…ç½‘ç©¿é€ç¥å™¨ï¼šngrokï¼ˆå®‰è£…åŒ…ä¹Ÿæ”¾åœ¨ä»“åº“ä¸­äº†ï¼‰</p><p>è§£å‹æ‰“å¼€åæ‰§è¡Œngrok http 8080ï¼Œç¬¬ä¸€æ¬¡éœ€è¦æ³¨å†Œè´¦å·å¹¶ç»‘å®šAuthtokenï¼Œç»‘å®šå®Œæˆåé‡å¯ngrokå†æ‰§è¡Œã€‚æˆåŠŸåä¼šè¿”å›ç»™ä½ ä¸‰ä¸ªåœ°å€ï¼Œæœ¬åœ°ã€httpå’Œhttpsçš„urlè·¯å¾„ï¼Œæˆ‘ä»¬ä½¿ç”¨httpsçš„å³å¯ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/002c45711e124719b383e1df70656fa4~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>æ‰‹æœºè®¿é—®åœ°å€åå°±å¯ä»¥å¼€å¯æ‘„åƒå¤´æƒé™äº†ã€‚</p><blockquote><p>å› ä¸ºæ˜¯å†…ç½‘ç©¿é€ï¼Œæ‰€ä»¥æ‰“å¼€é¡µé¢åŠè¯†åˆ«åŠ è½½éƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚</p></blockquote><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å…³äºè¯†åˆ«çš„å›¾ç‰‡ï¼Œæˆ‘ä½œä¸ºä¸€ä¸ªå‰ç«¯è®¤ä¸ºå¦‚æœæƒ³è¯†åˆ«é€šç”¨çš„ç¦å­—åº”è¯¥æ˜¯éœ€è¦è¿›è¡Œæ¨¡å‹è®­ç»ƒçš„ï¼Œä½†æ˜¯æˆ‘ä¸ä¼šï¼Œæ‰€ä»¥å°±æ”¹æˆäº†è¯†åˆ«è‡ªç„¶å›¾ç‰‡ï¼ŒæœŸå¾…å¤§ä½¬ä»¬çš„å®Œå–„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>AR.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Œæ–°æ˜¥åˆ›æ„ã€ç”¨å–œåº†çš„éŸ³ä¹é€è‡ªå·±ä¸€åœºéŸ³ä¹çƒŸèŠ±showğŸŠğŸŠ</title>
    <link href="/2022/01/10/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E7%94%A8%E5%96%9C%E5%BA%86%E7%9A%84%E9%9F%B3%E4%B9%90%E9%80%81%E8%87%AA%E5%B7%B1%E4%B8%80%E5%9C%BA%E9%9F%B3%E4%B9%90%E7%83%9F%E8%8A%B1show%F0%9F%8E%8A%F0%9F%8E%8A/"/>
    <url>/2022/01/10/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E7%94%A8%E5%96%9C%E5%BA%86%E7%9A%84%E9%9F%B3%E4%B9%90%E9%80%81%E8%87%AA%E5%B7%B1%E4%B8%80%E5%9C%BA%E9%9F%B3%E4%B9%90%E7%83%9F%E8%8A%B1show%F0%9F%8E%8A%F0%9F%8E%8A/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç»§<a href="https://juejin.cn/post/7051372704787595277">å†™ä¸ªç¦å­—é€ç»™æ–°å¹´çš„è‡ªå·±</a>åï¼Œä¸ºäº†è®©æ–°æ˜¥æ°›å›´æ›´åŠ æµ“åšï¼Œå¿…ä¸å¯å°‘çš„å°±æ˜¯çƒŸèŠ±å’Œ BGM äº†ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±åˆ©ç”¨ p5.js å®ç°ä¸€ä¸ªæ ¹æ®éŸ³ä¹æ¥ç»½æ”¾çƒŸèŠ±ï¼Œä¸ºæ–°æ˜¥å¢è‰²æ·»å½©~</p><h2 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b925f83d24f54322bbd7257581f04134~tplv-k3u1fbpfcp-watermark.image" alt="6.gif"></p><h2 id="ä»€ä¹ˆæ˜¯-p5-js"><a href="#ä»€ä¹ˆæ˜¯-p5-js" class="headerlink" title="ä»€ä¹ˆæ˜¯ p5.js"></a>ä»€ä¹ˆæ˜¯ p5.js</h2><blockquote><p>å®˜ç½‘ï¼šp5.js æ˜¯ä¸ª JavaScript åˆ›æ„ç¼–ç¨‹ç¨‹å¼åº“ï¼Œå…¶ä¸“æ³¨åœ¨è®©ç¼–ç¨‹æ›´æ˜“äºä½¿ç”¨åŠæ›´åŠ å¹¿æ³›çš„åŒ…å®¹è‰ºæœ¯å®¶ã€è®¾è®¡å¸ˆã€æ•™è‚²å®¶ã€åˆå­¦è€…ä»¥åŠä»»ä½•å…¶ä»–äººï¼p5.js æ˜¯ä¸ªå…è´¹åŠå¼€æºçš„è½¯ä»¶å› ä¸ºæˆ‘ä»¬ç›¸ä¿¡æ‰€æœ‰äººéƒ½åº”è¯¥èƒ½è‡ªç”±ä½¿ç”¨è½¯ä»¶åŠç”¨äºå­¦ä¹ è½¯ä»¶çš„å·¥å…·ã€‚p5.js ä½¿ç”¨ç»˜å›¾çš„æ¯”å–»å¹¶æœ‰ä¸€å‰¯å®Œæ•´çš„ç»˜ç”»åŠŸèƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨ä¹Ÿä¸å•é™äºæ‚¨çš„ç»˜å›¾ç”»å¸ƒã€‚æ‚¨å¯ä»¥å°†æ‚¨æ•´ä¸ªæµè§ˆå™¨é¡µé¢å½“ä½œæ‚¨çš„ç»˜å›¾ï¼Œè¿™åŒ…æ‹¬äº† HTML5 ç‰©ä»¶å¦‚æ–‡å­—ã€è¾“å…¥æ¡†ã€è§†å±ã€æ‘„åƒå¤´åŠéŸ³é¢‘ã€‚</p></blockquote><p>ç®€å•æ¥è¯´ï¼Œp5.js å¯ä»¥åˆ©ç”¨ canvas å®ç°è®¸è®¸å¤šå¤šç‚«é…·çš„æµè§ˆå™¨æ•ˆæœï¼Œä»¥åŠåœ¨æµè§ˆå™¨ä¸­è¿›è¡Œç»˜å›¾ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆå¼•ç”¨ p5 çš„ cdnï¼Œå› ä¸ºæˆ‘ä»¬è¦åˆ©ç”¨éŸ³é¢‘ç›¸å…³åŠŸèƒ½ï¼Œæ‰€ä»¥å†å¼•ç”¨å®ƒçš„æ‰©å±•åŒ… p5.sound</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/p5.js/1.4.0/p5.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.bootcdn.net/ajax/libs/p5.js/1.4.0/addons/p5.sound.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬é¦–å…ˆå®ç°çƒŸèŠ±çš„éƒ¨åˆ†ï¼Œç„¶åå†å°†éŸ³ä¹ä¸çƒŸèŠ±ç»“åˆèµ·æ¥</p><h3 id="åˆ›å»ºç”»å¸ƒ"><a href="#åˆ›å»ºç”»å¸ƒ" class="headerlink" title="åˆ›å»ºç”»å¸ƒ"></a>åˆ›å»ºç”»å¸ƒ</h3><p>p5 çš„å†™æ³•ä¸ä¸€èˆ¬æƒ…å†µä¸åŒï¼Œjs ä¸­ç›´æ¥å®šä¹‰ setup å‡½æ•°å³å¯å®ç°åˆå§‹åŒ–,draw å‡½æ•°åˆ™ç”¨æ¥å¯¹ç”»å¸ƒè¿›è¡Œç»˜åˆ¶ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">background</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ vue ä¸­å¦‚æœæƒ³è¦å®šä¹‰ setup å‡½æ•°åˆ™éœ€è¦ä½¿ç”¨å¦ä¸€ç§å£°æ˜æ–¹å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">s</span> = (<span class="hljs-params">sketch</span>) =&gt; &#123;<br>  sketch.<span class="hljs-property">setup</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">createCanvas</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>)<br>  &#125;<br>  sketch.<span class="hljs-property">draw</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">background</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬ç›´æ¥åœ¨ html ä¸­ç¼–å†™ä»£ç æ‰€ä»¥é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚</p><h3 id="åˆ›å»ºçƒŸèŠ±"><a href="#åˆ›å»ºçƒŸèŠ±" class="headerlink" title="åˆ›å»ºçƒŸèŠ±"></a>åˆ›å»ºçƒŸèŠ±</h3><p>è¿™é‡Œæˆ‘ä»¬æ¨¡æ‹Ÿçš„çƒŸèŠ±ç”±ä¸€ä¸ªä¸­å¿ƒç‚¹å’Œå›´ç»•åœ¨å‘¨å›´çš„éšæœºç‚¹æ„æˆã€‚ å…·ä½“ä»£ç ä½œç”¨å’Œå«ä¹‰åœ¨æ³¨é‡Šä¸­æ ‡æ³¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// ç›®å‰æ¥æ”¶ä¸€ä¸ªçˆ†ç‚¸åŠå¾„å‚æ•°ã€‚</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Fireworks</span>(<span class="hljs-params">radius</span>) &#123;<br>  <span class="hljs-keyword">var</span> num = <span class="hljs-number">64</span> <span class="hljs-comment">// ä¸€ä¸ªçƒŸèŠ±æœ‰å¤šå°‘ä¸ªç‚¹</span><br><br>  <span class="hljs-comment">// éšæœºä¸­å¿ƒç‚¹ä½ç½®ï¼Œwidthå’Œheightä¸ºç”»å¸ƒçš„å®½é«˜ã€‚</span><br>  <span class="hljs-keyword">var</span> cp = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<br>    <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, width),<br>    <span class="hljs-title function_">random</span>(height / <span class="hljs-number">2</span>, height / <span class="hljs-number">5</span>),<br>    <span class="hljs-title function_">random</span>(-<span class="hljs-number">100</span>, <span class="hljs-number">100</span>)<br>  )<br><br>  <span class="hljs-comment">// å®šä¹‰çƒŸèŠ±å‘å°„çš„é€Ÿåº¦å’ŒåŠ é€Ÿåº¦ï¼Œç›®å‰é«˜åº¦å†™æ­»ï¼Œåç»­ä¼šæ ¹æ®éŸ³é¢‘ç›¸å…³æ•°æ®è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ã€‚</span><br>  <span class="hljs-keyword">var</span> velocity = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">15</span>, <span class="hljs-number">0</span>)<br>  <span class="hljs-keyword">var</span> accel = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0.4</span>, <span class="hljs-number">0</span>)<br><br>  <span class="hljs-keyword">var</span> img<br><br>  <span class="hljs-keyword">var</span> fp = []<br><br>  <span class="hljs-keyword">var</span> cosTheta<br>  <span class="hljs-keyword">var</span> sinTheta<br>  <span class="hljs-keyword">var</span> phi<br>  <span class="hljs-keyword">var</span> colorChange = <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>)<br><br>  <span class="hljs-comment">// åˆå§‹åŒ–çƒŸèŠ±çš„ç‚¹</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; num; i++) &#123;<br>    cosTheta = <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) * <span class="hljs-number">2</span> - <span class="hljs-number">1</span><br>    sinTheta = <span class="hljs-title function_">sqrt</span>(<span class="hljs-number">1</span> - cosTheta * cosTheta)<br>    phi = <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>) * <span class="hljs-number">2</span> * <span class="hljs-variable constant_">PI</span><br>    fp[i] = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<br>      radius * sinTheta * <span class="hljs-title function_">cos</span>(phi),<br>      radius * sinTheta * <span class="hljs-title function_">sin</span>(phi),<br>      radius * cosTheta<br>    ) <span class="hljs-comment">//1å‘çƒŸèŠ±é‡Œå„ä¸ªç‚¹çš„ä½ç½®è®¡ç®—</span><br>    fp[i] = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">mult</span>(fp[i], <span class="hljs-number">1.01</span>)<br>  &#125;<br><br>  <span class="hljs-comment">// ä¸ºçƒŸèŠ±è¿›è¡Œéšæœºä¸Šè‰²</span><br>  <span class="hljs-keyword">var</span> side = <span class="hljs-number">64</span><br>  <span class="hljs-keyword">var</span> center = side / <span class="hljs-number">2.0</span><br><br>  img = <span class="hljs-title function_">createImage</span>(side, side)<br>  img.<span class="hljs-title function_">loadPixels</span>()<br>  <span class="hljs-keyword">const</span> r = <span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>)<br>  <span class="hljs-keyword">const</span> g = <span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>)<br>  <span class="hljs-keyword">const</span> b = <span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>)<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> y = <span class="hljs-number">0</span>; y &lt; side; y++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; side; x++) &#123;<br>      <span class="hljs-keyword">var</span> distance = (<span class="hljs-title function_">sq</span>(center - x) + <span class="hljs-title function_">sq</span>(center - y)) / <span class="hljs-number">10.0</span><br>      <span class="hljs-keyword">var</span> r = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * r) / distance)<br>      <span class="hljs-keyword">var</span> g = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * g) / distance)<br>      <span class="hljs-keyword">var</span> b = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * b) / distance)<br>      <span class="hljs-comment">// img.pixels[x + y * side] = color(r, g, b);</span><br>      img.<span class="hljs-title function_">set</span>(y, x, <span class="hljs-title function_">color</span>(r, g, b))<br>    &#125;<br>  &#125;<br><br>  img.<span class="hljs-title function_">updatePixels</span>()<br><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">display</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; num; i++) &#123;<br>      <span class="hljs-title function_">push</span>()<br>      <span class="hljs-title function_">translate</span>(cp.<span class="hljs-property">x</span>, cp.<span class="hljs-property">y</span>, cp.<span class="hljs-property">z</span>)<br>      <span class="hljs-title function_">translate</span>(fp[i].<span class="hljs-property">x</span>, fp[i].<span class="hljs-property">y</span>, fp[i].<span class="hljs-property">z</span>)<br>      <span class="hljs-title function_">blendMode</span>(<span class="hljs-variable constant_">ADD</span>) <span class="hljs-comment">//å„ä¸ªå°ç‚¹ï¼ˆå‘å…‰æºé®ç½©æ•ˆæœï¼‰</span><br>      <span class="hljs-title function_">image</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>      <span class="hljs-title function_">pop</span>()<br><br>      fp[i] = p5.<span class="hljs-property">Vector</span>.<span class="hljs-title function_">mult</span>(fp[i], <span class="hljs-number">1.015</span>) <span class="hljs-comment">//æ›´æ–°å°ç‚¹ï¼ˆå‘å…‰æºï¼‰æ‰©æ•£ä½ç½®</span><br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">//æ¨¡æ‹Ÿé‡åŠ›åŠ é€Ÿåº¦</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">update</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    radius = <span class="hljs-title function_">dist</span>(<br>      <span class="hljs-number">0</span>,<br>      <span class="hljs-number">0</span>,<br>      <span class="hljs-number">0</span>,<br>      fp[<span class="hljs-number">0</span>].<span class="hljs-property">x</span>,<br>      fp[<span class="hljs-number">0</span>].<span class="hljs-property">y</span>,<br>      fp[<span class="hljs-number">0</span>].<span class="hljs-property">z</span><br>    )<br>    centerPosition.<span class="hljs-title function_">add</span>(velocity)<br>    velocity.<span class="hljs-title function_">add</span>(accel)<br>  &#125;<br><br>  <span class="hljs-comment">//   åˆ¤æ–­æ˜¯å¦éœ€è¦é”€æ¯</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">needRemove</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (centerPosition.<span class="hljs-property">y</span> - radius &gt; height) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨åŸºæœ¬çš„çƒŸèŠ±ç±»å·²ç»è¢«å®šä¹‰å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ç”»å¸ƒç»‘å®šä¸€ä¸ªé”®ç›˜äº‹ä»¶ï¼Œå¹¶ä¿®æ”¹ draw å‡½æ•°ä¸­ç›¸å…³é€»è¾‘æ¥çœ‹ä¸€ä¸‹æ•ˆæœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">keyPressed</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//é”®ç›˜äº‹ä»¶æ·»åŠ ä¸€å‘çƒŸèŠ±</span><br>  fireworks.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Fireworks</span>(<span class="hljs-number">20</span>)) <span class="hljs-comment">//80ä¸ºçƒŸèŠ±åˆå§‹åŠå¾„</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-title function_">background</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>)<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fireworks.<span class="hljs-property">length</span>; i++) &#123;<br>    fireworks[i].<span class="hljs-title function_">display</span>()<br>    fireworks[i].<span class="hljs-title function_">update</span>()<br>    <span class="hljs-keyword">if</span> (fireworks[i].<span class="hljs-title function_">needRemove</span>()) &#123;<br>      fireworks.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/043e880dbae54477a802eb3f369efdae~tplv-k3u1fbpfcp-watermark.image" alt="7.gif"></p><p><strong>ç›¸å…³ API</strong></p><p>è¿™é‡Œå°†ä¸Šè¿°ç”¨åˆ°çš„ç›¸å…³ api å’Œç±» å•åˆ—å‡ºæ¥æ–¹ä¾¿æŸ¥çœ‹</p><table><thead><tr><th>API</th><th>æè¿°</th></tr></thead><tbody><tr><td>createCanvas</td><td>åˆ›å»ºç”»å¸ƒ</td></tr><tr><td>background</td><td>è®¾ç½®èƒŒæ™¯è‰²</td></tr><tr><td>p5.Vector</td><td>åˆ›å»ºåŒ…å«å¹…åº¦å’Œæ–¹å‘çš„æ–° p5 å‘é‡</td></tr><tr><td>random</td><td>è¿”å›åœ¨ä½œä¸ºå‚æ•°ç»™å‡ºçš„èŒƒå›´ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°</td></tr><tr><td>sqrt</td><td>è·å–ä»»ä½•è¾“å…¥æ•°å­—çš„å¹³æ–¹æ ¹</td></tr><tr><td>createImage</td><td>åˆ›å»ºå›¾ç‰‡</td></tr><tr><td>translate</td><td>æŒ‡å®šåœ¨æ˜¾ç¤ºçª—å£å†…æ”¾ç½®å¯¹è±¡çš„æ•°é‡ x å‚æ•°ç”¨äºæŒ‡å®šå·¦/å³å¹³ç§» y å‚æ•°ç”¨äºæŒ‡å®šä¸Š/ä¸‹å¹³ç§»</td></tr><tr><td>blendMode</td><td>æ ¹æ®ç»™å®šçš„æ··åˆæ¨¡å¼æ··åˆä¸¤ä¸ªåƒç´ </td></tr><tr><td>dist</td><td>æµ‹é‡è®¡ç®—åœ¨ 2D æˆ– 3D ä¸­ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»</td></tr></tbody></table><h3 id="è·å–éŸ³é¢‘å‚æ•°"><a href="#è·å–éŸ³é¢‘å‚æ•°" class="headerlink" title="è·å–éŸ³é¢‘å‚æ•°"></a>è·å–éŸ³é¢‘å‚æ•°</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ª<code>audio</code>æ ‡ç­¾æ¥å­˜æ”¾æˆ‘ä»¬çš„éŸ³ä¹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">audio</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./1.mp3&quot;</span> <span class="hljs-attr">autoplay</span> <span class="hljs-attr">controls</span>&gt;</span>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ audio æ ‡ç­¾ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">audio</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¥ç€æ”¹é€ æˆ‘ä»¬çš„ setup å‡½æ•°ï¼Œè®©å®ƒèƒ½å¤Ÿè·å–åˆ°æˆ‘ä»¬çš„éŸ³é¢‘èµ„æº</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> fireworks = []<br><span class="hljs-keyword">var</span> highMap = [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">15</span>]<br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ORI_NUM</span> = <span class="hljs-number">32</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//processingåˆå§‹åŒ–è®¾ç½®</span><br>  <span class="hljs-title function_">createCanvas</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>)<br>  <span class="hljs-title function_">frameRate</span>(<span class="hljs-number">60</span>) <span class="hljs-comment">// æ¯ç§’æ¸²æŸ“æ¬¡æ•°</span><br>  <span class="hljs-title function_">imageMode</span>(<span class="hljs-variable constant_">CENTER</span>)<br>  audioContext_ = <span class="hljs-title function_">getAudioContext</span>()<br>  <span class="hljs-comment">//å–å¾—å£°éŸ³dom</span><br>  <span class="hljs-keyword">let</span> el = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;audio&#x27;</span>)<br>  <span class="hljs-comment">//æ ¹æ®å£°éŸ³domåˆ›å»ºweb audio API source node, å¹¶ä¸”è¿æ¥ä¸»è¾“å‡º</span><br>  <span class="hljs-keyword">const</span> source = audioContext_.<span class="hljs-title function_">createMediaElementSource</span>(el)<br>  source.<span class="hljs-title function_">connect</span>(p5.<span class="hljs-property">soundOut</span>)<br>  <span class="hljs-comment">//0.8æ˜¯å˜åŒ–ç¨‹åº¦ï¼Œè¶Šå°å›¾æ¡ˆè¶ŠæŠ–</span><br>  fft = <span class="hljs-keyword">new</span> p5.<span class="hljs-title function_">FFT</span>(<span class="hljs-number">0.8</span>, <span class="hljs-variable constant_">ORI_NUM</span>)<br>  fft.<span class="hljs-title function_">setInput</span>(source)<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬è·å–äº†éŸ³é¢‘èµ„æºçš„é¢‘è°±ï¼Œæœªæ¥ç”¨æ¥æ§åˆ¶æˆ‘ä»¬çƒŸèŠ±çš„å¤§å°ä»¥åŠé«˜åº¦ã€‚å½“ç„¶ p5.sound è¿˜å¯ä»¥è·å–éŸ³é¢‘çš„éŸ³é‡ç­‰ç­‰ï¼Œä»¥å®ç°æ›´ç‚«é…·çš„å¯è§†åŒ–æ•ˆæœã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ”¹é€  draw ç»˜åˆ¶å‡½æ•°ï¼Œè§£ææœ¬åœ°éŸ³é¢‘çš„é¢‘è°±å¹¶åˆ©ç”¨å®ƒæ¥æäº‹æƒ…</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//å¾ªç¯æ‰§è¡Œï¼Œè¾¾æˆç”»é¢æ¸²æŸ“æ•ˆæœ</span><br><br>  audioContext_.<span class="hljs-title function_">resume</span>()<br>  <span class="hljs-title function_">background</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>)<br>  <span class="hljs-keyword">let</span> spectrum = fft.<span class="hljs-title function_">analyze</span>()<br><br>  spectrum.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item, j</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (item !== <span class="hljs-number">0</span> &amp;&amp; j % <span class="hljs-number">2</span>) &#123;<br>      <span class="hljs-keyword">let</span> a = highMap[<span class="hljs-number">0</span>]<br>      <span class="hljs-keyword">if</span> (item &gt;= <span class="hljs-number">64</span> &amp;&amp; item &lt; <span class="hljs-number">128</span>) &#123;<br>        a = highMap[<span class="hljs-number">1</span>]<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item &gt;= <span class="hljs-number">128</span> &amp;&amp; item &lt; <span class="hljs-number">192</span>) &#123;<br>        a = highMap[<span class="hljs-number">2</span>]<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        a = highMap[<span class="hljs-number">3</span>]<br>      &#125;<br>      <span class="hljs-keyword">const</span> fire = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Fireworks</span>(item, a)<br>      fireworks.<span class="hljs-title function_">push</span>(fire)<br>      <span class="hljs-keyword">if</span> (fireworks.<span class="hljs-property">length</span> &gt; <span class="hljs-number">64</span>) &#123;<br>        fireworks.<span class="hljs-title function_">shift</span>()<br>      &#125;<br>    &#125;<br>  &#125;)<br><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; fireworks.<span class="hljs-property">length</span>; i++) &#123;<br>    fireworks[i].<span class="hljs-title function_">display</span>()<br>    fireworks[i].<span class="hljs-title function_">update</span>()<br>    <span class="hljs-keyword">if</span> (fireworks[i].<span class="hljs-title function_">needRemove</span>()) &#123;<br>      fireworks.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>)<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨æ„<code>audioContext_.resume()</code>æ˜¯å¿…é¡»è¦æ·»åŠ çš„ï¼Œå› ä¸ºè°·æ­Œæµè§ˆå™¨é»˜è®¤ä¸ä¼šè‡ªåŠ¨æ’­æ”¾éŸ³é¢‘ã€‚</p></blockquote><p>spectrum å°±æ˜¯æˆ‘ä»¬åˆ†æå¾—åˆ°çš„é¢‘è°±æ•°å€¼ç»„æˆçš„æ•°ç»„ï¼ŒORI_NUM ä½œä¸ºé¢‘è°±çš„ä¸ªæ•°ï¼Œæœ€å°‘éœ€è¦ 32 ä¸ªã€‚æˆ‘ä»¬ç†è®ºä¸Šå¯ä»¥æ”¾æ›´å¤šçš„çƒŸèŠ±ï¼Œä½†æ˜¯ç”±äºæœ¬äººç”µè„‘æ€§èƒ½ä¸€èˆ¬ï¼Œæ‰€ä»¥ç›´æ¥å– 16 ä¸ªæ¥æ”¾çƒŸèŠ±ã€‚</p><p>ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒFireworks ç±»æˆ‘ä»¬ä¼ äº†ä¸¤ä¸ªå‚æ•°ï¼šé¢‘è°±çš„å€¼å’Œæˆ‘ä»¬å®šä¹‰çš„é«˜åº¦å€¼ï¼Œç°åœ¨å°±å¯ä»¥å¯¹çƒŸèŠ±ç±»æ”¹é€ ï¼Œä»¥å®ç°æ ¹æ®éŸ³é¢‘æ¥æ§åˆ¶çƒŸèŠ±çš„çˆ†ç‚¸åŠå¾„å’Œå‘å°„é«˜åº¦ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Fireworks</span>(<span class="hljs-params">radius, h</span>) &#123;<br>  <span class="hljs-keyword">var</span> num = <span class="hljs-number">64</span> <span class="hljs-comment">//ä¸€å‘çƒŸèŠ±é‡Œï¼Œæœ‰å¤šå°‘ä¸ªç‚¹ (æ¯”è¾ƒåƒæœºå™¨)</span><br><br>  <span class="hljs-keyword">var</span> cp = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<br>    <span class="hljs-title function_">random</span>(<span class="hljs-number">0</span>, width),<br>    <span class="hljs-title function_">random</span>(height / <span class="hljs-number">2</span>, height / <span class="hljs-number">5</span>),<br>    <span class="hljs-title function_">random</span>(-<span class="hljs-number">100</span>, <span class="hljs-number">100</span>)<br>  ) <span class="hljs-comment">//çƒŸèŠ±çš„ä¸­å¿ƒä½ç½®</span><br>  <span class="hljs-keyword">var</span> velocity = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<span class="hljs-number">0</span>, -h, <span class="hljs-number">0</span>)<br>  <span class="hljs-keyword">var</span> accel = <span class="hljs-keyword">new</span> p5.<span class="hljs-title class_">Vector</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0.4</span>, <span class="hljs-number">0</span>)<br><br>  â€¦â€¦<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºäº†æ•ˆæœæ›´çœŸå®ï¼Œæˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹çƒŸèŠ±çš„éšæœºé¢œè‰²ï¼Œè®©å®ƒæ›´äº®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (colorChange &gt;= <span class="hljs-number">3.5</span>) &#123;<br>  img = <span class="hljs-title function_">makeColor</span>(<span class="hljs-number">0.9</span>, <span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>), <span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>))<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colorChange &gt; <span class="hljs-number">3.2</span>) &#123;<br>  img = <span class="hljs-title function_">makeColor</span>(<span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>), <span class="hljs-number">0.9</span>, <span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>))<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (colorChange &gt; <span class="hljs-number">2</span>) &#123;<br>  img = <span class="hljs-title function_">makeColor</span>(<span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>), <span class="hljs-title function_">random</span>(<span class="hljs-number">0.2</span>, <span class="hljs-number">0.5</span>), <span class="hljs-number">0.9</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  img = <span class="hljs-title function_">makeColor</span>(<span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>), <span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>), <span class="hljs-title function_">random</span>(<span class="hljs-number">0.5</span>, <span class="hljs-number">0.8</span>))<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">makeColor</span>(<span class="hljs-params">rr, gg, bb</span>) &#123;<br>  <span class="hljs-keyword">var</span> side = <span class="hljs-number">64</span><br>  <span class="hljs-keyword">var</span> center = side / <span class="hljs-number">2.0</span><br><br>  <span class="hljs-keyword">var</span> img = <span class="hljs-title function_">createImage</span>(side, side)<br>  img.<span class="hljs-title function_">loadPixels</span>()<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> y = <span class="hljs-number">0</span>; y &lt; side; y++) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; side; x++) &#123;<br>      <span class="hljs-keyword">var</span> distance = (<span class="hljs-title function_">sq</span>(center - x) + <span class="hljs-title function_">sq</span>(center - y)) / <span class="hljs-number">10.0</span><br>      <span class="hljs-keyword">var</span> r = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * rr) / distance)<br>      <span class="hljs-keyword">var</span> g = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * gg) / distance)<br>      <span class="hljs-keyword">var</span> b = <span class="hljs-title function_">int</span>((<span class="hljs-number">255</span> * bb) / distance)<br>      <span class="hljs-comment">// img.pixels[x + y * side] = color(r, g, b);</span><br>      img.<span class="hljs-title function_">set</span>(y, x, <span class="hljs-title function_">color</span>(r, g, b))<br>    &#125;<br>  &#125;<br><br>  img.<span class="hljs-title function_">updatePixels</span>()<br>  <span class="hljs-keyword">return</span> img<br>&#125;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå°±å¦‚æ–‡ç« å¼€å¤´é‚£æ ·ç»šçƒ‚å¤šå½©ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è‡³æ­¤éŸ³ä¹çƒŸèŠ±å°±å®ç°äº†ï¼Œè€Œ p5.js ä¹Ÿæ˜¯æˆ‘ä¸ç»æ„é—´å‘ç°çš„ä¸€ä¸ªåº“ï¼Œå‘ç°ç”¨å®ƒå¯ä»¥åšå‡ºå„ç§å¼ºå¤§çš„åŠ¨ç”»ã€‚æœ¬ä»¥ä¸ºæˆ‘ä¼šæ˜¯ç¬¬ä¸€ä¸ªç”¨ p5,js æ¥å®ç°æ•ˆæœçš„äººï¼Œè€Œå°±åœ¨æˆ‘æŠŠè¿™ä¸ª demo å†™å‡ºæ¥çš„ç¬¬äºŒå¤©ï¼Œæ´»åŠ¨çš„ç¬¬ä¸€å¤©ï¼Œå°±è¯»åˆ°äº†åŒ—äº¬å“¥çš„<a href="https://juejin.cn/post/7051353946052362277">ä¸€åœºçƒŸèŠ±ç››å®´ ğŸ‡ï¼Œç¥ä½ æ–°å¹´å¿«ä¹ ğŸ‰</a>ï¼Œå®ç°æ€è·¯ä¸åŒï¼Œæ•ˆæœæˆ‘è§‰å¾—åŒ—äº¬å“¥çš„ä¹Ÿæ›´ç¾è§‚çœŸå®~ï¼Œå¿ƒç—›å“ˆå“ˆå“ˆå“ˆåšä¸äº†ç¬¬ä¸€é‚£åšä¸ªâ€¦â€¦ç¬¬nä¹Ÿä¸é”™ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>p5.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Œæ–°æ˜¥åˆ›æ„ã€å†™ä¸ªç¦å­—é€ç»™æ–°å¹´çš„è‡ªå·±å§ï¼</title>
    <link href="/2022/01/10/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E5%86%99%E4%B8%AA%E7%A6%8F%E5%AD%97%E9%80%81%E7%BB%99%E6%96%B0%E5%B9%B4%E7%9A%84%E8%87%AA%E5%B7%B1%E5%90%A7%EF%BC%81/"/>
    <url>/2022/01/10/%E3%80%8C%E6%96%B0%E6%98%A5%E5%88%9B%E6%84%8F%E3%80%8D%E5%86%99%E4%B8%AA%E7%A6%8F%E5%AD%97%E9%80%81%E7%BB%99%E6%96%B0%E5%B9%B4%E7%9A%84%E8%87%AA%E5%B7%B1%E5%90%A7%EF%BC%81/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘åˆåŒå’æ¥å‚åŠ æ´»åŠ¨äº†ï¼Œæ–°å¹´æ–°æ°”è±¡ï¼Œä½œä¸ºæ–°å¹´çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œå¿…é¡»ç¦æ°”æ»¡æ»¡ï¼Œç»™è‡ªå·±ä¸€ä¸ªå¥½å…†å¤´ï¼ˆè¯»ä¹¦ç¬”è®°æš‚æ—¶é¸½ä¸€ä¸‹ï¼Œå“ˆå“ˆå“ˆå“ˆï¼‰ã€‚ä¸çŸ¥é“jymè¿˜è®°ä¸è®°å¾—å»å¹´æ”¯ä»˜å®çš„ä¸€ä¸ªå†™ç¦å­—çš„æ´»åŠ¨ï¼Œæˆ‘å½“æ—¶è¿˜å†™äº†ä¸€ä¸ªè‡ªè®¤ä¸ºå¾ˆå¥½çœ‹çš„ç¦å‘¢ã€‚</p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fed104db39d84e0b915c72a33361303d~tplv-k3u1fbpfcp-watermark.image?" alt="" width="175" height="360" align="bottom" /><p>å‰å‡ å¤©çªå‘å¥‡æƒ³ï¼Œèº«ä¸ºä¸€ä¸ªå‰ç«¯äººä¸ºä»€ä¹ˆä¸èƒ½è‡ªå·±åšä¸€ä¸ªå‘¢ï¼Ÿè¯´å¹²å°±å¹²ï¼</p><h2 id="æ€ä¹ˆå®ç°"><a href="#æ€ä¹ˆå®ç°" class="headerlink" title="æ€ä¹ˆå®ç°"></a>æ€ä¹ˆå®ç°</h2><p>ç¾å…¶åæ›°å†™ç¦ï¼Œå…¶å®å°±æ˜¯åœ¨æµè§ˆå™¨ç»˜åˆ¶ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±èƒ½æƒ³åˆ°ç”¨canvaså®ç°ã€‚æˆ‘ä»¬åªéœ€è¦ç”¨canvasæ•æ‰é¼ æ ‡ç§»åŠ¨è½¨è¿¹å¹¶å°†å…¶ç»˜åˆ¶å‡ºæ¥å°±èƒ½å®ç°è¿™æ ·çš„æ•ˆæœï¼ˆå®ç°çš„æ—¶å€™å‘ç°æ˜¯æˆ‘æƒ³çš„å¤ªç®€å•äº†â€¦â€¦ï¼‰ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬å¯¹canvasçš„apiæœ‰è¶³å¤Ÿçš„äº†è§£ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†ï¼Œæƒ³äº†è§£çš„ç™¾åº¦ä¸€ä¸‹ä½ å°±çŸ¥é“~</p><h2 id="V1-0å®ç°"><a href="#V1-0å®ç°" class="headerlink" title="V1.0å®ç°"></a>V1.0å®ç°</h2><p>é¦–å…ˆæˆ‘ä»¬è‚¯å®šéœ€è¦ä¸€ä¸ªcanvasï¼Œä¸ºäº†æ–¹ä¾¿è§‚å¯Ÿï¼Œç»™å®ƒåŠ ä¸Šä¸€ä¸ªèƒŒæ™¯è‰²ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;canvas <span class="hljs-attribute">id</span>=<span class="hljs-string">&quot;canvas&quot;</span> <span class="hljs-attribute">style</span>=<span class="hljs-string">&quot;background:#ffffcc&quot;</span> <span class="hljs-attribute">width</span>=<span class="hljs-string">&quot;400&quot;</span> <span class="hljs-attribute">height</span>=<span class="hljs-string">&quot;500&quot;</span>&gt;&lt;/canvas&gt;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®šä¹‰å‡ ä¸ªå˜é‡å¹¶å¼€å§‹å®ç°æ•ˆæœï¼š</p><ul><li>moveFlag&lt;Boolean&gt;ï¼šå¼€å§‹ç»˜åˆ¶çš„æ ‡å¿—</li><li>offset&lt;Object&gt;ï¼šé¼ æ ‡çš„å½“å‰ä½ç½®</li><li>posList&lt;Array&gt;ï¼šé¼ æ ‡è¿åŠ¨çš„ä½ç½®é›†åˆ</li></ul><p>ç»˜åˆ¶å‡ºæ¥çš„çº¿å®è´¨ä¸Šæ˜¯ä¸€ä¸ªä¸ªç‚¹çš„é›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹é¼ æ ‡è¿åŠ¨è¿‡çš„ä½ç½®åŠ ä»¥è®°å½•ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ç”»ç¬”çš„é¢œè‰²å¹¶å¯¹canvasç»‘å®šä¸Šé¼ æ ‡ç›¸å…³äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯å¯è°ƒæ•´ä¸ºtouchç›¸å…³äº‹ä»¶ï¼Œè¿™é‡Œä¸åšç¼–å†™ï¼‰ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-tag">var</span> moveFlag = false<br><span class="hljs-selector-tag">var</span> offset = &#123;&#125;,<br> Â  Â posList = <span class="hljs-selector-attr">[]</span> <br><br><span class="hljs-selector-tag">var</span> <span class="hljs-selector-tag">canvas</span> = document<span class="hljs-selector-class">.getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>)<br><span class="hljs-selector-tag">var</span> ctx = <span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>)<br>ctx<span class="hljs-selector-class">.fillStyle</span> = <span class="hljs-string">&#x27;rgba(0,0,0,0.3)&#x27;</span><br><br><span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.onmousedown</span> = (e) =&gt; &#123;<br> Â  Â <span class="hljs-built_in">downEvent</span>(e)<br>&#125;<br><span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.onmousemove</span> = (e) =&gt; &#123;<br> Â  Â <span class="hljs-built_in">moveEvent</span>(e)<br>&#125;<br><span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.onmouseup</span> = (e) =&gt; &#123;<br> Â  Â <span class="hljs-built_in">upEvent</span>(e)<br>&#125;<br><span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.onmouseout</span> = (e) =&gt; &#123;<br> Â  Â <span class="hljs-built_in">upEvent</span>(e)<br>&#125;<br><br></code></pre></td></tr></table></figure><p>é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶çš„é€»è¾‘å°±æ˜¯ä¿®æ”¹æ ‡å¿—ä¸ºtrueï¼Œæ¸…ç©ºä½ç½®é›†åˆå¹¶ä¿å­˜å½“å‰é¼ æ ‡ä½ç½®ï¼ŒæŠ¬èµ·å’Œç§»å‡ºäº‹ä»¶æ— éå°±æ˜¯ä¿®æ”¹æ ‡å¿—ä¸ºfalseï¼Œå®ç°çš„é‡ç‚¹åœ¨ç§»åŠ¨äº‹ä»¶ï¼Œç¨åé‡ç‚¹è®²è§£ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">function</span> down<span class="hljs-constructor">Event(<span class="hljs-params">e</span>)</span> &#123;<br> Â  Â moveFlag = <span class="hljs-literal">true</span><br> Â  Â posList = <span class="hljs-literal">[]</span><br> Â  Â offset = get<span class="hljs-constructor">Pos(<span class="hljs-params">e</span>)</span><br>&#125;<br><span class="hljs-keyword">function</span> up<span class="hljs-constructor">Event(<span class="hljs-params">e</span>)</span> &#123;<br> Â  Â moveFlag = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é¼ æ ‡æŒ‰ä¸‹æ—¶ä½¿ç”¨äº†ä¸€ä¸ªå·¥å…·å‡½æ•°è·å–ä½ç½®ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">function <span class="hljs-built_in">getPos</span>(e) &#123;<br> Â  Â return &#123;<br> Â  Â  Â  Â x: e<span class="hljs-selector-class">.clientX</span> - <span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.offsetLeft</span>,<br> Â  Â  Â  Â y: e<span class="hljs-selector-class">.clientY</span> - <span class="hljs-selector-tag">canvas</span><span class="hljs-selector-class">.offsetTop</span><br> Â   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é¼ æ ‡ç§»åŠ¨æ—¶æˆ‘ä»¬éƒ½è¦å¹²ä»€ä¹ˆï¼Œè·å–å½“å‰é¼ æ ‡ä½ç½®ï¼Œå°†ä¸¤æ¬¡é¼ æ ‡ä½ç½®ç§»åŠ¨çš„è·ç¦»ç½®å…¥é›†åˆï¼Œå¹¶æ ¹æ®ç§»åŠ¨è·ç¦»ç»˜åˆ¶æ— æ•°ä¸ªç‚¹ä»¥æ„æˆçº¿ï¼Œç„¶åå°†å½“å‰ç‚¹å˜æˆé¼ æ ‡ç§»åŠ¨ç»ˆç‚¹ä½ç½®ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs maxima">function moveEvent(e) &#123;<br> Â  Â <span class="hljs-keyword">if</span> (!moveFlag) <span class="hljs-built_in">return</span><br> Â  Â <span class="hljs-built_in">var</span> currentOffset = getPos(e)<br> Â  Â <span class="hljs-built_in">var</span> prevOffset = offset<br> Â  Â <span class="hljs-built_in">var</span> <span class="hljs-built_in">radius</span> = <span class="hljs-number">1</span><br><br> Â  Â posList.unshift(&#123;<br> Â  Â  Â  Â distance: getDistance(prevOffset, currentOffset),<br> Â  Â  Â  Â <span class="hljs-built_in">time</span>: <span class="hljs-built_in">new</span> Date().getTime()<br> Â   &#125;)<br><br> Â  Â <span class="hljs-built_in">var</span> dis = <span class="hljs-number">0</span>,<br> Â  Â  Â  Â <span class="hljs-built_in">time</span> = <span class="hljs-number">0</span><br><br> Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-built_in">var</span> i = <span class="hljs-number">0</span>, l = posList.<span class="hljs-built_in">length</span> - <span class="hljs-number">1</span>; i &lt; l; i++) &#123;<br> Â  Â  Â  Â dis += posList[i].distance<br> Â  Â  Â  Â <span class="hljs-built_in">time</span> += posList[i].<span class="hljs-built_in">time</span> - posList[i + <span class="hljs-number">1</span>].<span class="hljs-built_in">time</span><br> Â   &#125;<br><br> Â  Â offset = currentOffset<br><br> Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-built_in">var</span> i = <span class="hljs-number">0</span>, l = Math.<span class="hljs-built_in">round</span>(posList[<span class="hljs-number">0</span>].distance / <span class="hljs-number">1</span>); i &lt; l + <span class="hljs-number">1</span>; i++) &#123;<br> Â  Â  Â  Â <span class="hljs-built_in">var</span> x = prevOffset.x + (currentOffset.x - prevOffset.x) / l * i<br> Â  Â  Â  Â <span class="hljs-built_in">var</span> y = prevOffset.y + (currentOffset.y - prevOffset.y) / l * i<br><br> Â  Â  Â  Â ctx.beginPath()<br> Â  Â  Â  Â ctx.arc(x, y, <span class="hljs-built_in">radius</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * Math.PI, <span class="hljs-literal">true</span>)<br> Â  Â  Â  Â ctx.fill()<br> Â   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªforå¾ªç¯å†…æˆ‘ä»¬è®¡ç®—äº†é¼ æ ‡ç§»åŠ¨è·ç¦»ï¼Œç¬¬äºŒä¸ªforå¾ªç¯å†…åˆ™æ˜¯å°†è·ç¦»ä»¥1ä¸ºå•ä½åˆ†æˆè‹¥å¹²ä»½ï¼Œæ¯ä»½éƒ½ç”»ä¸€ä¸ªåœ†ï¼Œå½¢æˆç›´çº¿ã€‚ä»£ç ä¸­ç”¨åˆ°äº†ä¸€ä¸ªå·¥å…·å‡½æ•°è®¡ç®—è·ç¦»ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">function <span class="hljs-built_in">getDistance</span>(<span class="hljs-selector-tag">a</span>, b) &#123;<br> Â  Â return Math<span class="hljs-selector-class">.sqrt</span>(Math<span class="hljs-selector-class">.pow</span>((<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.x</span> - <span class="hljs-selector-tag">a</span>.x), <span class="hljs-number">2</span>) + Math<span class="hljs-selector-class">.pow</span>((<span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.y</span> - <span class="hljs-selector-tag">a</span>.y), <span class="hljs-number">2</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>è‡³æ­¤æˆ‘ä»¬çš„v1.0ç‰ˆæœ¬å°±å·²ç»å®Œæˆäº†ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨canvasä¸­æ¯”æ¯”åˆ’åˆ’äº†ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a22919591657406e80274eea2ec13765~tplv-k3u1fbpfcp-watermark.image" alt="1.gif"><br>è™½ç„¶å®ç°äº†ä½†æ˜¯å®ƒä¹Ÿå¤ªä¸‘äº†ï¼Œæ²¡æœ‰ç¬”é”‹ä¹Ÿæ²¡æœ‰ç²—ç»†å˜åŒ–ï¼Œæ€ä¹ˆèƒ½å†™å‡ºå¥½çœ‹çš„ç¦å­—å‘¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œ2.0ç‰ˆæœ¬æ”¹é€ ã€‚</p><h2 id="V2-0å®ç°"><a href="#V2-0å®ç°" class="headerlink" title="V2.0å®ç°"></a>V2.0å®ç°</h2><p>ç›¸æ¯”äº1.0ç‰ˆæœ¬ï¼Œæˆ‘ä»¬éœ€è¦ç»™ç”»ç¬”æ·»åŠ æ›´åŠ çœŸå®çš„æ•ˆæœï¼Œæ¯”å¦‚è§¦æ‘¸çš„å‹åŠ›ï¼Œç¬”çš„æœ€å¤§å®½åº¦å’Œæœ€å°å®½åº¦ï¼Œä»¥åŠç¬”çš„å¹³æ»‘ç¨‹åº¦ã€‚å°½æœ€å¤§ç¨‹åº¦è¿˜åŸçœŸå®çš„ä½¿ç”¨æ„Ÿè§‰ã€‚</p><p>æ–°å¢å¦‚ä¸‹å‚æ•°</p><ul><li>  lineMax&lt;Number&gt;ï¼šçº¿å®½æœ€å¤§å€¼</li><li>  lineMin&lt;Number&gt;ï¼šçº¿å®½æœ€å°å€¼</li><li>  smoothness&lt;Number&gt;ï¼šç¬”è§¦å¹³æ»‘ç¨‹åº¦</li><li>  linePressure&lt;Number&gt;ï¼šç¬”è§¦å‹åŠ›</li></ul><p>å¦‚ä½•å®ç°ç¬”è§¦çš„å¹³æ»‘ï¼Œæˆ‘ä»¬åœ¨è®¡ç®—è·ç¦»çš„æ—¶å€™åˆ¤æ–­å½“å‰è·ç¦»å’Œç¬”è§¦çš„å¹³æ»‘ç¨‹åº¦å¤§å°ï¼Œè‹¥è·ç¦»å¤§äºå¹³æ»‘ç¨‹åº¦åˆ™è·³å‡ºæ­¤æ¬¡å¾ªç¯ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">for <span class="hljs-params">(var <span class="hljs-attr">i</span> = 0, <span class="hljs-attr">l</span> = posList.length - 1; i &lt; l; i++)</span> &#123;<br> Â  Â dis += posList[i]<span class="hljs-string">.distance</span><br> Â  Â time += posList[i]<span class="hljs-string">.time</span> - posList[i + 1]<span class="hljs-string">.time</span><br> Â  Â <span class="hljs-keyword">if</span> <span class="hljs-params">(dis &gt; smoothness)</span> break; <span class="hljs-string">//</span> æ–°å¢ï¼Œä¿æŒå¹³æ»‘<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£æˆ‘ä»¬å¦‚ä½•å®ç°ç¬”è§¦çš„å‹åŠ›æ•ˆæœå‘¢ï¼Œåœ¨ä½¿ç”¨ä¸­ï¼Œæ— éå°±æ˜¯åœç•™æ—¶é—´é•¿ã€ä½¿åŠ²ä¼šè®©çº¿æ¡æ›´åŠ æµ‘åšç²—çŠ·ï¼Œåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç‚¹ä¹‹é—´<code>time</code>çš„é—´éš”å’Œè·ç¦»æ¨¡æ‹Ÿè¿™ä¸€ä½¿ç”¨åœºæ™¯ï¼ŒåŠ¨æ€ç”Ÿæˆåœ†çš„åŠå¾„ç”¨æ¥ç»˜åˆ¶ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">var</span> offsetRadius = Math.<span class="hljs-built_in">min</span>((<span class="hljs-built_in">time</span> / dis) * linePressure + lineMin, lineMax) / <span class="hljs-number">2</span> <br></code></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åˆ©ç”¨æœ€å°çº¿å®½ã€å‹åŠ›ã€ç‚¹çš„æ—¶é—´å’Œè·ç¦»æ¨¡æ‹Ÿäº†åŠ¨æ€åœ†çš„åŠå¾„ï¼Œå¹¶é™åˆ¶ä½åœ†åŠå¾„èŒƒå›´ä¸è¶…è¿‡æœ€å¤§çº¿å®½ã€‚æ¥ç€åœ¨ç¬¬äºŒä¸ªforå¾ªç¯ç»˜åˆ¶åœ†ä¸­æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åŠ¨æ€çš„åœ†åŠå¾„æ¥ç»˜åˆ¶å¤§å°ä¸ä¸€çš„åœ†ï¼Œæ¨¡æ‹Ÿç²—ç»†æœ‰è‡´çš„å¹³æ»‘ç¬”è§¦ã€‚</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = Math.<span class="hljs-built_in">round</span>(posList[<span class="hljs-number">0</span>].<span class="hljs-built_in">distance</span> / <span class="hljs-number">1</span>); i &lt; l + <span class="hljs-number">1</span>; i++) &#123;<br> Â  Â <span class="hljs-keyword">var</span> x = prevOffset.x + (currentOffset.x - prevOffset.x) / l * i<br> Â  Â <span class="hljs-keyword">var</span> y = prevOffset.y + (currentOffset.y - prevOffset.y) / l * i<br> Â  Â <span class="hljs-keyword">var</span> r = currentRadius + (offsetRadius - currentRadius) / l * i<br> Â  Â ctx.beginPath()<br> Â  Â ctx.arc(x, y, r, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * Math.<span class="hljs-literal">PI</span>, <span class="hljs-literal">true</span>)<br> Â  Â ctx.fill()<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>2.0çš„å®Œæ•´ä»£ç ä¸æ‘†åœ¨è¿™äº†ï¼Œä¸‹é¢è¿˜æœ‰3.0å®Œæ•´ç‰ˆï¼Œæˆ‘æœ€åä¼šé™„ä¸Š3.0çš„å®Œæ•´ç‰ˆä»£ç </p></blockquote><p>çœ‹æ•ˆæœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65365afddca7490bb9e0c6f9256d3e8d~tplv-k3u1fbpfcp-zoom-1.image" alt="2.gif"></p><p>åˆ°è¿™å…¶å®åŸºæœ¬ä¸Šå¯¹ç»˜åˆ¶ä»¥åŠç¬”è§¦çš„æ¨¡æ‹Ÿéƒ½å·²å®Œæˆï¼Œä½†æ¯•ç«Ÿæ˜¯è¿‡å¹´ï¼Œéœ€è¦æœ‰ç‚¹è¿‡å¹´çš„æ°”æ°›ï¼Œè€Œä¸”å…³äºçº¿å®½è¿™äº›æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶äº¤ç»™ç”¨æˆ·ï¼Œè®©å…¶è‡ªå·±é…ç½®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯3.0ç»ˆæç‰ˆã€‚</p><h2 id="V3-0å®ç°"><a href="#V3-0å®ç°" class="headerlink" title="V3.0å®ç°"></a>V3.0å®ç°</h2><p>V3.0ä¸»è¦æ·»åŠ äº†æ’¤é”€çš„åŠŸèƒ½ã€‚æ’¤é”€çš„å®ç°è¯´ç™½äº†å°±æ˜¯åœ¨é¼ æ ‡ç§»åŠ¨çš„æ—¶å€™ç»´æŠ¤ä¸€ä¸ªç¬”åˆ’çš„å†å²æ•°ç»„ï¼Œç‚¹å‡»æ’¤é”€åå»é™¤å†å²æ•°ç»„ä¸­çš„æœ€æœ«ä¸€ä¸ªå¯¹æ•´å¹…canvasè¿›è¡Œé‡æ–°ç»˜åˆ¶ã€‚</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">back</span>() &#123;<br> Â  Â history.<span class="hljs-built_in">pop</span>();<br> Â  Â ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.width, canvas.height);<br> Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; history.<span class="hljs-built_in">length</span>; i++) &#123;<br> Â  Â  Â  Â <span class="hljs-keyword">var</span> h = history[i];<br> Â  Â  Â  Â <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; h.<span class="hljs-built_in">length</span>; j += <span class="hljs-number">3</span>) &#123;<br> Â  Â  Â  Â  Â  Â ctx.beginPath();<br> Â  Â  Â  Â  Â  Â canvas<br> Â  Â  Â  Â  Â  Â  Â   .getContext(<span class="hljs-string">&quot;2d&quot;</span>)<br> Â  Â  Â  Â  Â  Â  Â   .arc(h[j], h[j + <span class="hljs-number">1</span>], h[j + <span class="hljs-number">2</span>], <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * Math.<span class="hljs-literal">PI</span>, <span class="hljs-literal">true</span>);<br> Â  Â  Â  Â  Â  Â ctx.fill();<br> Â  Â  Â   &#125;<br> Â   &#125;<br>&#125;,<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2bcc1610bf984a5abe290d29581e574a~tplv-k3u1fbpfcp-zoom-1.image" alt="3.gif"></p><p>åœ¨ä¸Šè¾¹çš„å›¾ç‰‡ä¸­ä¹Ÿçœ‹åˆ°äº†ï¼Œæˆ‘å°†çº¿å®½èŒƒå›´ã€ç¬”è§¦å‹åŠ›å’Œå¹³æ»‘ç¨‹åº¦å¯è§†åŒ–å‡ºæ¥æ–¹ä¾¿ç”¨æˆ·è‡ªå·±é…ç½®è°ƒèŠ‚æƒ³è¦çš„æ•ˆæœï¼Œè¿™é‡Œç®€å•å†™äº†ä¸€ä¸ªåŸç”Ÿçš„åŒå‘ç»‘å®šæ”¯æŒéšæ”¹éšç”Ÿæ•ˆã€‚</p><p>æœ€åä¸ºäº†çƒ˜æ‰˜ä¸€ä¸‹è¿‡å¹´çš„æ°”æ°›ï¼Œæˆ‘ä»¬æ‰¾ä¸€å¼ å–œåº†çš„èƒŒæ™¯å›¾ä½œä¸ºcanvasçš„èƒŒæ™¯ç»˜åˆ¶ä¸Šå»ã€‚</p><p>æœ‰äººä¼šé—®ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨cssé‡Œæ·»åŠ backgroundï¼Œå…¶å®æœ€å¼€å§‹æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆåŠ çš„ï¼Œä½†è¿™ç§æ–¹å¼åœ¨canvasè½¬å›¾ç‰‡æ—¶æ˜¯ä¸ä¼šå°†èƒŒæ™¯ä¹Ÿä½œä¸ºcanvasçš„ä¸€éƒ¨åˆ†çš„ï¼Œæ‰€ä»¥ç›´æ¥å°†å›¾ç‰‡ç»˜åˆ°canvasä¸Šäº†ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">var img = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Image()</span>;<br>img.set<span class="hljs-constructor">Attribute(&#x27;<span class="hljs-params">crossOrigin</span>&#x27;, &#x27;<span class="hljs-params">anonymous</span>&#x27;)</span>;<br>img.onload = <span class="hljs-keyword">function</span> <span class="hljs-literal">()</span> &#123;<br> Â  Â ctx.draw<span class="hljs-constructor">Image(<span class="hljs-params">img</span>, 0, 0)</span>;<br>&#125;<br>img.src = &#x27;./drawBG.jpg&#x27;;<br></code></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯æ·»åŠ ä¸€ä¸ªä¿å­˜é€»è¾‘ï¼Œè¿™ä¸ªå°±ä¸åˆ—å‡ºæ¥äº†ã€‚</p><p>å¤§åŠŸå‘Šæˆï¼Œæˆ‘ä»¬æœ€ç»ˆå½¢æˆçš„å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªé¡µé¢ï¼Œé‡ç‚¹åœ¨åŠŸèƒ½å®ç°å“ˆï¼Œé¡µé¢å®åœ¨æ˜¯æ‡’å¾—å»ç¾åŒ–äº†ï¼Œè‡³å°‘è¿™ä¸ªèƒŒæ™¯çœ‹ç€å°±å¾ˆæœ‰è¿‡å¹´çš„æ°”æ°›å˜›å“ˆå“ˆå“ˆã€‚ç¾ä¸­ä¸è¶³ï¼ˆä¹‹ä¸€ï¼‰å°±æ˜¯å¯¹äºç¬”é”‹çš„æ¨¡æ‹Ÿè¿˜æ˜¯ä¸å¤Ÿåˆ°ä½ï¼Œä½†è¿™æ˜¯æˆ‘ç›®å‰èƒ½å¤Ÿæƒ³åˆ°æœ€å¥½çš„æ–¹æ¡ˆäº†ï¼Œæ¬¢è¿å°ä¼™ä¼´è¯„è®ºåŒºè®¨è®ºå“ˆï¼Œæˆ‘ä¸€å®šè™šå¿ƒå€¾å¬ã€‚v3.0ç‰ˆæœ¬çš„æœ€ç»ˆä»£ç æ”¾åœ¨æœ€åäº†ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3084f9d581a44469bdceb165fd252623~tplv-k3u1fbpfcp-zoom-1.image" alt="image.png"></p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å°±æŠŠæˆ‘å†™çš„è¿™ä¸äº‰æ°”çš„ç¦å‘å‡ºæ¥ç¥å¤§å®¶æ–°å¹´å¿ƒæƒ³äº‹æˆç¦æ°”æ»¡æ»¡ï¼</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f35b61f458524dfcbdb8f0d27e924ebb~tplv-k3u1fbpfcp-zoom-1.image" alt="ä¸‹è½½ (4).png"></p><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge,chrome=1&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;canvas&quot;</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;background:#ffffcc&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;400&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;700&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br><span class="hljs-comment">&lt;!-- &lt;img src=&quot;./drawBG.jpg&quot; crossorigin=&quot;anonymous&quot; id=&quot;bg&quot; alt=&quot;&quot; style=&quot;display: none;&quot;&gt; --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;position: absolute;top: 10px;left: 420px;&quot;</span>&gt;</span><br>çº¿å®½èŒƒå›´ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display:inline&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">model</span>=<span class="hljs-string">&#x27;lineMin&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;lineMin&quot;</span> /&gt;</span> - <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&quot;display:inline&quot;</span></span><br><span class="hljs-tag"><span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">model</span>=<span class="hljs-string">&#x27;lineMax&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;lineMax&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>ç¬”è§¦å‹åŠ›ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">model</span>=<span class="hljs-string">&#x27;linePressure&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;linePressure&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br>å¹³æ»‘ç¨‹åº¦ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">model</span>=<span class="hljs-string">&#x27;smoothness&#x27;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;smoothness&quot;</span> /&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;back&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æ’¤é”€&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;back()&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;clear&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æ¸…ç©º&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;clear()&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;save&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä¿å­˜&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;save()&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> moveFlag = <span class="hljs-literal">false</span></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> offset = &#123;&#125;, <span class="hljs-comment">// å½“å‰ä½ç½®</span></span><br><span class="language-javascript">posList = [] <span class="hljs-comment">// è¿åŠ¨ä½ç½®é›†åˆ</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> drawHistory = [],</span><br><span class="language-javascript">startOffset = <span class="hljs-literal">null</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> lineMax = <span class="hljs-number">30</span>,</span><br><span class="language-javascript">lineMin = <span class="hljs-number">2</span>,</span><br><span class="language-javascript">linePressure = <span class="hljs-number">3</span>,</span><br><span class="language-javascript">smoothness = <span class="hljs-number">80</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> radius = <span class="hljs-number">0</span></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>)</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();</span><br><span class="language-javascript">img.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">&#x27;crossOrigin&#x27;</span>, <span class="hljs-string">&#x27;anonymous&#x27;</span>);</span><br><span class="language-javascript">img.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">img.<span class="hljs-property">src</span> = <span class="hljs-string">&#x27;./drawBG.jpg&#x27;</span>;</span><br><span class="language-javascript">ctx.<span class="hljs-property">fillStyle</span> = <span class="hljs-string">&#x27;rgba(0,0,0,0.3)&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">canvas.<span class="hljs-property">onmousedown</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">downEvent</span>(e)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">canvas.<span class="hljs-property">onmousemove</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">moveEvent</span>(e)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">canvas.<span class="hljs-property">onmouseup</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">upEvent</span>(e)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">canvas.<span class="hljs-property">onmouseout</span> = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span><br><span class="language-javascript"><span class="hljs-title function_">upEvent</span>(e)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">downEvent</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">moveFlag = <span class="hljs-literal">true</span></span><br><span class="language-javascript">posList = []</span><br><span class="language-javascript">drawHistory.<span class="hljs-title function_">push</span>([])</span><br><span class="language-javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(drawHistory);</span><br><span class="language-javascript">startOffset = offset = <span class="hljs-title function_">getPos</span>(e)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">moveEvent</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">if</span> (!moveFlag) <span class="hljs-keyword">return</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> currentOffset = <span class="hljs-title function_">getPos</span>(e)</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> prevOffset = offset</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> currentRadius = radius</span><br><span class="language-javascript"></span><br><span class="language-javascript">posList.<span class="hljs-title function_">unshift</span>(&#123;</span><br><span class="language-javascript"><span class="hljs-attr">distance</span>: <span class="hljs-title function_">getDistance</span>(prevOffset, currentOffset),</span><br><span class="language-javascript"><span class="hljs-attr">time</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>()</span><br><span class="language-javascript">&#125;)</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> dis = <span class="hljs-number">0</span>,</span><br><span class="language-javascript">time = <span class="hljs-number">0</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = posList.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &lt; l; i++) &#123;</span><br><span class="language-javascript">dis += posList[i].<span class="hljs-property">distance</span></span><br><span class="language-javascript">time += posList[i].<span class="hljs-property">time</span> - posList[i + <span class="hljs-number">1</span>].<span class="hljs-property">time</span></span><br><span class="language-javascript"><span class="hljs-keyword">if</span> (dis &gt; smoothness) <span class="hljs-keyword">break</span>; <span class="hljs-comment">// æ–°å¢ï¼Œä¿æŒå¹³æ»‘</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> offsetRadius = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>((time / dis) * linePressure + lineMin, lineMax) / <span class="hljs-number">2</span> <span class="hljs-comment">// æ–°å¢ï¼Œå‹åŠ›æ§åˆ¶åœ†åŠå¾„</span></span><br><span class="language-javascript">radius = offsetRadius <span class="hljs-comment">// æ–°å¢</span></span><br><span class="language-javascript">offset = currentOffset</span><br><span class="language-javascript"><span class="hljs-keyword">if</span> (dis &lt; <span class="hljs-number">7</span>) <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">if</span> (startOffset) &#123;</span><br><span class="language-javascript">prevOffset = startOffset</span><br><span class="language-javascript">currentRadius = offsetRadius</span><br><span class="language-javascript">startOffset = <span class="hljs-literal">null</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(posList[<span class="hljs-number">0</span>].<span class="hljs-property">distance</span> / <span class="hljs-number">1</span>); i &lt; l + <span class="hljs-number">1</span>; i++) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> x = prevOffset.<span class="hljs-property">x</span> + (currentOffset.<span class="hljs-property">x</span> - prevOffset.<span class="hljs-property">x</span>) / l * i</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> y = prevOffset.<span class="hljs-property">y</span> + (currentOffset.<span class="hljs-property">y</span> - prevOffset.<span class="hljs-property">y</span>) / l * i</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> r = currentRadius + (offsetRadius - currentRadius) / l * i</span><br><span class="language-javascript"></span><br><span class="language-javascript">ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">arc</span>(x, y, r, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>, <span class="hljs-literal">true</span>)</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">fill</span>()</span><br><span class="language-javascript"></span><br><span class="language-javascript">drawHistory[drawHistory.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-title function_">push</span>(x, y, r)</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">upEvent</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">moveFlag = <span class="hljs-literal">false</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPos</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript"><span class="hljs-attr">x</span>: e.<span class="hljs-property">clientX</span> - canvas.<span class="hljs-property">offsetLeft</span>,</span><br><span class="language-javascript"><span class="hljs-attr">y</span>: e.<span class="hljs-property">clientY</span> - canvas.<span class="hljs-property">offsetTop</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDistance</span>(<span class="hljs-params">a, b</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>((b.<span class="hljs-property">x</span> - a.<span class="hljs-property">x</span>), <span class="hljs-number">2</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>((b.<span class="hljs-property">y</span> - a.<span class="hljs-property">y</span>), <span class="hljs-number">2</span>))</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">drawHistory = []</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">back</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">drawHistory.<span class="hljs-title function_">pop</span>();</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">drawImage</span>(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</span><br><span class="language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; drawHistory.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> h = drawHistory[i];</span><br><span class="language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; h.<span class="hljs-property">length</span>; j += <span class="hljs-number">3</span>) &#123;</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">canvas</span><br><span class="language-javascript">.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>)</span><br><span class="language-javascript">.<span class="hljs-title function_">arc</span>(h[j], h[j + <span class="hljs-number">1</span>], h[j + <span class="hljs-number">2</span>], <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>, <span class="hljs-literal">true</span>);</span><br><span class="language-javascript">ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">save</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">var</span> url = canvas.<span class="hljs-title function_">toDataURL</span>(<span class="hljs-string">&quot;image/png&quot;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> oA = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;a&quot;</span>);</span><br><span class="language-javascript">oA.<span class="hljs-property">download</span> = <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">// è®¾ç½®ä¸‹è½½çš„æ–‡ä»¶åï¼Œé»˜è®¤æ˜¯&#x27;ä¸‹è½½&#x27;</span></span><br><span class="language-javascript">oA.<span class="hljs-property">href</span> = url;</span><br><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(oA);</span><br><span class="language-javascript">oA.<span class="hljs-title function_">click</span>();</span><br><span class="language-javascript">oA.<span class="hljs-title function_">remove</span>(); <span class="hljs-comment">// ä¸‹è½½ä¹‹åæŠŠåˆ›å»ºçš„å…ƒç´ åˆ é™¤</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"><span class="hljs-comment">// inputåŒå‘ç»‘å®š</span></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> ngmodel = &#123;</span><br><span class="language-javascript">lineMin,</span><br><span class="language-javascript">lineMax,</span><br><span class="language-javascript">linePressure,</span><br><span class="language-javascript">smoothness</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"><span class="hljs-comment">// åˆå§‹åŒ–èµ‹å€¼</span></span><br><span class="language-javascript"><span class="hljs-keyword">const</span> inputs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;input[model]&#x27;</span>);</span><br><span class="language-javascript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; inputs.<span class="hljs-property">length</span>; i++) &#123;</span><br><span class="language-javascript">inputs[i].<span class="hljs-property">value</span> = ngmodel[inputs[i].<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;model&#x27;</span>)]</span><br><span class="language-javascript">inputs[i].<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;keyup&#x27;</span>, change)</span><br><span class="language-javascript"></span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"><span class="hljs-comment">// inputæ“ä½œèµ‹å€¼</span></span><br><span class="language-javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">change</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript"><span class="hljs-keyword">const</span> attr = e.<span class="hljs-property">target</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;model&#x27;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">window</span>[attr] = ngmodel[attr] = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span></span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Canvas</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wå­—æ€»ç»“ã€Šæ·±å…¥æµ…å‡ºVue.jsã€‹ä¹‹å˜åŒ–ä¾¦æµ‹ç¯‡</title>
    <link href="/2021/12/06/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAVue.js%E3%80%8B%E4%B9%8B%E5%8F%98%E5%8C%96%E4%BE%A6%E6%B5%8B%E7%AF%87/"/>
    <url>/2021/12/06/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8A%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAVue.js%E3%80%8B%E4%B9%8B%E5%8F%98%E5%8C%96%E4%BE%A6%E6%B5%8B%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="å˜åŒ–ä¾¦æµ‹"><a href="#å˜åŒ–ä¾¦æµ‹" class="headerlink" title="å˜åŒ–ä¾¦æµ‹"></a>å˜åŒ–ä¾¦æµ‹</h1><blockquote><p>ä»€ä¹ˆæ˜¯å˜åŒ–ä¾¦æµ‹ï¼Ÿ</p></blockquote><p>Vue.jsè‡ªåŠ¨é€šè¿‡çŠ¶æ€ç”ŸæˆDOMï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°é¡µé¢ï¼Œæ­¤ä¸ºæ¸²æŸ“ã€‚Vue.jsçš„æ¸²æŸ“è¿‡ç¨‹æ˜¯å£°æ˜å¼çš„ï¼Œæˆ‘ä»¬é€šè¿‡æ¨¡ç‰ˆæ¥æè¿°çŠ¶æ€ä¸DOMä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚è€Œå½“åº”ç”¨å†…éƒ¨çŠ¶æ€å˜åŒ–æ—¶éœ€è¦é‡æ–°æ¸²æŸ“ï¼Œè€Œå¦‚ä½•ç¡®å®šçŠ¶æ€ä¸­ä»€ä¹ˆå˜åŒ–äº†å°±æ˜¯å˜åŒ–ä¾¦æµ‹è¦è§£å†³çš„é—®é¢˜ã€‚</p><h2 id="objectçš„å˜åŒ–ä¾¦æµ‹"><a href="#objectçš„å˜åŒ–ä¾¦æµ‹" class="headerlink" title="objectçš„å˜åŒ–ä¾¦æµ‹"></a>objectçš„å˜åŒ–ä¾¦æµ‹</h2><h3 id="å¦‚ä½•è¿½è¸ªå˜åŒ–ï¼Ÿ"><a href="#å¦‚ä½•è¿½è¸ªå˜åŒ–ï¼Ÿ" class="headerlink" title="å¦‚ä½•è¿½è¸ªå˜åŒ–ï¼Ÿ"></a>å¦‚ä½•è¿½è¸ªå˜åŒ–ï¼Ÿ</h3><p>ä¸¤ç§æ–¹å¼å¯ä»¥è¿½è¸ªå˜åŒ–ï¼š<code>Object.defineProperty</code>å’ŒES6çš„<code>Proxy</code>ã€‚</p><p>ç”±äºES6åœ¨æµè§ˆå™¨ä¸­çš„æ”¯æŒåº¦ä¸ç†æƒ³ï¼Œæ‰€ä»¥Vue2é‡‡ç”¨äº†<code>Object.defineProperty</code>å®ç°ï¼Œè€ŒVue3åˆ™é‡‡ç”¨äº†<code>Proxy</code>ã€‚</p><p>åˆ©ç”¨<code>Object.defineProperty</code>ä¾¦æµ‹å¯¹è±¡å˜åŒ–å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactiv</span> (data, key, val) &#123;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, key, &#123;<br>        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> val<br>        &#125;,<br>        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params">newVal</span>) &#123;<br>            <span class="hljs-keyword">if</span>(val === newVal) &#123;<br>                <span class="hljs-keyword">return</span><br>            &#125;<br>            val = newVal<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>defineReactiveæ˜¯å¯¹Object.definePropertyçš„å°è£…ï¼Œå…¶ä½œç”¨ä¸ºå®šä¹‰ä¸€ä¸ªå“åº”å¼æ•°æ®ï¼Œåœ¨è¿™ä¸ªå‡½æ•°ä¸­è¿›è¡Œå˜åŒ–è¿½è¸ªï¼Œå°è£…ååªéœ€è¦ä¼ é€’dataï¼Œkeyï¼Œvalueå³å¯ã€‚å°è£…å¥½åï¼Œæ¯å½“ä»dataçš„keyä¸­è¯»å–æ•°æ®ï¼Œgetå‡½æ•°è¢«è§¦å‘ï¼›å¾€dataçš„keyä¸­è®¾ç½®æ•°æ®æ—¶ï¼Œsetå‡½æ•°è¢«è§¦å‘ã€‚</p><h3 id="å¦‚ä½•æ”¶é›†ä¾èµ–ï¼Ÿæ”¶é›†åœ¨å“ªé‡Œï¼Ÿ"><a href="#å¦‚ä½•æ”¶é›†ä¾èµ–ï¼Ÿæ”¶é›†åœ¨å“ªé‡Œï¼Ÿ" class="headerlink" title="å¦‚ä½•æ”¶é›†ä¾èµ–ï¼Ÿæ”¶é›†åœ¨å“ªé‡Œï¼Ÿ"></a>å¦‚ä½•æ”¶é›†ä¾èµ–ï¼Ÿæ”¶é›†åœ¨å“ªé‡Œï¼Ÿ</h3><blockquote><p>åœ¨Vue2ä¸­ï¼Œæ¨¡æ¿ä½¿ç”¨æ•°æ®ç­‰åŒäºç»„ä»¶ä½¿ç”¨æ•°æ®ï¼Œæ‰€ä»¥æ•°æ®å˜åŒ–æ—¶ï¼Œä¼šå°†é€šçŸ¥å‘é€åˆ°ç»„ä»¶ï¼Œç»„ä»¶å†…éƒ¨å†é€šè¿‡è™šæ‹ŸDOMé‡æ–°æ¸²æŸ“ã€‚</p></blockquote><p>æˆ‘ä»¬è§‚å¯Ÿä¾èµ–çš„ç›®çš„æ˜¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œé€šçŸ¥é‚£äº›ä½¿ç”¨äº†è¯¥æ•°æ®çš„åœ°æ–¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ”¶é›†ä¾èµ–ï¼ŒæŠŠç”¨åˆ°æ•°æ®çš„åœ°æ–¹æ”¶é›†èµ·æ¥ï¼Œç­‰å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†ä¹‹å‰æ”¶é›†å¥½çš„ä¾èµ–å¾ªç¯è§¦å‘ä¸€éï¼Œä¹Ÿå°±æ˜¯åœ¨getterä¸­æ”¶é›†ä¾èµ–ï¼Œsetterä¸­è§¦å‘ä¾èµ–ã€‚</p><p>ç°åœ¨å·²ç»çŸ¥é“äº†è¦åœ¨å“ªé‡Œæ”¶é›†è§¦å‘ä¾èµ–ï¼Œé‚£ä¹ˆè¦æŠŠå®ƒæ”¶é›†åˆ°å“ªé‡Œï¼Ÿæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä¸“é—¨å¸®åŠ©ç®¡ç†ä¾èµ–çš„ç±»Depï¼Œä½¿ç”¨è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å¯ä»¥æ”¶é›†ã€åˆ é™¤ä¾èµ–æˆ–å‘ä¾èµ–å‘é€é€šçŸ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []<br>    &#125;<br>    <br>    <span class="hljs-title function_">addSub</span>(<span class="hljs-params">sub</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(sub)<br>    &#125;<br>    <br>    <span class="hljs-title function_">removeSub</span>(<span class="hljs-params">sub</span>) &#123;<br>        <span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>, sub)<br>    &#125;<br>    <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addSub</span>(windwo.<span class="hljs-property">target</span>)<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> subs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">slice</span>()<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = subs.<span class="hljs-property">length</span>; i &lt; l; i++) &#123;<br>            subs[i].<span class="hljs-title function_">update</span>()<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">remove</span> (arr, item) &#123;<br>    <span class="hljs-keyword">if</span> (arr.<span class="hljs-property">length</span>) &#123;<br>        <span class="hljs-keyword">const</span> index = arr.<span class="hljs-title function_">indexOf</span>(item)<br>        <span class="hljs-keyword">if</span>(index &gt; -<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">return</span> arr.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†æ”¹é€ ä¸€ä¸‹defineReactive</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span> (data, key, val) &#123;<br>    <span class="hljs-keyword">let</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, key, &#123;<br>        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            dep.<span class="hljs-title function_">depend</span>()<br>            <span class="hljs-keyword">return</span> val<br>        &#125;,<br>        <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">if</span>(val === newVal) &#123;<br>               <span class="hljs-keyword">return</span> <br>            &#125;<br>            val = newVal<br>            dep.<span class="hljs-title function_">notify</span>()<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä»€ä¹ˆæ˜¯Watcher"><a href="#ä»€ä¹ˆæ˜¯Watcher" class="headerlink" title="ä»€ä¹ˆæ˜¯Watcher"></a>ä»€ä¹ˆæ˜¯Watcher</h3><p>ä¸Šè¾¹çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ”¶é›†çš„ä¾èµ–æ˜¯window.targetï¼Œé‚£æˆ‘ä»¬ç©¶ç«Ÿè¦æ”¶é›†è°å‘¢ã€‚æ”¶é›†è¯´çš„é€šä¿—æ˜“æ‡‚ç‚¹å°±æ˜¯å½“å±æ€§å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥é€šçŸ¥è°ã€‚</p><p>æˆ‘ä»¬éœ€è¦é€šçŸ¥ç”¨åˆ°æ•°æ®çš„åœ°æ–¹ï¼Œè€Œç”¨åˆ°å®ƒçš„åœ°æ–¹å¯èƒ½ä¼šå¾ˆå¤šï¼Œæœ‰å¯èƒ½æ˜¯æ¨¡ç‰ˆï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯watchç­‰ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠ½è±¡å‡ºä¸€ä¸ªèƒ½é›†ä¸­å¤„ç†è¿™äº›æƒ…å†µçš„ç±»ã€‚æˆ‘ä»¬åœ¨æ”¶é›†ä¾èµ–é˜¶æ®µåªæ”¶é›†è¿™ä¸ªå°è£…å¥½çš„ç±»å®ä¾‹ï¼ŒåŒæ ·ä¹Ÿåªé€šçŸ¥å®ƒè‡ªå·±ï¼Œç”±å®ƒè´Ÿè´£é€šçŸ¥å…¶ä»–åœ°æ–¹ï¼Œè¿™å°±æ˜¯Watcherã€‚</p><p>Watcheræ˜¯ä¸€ä¸ªä¸­ä»‹çš„è§’è‰²ï¼Œæ•°æ®å˜åŒ–æ—¶é€šçŸ¥å®ƒï¼Œä»–è´Ÿè´£é€šçŸ¥å…¶ä»–åœ°æ–¹ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹Watcherçš„ç»å…¸ä½¿ç”¨æ–¹å¼ï¼šå½“a.b.cå˜åŒ–æ—¶ä¼šè§¦å‘ç¬¬äºŒä¸ªå‚æ•°ä¸­çš„å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">vm.$watch(<span class="hljs-string">&#x27;a.b.c&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">newVal, oldVal</span>) &#123;<br>    <span class="hljs-comment">// æ“ä½œ</span><br>&#125;)<br></code></pre></td></tr></table></figure><p>æ ¹æ®ä½¿ç”¨æ–¹æ³•æˆ‘ä»¬å¯ä»¥é¦–å…ˆå®ç°Watcherï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, expOrFn, cb</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = <span class="hljs-title function_">parsePath</span>(expOrFn)<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>    &#125;<br>    <br>    <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span><br>        <span class="hljs-keyword">let</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)<br>        windwo.<span class="hljs-property">target</span> = <span class="hljs-literal">undefined</span><br>        <span class="hljs-keyword">return</span> value<br>    &#125;<br>    <br>    <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> oldValue = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>, oldValue)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ®µèƒ†ç å¯ä»¥æŠŠè‡ªå·±ä¸»åŠ¨æ·»åŠ åˆ°data.a.b.cçš„Depä¸­ã€‚åœ¨getæ–¹æ³•ä¸­å…ˆæŠŠwindow.targetè®¾ç½®ä¸ºthiså³å½“å‰çš„watcherå®ä¾‹ï¼Œç„¶åè¯»data.a.b.cçš„å€¼ï¼Œè§¦å‘getterã€‚</p><p>è§¦å‘äº†getterï¼Œå°±ä¼šè§¦å‘æ”¶é›†ä¾èµ–çš„é€»è¾‘ï¼Œä»window.targetä¸­è¯»å–ä¸€ä¸ªä¾èµ–æ·»åŠ åˆ°Depä¸­ã€‚è¿™æ ·åªè¦åœ¨window.targetèµ‹ä¸€ä¸ªthisï¼Œå†è¯»ä¸€ä¸‹å€¼ï¼Œè§¦å‘getterï¼Œå°±å¯ä»¥æŠŠthisä¸»åŠ¨æ·»åŠ åˆ°keypathçš„Depä¸­ã€‚</p><p>ä¾èµ–æ³¨å…¥åˆ°Depä¸­åï¼Œæ¯æ¬¡å€¼å˜åŒ–å°±ä¼šè®©ä¾èµ–åˆ—è¡¨ä¸­æ‰€æœ‰ä¾èµ–å¾ªç¯è§¦å‘updateæ–¹æ³•ï¼Œæ‰§è¡Œå‚æ•°ä¸­çš„å›è°ƒå‡½æ•°ï¼Œå°†valueå’ŒoldValueä¼ åˆ°å‚æ•°ä¸­ã€‚</p><h3 id="é€’å½’ä¾¦æµ‹æ‰€æœ‰key"><a href="#é€’å½’ä¾¦æµ‹æ‰€æœ‰key" class="headerlink" title="é€’å½’ä¾¦æµ‹æ‰€æœ‰key"></a>é€’å½’ä¾¦æµ‹æ‰€æœ‰key</h3><p>ç°åœ¨å·²ç»å¯ä»¥å®ç°å˜åŒ–ä¾¦æµ‹çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›æŠŠæ•°æ®ä¸­æ‰€æœ‰å±æ€§ï¼ˆå«å­å±æ€§ï¼‰éƒ½ä¾¦æµ‹åˆ°ï¼Œéœ€è¦ä¸€ä¸ªObserverç±»ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªæ•°æ®å†…æ‰€æœ‰å±æ€§éƒ½è½¬æ¢æˆgetter/setterå½¢å¼ï¼Œå†å»è¿½è¸ªä»–ä»¬çš„å˜åŒ–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <br>        <span class="hljs-keyword">if</span>(!<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(value)<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-title function_">walk</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; i++) &#123;<br>            <span class="hljs-title function_">defineReactive</span>(obj, keys[i], obj[keys[i]])<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">data, key, val</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;object&#x27;</span>) &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(val)<br>    &#125;<br>    <br>    <span class="hljs-keyword">let</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data, key, &#123;<br>    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        dep.<span class="hljs-title function_">depend</span>()<br>        <span class="hljs-keyword">return</span> val<br>    &#125;,<br>    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(val === newVal) &#123;<br>           <span class="hljs-keyword">return</span> <br>        &#125;<br>        val = newVal<br>        dep.<span class="hljs-title function_">notify</span>()<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å®šä¹‰Observerç±»ï¼Œå°†æ­£å¸¸å¯¹è±¡è½¬æ¢æˆè¢«ä¾¦æµ‹çš„å¯¹è±¡ã€‚ç„¶ååˆ¤æ–­æ•°æ®ç±»å‹ï¼Œåªæœ‰Objectæ‰ä¼šè°ƒç”¨walkè¿›è¡Œè½¬æ¢ï¼Œæœ€ååœ¨defineReactiveä¸­æ–°å¢<code>new Observer(val)</code>æ¥é€’å½’å­å±æ€§ã€‚</p><h3 id="å…³äºObjectçš„é—®é¢˜"><a href="#å…³äºObjectçš„é—®é¢˜" class="headerlink" title="å…³äºObjectçš„é—®é¢˜"></a>å…³äºObjectçš„é—®é¢˜</h3><p>ä¸Šè¾¹æˆ‘ä»¬ä»‹ç»äº†Objectç±»å‹çš„å˜åŒ–ä¾¦æµ‹åŸç†ï¼Œæ­£æ˜¯å› ä¸ºæ•°æ®å˜åŒ–æ˜¯é€šè¿‡getter/setterè¿›è¡Œè¿½è¸ªï¼Œæ‰€ä»¥æœ‰äº›è¯­æ³•ä¸­å³ä½¿æ•°æ®å˜åŒ–ï¼ŒVueä¹Ÿè¿½è¸ªä¸åˆ°ã€‚</p><p>æ¯”å¦‚ï¼Œå‘objectæ·»åŠ æˆ–åˆ é™¤å±æ€§ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#app&#x27;</span>,<br>    <span class="hljs-attr">template</span>:<span class="hljs-string">&#x27;#demo-template&#x27;</span>,<br>    <span class="hljs-attr">methods</span>:&#123;<br>        <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>.<span class="hljs-property">age</span> = <span class="hljs-string">&#x27;23&#x27;</span><br>        &#125;,<br>        <span class="hljs-title function_">dAction</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>.<span class="hljs-property">name</span><br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">data</span>: &#123;<br>        <span class="hljs-attr">obj</span>:&#123;<br>            <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;abc&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>Object.definePropertyå°†å¯¹è±¡çš„keyè½¬åŒ–ä¸ºgetter/setteræ¥è¿½è¸ªå˜åŒ–ï¼Œä½†å®ƒåªèƒ½è¿½è¸ªä¸€ä¸ªæ•°æ®æ˜¯å¦è¢«ä¿®æ”¹ï¼Œæ— æ³•ä¾¦æµ‹æ–°å¢å’Œåˆ é™¤ã€‚</p><p>æ‰€ä»¥Vueæä¾›ä¸¤ä¸ªAPIï¼švm.$setå’Œvm.$delete</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Objectå¯ä»¥é€šè¿‡Object.definePropertyå°†å±æ€§è½¬æ¢æˆgetter/setterå½¢å¼æ¥è¿½è¸ªå˜åŒ–ï¼Œè¯»å–è§¦å‘getterï¼Œä¿®æ”¹è§¦å‘setterã€‚</p><p>åœ¨getterä¸­å¯¹ä½¿ç”¨äº†æ•°æ®çš„ä¾èµ–è¿›è¡Œæ”¶é›†ï¼Œå½“setterè§¦å‘æ—¶é€šçŸ¥getterä¸­æ”¶é›†çš„ä¾èµ–æ•°æ®å‘ç”Ÿå˜åŒ–ã€‚</p><p>æ”¶é›†ä¾èµ–éœ€è¦ä¸ºä¾èµ–æ‰¾ä¸€ä¸ªå‚¨å­˜çš„åœ°æ–¹ï¼Œæ‰€ä»¥æœ‰äº†Depï¼Œå®ƒç”¨æ¥æ”¶é›†ã€åˆ é™¤ä¾èµ–å¹¶å‘ä¾èµ–å‘é€æ¶ˆæ¯ã€‚</p><p>ä¾èµ–å°±æ˜¯Watcherï¼Œåªæœ‰Watcherè§¦å‘çš„getteræ‰ä¼šæ”¶é›†ä¾èµ–ï¼Œå“ªä¸ªWatcherè§¦å‘äº†getterå°±æŠŠå®ƒæ”¶é›†åˆ°Depä¸­ï¼Œæ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ä¼šå¾ªç¯ä¾èµ–åˆ—è¡¨é€šçŸ¥æ‰€æœ‰Watcherã€‚</p><p>Watcherçš„åŸç†æ˜¯å…ˆæŠŠè‡ªå·±è®¾ç½®åˆ°å…¨å±€å”¯ä¸€çš„ä½ç½®ï¼Œç„¶åè¯»å–æ•°æ®è§¦å‘getterï¼Œæ¥ç€getterä¸­å°±ä¼šä»å”¯ä¸€çš„ä½ç½®è¯»å–å½“å‰æ­£åœ¨è¯»å–æ•°æ®çš„Watcherï¼Œå¹¶æŠŠå®ƒæ”¶é›†åˆ°Depä¸­ï¼Œè¿™æ ·Watcherå¯ä»¥ä¸»åŠ¨å»è®¢é˜…ä»»ä¸€æ•°æ®çš„å˜åŒ–ã€‚</p><p>æ­¤å¤–ï¼Œè¿˜åˆ›å»ºäº†Observerç±»ï¼Œå®ƒæ˜¯ç”¨æ¥å°†ä¸€ä¸ªobjectä¸­çš„æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬å­æ•°æ®ï¼‰éƒ½è½¬æ¢æˆå“åº”å¼çš„ã€‚</p><h2 id="Arrayçš„å˜åŒ–ä¾¦æµ‹"><a href="#Arrayçš„å˜åŒ–ä¾¦æµ‹" class="headerlink" title="Arrayçš„å˜åŒ–ä¾¦æµ‹"></a>Arrayçš„å˜åŒ–ä¾¦æµ‹</h2><p>Arrayçš„ä¾¦æµ‹ä¸ºä»€ä¹ˆä¸Objectä¸åŒï¼Œå› ä¸ºObjectä½¿ç”¨getter/setterä¾¦æµ‹å˜åŒ–ï¼Œè€Œæ•°ç»„é€šå¸¸ä½¿ç”¨pushç­‰æ–¹æ³•æ¥æ”¹å˜ï¼Œä¸ä¼šè§¦å‘getter/setterã€‚</p><h3 id="å¦‚ä½•è¿½è¸ªå˜åŒ–"><a href="#å¦‚ä½•è¿½è¸ªå˜åŒ–" class="headerlink" title="å¦‚ä½•è¿½è¸ªå˜åŒ–"></a>å¦‚ä½•è¿½è¸ªå˜åŒ–</h3><p>è¿™é‡Œä¸è®¨è®ºES6çš„æƒ…å†µï¼Œåœ¨ES6ä»¥å‰ï¼Œæˆ‘ä»¬æ²¡æœ‰èƒ½å¤Ÿæ‹¦æˆªåŸå‹æ–¹æ³•ï¼ˆpushç­‰ï¼‰çš„èƒ½åŠ›ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨è‡ªå®šä¹‰æ–¹æ³•è¦†ç›–åŸç”Ÿçš„åŸå‹æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ‹¦æˆªå™¨è¦†ç›–Array.prototypeã€‚ä¹‹åæ¯å½“ä½¿ç”¨åŸå‹ä¸Šçš„æ–¹æ³•æ“ä½œæ•°ç»„çš„æ—¶å€™ï¼Œæ‰§è¡Œçš„å…¶å®æ˜¯æ‹¦æˆªå™¨ä¸­çš„æ–¹æ³•ï¼Œä¹‹ååœ¨æ‹¦æˆªå™¨å†…ä½¿ç”¨åŸç”Ÿçš„åŸå‹æ–¹æ³•å»æ“ä½œæ•°ç»„ã€‚</p><h3 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h3><p>æ•°ç»„åŸå‹ä¸Šçš„æ–¹æ³•æœ‰ä¸ƒä¸ªï¼Œåˆ†åˆ«æ˜¯pushï¼Œpopï¼Œshiftï¼Œunshiftï¼Œspliceï¼Œsortå’Œreverseã€‚æˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ªå’ŒåŸå‹æ ·çš„Objectï¼Œé‡Œé¢çš„å±æ€§ä¸€æ¨¡ä¸€æ ·ï¼Œåªä¸è¿‡å…¶ä¸­æ”¹å˜æ•°ç»„è‡ªèº«å†…å®¹çš„æ–¹æ³•æ˜¯é‡å†™çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> arrayProto = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> arrayMethods = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">create</span>(arrayProto)<br><br><span class="hljs-keyword">const</span> methods = [<span class="hljs-string">&#x27;push&#x27;</span>,<span class="hljs-string">&#x27;pop&#x27;</span>,<span class="hljs-string">&#x27;shift&#x27;</span>,<span class="hljs-string">&#x27;unshift&#x27;</span>,<span class="hljs-string">&#x27;splice&#x27;</span>,<span class="hljs-string">&#x27;sort&#x27;</span>,<span class="hljs-string">&#x27;reverse&#x27;</span>]<br><br>methods.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">method</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> original = arrayProto[method]<br>    <br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(arrayMethods , method , &#123;<br>        <span class="hljs-attr">value</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">mutator</span>(<span class="hljs-params">...args</span>) &#123;<br>            <span class="hljs-keyword">return</span> original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)<br>        &#125;,<br>        <span class="hljs-attr">enumerable</span>:<span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configurable</span>:<span class="hljs-literal">true</span><br>    &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>åˆ›å»ºäº†arrayMethodsç»§æ‰¿è‡ªArray.prototypeï¼Œå…·å¤‡æ‰€æœ‰åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨Object.definePropertyå¯¹æ”¹å˜æ•°ç»„çš„æ–¹æ³•è¿›è¡Œå°è£…ã€‚æ‰€ä»¥å½“æˆ‘ä»¬è°ƒç”¨pushçš„æ—¶å€™ï¼Œå®é™…è°ƒç”¨çš„æ˜¯arrayMethods.pushï¼Œè€Œå®ƒå®é™…ä¸Šæ˜¯mutatorå‡½æ•°ï¼Œåœ¨mutatorå‡½æ•°ä¸­æ‰§è¡Œoriginalï¼ˆåŸç”Ÿæ–¹æ³•ï¼‰æ¥åšåº”è¯¥åšçš„äº‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨mutatorä¸­åšå…¶ä»–çš„äº‹æ¯”å¦‚å‘é€å˜åŒ–é€šçŸ¥ã€‚</p><h3 id="ä½¿ç”¨æ‹¦æˆªå™¨è¦†ç›–ArrayåŸå‹"><a href="#ä½¿ç”¨æ‹¦æˆªå™¨è¦†ç›–ArrayåŸå‹" class="headerlink" title="ä½¿ç”¨æ‹¦æˆªå™¨è¦†ç›–ArrayåŸå‹"></a>ä½¿ç”¨æ‹¦æˆªå™¨è¦†ç›–ArrayåŸå‹</h3><p>æˆ‘ä»¬éœ€è¦ç”¨å®ƒè¦†ç›–Array.prototypeï¼Œä½†åˆä¸èƒ½ç›´æ¥è¦†ç›–ï¼Œå› ä¸ºè¿™æ ·ä¼šæ±¡æŸ“å…¨å±€çš„Arrayã€‚æˆ‘ä»¬å¸Œæœ›æ‹¦æˆªåªé’ˆå¯¹é‚£äº›è¢«ä¾¦æµ‹äº†å˜åŒ–çš„æ•°æ®ç”Ÿæ•ˆï¼Œä¹Ÿå°±æ˜¯å¸Œæœ›æ‹¦æˆªå™¨åªè¦†ç›–é‚£äº›å“åº”å¼æ•°ç»„çš„åŸå‹ã€‚</p><p>è€Œæ•°æ®è½¬æˆå“åº”å¼çš„ï¼Œéœ€è¦é€šè¿‡Observerï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨Observerä¸­ç”¨æ‹¦æˆªå™¨è¦†ç›–é‚£äº›Arrayç±»å‹æ•°æ®çš„åŸå‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            value.<span class="hljs-property">_proto_</span> = arrayMethods<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(value)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ƒçš„ä½œç”¨æ˜¯å°†æ‹¦æˆªå™¨èµ‹ç»™value._proto_ï¼Œè¦†ç›–valueåŸå‹çš„åŠŸèƒ½ã€‚</p><h3 id="æ‹¦æˆªå™¨æŒ‚è½½åˆ°æ•°ç»„å±æ€§ä¸Š"><a href="#æ‹¦æˆªå™¨æŒ‚è½½åˆ°æ•°ç»„å±æ€§ä¸Š" class="headerlink" title="æ‹¦æˆªå™¨æŒ‚è½½åˆ°æ•°ç»„å±æ€§ä¸Š"></a>æ‹¦æˆªå™¨æŒ‚è½½åˆ°æ•°ç»„å±æ€§ä¸Š</h3><p>éƒ¨åˆ†æµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒ_proto_ï¼Œè€ŒVueçš„åšæ³•æ˜¯å¦‚æœä¸èƒ½ä½¿ç”¨_proto_ï¼Œåˆ™ç›´æ¥å°†arrayMethodsèº«ä¸Šçš„æ–¹æ³•è®¾ç½®åˆ°è¢«ä¾¦æµ‹çš„æ•°ç»„ä¸Šï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> hasProto = <span class="hljs-string">&#x27;_proto_&#x27;</span> <span class="hljs-keyword">in</span> &#123;&#125;<br><br><span class="hljs-keyword">const</span> arrayKeys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyNames</span>(arrayMethods)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            <span class="hljs-keyword">const</span> augment = hasProto ? protoAugment : copyAugment<br>            <br>            <span class="hljs-title function_">augment</span>(value, arrayMethods, arrayKeys)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            ...<br>        &#125;<br>    &#125;<br>    <br>    ...<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">protoAugment</span>(<span class="hljs-params">target, src, keys</span>) &#123;<br>    target.<span class="hljs-property">_proto_</span> = src<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">copyAugment</span>(<span class="hljs-params">target, src, keys</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>,l = keys.<span class="hljs-property">length</span>;i &lt; l; i++) &#123;<br>        <span class="hljs-keyword">const</span> key = keys[i]<br>        <span class="hljs-title function_">def</span>(target, key, src[key])<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¦‚ä½•æ”¶é›†ä¾èµ–"><a href="#å¦‚ä½•æ”¶é›†ä¾èµ–" class="headerlink" title="å¦‚ä½•æ”¶é›†ä¾èµ–"></a>å¦‚ä½•æ”¶é›†ä¾èµ–</h3><p>æˆ‘ä»¬å·²å®Œæˆäº†æ‹¦æˆªå™¨ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ºäº†å½“æ•°ç»„å†…å®¹å˜åŒ–æ—¶èƒ½å¤Ÿå¾—åˆ°é€šçŸ¥Depä¸­çš„ä¾èµ–çš„èƒ½åŠ›ã€‚è€Œæ•°ç»„ä¹Ÿæ˜¯åœ¨getterä¸­æ”¶é›†ä¾èµ–çš„ã€‚æƒ³è¦è¯»å–æ•°ç»„ï¼Œé¦–å…ˆè‚¯å®šä¼šè§¦å‘è¿™ä¸ªæ•°ç»„çš„åå¯¹åº”å±æ€§çš„getterã€‚è€ŒArrayçš„ä¾èµ–å’ŒObjectä¸€æ ·ï¼Œä¹Ÿä¼šåœ¨defineReactiveä¸­æ”¶é›†ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">data, key, val</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> val === <span class="hljs-string">&#x27;object&#x27;</span>) <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(val)<br>    <br>    <span class="hljs-keyword">let</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br>    <br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">deintProperty</span>(data,key, &#123;<br>        <span class="hljs-attr">enumerable</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configurable</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">get</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            dep.<span class="hljs-title function_">depend</span>()<br>            <span class="hljs-comment">// æ”¶é›†æ•°ç»„çš„ä¾èµ–</span><br>            <br>            <span class="hljs-keyword">return</span> val<br>        &#125;,<br>        <span class="hljs-attr">set</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">newVal</span>) &#123;<br>            <span class="hljs-keyword">if</span>(val === newVal) <span class="hljs-keyword">return</span><br>            <br>            dep.<span class="hljs-title function_">notify</span>()<br>            val = newVal<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>Arrayåœ¨getterä¸­æ”¶é›†ä¾èµ–ï¼Œåœ¨æ‹¦æˆªå™¨ä¸­è§¦å‘ä¾èµ–ã€‚</p><h3 id="ä¾èµ–åˆ—è¡¨å­˜åœ¨å“ª"><a href="#ä¾èµ–åˆ—è¡¨å­˜åœ¨å“ª" class="headerlink" title="ä¾èµ–åˆ—è¡¨å­˜åœ¨å“ª"></a>ä¾èµ–åˆ—è¡¨å­˜åœ¨å“ª</h3><p>Arrayçš„ä¾èµ–è¢«å­˜æ”¾åœ¨Observerä¸­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>() <span class="hljs-comment">// æ–°å¢dep</span><br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            <span class="hljs-keyword">const</span> augment = hasProto ? protoAugment : copyAugment<br>            <br>            <span class="hljs-title function_">augment</span>(value, arrayMethods, arrayKeys)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            ...<br>        &#125;<br>    &#125;<br>    <br>    ...<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æœ‰ä¸ªç–‘é—®ï¼Œä¸ºä»€ä¹ˆæ•°ç»„çš„depè¦ä¿å­˜åœ¨Observerå®ä¾‹ä¸Šå‘¢ã€‚å› ä¸ºæ•°ç»„åœ¨getterä¸­æ”¶é›†ä¾èµ–ï¼Œåœ¨æ‹¦æˆªå™¨ä¸­è§¦å‘ä¾èµ–ï¼Œæ‰€ä»¥ä¾èµ–ä¿å­˜çš„ä½ç½®å¾ˆå…³é”®ï¼Œéœ€è¦åœ¨getterå’Œæ‹¦æˆªå™¨ä¸­éƒ½èƒ½è®¿é—®åˆ°ã€‚å°†Depå®ä¾‹ä¿å­˜åˆ°Observerçš„å±æ€§ä¸Šä»¥åï¼Œæˆ‘ä»¬èƒ½å¤Ÿåœ¨getterä¸­è®¿é—®å¹¶æ”¶é›†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">data, key, val</span>) &#123;<br>    <span class="hljs-keyword">let</span> childOb = <span class="hljs-title function_">observer</span>(val)<br>    <span class="hljs-keyword">let</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProerty</span>(data, key, &#123;<br>        <span class="hljs-attr">enumerable</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configurable</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">get</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            dep.<span class="hljs-title function_">depend</span>()<br>            <span class="hljs-keyword">if</span>(childOb) &#123;<br>                childOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()<br>            &#125;<br>            <span class="hljs-keyword">return</span> val<br>        &#125;,<br>        <span class="hljs-attr">set</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params">newVal</span>) &#123;<br>            <span class="hljs-keyword">if</span>(val === newVal) &#123;<br>                <span class="hljs-keyword">return</span><br>            &#125;<br>            <br>            dep.<span class="hljs-title function_">notify</span>()<br>            val = newVal<br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨defineReactiveä¸­è°ƒç”¨observeï¼Œå°†valå½“åšå‚æ•°ä¼ è¿›å»æ‹¿åˆ°è¿”å›å€¼ï¼Œå°±æ˜¯observerå®ä¾‹ã€‚</p><h3 id="åœ¨æ‹¦æˆªå™¨ä¸­è·å–Observerå®ä¾‹"><a href="#åœ¨æ‹¦æˆªå™¨ä¸­è·å–Observerå®ä¾‹" class="headerlink" title="åœ¨æ‹¦æˆªå™¨ä¸­è·å–Observerå®ä¾‹"></a>åœ¨æ‹¦æˆªå™¨ä¸­è·å–Observerå®ä¾‹</h3><p>å› ä¸ºArrayæ‹¦æˆªå™¨æ˜¯å¯¹åŸå‹çš„ä¸€ç§å°è£…ï¼Œæ‰€ä»¥åœ¨æ‹¦æˆªå™¨ä¸­å¯ä»¥è®¿é—®åˆ°thisã€‚è€Œdepä¿å­˜åœ¨Observerä¸­ï¼Œæ‰€ä»¥éœ€è¦åœ¨thisä¸Šè¯»åˆ°Observerå®ä¾‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">def</span> (obj, key, val, enumerable) &#123;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key,  &#123;<br>        <span class="hljs-attr">value</span>:val,<br>        <span class="hljs-attr">enumerable</span>:!!enumerable,<br>        <span class="hljs-attr">writable</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">configruable</span>:<span class="hljs-literal">true</span><br>    &#125;)<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">dep</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br>        <br>        <span class="hljs-title function_">def</span>(value , <span class="hljs-string">&#x27;__ob__&#x27;</span>,<span class="hljs-variable language_">this</span>)<br>        <br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            ...<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            ...<br>        &#125;<br>    &#125;<br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç åœ¨Observerä¸­æ–°å¢äº†ä¸€æ®µä»£ç ï¼Œå®ƒåœ¨valueä¸Šæ–°å¢äº†ä¸€ä¸ªä¸å¯æšä¸¾çš„__ob__å±æ€§å³å½“å‰Observerå®ä¾‹ã€‚å®ƒè¿˜å¯ä»¥ç”¨æ¥æ ‡è®°å½“å‰valueæ˜¯å¦è¢«Observerè½¬æ¢æˆå“åº”å¼æ•°æ®ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´æ‰€æœ‰è¢«ä¾¦æµ‹äº†çš„æ•°æ®èº«ä¸Šéƒ½ä¼šæœ‰ä¸€ä¸ª__ob__æ¥è¡¨ç¤ºå®ƒä»¬æ˜¯å“åº”å¼çš„ï¼Œå¯ä»¥é€šè¿‡value.__ob__æ¥è®¿é—®Observerå®ä¾‹ã€‚å¦‚æœæ˜¯Arrayæ‹¦æˆªå™¨ï¼Œå› ä¸ºå®ƒæ˜¯åŸå‹æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡this.__ob__æ¥è®¿é—®Observerå®ä¾‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>[<span class="hljs-string">&#x27;push&#x27;</span>,<span class="hljs-string">&#x27;pop&#x27;</span>,â€¦â€¦].<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) &#123;<br>    <span class="hljs-keyword">const</span> original = arrayProto[method]<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(arrayMethods,method, &#123;<br>        <span class="hljs-attr">value</span>:<span class="hljs-keyword">function</span> <span class="hljs-title function_">mutator</span>(<span class="hljs-params">...args</span>) &#123;<br>            <span class="hljs-keyword">const</span> ob = <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span><br>            <span class="hljs-keyword">return</span> original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,args)<br>        &#125;,<br>        ...<br>    &#125;)<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="å‘æ•°ç»„ä¾èµ–å‘é€é€šçŸ¥"><a href="#å‘æ•°ç»„ä¾èµ–å‘é€é€šçŸ¥" class="headerlink" title="å‘æ•°ç»„ä¾èµ–å‘é€é€šçŸ¥"></a>å‘æ•°ç»„ä¾èµ–å‘é€é€šçŸ¥</h3><p>æˆ‘ä»¬åªéœ€è¦åœ¨æ‹¦æˆªå™¨ä¸­è®¿é—®Observerå®ä¾‹ï¼Œæ‹¿åˆ°depå±æ€§ï¼Œç›´æ¥å‘é€é€šçŸ¥å³å¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>[<span class="hljs-string">&#x27;push&#x27;</span>,<span class="hljs-string">&#x27;pop&#x27;</span>,â€¦â€¦].<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) &#123;<br>    <span class="hljs-keyword">const</span> original = arrayProto[method]<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(arrayMethods,method, &#123;<br>        <span class="hljs-attr">value</span>:<span class="hljs-keyword">function</span> <span class="hljs-title function_">mutator</span>(<span class="hljs-params">...args</span>) &#123;<br>            <span class="hljs-keyword">const</span> ob = <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span><br>            ob.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()<br>            <span class="hljs-keyword">return</span> original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,args)<br>        &#125;,<br>        ...<br>    &#125;)<br>&#125;)<br><br></code></pre></td></tr></table></figure><h3 id="ä¾¦æµ‹æ•°ç»„å…ƒç´ å˜åŒ–åŠæ–°å¢å˜åŒ–"><a href="#ä¾¦æµ‹æ•°ç»„å…ƒç´ å˜åŒ–åŠæ–°å¢å˜åŒ–" class="headerlink" title="ä¾¦æµ‹æ•°ç»„å…ƒç´ å˜åŒ–åŠæ–°å¢å˜åŒ–"></a>ä¾¦æµ‹æ•°ç»„å…ƒç´ å˜åŒ–åŠæ–°å¢å˜åŒ–</h3><h4 id="å…ƒç´ å˜åŒ–"><a href="#å…ƒç´ å˜åŒ–" class="headerlink" title="å…ƒç´ å˜åŒ–"></a>å…ƒç´ å˜åŒ–</h4><p>ä»‹ç»Observeræ—¶è¯´è¿‡ï¼Œä½œç”¨æ˜¯å°†objectçš„å±æ€§å˜ä¸ºgetter/setterå½¢å¼ï¼Œç°åœ¨Observerç±»ä¸ä»…å¤„ç†Objectç±»å‹ï¼Œè¿˜è¦å¤„ç†Arrayç±»å‹ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åœ¨Observerä¸­æ–°å¢ä¸€äº›å¤„ç†ï¼Œè®©å®ƒèƒ½æŠŠArrayä¹Ÿå˜æˆå“åº”å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br>        <span class="hljs-title function_">def</span>(value,<span class="hljs-string">&#x27;__ob__&#x27;</span>,<span class="hljs-variable language_">this</span>)<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observeArray</span>(value)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">walk</span>(value)<br>        &#125;<br>    &#125;<br>    <br>    ...<br>    <br>    <span class="hljs-title function_">observeArray</span>(<span class="hljs-params">items</span>) &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>,l = items.<span class="hljs-property">length</span>;i &lt; l; i++) &#123;<br>            <span class="hljs-title function_">observe</span>(items[i])<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ–°å¢å…ƒç´ çš„å˜åŒ–"><a href="#æ–°å¢å…ƒç´ çš„å˜åŒ–" class="headerlink" title="æ–°å¢å…ƒç´ çš„å˜åŒ–"></a>æ–°å¢å…ƒç´ çš„å˜åŒ–</h4><ol><li>è·å–æ–°å¢å…ƒç´ </li></ol><p>æˆ‘ä»¬éœ€è¦åœ¨æ‹¦æˆªå™¨ä¸­é˜Ÿæ•°ç»„æ–¹æ³•çš„ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯pushã€unshiftå’Œspliceï¼ˆæ·»åŠ å…ƒç´ æ–¹æ³•ï¼‰ï¼Œéœ€è¦æŠŠå‚æ•°ä¸­æ–°å¢çš„å…ƒç´ æ‹¿è¿‡æ¥ï¼Œç”¨Observerä¾¦æµ‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">[<span class="hljs-string">&#x27;push&#x27;</span>,<span class="hljs-string">&#x27;pop&#x27;</span>,â€¦â€¦].<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">method</span>) &#123;<br>    <span class="hljs-keyword">const</span> original = arrayProto[method]<br>    <span class="hljs-title function_">def</span>(arrayMethods, method, <span class="hljs-keyword">function</span> <span class="hljs-title function_">mutator</span>(<span class="hljs-params">...args</span>) &#123;<br>        <span class="hljs-keyword">const</span> result = original.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)<br>        <span class="hljs-keyword">const</span> ob = <span class="hljs-variable language_">this</span>.<span class="hljs-property">__ob__</span><br>        <span class="hljs-keyword">let</span> inserted<br>        <span class="hljs-keyword">switch</span>(method) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;push&#x27;</span>:<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;unshift&#x27;</span>:<br>                inserted = args<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;splice&#x27;</span>:<br>                inserted = args.<span class="hljs-title function_">slice</span>(<span class="hljs-number">2</span>)<br>                <span class="hljs-keyword">break</span><br>        &#125;<br>        ob.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()<br>        <span class="hljs-keyword">return</span> result<br>    &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="å…³äºæ•°ç»„çš„é—®é¢˜"><a href="#å…³äºæ•°ç»„çš„é—®é¢˜" class="headerlink" title="å…³äºæ•°ç»„çš„é—®é¢˜"></a>å…³äºæ•°ç»„çš„é—®é¢˜</h3><p>å¯¹Arrayçš„å˜åŒ–ä¾¦æµ‹æ˜¯é€šè¿‡æ‹¦æˆªåŸå‹çš„æ–¹æ³•å®ç°ï¼Œæ‰€ä»¥æœ‰äº›æ“ä½œVueæ— æ³•æ‹¦æˆªï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">2</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span>.<span class="hljs-property">length</span> = <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>æ— æ³•ä¾¦æµ‹æ•°ç»„å˜åŒ–ï¼Œä¸ä¼šè§¦å‘re-renderæˆ–è€…watchã€‚</p><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Arrayçš„è¿½è¸ªæ–¹å¼å’ŒObjectä¸åŒï¼Œå› ä¸ºå®ƒæ˜¯é€šè¿‡æ–¹æ³•æ¥æ”¹å˜å†…å®¹ï¼Œæ‰€ä»¥é€šè¿‡åˆ›å»ºæ‹¦æˆªå™¨å»è¦†ç›–æ•°ç»„çš„åŸå‹æ–¹æ³•æ¥è¿½è¸ªå˜åŒ–ã€‚</p><p>è€Œä¸ºäº†ä¸æ±¡æŸ“å…¨å±€çš„åŸå‹æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨Observerä¸­åªé’ˆå¯¹éœ€è¦ä¾¦æµ‹å˜åŒ–çš„æ•°ç»„ç”¨__proto__æ¥è¦†ç›–åŸå‹æ–¹æ³•ï¼Œè€ŒES6ä¹‹å‰å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒï¼Œæ‰€ä»¥é’ˆå¯¹ä¸æ”¯æŒçš„æµè§ˆå™¨ï¼Œæˆ‘ä»¬å¾ªç¯æ‹¦æˆªå™¨ï¼Œå°†æ–¹æ³•è®¾ç½®åˆ°æ•°ç»„èº«ä¸Šæ¥æ‹¦æˆªArray.prototypeä¸Šçš„åŸå‹æ–¹æ³•ã€‚</p><p>ArrayåŒObjectæ”¶é›†ä¾èµ–çš„æ–¹å¼ç›¸åŒï¼Œå‡åœ¨getterä¸­ï¼Œä½†æ˜¯ä½¿ç”¨ä¾èµ–çš„ä½ç½®ä¸åŒï¼Œæ•°ç»„è¦åœ¨æ‹¦æˆªå™¨ä¸­å‘ä¾èµ–å‘é€æ¶ˆæ¯ï¼Œæ‰€ä»¥ä¾èµ–ä¸èƒ½åƒObjectä¸€æ ·ä¿å­˜åœ¨defineReactiveä¸­ï¼Œè€Œæ˜¯ä¿å­˜åœ¨Observerå®ä¾‹ä¸Šã€‚</p><p>åœ¨Observerä¸­é˜Ÿæ¯ä¸ªä¾¦æµ‹äº†å˜åŒ–çš„æ•°æ®éƒ½æ ‡è®°__ob__ï¼Œå¹¶æŠŠthisä¿å­˜åœ¨__ob__ä¸Šã€‚ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ–¹é¢ä¸ºäº†æ ‡è®°æ•°æ®æ˜¯å¦è¢«ä¾¦æµ‹å˜åŒ–ï¼ˆä¿è¯åŒä¸€æ•°æ®åªä¾¦æµ‹ä¸€æ¬¡ï¼‰ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥å¾ˆæ–¹ä¾¿çš„é€šè¿‡æ•°æ®å–åˆ°__ob__ï¼Œä»è€Œæ‹¿åˆ°Observerä¸Šä¿å­˜çš„ä¾èµ–ï¼Œå‘é€é€šçŸ¥ã€‚</p><p>é™¤äº†ä¾¦æµ‹æ•°ç»„è‡ªèº«å˜åŒ–ï¼Œæ•°ç»„ä¸­å…ƒç´ çš„å˜åŒ–ä¹Ÿè¦ä¾¦æµ‹ï¼Œåœ¨Observerä¸­åˆ¤æ–­å¦‚æœå½“å‰è¢«ä¾¦æµ‹æ•°æ®æ˜¯æ•°ç»„ï¼Œåˆ™è°ƒç”¨observerArrayå°†æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ è½¬æ¢æˆå“åº”å¼ã€‚</p><p>é™¤äº†å·²æœ‰æ•°æ®çš„ä¾¦æµ‹ï¼Œå½“ä½¿ç”¨pushç­‰æ–¹æ³•æ–°å¢æ•°æ®æ—¶ï¼Œæ–°å¢çš„æ•°æ®ä¹Ÿè¦ä¾¦æµ‹ï¼Œæˆ‘ä»¬ä½¿ç”¨å½“å‰æ“ä½œæ•°ç»„çš„æ–¹æ³•åˆ¤æ–­ï¼Œå¦‚æœæ˜¯pushã€unshiftå’Œspliceï¼Œåˆ™å°†å‚æ•°ä¸­çš„æ–°å¢æ•°æ®æå–å‡ºæ¥ï¼Œå¯¹å…¶è½¬æ¢ã€‚</p><h2 id="å˜åŒ–ä¾¦æµ‹ç›¸å…³çš„apiå®ç°åŸç†"><a href="#å˜åŒ–ä¾¦æµ‹ç›¸å…³çš„apiå®ç°åŸç†" class="headerlink" title="å˜åŒ–ä¾¦æµ‹ç›¸å…³çš„apiå®ç°åŸç†"></a>å˜åŒ–ä¾¦æµ‹ç›¸å…³çš„apiå®ç°åŸç†</h2><h3 id="vm-watch"><a href="#vm-watch" class="headerlink" title="vm.$watch"></a>vm.$watch</h3><h4 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h4><p><code>vm.$watch(expOfFn, callback, [options])</code></p><p>ç”¨äºè§‚å¯Ÿä¸€ä¸ªè¡¨è¾¾å¼æˆ–computedå‡½æ•°åœ¨vueå®ä¾‹ä¸Šçš„å˜åŒ–ã€‚å›è°ƒå‡½æ•°è°ƒç”¨æ—¶ä¼šä»å‚æ•°å¾—åˆ°æ–°æ•°æ®å’Œæ—§æ•°æ®ï¼Œè¡¨è¾¾å¼åªæ¥å—ä»¥ç‚¹åˆ†éš”çš„è·¯å¾„ï¼Œä¾‹å¦‚<code>a.b.c</code>ã€‚</p><p>optionsåŒ…æ‹¬deepå’Œimmediateï¼Œdeepä¸ºäº†å‘ç°å¯¹è±¡å†…éƒ¨å€¼çš„å˜åŒ–ï¼Œimmediateå°†ç«‹å³ä»¥è¡¨è¾¾å¼çš„å½“å‰å€¼è§¦å‘å›è°ƒã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">vm.$watch(<span class="hljs-string">&#x27;someObject&#x27;</span>,callback, &#123;<br>    <span class="hljs-attr">deep</span>:<span class="hljs-literal">true</span>, <span class="hljs-comment">// someObject.aä¿®æ”¹æ—¶è§¦å‘ã€‚</span><br>    <span class="hljs-attr">immediate</span>:<span class="hljs-literal">true</span> <span class="hljs-comment">// ç«‹å³ä»¥someObjectçš„å½“å‰å€¼è§¦å‘å›è°ƒã€‚</span><br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="å†…éƒ¨åŸç†"><a href="#å†…éƒ¨åŸç†" class="headerlink" title="å†…éƒ¨åŸç†"></a>å†…éƒ¨åŸç†</h4><p>vm.$watchæ˜¯å¯¹Watcherçš„ä¸€ç§å°è£…ï¼Œé€šè¿‡Watcherå®Œå…¨å¯ä»¥å®ç°vm.$watchçš„åŠŸèƒ½ï¼Œä½†å®ƒçš„deepå’Œimmediateæ˜¯Watcheræ²¡æœ‰çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Vue</span>.<span class="hljs-property">property</span>.<span class="hljs-property">$watch</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">expOrFn, cb, options</span>) &#123;<br>    <span class="hljs-keyword">const</span> vm = <span class="hljs-variable language_">this</span><br>    options = options || &#123;&#125;<br>    <span class="hljs-keyword">const</span> watcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(vm, expOfFn, cb, options)<br>    <span class="hljs-keyword">if</span>(options.<span class="hljs-property">immediate</span>) &#123;<br>        cb.<span class="hljs-title function_">call</span>(vm, watcher)<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">unwatchFn</span>(<span class="hljs-params"></span>) &#123;<br>        watcher.<span class="hljs-title function_">teardown</span>()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>expOrFnæ˜¯æ”¯æŒå‡½æ•°çš„ï¼Œè€Œä¹‹å‰ä»‹ç»Watcheræ—¶æ²¡æœ‰æ·»åŠ è¿™éƒ¨åˆ†ï¼Œéœ€è¦å¯¹Watcherç®€å•ä¿®æ”¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, expOrFn, cb</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm<br>        <br>        <span class="hljs-comment">//ä¿®æ”¹</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> expOrFn === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = expOrFn<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = <span class="hljs-title function_">parsePath</span>(expOrFn)<br>        &#125;<br>        <br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœexpOrFnæ˜¯å‡½æ•°ï¼Œå°†å®ƒç›´æ¥èµ‹ç»™getterï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ç”¨parsePathè¯»å–keypathä¸­çš„æ•°æ®ï¼Œkeypathæ˜¯å±æ€§è·¯å¾„ï¼Œä¾‹å¦‚a.b.c.då°±ä»£è¡¨ä»vm.a.b.c.dä¸­è¯»å–æ•°æ®ã€‚</p><p>è€ŒexpOrFnæ˜¯å‡½æ•°æ—¶ï¼Œä¸æ­¢å¯ä»¥åŠ¨æ€è¿”å›æ•°æ®ï¼Œå…¶ä¸­è¯»å–çš„æ•°æ®ä¹Ÿéƒ½ä¼šè¢«Watcherè§‚å¯Ÿã€‚å½“expOrFnæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„keypathæ—¶ï¼ŒWatcherä¼šè¯»å–å®ƒæŒ‡å‘çš„æ•°æ®å¹¶è§‚å¯Ÿæ•°æ®çš„å˜åŒ–ã€‚è€ŒexpOrFnæ˜¯å‡½æ•°æ—¶ï¼ŒWatcherä¼šåŒæ—¶è§‚å¯ŸexpOrFnå‡½æ•°ä¸­è¯»å–çš„æ‰€æœ‰Vueå®ä¾‹ä¸Šçš„å“åº”å¼æ•°æ®ã€‚</p><p>æ‰§è¡Œnew Watcheråï¼Œä»£ç ä¼šåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç”¨äº†immediateå‚æ•°ï¼Œä½¿ç”¨äº†åˆ™ç«‹å³æ‰§è¡Œä¸€æ¬¡cbã€‚</p><p>æœ€åè¿”å›ä¸€ä¸ªå‡½æ•°unwatcheFnï¼Œå®ƒçš„ä½œç”¨æ˜¯å–æ¶ˆè§‚å¯Ÿæ•°æ®ã€‚ç”¨æˆ·æ‰§è¡Œå®ƒæ—¶ï¼Œå®é™…ä¸Šæ˜¯æ‰§è¡Œäº†watcher.teardown()æ¥å–æ¶ˆè§‚å¯Ÿæ•°æ®ï¼Œå…¶æœ¬è´¨æ˜¯æŠŠwatcherå®ä¾‹ä»å½“å‰æ­£åœ¨è§‚å¯Ÿçš„çŠ¶æ€çš„ä¾èµ–åˆ—è¡¨ä¸­ç§»é™¤ã€‚</p><p>ç°åœ¨éœ€è¦å®ç°watcherä¸­çš„teardownæ–¹æ³•ï¼Œæ¥å®ç°unwatchåŠŸèƒ½ã€‚</p><p>é¦–å…ˆéœ€è¦åœ¨Watcherä¸­è®°å½•è‡ªå·±éƒ½è®¢é˜…äº†è°ï¼Œå½“Watcherä¸æƒ³ç»§ç»­è®¢é˜…æ—¶ï¼Œå¾ªç¯è‡ªå·±è®°å½•çš„åˆ—è¡¨æ¥é€šçŸ¥ä»–ä»¬å°†è‡ªå·±ä»ä»–ä»¬çš„ä¾èµ–åˆ—è¡¨ä¸­ç§»é™¤ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, expOrFn, cb</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>  = vm<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">depsIds</span>= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br>        â€¦â€¦<br>    &#125;<br>    <br>    â€¦â€¦<br>    <br>    <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep</span>) &#123;<br>        <span class="hljs-keyword">const</span> id = dep.<span class="hljs-property">id</span><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span>.<span class="hljs-title function_">has</span>(id)) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span>.<span class="hljs-title function_">add</span>(id)<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-title function_">push</span>(dep)<br>            dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œç”¨depIdsåˆ¤æ–­å½“å‰Watcheræ˜¯å¦è®¢é˜…äº†Depï¼Œä¸ä¼šå‘ç”Ÿé‡å¤è®¢é˜…ã€‚</p><p>æ¥ç€æ‰§è¡Œthis.depIds.addæ¥è®°å½•å½“å‰Watcherå·²ç»è®¢é˜…äº†è¿™ä¸ªDepã€‚ç„¶åæ‰§è¡Œthis.deps.push(dep)è®°å½•è‡ªå·±è®¢é˜…äº†é‚£äº›Depã€‚æœ€åè§¦å‘dep.addSub(this)å°†è‡ªå·±è®¢é˜…åˆ°Depä¸­ã€‚</p><p>Watcherä¸­æ–°å¢äº†addDepæ–¹æ³•åï¼ŒDepä¸­æ”¶é›†ä¾èµ–çš„é€»è¾‘ä¹Ÿéœ€è¦æ”¹å˜ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> uid = <span class="hljs-number">0</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = uid++<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []<br>    &#125;<br>    <br>    â€¦â€¦<br>    <br>    <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span>) &#123;<br>            <span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>Depä¼šè®°å½•æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œéœ€è¦é€šçŸ¥å“ªäº›Watcherï¼Œè€ŒWatcherä¸­ä¹Ÿè®°å½•äº†è‡ªå·±ä¼šè¢«å“ªäº›Depé€šçŸ¥ï¼Œæ˜¯å¤šå¯¹å¤šçš„å…³ç³»ã€‚</p><p>åœ¨Watcherä¸­è®°å½•äº†è‡ªå·±éƒ½è®¢é˜…äº†é‚£äº›Depåï¼Œå¯ä»¥åœ¨Watcherä¸­å¢åŠ teardownæ–¹æ³•æ¥é€šçŸ¥è®¢é˜…çš„Depï¼Œè®©ä»–ä»¬æŠŠè‡ªå·±ä»ä¾èµ–ä¸­ç§»é™¤ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">teardown</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-property">length</span><br>    <span class="hljs-keyword">while</span>(i--) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>[i].<span class="hljs-title function_">removeSub</span>(<span class="hljs-variable language_">this</span>)<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> &#123;<br>    â€¦â€¦<br>    <br>    <span class="hljs-title function_">removeSub</span>(<span class="hljs-params">sub</span>) &#123;<br>        <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">indexOf</span>(sub)<br>        <span class="hljs-keyword">if</span>(index &gt; -<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>)<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="deepå‚æ•°å®ç°åŸç†"><a href="#deepå‚æ•°å®ç°åŸç†" class="headerlink" title="deepå‚æ•°å®ç°åŸç†"></a>deepå‚æ•°å®ç°åŸç†</h4><p>deepçš„ ä½œç”¨æ˜¯ç›‘å¬å®ƒåŠå…¶å­å¯¹è±¡çš„æ•°æ®ï¼Œå…¶å®å°±æ˜¯é™¤äº†è¦è§¦å‘å½“å‰è¢«ç›‘å¬æ•°æ®çš„æ”¶é›†ä¾èµ–é€»è¾‘å¤–ï¼Œè¿˜è¦æŠŠå½“å‰ç›‘å¬å€¼åœ¨å†…çš„æ‰€æœ‰å­å€¼éƒ½è§¦å‘ä¸€éæ”¶é›†ä¾èµ–é€»è¾‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm, expOrFn, cb, options</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm<br>        <span class="hljs-comment">// æ–°å¢</span><br>        <span class="hljs-keyword">if</span>(options) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span> = !!options.<span class="hljs-property">deep</span><br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span> = <span class="hljs-literal">false</span><br>        &#125;<br>        <br>        â€¦â€¦<br>    &#125;<br>    <br>    <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">window</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span><br>        <span class="hljs-keyword">let</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span>.<span class="hljs-title function_">call</span>(vm, vm)<br>        <br>        <span class="hljs-comment">//æ–°å¢</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span>) &#123;<br>            <span class="hljs-title function_">traverse</span>(value)<br>        &#125;<br>        windwo.<span class="hljs-property">target</span> = <span class="hljs-literal">undefined</span><br>        <span class="hljs-keyword">return</span> value<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœä½¿ç”¨äº†deepå‚æ•°ï¼Œåˆ™åœ¨target = undefinedå‰è°ƒç”¨traverseæ¥å¤„ç†deepçš„é€»è¾‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> seenObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">traverse</span>(<span class="hljs-params">value</span>) &#123;<br>    <span class="hljs-title function_">_traverse</span>(val, seenObjects)<br>    seenObjects.<span class="hljs-title function_">clear</span>()<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">_traverse</span>(<span class="hljs-params">val, seen</span>) &#123;<br>    <span class="hljs-keyword">let</span> i , keys<br>    <span class="hljs-keyword">const</span> isA = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(val)<br>    <span class="hljs-keyword">if</span>( (!isA &amp;&amp; !<span class="hljs-title function_">isObject</span>(val)) || (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">isFrozen</span>(val)) ) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(val.<span class="hljs-property">__ob__</span>) &#123;<br>        <span class="hljs-keyword">const</span> depId = val.<span class="hljs-property">__ob__</span>.<span class="hljs-property">dep</span>.<span class="hljs-property">id</span><br>        <span class="hljs-keyword">if</span>(seen.<span class="hljs-title function_">has</span>(depId)) &#123;<br>            <span class="hljs-keyword">return</span><br>        &#125;<br>        seen.<span class="hljs-title function_">add</span>(depId)<br>    &#125;<br>    <span class="hljs-keyword">if</span>(isA) &#123;<br>        i = val.<span class="hljs-property">length</span><br>        <span class="hljs-keyword">while</span>(i--) <span class="hljs-title function_">_traverse</span>(val[i], seen)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        keys =<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(val)<br>        i = keys.<span class="hljs-property">length</span><br>        <span class="hljs-keyword">while</span>(i--) <span class="hljs-title function_">_traverse</span>(val[keys[i]], seen)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ©ç”¨é€’å½’æ¥åˆ¤æ–­å­å€¼çš„ç±»å‹ï¼Œæ•°ç»„åˆ™ç›´æ¥å¾ªç¯é€’å½’è°ƒç”¨_traverseï¼Œè€Œå¯¹è±¡åˆ™åˆ©ç”¨keyè¯»å–å¹¶é€’å½’å­å€¼ï¼Œè€Œval[keys[i]]ä¼šè§¦å‘getterï¼Œæ‰€ä»¥è¦åœ¨target = undefinedä¹‹å‰è§¦å‘æ”¶é›†ä¾èµ–çš„åŸå› ã€‚</p><h3 id="vm-set"><a href="#vm-set" class="headerlink" title="vm.$set"></a>vm.$set</h3><h4 id="ç”¨æ³•-1"><a href="#ç”¨æ³•-1" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h4><p><code>vm.$set(target, key, value)</code></p><p>åœ¨objectä¸Šè®¾ç½®ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœobjectæ˜¯å“åº”å¼çš„ï¼ŒVueä¿è¯å±æ€§åœ¨åˆ›å»ºåä¹Ÿæ˜¯å“åº”å¼çš„ï¼Œå¹¶èƒ½å¤Ÿè§¦å‘è§†å›¾æ›´æ–°ã€‚æ­¤æ–¹æ³•ä¸ºäº†é¿å¼€Vueä¸èƒ½ä¾¦æµ‹å±æ€§è¢«æ·»åŠ çš„é™åˆ¶ã€‚</p><blockquote><p>target ä¸èƒ½æ˜¯Vueå®ä¾‹æˆ–Vueå®ä¾‹çš„æ ¹æ•°æ®å¯¹è±¡ã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#el&#x27;</span>,<br>    <span class="hljs-attr">template</span>:<span class="hljs-string">&#x27;#demo-template&#x27;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        obj<br>    &#125;,<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-title function_">action</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">obj</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;abc&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure><p>è°ƒç”¨actionæ–¹æ³•æ—¶ï¼Œä¼šä¸ºobjæ–°å¢ä¸€ä¸ªnameå±æ€§ï¼Œä½†Vueä¸ä¼šå¾—åˆ°ä»»ä½•é€šçŸ¥ï¼Œæ–°å¢çš„å±æ€§ä¹Ÿä¸æ˜¯å“åº”å¼çš„ï¼ŒVueä¸çŸ¥é“è¿™ä¸ªobjæ–°å¢äº†å±æ€§ç­‰åŒäºä¸çŸ¥é“æˆ‘ä»¬ä½¿ç”¨äº†array.length = 0æ¥æ¸…ç©ºæ•°ç»„ä¸€æ ·ã€‚è€Œvm.$setå°±ç”¨æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚</p><h4 id="Arrayçš„å¤„ç†"><a href="#Arrayçš„å¤„ç†" class="headerlink" title="Arrayçš„å¤„ç†"></a>Arrayçš„å¤„ç†</h4><p>é¦–å…ˆåˆ›å»ºsetæ–¹æ³•ï¼Œå¹¶è§„å®šæ¥æ”¶ä¸$setè§„å®šçš„å‚æ•°ä¸€è‡´çš„ä¸‰ä¸ªå‚æ•°ï¼Œå¹¶å¯¹æ•°ç»„è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, val</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target) &amp;&amp; <span class="hljs-title function_">isValidArrayIndex</span>(<span class="hljs-params">key</span>) &#123;<br>        target.<span class="hljs-property">length</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(target.<span class="hljs-property">length</span>, key)<br>        target.<span class="hljs-title function_">splice</span>(key, <span class="hljs-number">1</span>, val)<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœtargetæ˜¯æ•°ç»„å¹¶ä¸”keyæ˜¯æœ‰æ•ˆçš„ç´¢å¼•å€¼ï¼Œå°±å…ˆè®¾ç½®lengthå±æ€§ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬ä¼ çš„ç´¢å¼•å€¼å¤§äºlengthï¼Œå°±éœ€è¦è®©targetçš„lenthç­‰äºç´¢å¼•ã€‚æ¥ä¸‹æ¥é€šè¿‡spliceæ–¹æ³•æŠŠvalè®¾ç½®åˆ°targetçš„æŒ‡å®šä½ç½®ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨spliceæ–¹æ³•æ—¶ï¼Œæ•°ç»„æ‹¦æˆªå™¨ä¼šä¾¦æµ‹åˆ°targetå˜åŒ–ï¼Œè‡ªåŠ¨æŠŠæ–°å¢çš„valè½¬æ¢æˆå“åº”å¼çš„ï¼Œæœ€åè¿”å›valã€‚</p><h4 id="keyå·²ç»å­˜åœ¨targetä¸­"><a href="#keyå·²ç»å­˜åœ¨targetä¸­" class="headerlink" title="keyå·²ç»å­˜åœ¨targetä¸­"></a>keyå·²ç»å­˜åœ¨targetä¸­</h4><p>å› ä¸ºkeyå·²å­˜åœ¨targetä¸­ï¼Œæ‰€ä»¥å®ƒå·²ç»è¢«ä¾¦æµ‹äº†å˜åŒ–ï¼Œæ­¤æ—¶ä¿®æ”¹æ•°æ®ç›´æ¥ç”¨keyå’Œvalå°±å¥½ï¼Œä¿®æ”¹çš„åŠ¨ä½œä¼šè¢«ä¾¦æµ‹åˆ°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, val</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target) &amp;&amp; <span class="hljs-title function_">isValidArrayIndex</span>(<span class="hljs-params">key</span>) &#123;<br>        target.<span class="hljs-property">length</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(target.<span class="hljs-property">length</span>, key)<br>        target.<span class="hljs-title function_">splice</span>(key, <span class="hljs-number">1</span>, val)<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(key <span class="hljs-keyword">in</span> target &amp;&amp; !(key <span class="hljs-keyword">in</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)) &#123;<br>        target[key] = val<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="å¤„ç†æ–°å¢çš„å±æ€§"><a href="#å¤„ç†æ–°å¢çš„å±æ€§" class="headerlink" title="å¤„ç†æ–°å¢çš„å±æ€§"></a>å¤„ç†æ–°å¢çš„å±æ€§</h4><p>ç°åœ¨å¤„ç†åœ¨targetä¸Šæ–°å¢çš„keyï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">target, key, val</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target) &amp;&amp; <span class="hljs-title function_">isValidArrayIndex</span>(<span class="hljs-params">key</span>) &#123;<br>        target.<span class="hljs-property">length</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(target.<span class="hljs-property">length</span>, key)<br>        target.<span class="hljs-title function_">splice</span>(key, <span class="hljs-number">1</span>, val)<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(key <span class="hljs-keyword">in</span> target &amp;&amp; !(key <span class="hljs-keyword">in</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>)) &#123;<br>        target[key] = val<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>    <br>    <span class="hljs-comment">// æ–°å¢</span><br>    <br>    <span class="hljs-keyword">const</span> ob = target.<span class="hljs-property">__ob__</span><br>    <span class="hljs-keyword">if</span>(target.<span class="hljs-property">_isVue</span> || (ob &amp;&amp; ob.<span class="hljs-property">vmCount</span>)) &#123;<br>        process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span> &amp;&amp; <span class="hljs-title function_">warn</span>(<br>            <span class="hljs-string">&#x27;Avoid adding reactive properties to a Vue instance or its root $data&#x27;</span> + <br>            <span class="hljs-string">&#x27;at runtime - declare it upfront in the data option&#x27;</span><br>        )<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(!ob) &#123;<br>        target[key] = val<br>        <span class="hljs-keyword">return</span> val<br>    &#125;<br>    <br>    <span class="hljs-title function_">defineReactive</span>(ob, value, key, val)<br>    ob.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()<br>    <span class="hljs-keyword">return</span> val<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ï¼Œé¦–å…ˆè·å–äº†targetçš„__ob__å±æ€§ï¼Œç„¶åå¤„ç†è¾¹ç•Œæ¡ä»¶å³â€œtargetä¸èƒ½æ˜¯Vueå®ä¾‹æˆ–Vueå®ä¾‹çš„è·Ÿæ•°æ®å¯¹è±¡â€å’Œtargetä¸æ˜¯å“åº”å¼çš„æƒ…å†µã€‚è‹¥æœå®ƒèº«ä¸Šæ²¡æœ‰__ob__ï¼Œåˆ™ä¸æ˜¯å“åº”å¼çš„ï¼Œç›´æ¥ç”¨keyå’Œvalè®¾ç½®å³å¯ã€‚å¦‚æœå‰è¾¹æ‰€æœ‰æ¡ä»¶éƒ½ä¸æ»¡è¶³é‚£ä¹ˆè¯´æ˜è¿™æ˜¯æ–°å¢çš„å±æ€§ï¼Œä½¿ç”¨defineReactiveå°†æ–°å¢çš„å±æ€§è½¬æˆgetter/setterå³å¯ã€‚</p><h3 id="vm-delete"><a href="#vm-delete" class="headerlink" title="vm.$delete"></a>vm.$delete</h3><p>vm.$deleteçš„ä½œç”¨æ˜¯åˆ é™¤æ•°æ®ä¸­çš„æŸä¸ªå±æ€§ï¼Œå› ä¸ºVue2é‡‡ç”¨Object.definePropertyå®ç°ç›‘å¬ï¼Œdeleteå…³é”®å­—åˆ é™¤æ— æ³•ä¾¦æµ‹åˆ°ã€‚</p><h4 id="ç”¨æ³•-2"><a href="#ç”¨æ³•-2" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h4><p><code>vm.$delete(target , key)</code></p><blockquote><p>åˆ é™¤å¯¹è±¡çš„å±æ€§ï¼Œå¦‚æœå¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œéœ€è¦ç¡®ä¿åˆ é™¤èƒ½æ›´æ–°è§†å›¾ã€‚åŒæ ·çš„ï¼Œç›®æ ‡ä¸èƒ½æ˜¯Vueå®ä¾‹æˆ–Vueå®ä¾‹çš„è·Ÿæ•°æ®å¯¹è±¡ã€‚</p></blockquote><h4 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h4><p>vm.$deleteçš„å®ç°åŸç†å’Œä¸Šè¿°ä»£ç ç±»ä¼¼ï¼Œåˆ é™¤å±æ€§åå‘ä¾èµ–å‘æ¶ˆæ¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">del</span>(<span class="hljs-params">target, key</span>) &#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(target) &amp;&amp; <span class="hljs-title function_">isValidArrayIndex</span>(key)) &#123;<br>        target.<span class="hljs-title function_">splice</span>(key , l)<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">const</span> ob = (target).<span class="hljs-property">__ob__</span><br>    <span class="hljs-keyword">if</span>(target.<span class="hljs-property">_isVue</span> || (ob &amp;&amp; ob.<span class="hljs-property">vmCount</span>)) &#123;<br>        process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span> &amp;&amp; <span class="hljs-title function_">warn</span>(<br>            <span class="hljs-string">&#x27;Avoid deleting properties on a Vue instance or its root $data&#x27;</span> + <br>            <span class="hljs-string">&#x27;- just set it to null.&#x27;</span><br>        )<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_">hasOwn</span>(target, key) ) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-keyword">delete</span> target[key]<br>    <span class="hljs-keyword">if</span>(!ob) &#123;<br>        <span class="hljs-keyword">return</span><br>    &#125;<br>    ob.<span class="hljs-property">dep</span>.<span class="hljs-title function_">notify</span>()<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue.js</tag>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§ï¼‰</title>
    <link href="/2021/11/22/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%EF%BC%89/"/>
    <url>/2021/11/22/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99%E5%92%8C%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="è®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§"><a href="#è®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§" class="headerlink" title="è®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§"></a>è®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§</h1><h2 id="å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰"><a href="#å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰"></a>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</h2><p>SRPåŸåˆ™ä½“ç°ä¸ºï¼šä¸€ä¸ªå¯¹è±¡ï¼ˆæ–¹æ³•ï¼‰å€¼åšä¸€ä»¶äº‹æƒ…ã€‚</p><h3 id="è®¾è®¡æ¨¡å¼ä¸­çš„SRP"><a href="#è®¾è®¡æ¨¡å¼ä¸­çš„SRP" class="headerlink" title="è®¾è®¡æ¨¡å¼ä¸­çš„SRP"></a>è®¾è®¡æ¨¡å¼ä¸­çš„SRP</h3><p>ä»£ç†æ¨¡å¼ï¼Œè¿­ä»£å™¨æ¨¡å¼ï¼Œå•ä¾‹æ¨¡å¼ï¼Œè£…é¥°è€…æ¨¡å¼éƒ½è¿ç”¨åˆ°äº†SRP</p><h4 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h4><p>ä»¥å›¾ç‰‡é¢„åŠ è½½ä¸ºä¾‹ï¼Œæˆ‘ä»¬æ·»åŠ è™šæ‹Ÿä»£ç†æ¥æ‰§è¡Œé¢„åŠ è½½å›¾ç‰‡ï¼Œæœ¬ä½“ä»…ä»…è´Ÿè´£å‘é¡µé¢ä¸­æ·»åŠ imgæ ‡ç­¾ï¼Œè¿™ä¹Ÿæ˜¯ä»–æœ€åŸå§‹çš„è´£ä»»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// myImageè´Ÿè´£å‘é¡µé¢æ·»åŠ imgæ ‡ç­¾</span><br><br><span class="hljs-keyword">var</span> myImage = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> imgNode = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;img&#x27;</span>)<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(imgNode)<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-title class_">SetSrc</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> src </span>)&#123;<br>            imgNode.<span class="hljs-property">src</span> = src<br>        &#125;<br>    &#125;<br>&#125;)()<br><br><span class="hljs-comment">// proxyImageè´Ÿè´£å›¾ç‰‡çš„é¢„åŠ è½½ï¼Œå¹¶åœ¨é¢„åŠ è½½å®ŒæˆåæŠŠè¯·æ±‚äº¤ç»™æœ¬ä½“myImage</span><br><span class="hljs-keyword">var</span> proxyImage = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span><br>    img.<span class="hljs-property">onLoad</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        myImage.<span class="hljs-title class_">SetSrc</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">src</span>)<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">setSrc</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">src</span>) &#123;<br>            myImage.<span class="hljs-title class_">SetSrc</span>(<span class="hljs-string">&#x27;åŠ è½½ä¸­å›¾ç‰‡è·¯å¾„&#x27;</span>)<br>            img.<span class="hljs-property">src</span>=  src<br>        &#125;<br>    &#125;<br>&#125;)()<br><br>proxyImage.<span class="hljs-title function_">setSrc</span>(<span class="hljs-string">&#x27;å›¾ç‰‡è·¯å¾„&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h3><p>æœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼Œå…ˆéå†ä¸€ä¸ªé›†åˆï¼Œç„¶åå¾€é¡µé¢ä¸­æ·»åŠ ä¸€äº› divï¼Œè¿™äº› div çš„ innerHTMLåˆ†åˆ«å¯¹åº”é›†åˆé‡Œçš„å…ƒç´ ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> appendDiv = <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>,l = data.<span class="hljs-property">legnth</span>;i &lt; l;i++) &#123;<br>        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>        div.<span class="hljs-property">innerHTML</span> = data[i]<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_">appendDiv</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>])<br></code></pre></td></tr></table></figure><p>appendDivæœ¬æ¥åªè´Ÿè´£æ¸²æŸ“æ•°æ®ï¼Œä½†è¿™é‡Œä»–è¿˜æ‰¿æ‹…äº†éå†å¯¹è±¡dataçš„èŒè´£ï¼Œå¦‚æœæœ‰ä¸€å¤©è¿”å›çš„dataæ ¼å¼é”™è¯¯ï¼Œé‚£ä¹ˆä»£ç ä¼šå‡ºç°é—®é¢˜ï¼Œéœ€è¦ä¿®æ”¹appendDivå†…éƒ¨ä»£ç ï¼Œæ‰èƒ½ä¿è¯åŠŸèƒ½çš„æ­£å¸¸ä½¿ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†éå†è¿‡ç¨‹æå–å‡ºæ¥ï¼Œè¿™ä¹Ÿæ˜¯è¿­ä»£å™¨æ¨¡å¼çš„æ„ä¹‰æ‰€åœ¨ï¼Œå®ƒæä¾›ä¸€ç§æ–¹æ³•æ¥è®¿é—®èšåˆå¯¹è±¡ï¼Œåˆä¸æš´éœ²å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p><p>æŠŠè¿­ä»£èšåˆå¯¹è±¡çš„èŒè´£å•ç‹¬å°è£…åœ¨eachä¸­ï¼Œå³ä½¿ä»¥åè¦å¢åŠ æ–°çš„è¿­ä»£æ–¹å¼ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹eachï¼Œæ— éœ€æ”¹åŠ¨appendDivã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> each = <span class="hljs-keyword">function</span>(<span class="hljs-params">obj, callback</span>) &#123;<br>    <span class="hljs-keyword">var</span> value,<br>        i = <span class="hljs-number">0</span>,<br>        length = obj.<span class="hljs-property">length</span>,<br>        isArray = <span class="hljs-title function_">isArraylike</span>(obj) <span class="hljs-comment">// æœªå®ç°isArrayLikeï¼Œå¯è‡ªè¡Œå®ç°ã€‚</span><br>    <br>    <span class="hljs-keyword">if</span>(isArray) &#123; <span class="hljs-comment">// è¿­ä»£ç±»æ•°ç»„</span><br>        <span class="hljs-keyword">for</span>(;i &lt; length; i++) &#123;<br>            callback.<span class="hljs-title function_">call</span>(obj[i],i,obj[i])<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> obj) &#123;<br>            value = callback.<span class="hljs-title function_">call</span>(obj[i] , i obj[i])<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> obj<br>&#125;<br><br><span class="hljs-keyword">var</span> appendDiv = <span class="hljs-keyword">function</span>(<span class="hljs-params"> data </span>)&#123; <br>    <span class="hljs-title function_">each</span>( data, <span class="hljs-keyword">function</span>(<span class="hljs-params"> i, n </span>)&#123; <br>        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;div&#x27;</span> ); <br>        div.<span class="hljs-property">innerHTML</span> = n; <br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>( div ); <br>    &#125;); <br>&#125;; <br><span class="hljs-title function_">appendDiv</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span> ] ); <br><span class="hljs-title function_">appendDiv</span>(&#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>,<span class="hljs-attr">b</span>:<span class="hljs-number">2</span>,<span class="hljs-attr">c</span>:<span class="hljs-number">3</span>,<span class="hljs-attr">d</span>:<span class="hljs-number">4</span>&#125; );<br></code></pre></td></tr></table></figure><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>å®ç°ä¸€ä¸ªæƒ°æ€§å•ä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> createLoginLayer = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> div<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">if</span>(!div) &#123;<br>            div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>            div.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;ç™»å½•çª—å£&#x27;</span><br>            div.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span><br>            <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br>        &#125;<br>        <span class="hljs-keyword">return</span> div<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠç®¡ç†å•ä¾‹çš„èŒè´£å’Œåˆ›å»ºç™»å½•æµ®çª—çš„èŒè´£å°è£…åœ¨ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œä¸¤è€…ç‹¬ç«‹å˜åŒ–äº’ä¸å½±å“ï¼Œè¿æ¥èµ·æ¥å®Œæˆåˆ›å»ºå”¯ä¸€ç™»å½•çª—å£çš„åŠŸèƒ½ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> getSingle = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">var</span> result<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> result || (result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,<span class="hljs-variable language_">arguments</span>))<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> createLoginLayer = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>    div.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;ç™»å½•çª—å£&#x27;</span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br>    <span class="hljs-keyword">return</span> div<br>&#125;<br><br><span class="hljs-keyword">var</span> createSingleLoginLayer = <span class="hljs-title function_">getSingle</span>( createLoginLayer ); <br><span class="hljs-keyword">var</span> loginLayer1 = <span class="hljs-title function_">createSingleLoginLayer</span>(); <br><span class="hljs-keyword">var</span> loginLayer2 = <span class="hljs-title function_">createSingleLoginLayer</span>(); <br><br>alert ( loginLayer1 === loginLayer2 ); <span class="hljs-comment">// è¾“å‡ºï¼š true</span><br></code></pre></td></tr></table></figure><h3 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h3><p>ä½¿ç”¨è£…é¥°è€…æ¨¡å¼æ—¶ï¼Œé€šå¸¸è®©ç±»æˆ–å¯¹è±¡ä¸€å¼€å§‹åªå…·æœ‰åŸºæœ¬èŒè´£ï¼Œæ›´å¤šçš„èŒè´£åœ¨ä»£ç è¿è¡Œæ—¶è¢«åŠ¨æ€çš„è£…é¥°åˆ°å¯¹è±¡ä¸Šï¼Œä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œè¿™ä¹Ÿæ˜¯åˆ†ç¦»èŒè´£çš„ä¸€ç§æ–¹å¼ã€‚</p><h3 id="ä½•æ—¶åº”è¯¥åˆ†ç¦»èŒè´£"><a href="#ä½•æ—¶åº”è¯¥åˆ†ç¦»èŒè´£" class="headerlink" title="ä½•æ—¶åº”è¯¥åˆ†ç¦»èŒè´£"></a>ä½•æ—¶åº”è¯¥åˆ†ç¦»èŒè´£</h3><p>SRP åŸåˆ™æ˜¯æ‰€æœ‰åŸåˆ™ä¸­æœ€ç®€å•ä¹Ÿæ˜¯æœ€éš¾æ­£ç¡®è¿ç”¨çš„åŸåˆ™ä¹‹ä¸€ã€‚è¦æ˜ç¡®çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„èŒè´£éƒ½åº”è¯¥ä¸€ä¸€åˆ†ç¦»ã€‚ä¸€æ–¹é¢ï¼Œå¦‚æœéšç€éœ€æ±‚çš„å˜åŒ–ï¼Œæœ‰ä¸¤ä¸ªèŒè´£æ€»æ˜¯åŒæ—¶å˜åŒ–ï¼Œé‚£å°±ä¸å¿…åˆ†ç¦»ä»–ä»¬ã€‚æ¯”å¦‚åœ¨ajaxè¯·æ±‚çš„æ—¶å€™ï¼Œåˆ›å»ºxhrå¯¹è±¡å’Œå‘é€xhrè¯·æ±‚å‡ ä¹æ€»æ˜¯åœ¨ä¸€èµ·çš„ï¼Œé‚£ä¹ˆåˆ›å»º xhr å¯¹è±¡çš„èŒè´£å’Œå‘é€xhrè¯·æ±‚çš„èŒè´£å°±æ²¡æœ‰å¿…è¦åˆ†å¼€ã€‚<br>å¦ä¸€æ–¹é¢ï¼ŒèŒè´£çš„å˜åŒ–è½´çº¿ä»…å½“å®ƒä»¬ç¡®å®šä¼šå‘ç”Ÿå˜åŒ–æ—¶æ‰å…·æœ‰æ„ä¹‰ï¼Œå³ä½¿ä¸¤ä¸ªèŒè´£å·²ç»è¢«è€¦åˆåœ¨ä¸€èµ·ï¼Œä½†å®ƒä»¬è¿˜æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„å¾å…†ï¼Œé‚£ä¹ˆä¹Ÿè®¸æ²¡æœ‰å¿…è¦ä¸»åŠ¨åˆ†ç¦»å®ƒä»¬ï¼Œåœ¨ä»£ç éœ€è¦é‡æ„çš„æ—¶å€™å†è¿›è¡Œåˆ†ç¦»ä¹Ÿä¸è¿Ÿã€‚</p><h3 id="SRPçš„ä¼˜ç¼ºç‚¹"><a href="#SRPçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="SRPçš„ä¼˜ç¼ºç‚¹"></a>SRPçš„ä¼˜ç¼ºç‚¹</h3><p>SRP åŸåˆ™çš„ä¼˜ç‚¹æ˜¯é™ä½äº†å•ä¸ªç±»æˆ–è€…å¯¹è±¡çš„å¤æ‚åº¦ï¼ŒæŒ‰ç…§èŒè´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ï¼Œè¿™æœ‰åŠ©äºä»£ç çš„å¤ç”¨ï¼Œä¹Ÿæœ‰åˆ©äºè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚å½“ä¸€ä¸ªèŒè´£éœ€è¦å˜æ›´çš„æ—¶å€™ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„èŒè´£ã€‚ä½†SRPåŸåˆ™ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œæœ€æ˜æ˜¾çš„æ˜¯ä¼šå¢åŠ ç¼–å†™ä»£ç çš„å¤æ‚åº¦ã€‚å½“æˆ‘ä»¬æŒ‰ç…§èŒè´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ä¹‹åï¼Œå®é™…ä¸Šä¹Ÿå¢å¤§äº†è¿™äº›å¯¹è±¡ä¹‹é—´ç›¸äº’è”ç³»çš„éš¾åº¦ã€‚</p><h2 id="æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLKPï¼‰"><a href="#æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLKPï¼‰" class="headerlink" title="æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLKPï¼‰"></a>æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLKPï¼‰</h2><p>ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨ã€‚è¿™é‡Œçš„è½¯ä»¶å®ä½“æ˜¯ä¸€ä¸ªå¹¿ä¹‰çš„æ¦‚å¿µï¼Œä¸ä»…åŒ…æ‹¬å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿã€ç±»ã€æ¨¡å—ã€å‡½æ•°ã€å˜é‡ç­‰ã€‚</p><h3 id="å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»"><a href="#å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»" class="headerlink" title="å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»"></a>å‡å°‘å¯¹è±¡ä¹‹é—´çš„è”ç³»</h3><p>æœ€å°‘çŸ¥è¯†åŸåˆ™è¦æ±‚æˆ‘ä»¬åœ¨è®¾è®¡ç¨‹åºæ—¶ï¼Œåº”å½“å°½é‡å‡å°‘å¯¹è±¡ä¹‹é—´çš„äº¤äº’ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¸å¿…å½¼æ­¤ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡å°±ä¸è¦å‘ç”Ÿç›´æ¥çš„ç›¸äº’è”ç³»ã€‚å¸¸è§çš„åšæ³•æ˜¯å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰è€…å¯¹è±¡ï¼Œæ¥æ‰¿æ‹…è¿™äº›å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ä½œç”¨ã€‚å¦‚æœä¸€äº›å¯¹è±¡éœ€è¦å‘å¦ä¸€äº›å¯¹è±¡å‘èµ·è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰è€…å¯¹è±¡æ¥è½¬å‘è¿™äº›è¯·æ±‚ã€‚</p><h3 id="è®¾è®¡æ¨¡å¼ä¸­çš„LKP"><a href="#è®¾è®¡æ¨¡å¼ä¸­çš„LKP" class="headerlink" title="è®¾è®¡æ¨¡å¼ä¸­çš„LKP"></a>è®¾è®¡æ¨¡å¼ä¸­çš„LKP</h3><ol><li>ä¸­ä»‹è€…æ¨¡å¼</li></ol><p>é€šè¿‡å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡ï¼Œè®©æ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯äº’ç›¸å¼•ç”¨ã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªéœ€è¦é€šçŸ¥ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚</p><h3 id="å°è£…åœ¨æœ€å°‘çŸ¥è¯†åŸåˆ™ä¸­çš„ä½“ç°"><a href="#å°è£…åœ¨æœ€å°‘çŸ¥è¯†åŸåˆ™ä¸­çš„ä½“ç°" class="headerlink" title="å°è£…åœ¨æœ€å°‘çŸ¥è¯†åŸåˆ™ä¸­çš„ä½“ç°"></a>å°è£…åœ¨æœ€å°‘çŸ¥è¯†åŸåˆ™ä¸­çš„ä½“ç°</h3><p>å°è£…åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¡¨è¾¾çš„æ˜¯æ•°æ®çš„éšè—ã€‚ä¸€ä¸ªæ¨¡å—æˆ–è€…å¯¹è±¡å¯ä»¥å°†å†…éƒ¨çš„æ•°æ®æˆ–è€…å®ç°ç»†èŠ‚éšè—èµ·æ¥ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£APIä¾›å¤–ç•Œè®¿é—®ã€‚å¯¹è±¡ä¹‹é—´éš¾å…äº§ç”Ÿè”ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡å¿…é¡»å¼•ç”¨å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¯¹è±¡åªæš´éœ²å¿…è¦çš„æ¥å£ï¼Œè®©å¯¹è±¡ä¹‹é—´çš„è”ç³»é™åˆ¶åœ¨æœ€å°çš„èŒƒå›´ä¹‹å†…ã€‚</p><h2 id="å¼€æ”¾-å°é—­åŸåˆ™ï¼ˆOCPï¼‰"><a href="#å¼€æ”¾-å°é—­åŸåˆ™ï¼ˆOCPï¼‰" class="headerlink" title="å¼€æ”¾-å°é—­åŸåˆ™ï¼ˆOCPï¼‰"></a>å¼€æ”¾-å°é—­åŸåˆ™ï¼ˆOCPï¼‰</h2><p>å½“éœ€è¦æ”¹å˜ä¸€ä¸ªç¨‹åºçš„åŠŸèƒ½æˆ–è€…ç»™è¿™ä¸ªç¨‹åºå¢åŠ æ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å¢åŠ ä»£ç çš„æ–¹å¼ï¼Œä½†æ˜¯ä¸å…è®¸æ”¹åŠ¨ç¨‹åºçš„æºä»£ç ã€‚</p><h3 id="åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¶ˆé™¤æ¡ä»¶åˆ†æ”¯"><a href="#åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¶ˆé™¤æ¡ä»¶åˆ†æ”¯" class="headerlink" title="åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¶ˆé™¤æ¡ä»¶åˆ†æ”¯"></a>åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¶ˆé™¤æ¡ä»¶åˆ†æ”¯</h3><p>è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯é€ æˆç¨‹åºè¿åå¼€æ”¾-å°é—­åŸåˆ™çš„å¸¸è§åŸå› ã€‚æ¯å½“éœ€è¦æ·»åŠ æ–°çš„ifè¯­å¥æ—¶éƒ½éœ€è¦ä¿®æ”¹åŸå‡½æ•°ï¼Œswitch-caseä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œå¯¹äºæŸäº›æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹è±¡çš„å¤šæ€é‡æ„ä»–ä»¬ã€‚è¿™é‡Œé€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚</p><p>æˆ‘ä»¬å®ç°ä¸€ä¸ªè®©åŠ¨ç‰©å‘å‡ºå«å£°çš„ä¾‹å­ï¼Œé¦–å…ˆæä¾›ä¸€æ®µä¸ç¬¦åˆåŸåˆ™çš„ä»£ç ï¼Œæ¯å½“æˆ‘ä»¬å¢åŠ ä¸€ç§åŠ¨ç‰©ï¼Œå°±éœ€è¦ä¿®æ”¹å‡½æ•°çš„å†…éƒ¨å®ç°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> makeSound = <span class="hljs-keyword">function</span>(<span class="hljs-params">animal</span>) &#123;<br>    <span class="hljs-keyword">if</span>(animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Duck</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å˜&#x27;</span>)<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(animal <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Chicken</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å’¯&#x27;</span>)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Duck</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Chicken</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><br><span class="hljs-title function_">makeSound</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Duck</span>())<br><span class="hljs-title function_">makeSound</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Chicken</span>())<br></code></pre></td></tr></table></figure><p>å¦‚æœç°åœ¨éœ€è¦æ·»åŠ ä¸€ä¸ªç‹—ï¼Œé‚£å¿…é¡»ä¿®æ”¹makeSoundçš„å†…éƒ¨å®ç°æ‰å¯ä»¥ï¼Œç°åœ¨æˆ‘ä»¬åˆ©ç”¨å¤šæ€çš„æ€æƒ³ï¼Œå°†ç¨‹åºä¸­ä¸å˜çš„éƒ¨åˆ†åˆ†ç¦»å‡ºæ¥ï¼ˆåŠ¨ç‰©å«ï¼‰ï¼Œå°†å¯å˜çš„éƒ¨åˆ†å°è£…ï¼ˆä¸åŒåŠ¨ç‰©å«å£°ä¸åŒï¼‰ï¼Œè¿™æ ·ç¨‹åºå˜å¾—å¯æ‰©å±•ï¼Œæƒ³è¦æ·»åŠ ç‹—å«æ—¶æ— éœ€å»ä¿®æ”¹makeSoundå‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> makeSound = <span class="hljs-keyword">function</span>(<span class="hljs-params">animal</span>) &#123;<br>    animal.<span class="hljs-title function_">sound</span>()<br>&#125;<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Duck</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><br><span class="hljs-title class_">Duck</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sound</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å˜&#x27;</span>)<br>&#125;<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Chicken</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><br><span class="hljs-title class_">Chicken</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">sound</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å’¯&#x27;</span>)<br>&#125;<br><br><span class="hljs-title function_">makeSound</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Duck</span>())<br><span class="hljs-title function_">makeSound</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Chicken</span>())<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–å¸®åŠ©éµå®ˆå¼€æ”¾-å°é—­åŸåˆ™çš„ä»£ç "><a href="#å…¶ä»–å¸®åŠ©éµå®ˆå¼€æ”¾-å°é—­åŸåˆ™çš„ä»£ç " class="headerlink" title="å…¶ä»–å¸®åŠ©éµå®ˆå¼€æ”¾-å°é—­åŸåˆ™çš„ä»£ç "></a>å…¶ä»–å¸®åŠ©éµå®ˆå¼€æ”¾-å°é—­åŸåˆ™çš„ä»£ç </h3><ol><li>hook</li></ol><p>hookä¹Ÿæ˜¯åˆ†ç¦»å˜åŒ–çš„æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ç¨‹åºå¯èƒ½å˜åŒ–çš„åœ°æ–¹æ·»åŠ é’©å­å‡½æ•°ï¼Œé’©å­çš„ç»“æœå†³å®šäº†ç¨‹åºçš„ä¸‹ä¸€æ­¥æ‰§è¡Œï¼Œè¿™æ ·ç»™ä»£ç æä¾›äº†å¤šç§æ‰§è¡Œç»“æœçš„å¯èƒ½æ€§ã€‚</p><ol start="2"><li>å›è°ƒå‡½æ•°</li></ol><p>å›è°ƒå‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„hookï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€éƒ¨åˆ†æ˜“äºå˜åŒ–çš„é€»è¾‘å°è£…åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œå°†å›è°ƒå½“åšå‚æ•°ä¼ å…¥ä¸€ä¸ªç¨³å®šå’Œå°é—­çš„å‡½æ•°ä¸­ï¼Œå›è°ƒå‡½æ•°çœŸå¿ƒå¾ˆæ—¶ï¼Œç¨‹åºå› ä¸ºå›è°ƒå‡½æ•°å†…éƒ¨é€»è¾‘ä¸é€šè€Œäº§ç”Ÿä¸åŒç»“æœã€‚</p><h3 id="è®¾è®¡æ¨¡å¼ä¸­çš„å¼€æ”¾-å°é—­åŸåˆ™"><a href="#è®¾è®¡æ¨¡å¼ä¸­çš„å¼€æ”¾-å°é—­åŸåˆ™" class="headerlink" title="è®¾è®¡æ¨¡å¼ä¸­çš„å¼€æ”¾-å°é—­åŸåˆ™"></a>è®¾è®¡æ¨¡å¼ä¸­çš„å¼€æ”¾-å°é—­åŸåˆ™</h3><ol><li>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</li><li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</li><li>ç­–ç•¥æ¨¡å¼</li><li>ä»£ç†æ¨¡å¼</li><li>èŒè´£é“¾æ¨¡å¼</li></ol><h2 id="æ¥å£å’Œé¢å‘æ¥å£ç¼–ç¨‹"><a href="#æ¥å£å’Œé¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="æ¥å£å’Œé¢å‘æ¥å£ç¼–ç¨‹"></a>æ¥å£å’Œé¢å‘æ¥å£ç¼–ç¨‹</h2><p>è¿™é‡Œçš„æ¥å£å®šä¹‰æ˜¯<strong>å¯¹è±¡èƒ½å“åº”çš„è¯·æ±‚çš„é›†åˆ</strong>ã€‚å¹¶ä¸æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ä¸€ä¸ªåº“æˆ–æ¨¡å—å¯¹å¤–æä¾›çš„apiæ¥å£ã€‚</p><p>Javaä¸­çš„æŠ½è±¡ç±»å’Œinterfaceçš„ä½œç”¨æ— éä¸¤ç‚¹ï¼š</p><ul><li>é€šè¿‡å‘ä¸Šè½¬å‹éšè—å¯¹è±¡çš„çœŸæ­£ç±»å‹ï¼Œè¡¨ç°å¯¹è±¡çš„å¤šæ€æ€§ã€‚</li><li>çº¦å®šç±»ä¸ç±»ä¹‹é—´çš„å¥‘çº¦è¡Œä¸ºã€‚</li></ul><p>åœ¨JavaScriptä¸­ï¼Œç±»æ˜¯ä¸€ä¸ªç›¸å¯¹æ¨¡ç³Šçš„æ¦‚å¿µï¼Œä¸éœ€è¦åˆ©ç”¨ä¸¤è€…ç»™å¯¹è±¡è¿›è¡Œâ€œå‘ä¸Šè½¬å‹â€ã€‚é™¤äº†åŸºæœ¬ç±»å‹å¤–ï¼Œå…¶ä»–å¯¹è±¡éƒ½å¯ä»¥è¢«çœ‹åšâ€œå¤©ç”Ÿâ€è¢«â€œå‘ä¸Šè½¬å‹â€æˆObjectç±»å‹ï¼Œæ‰€ä»¥åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå¦‚æœå¿½ç•¥äº†æ£€æŸ¥å‚æ•°ç±»å‹æˆ–æ£€æŸ¥å®ç°æ–¹æ³•åˆ™ä¼šæœ‰å¯èƒ½åœ¨ä»£ç ä¸­ç•™ä¸‹éšè—çš„bugã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"> obj </span>)&#123; <br> obj.<span class="hljs-title function_">show</span>(); <span class="hljs-comment">// Uncaught TypeError: undefined is not a function </span><br>&#125; <br><span class="hljs-keyword">var</span> myObject = &#123;&#125;; <span class="hljs-comment">// myObject å¯¹è±¡æ²¡æœ‰ show æ–¹æ³•</span><br><span class="hljs-title function_">show</span>( myObject );<br></code></pre></td></tr></table></figure><p>è¿™æ—¶æˆ‘ä»¬éœ€è¦å¯¹showæ–¹æ³•æ·»åŠ é˜²å¾¡æ€§ä»£ç ï¼Œä»¥ä¿è¯ä»£ç å¯ç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params"> obj </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( obj &amp;&amp; <span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">show</span> === <span class="hljs-string">&#x27;function&#x27;</span> )&#123; <br>        obj.<span class="hljs-title function_">show</span>(); <br>    &#125; <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ä»£ç é‡æ„"><a href="#ä»£ç é‡æ„" class="headerlink" title="ä»£ç é‡æ„"></a>ä»£ç é‡æ„</h2><h3 id="æç‚¼å‡½æ•°"><a href="#æç‚¼å‡½æ•°" class="headerlink" title="æç‚¼å‡½æ•°"></a>æç‚¼å‡½æ•°</h3><p>å¦‚æœä»£ç ä¸­æœ‰ä»£ç å¯ä»¥è¢«ç‹¬ç«‹å‡ºæ¥ï¼Œé‚£ä¹ˆæœ€å¥½å°†å…¶æ”¾åœ¨å¦ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ä¸­ï¼Œè¿™å¾ˆå¸¸è§ï¼Œè¿™æ ·çš„å¥½å¤„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>é¿å…å‡ºç°è¶…å¤§å‡½æ•°</li><li>ç‹¬ç«‹å‡ºæ¥çš„å‡½æ•°æœ‰åŠ©äºä»£ç å¤ç”¨</li><li>ç‹¬ç«‹å‡ºæ¥çš„å‡½æ•°å®¹æ˜“è¢«è¦†å†™</li><li>ç‹¬ç«‹å‡ºæ¥çš„å‡½æ•°å¦‚æœæ‹¥æœ‰è‰¯å¥½å‘½åï¼Œåˆ™å…¶æœ¬èº«å³ä¸ºä¸€ä¸ªè‰¯å¥½çš„æ³¨é‡Š</li></ul><h3 id="åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ"><a href="#åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ" class="headerlink" title="åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ"></a>åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ</h3><p>å‡½æ•°å†…çš„ä¸€äº›æ¡ä»¶åˆ†æ”¯è¯­å¥å¾ˆå®¹æ˜“æ•£å¸ƒé‡å¤ä»£ç ï¼Œæœ‰å¿…è¦è¿›è¡Œä¸€äº›åˆå¹¶å»é‡å·¥ä½œï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåˆ†é¡µå‡½æ•°çš„ä¾‹å­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> paging = <span class="hljs-keyword">function</span>(<span class="hljs-params"> currPage </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( currPage &lt;= <span class="hljs-number">0</span> )&#123; <br>        currPage = <span class="hljs-number">0</span>; <br>        <span class="hljs-title function_">jump</span>( currPage ); <span class="hljs-comment">// è·³è½¬ </span><br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( currPage &gt;= totalPage )&#123; <br>        currPage = totalPage; <br>        <span class="hljs-title function_">jump</span>( currPage ); <span class="hljs-comment">// è·³è½¬</span><br>    &#125;<span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-title function_">jump</span>( currPage ); <span class="hljs-comment">// è·³è½¬</span><br>    &#125; <br>&#125;;<br></code></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å¯ä»¥å‘ç°ï¼Œjumpå‡½æ•°åœ¨æ¯ä¸ªåˆ†æ”¯å†…éƒ½å­˜åœ¨ï¼Œå¯ä»¥å°†å®ƒç‹¬ç«‹å‡ºæ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> paging = <span class="hljs-keyword">function</span>(<span class="hljs-params"> currPage </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( currPage &lt;= <span class="hljs-number">0</span> )&#123; <br>        currPage = <span class="hljs-number">0</span>; <br>    &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( currPage &gt;= totalPage )&#123; <br>        currPage = totalPage; <br>    &#125; <br>    <span class="hljs-title function_">jump</span>( currPage ); <span class="hljs-comment">// æŠŠ jump å‡½æ•°ç‹¬ç«‹å‡ºæ¥</span><br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="æ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼ä¸ºå‡½æ•°"><a href="#æ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼ä¸ºå‡½æ•°" class="headerlink" title="æ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼ä¸ºå‡½æ•°"></a>æ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼ä¸ºå‡½æ•°</h3><p>å¤æ‚çš„æ¡ä»¶åˆ†æ”¯æ˜¯å¯¼è‡´ç¨‹åºä»£ç éš¾ä»¥é˜…è¯»å’Œç†è§£çš„åŸå› ä¹‹ä¸€ï¼Œä¸”å®¹æ˜“å¯¼è‡´ä¸€ä¸ªåºå¤§çš„å‡½æ•°ã€‚ä¸¾ä¸€ä¸ªè®¡ç®—å•†å“ä»·æ ¼çš„ä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> getPrice = <span class="hljs-keyword">function</span>(<span class="hljs-params"> price </span>)&#123; <br>    <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(); <br>    <span class="hljs-keyword">if</span> ( date.<span class="hljs-title function_">getMonth</span>() &gt;= <span class="hljs-number">6</span> &amp;&amp; date.<span class="hljs-title function_">getMonth</span>() &lt;= <span class="hljs-number">9</span> )&#123; <span class="hljs-comment">// å¤å¤©</span><br>        <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.8</span>; <br>    &#125; <br>    <span class="hljs-keyword">return</span> price; <br>&#125;;<br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿå‡½æ•°ä¸­çš„æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œå®ƒçš„ç›®çš„åªæ˜¯ä¸ºäº†åˆ¤æ–­å½“å‰æ˜¯å¦å¤„äºå¤å¤©ï¼Œå¯ä»¥å°†å…¶æç‚¼æˆå•ç‹¬çš„å‡½æ•°ï¼Œæ—¢èƒ½æ›´å‡†ç¡®è¡¨è¾¾æ„æ€ï¼ŒåŒäº‹å‡½æ•°åæœ¬èº«åˆèƒ½èµ·åˆ°æ³¨é‡Šçš„ä½œç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> isSummer = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(); <br>    <span class="hljs-keyword">return</span> date.<span class="hljs-title function_">getMonth</span>() &gt;= <span class="hljs-number">6</span> &amp;&amp; date.<span class="hljs-title function_">getMonth</span>() &lt;= <span class="hljs-number">9</span>; <br>&#125;; <br><span class="hljs-keyword">var</span> getPrice = <span class="hljs-keyword">function</span>(<span class="hljs-params"> price </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( <span class="hljs-title function_">isSummer</span>() )&#123; <span class="hljs-comment">// å¤å¤©</span><br>        <span class="hljs-keyword">return</span> price * <span class="hljs-number">0.8</span>; <br>    &#125; <br>    <span class="hljs-keyword">return</span> price; <br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="åˆç†ä½¿ç”¨å¾ªç¯"><a href="#åˆç†ä½¿ç”¨å¾ªç¯" class="headerlink" title="åˆç†ä½¿ç”¨å¾ªç¯"></a>åˆç†ä½¿ç”¨å¾ªç¯</h3><p>åœ¨å‡½æ•°ä½“å†…ï¼Œå¦‚æœæœ‰äº›ä»£ç å®é™…ä¸Šè´Ÿè´£çš„æ˜¯ä¸€äº›é‡å¤æ€§çš„å·¥ä½œï¼Œé‚£ä¹ˆåˆç†åˆ©ç”¨å¾ªç¯ä¸ä»…å¯ä»¥å®ŒæˆåŒæ ·çš„åŠŸèƒ½ï¼Œè¿˜å¯ä»¥ä½¿ä»£ç é‡æ›´å°‘ã€‚</p><h3 id="æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯"><a href="#æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯" class="headerlink" title="æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯"></a>æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> del = <span class="hljs-keyword">function</span>(<span class="hljs-params"> obj </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( obj.<span class="hljs-property">isReadOnly</span> )&#123; <span class="hljs-comment">// åè½¬ if è¡¨è¾¾å¼</span><br>        <span class="hljs-keyword">return</span>; <br>    &#125; <br>    <span class="hljs-keyword">if</span> ( obj.<span class="hljs-property">isFolder</span> )&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">deleteFolder</span>( obj ); <br>    &#125; <br>    <span class="hljs-keyword">if</span> ( obj.<span class="hljs-property">isFile</span> )&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">deleteFile</span>( obj ); <br>    &#125; <br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨"><a href="#ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨" class="headerlink" title="ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨"></a>ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨</h3><p>å½“å‡½æ•°æ¥æ”¶å¤šä¸ªå‚æ•°ä¸”æ•°é‡è¿‡å¤šæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½æ‰€æœ‰å‚æ•°çš„æ„ä¹‰ï¼Œå¹¶è¦å°å¿ƒæ˜¯å¦æœ‰å‚æ•°æœªä¼ é€’æˆ–é¢ å€’äº†ä½ç½®ï¼Œæˆ–æˆ‘ä»¬æƒ³æ·»åŠ å‚æ•°æ—¶éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°†å‚æ•°æ”¾åœ¨å¯¹è±¡å†…ï¼Œè¿™æ ·æˆ‘ä»¬æ— éœ€å…³å¿ƒå‚æ•°æ•°é‡å’Œé¡ºåºï¼Œåªè¦ä¿è¯å‚æ•°å¯¹åº”çš„keyä¸å˜å³å¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> setUserInfo = <span class="hljs-keyword">function</span>(<span class="hljs-params"> obj </span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;id= &#x27;</span> + obj.<span class="hljs-property">id</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;name= &#x27;</span> + obj.<span class="hljs-property">name</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;address= &#x27;</span> + obj.<span class="hljs-property">address</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;sex= &#x27;</span> + obj.<span class="hljs-property">sex</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;mobile= &#x27;</span> + obj.<span class="hljs-property">mobile</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;qq= &#x27;</span> + obj.<span class="hljs-property">qq</span> ); <br>&#125;; <br><span class="hljs-title function_">setUserInfo</span>(&#123; <br>    <span class="hljs-attr">id</span>: <span class="hljs-number">1314</span>, <br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;sven&#x27;</span>, <br>    <span class="hljs-attr">address</span>: <span class="hljs-string">&#x27;shenzhen&#x27;</span>, <br>    <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;male&#x27;</span>, <br>    <span class="hljs-attr">mobile</span>: <span class="hljs-string">&#x27;137********&#x27;</span>, <br>    <span class="hljs-attr">qq</span>: <span class="hljs-number">377876679</span> <br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="å°½é‡å‡å°‘å‚æ•°æ•°é‡"><a href="#å°½é‡å‡å°‘å‚æ•°æ•°é‡" class="headerlink" title="å°½é‡å‡å°‘å‚æ•°æ•°é‡"></a>å°½é‡å‡å°‘å‚æ•°æ•°é‡</h3><p>ä¸€ä¸ªå‡½æ•°çš„å‚æ•°è¿‡å¤šæ˜¯è®©äººæœ›è€Œç”Ÿç•çš„ï¼Œæˆ‘ä»¬éœ€è¦ææ¸…æ¥šå‚æ•°çš„å«ä¹‰ï¼Œå°å¿ƒç¿¼ç¿¼çš„ä¼ é€’ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å–œæ¬¢ä¸éœ€è¦ä»»ä½•å‚æ•°å°±èƒ½ä½¿ç”¨çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘å‚æ•°çš„æ•°é‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> draw = <span class="hljs-keyword">function</span>(<span class="hljs-params"> width, height, square </span>)&#123;&#125;;<br><br><span class="hljs-comment">// å®é™…ä¸Šæ­£æ–¹å½¢çš„é¢ç§¯æ˜¯å¯ä»¥é€šè¿‡ width å’Œ height è®¡ç®—å‡ºæ¥çš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå‚æ•° squareä» draw å‡½æ•°ä¸­å»æ‰</span><br><br><span class="hljs-keyword">var</span> draw = <span class="hljs-keyword">function</span>(<span class="hljs-params"> width, height </span>)&#123; <br> <span class="hljs-keyword">var</span> square = width * height; <br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="å°‘ç”¨ä¸‰ç›®è¿ç®—ç¬¦"><a href="#å°‘ç”¨ä¸‰ç›®è¿ç®—ç¬¦" class="headerlink" title="å°‘ç”¨ä¸‰ç›®è¿ç®—ç¬¦"></a>å°‘ç”¨ä¸‰ç›®è¿ç®—ç¬¦</h3><p>ä¸‰ç›®è¿ç®—ç¬¦ä»…ä»…åœ¨ä»£ç é‡ä¸Šå¯ä»¥èƒœè¿‡if-elseï¼Œä½†å´æ˜¯ä»¥ç‰ºç‰²ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¸ºå‰æçš„ã€‚å¦‚æœæ¡ä»¶åˆ†æ”¯é€»è¾‘ç®€å•æ¸…æ™°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œä½†å¦‚æœé€»è¾‘å¤æ‚ï¼Œè¿˜æ˜¯if-elseæ›´æ˜“äºç»´æŠ¤å’Œé˜…è¯»ï¼Œæ¯”å¦‚ä¸‹è¾¹çš„ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> ( !aup || !bup ) &#123; <br>     <span class="hljs-keyword">return</span> a === doc ? -<span class="hljs-number">1</span> : <br>     b === doc ? <span class="hljs-number">1</span> : <br>     aup ? -<span class="hljs-number">1</span> : <br>     bup ? <span class="hljs-number">1</span> : <br>     sortInput ? <br>     ( indexOf.<span class="hljs-title function_">call</span>( sortInput, a ) - indexOf.<span class="hljs-title function_">call</span>( sortInput, b ) ) : <br>     <span class="hljs-number">0</span>; <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é“¾å¼è°ƒç”¨çš„å¥½å¤„ä¸åå¤„"><a href="#é“¾å¼è°ƒç”¨çš„å¥½å¤„ä¸åå¤„" class="headerlink" title="é“¾å¼è°ƒç”¨çš„å¥½å¤„ä¸åå¤„"></a>é“¾å¼è°ƒç”¨çš„å¥½å¤„ä¸åå¤„</h3><p>jQueryä¸­å¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨éå¸¸æ–¹ä¾¿çš„å®ç°éœ€æ±‚ï¼Œä¸”åœ¨é˜…è¯»ä¸Šä¸ä¼šæœ‰å¾ˆå¤šå›°éš¾ï¼Œåˆèƒ½å‰©ä¸‹å¾ˆå¤šçš„å­—ç¬¦ä»¥åŠä¸­é—´å˜é‡ï¼Œä½†å¦‚æœæœ‰ä¸€æ¡é“¾ä¸­æœ‰é”™è¯¯å‡ºç°ï¼Œæˆ‘ä»¬éœ€è¦å°†é“¾æ‹†å¼€å¹¶åŠ ä¸Šæ–­ç‚¹æ‰èƒ½å®šä½é”™è¯¯ã€‚</p><h3 id="ç”¨returné€€å‡ºå¤šé‡å¾ªç¯"><a href="#ç”¨returné€€å‡ºå¤šé‡å¾ªç¯" class="headerlink" title="ç”¨returné€€å‡ºå¤šé‡å¾ªç¯"></a>ç”¨returné€€å‡ºå¤šé‡å¾ªç¯</h3><p>å‡è®¾åœ¨å‡½æ•°ä½“å†…æœ‰ä¸€ä¸ªä¸¤é‡å¾ªç¯è¯­å¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å†…å±‚å¾ªç¯ä¸­åˆ¤æ–­ï¼Œå½“è¾¾åˆ°æŸä¸ªä¸´ç•Œæ¡ä»¶æ—¶é€€å‡ºå¤–å±‚çš„å¾ªç¯ã€‚æˆ‘ä»¬å¤§å¤šæ•°æ—¶å€™ä¼šå¼•å…¥ä¸€ä¸ªæ§åˆ¶æ ‡è®°å˜é‡ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> flag = <span class="hljs-literal">false</span>; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ )&#123; <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++ )&#123; <br>            <span class="hljs-keyword">if</span> ( i * j &gt;<span class="hljs-number">30</span> )&#123; <br>                flag = <span class="hljs-literal">true</span>; <br>                <span class="hljs-keyword">break</span>; <br>            &#125; <br>        &#125;    <br>        <span class="hljs-keyword">if</span> ( flag === <span class="hljs-literal">true</span> )&#123; <br>            <span class="hljs-keyword">break</span>; <br>        &#125; <br>    &#125; <br>&#125;; <br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç§åšæ³•æ˜¯è®¾ç½®å¾ªç¯æ ‡è®°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-attr">outerloop</span>: <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ )&#123; <br>        <span class="hljs-attr">innerloop</span>: <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++ )&#123; <br>            <span class="hljs-keyword">if</span> ( i * j &gt;<span class="hljs-number">30</span> )&#123; <br>                <span class="hljs-keyword">break</span> outerloop; <br>            &#125; <br>        &#125; <br>    &#125; <br>&#125;; <br></code></pre></td></tr></table></figure><p>è¿™ä¸¤ç§åšæ³•æ— ç–‘éƒ½è®©äººå¤´æ™•ç›®çœ©ï¼Œæ›´ç®€å•çš„åšæ³•æ˜¯åœ¨éœ€è¦ä¸­æ­¢å¾ªç¯çš„æ—¶å€™ç›´æ¥é€€å‡ºæ•´ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ )&#123; <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++ )&#123; <br>            <span class="hljs-keyword">if</span> ( i * j &gt;<span class="hljs-number">30</span> )&#123; <br>                <span class="hljs-keyword">return</span>; <br>            &#125; <br>        &#125; <br>    &#125; <br>&#125;; <br></code></pre></td></tr></table></figure><p>å½“ç„¶ç”¨ return ç›´æ¥é€€å‡ºæ–¹æ³•ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåœ¨å¾ªç¯ä¹‹åè¿˜æœ‰ä¸€äº›å°†è¢«æ‰§è¡Œçš„ä»£ç å‘¢ï¼Ÿ<br>å¦‚æœæˆ‘ä»¬æå‰é€€å‡ºäº†æ•´ä¸ªæ–¹æ³•ï¼Œè¿™äº›ä»£ç å°±å¾—ä¸åˆ°è¢«æ‰§è¡Œçš„æœºä¼šï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ )&#123; <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++ )&#123; <br>            <span class="hljs-keyword">if</span> ( i * j &gt;<span class="hljs-number">30</span> )&#123; <br>                <span class="hljs-keyword">return</span>; <br>            &#125; <br>        &#125; <br>    &#125; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( i ); <span class="hljs-comment">// è¿™å¥ä»£ç æ²¡æœ‰æœºä¼šè¢«æ‰§è¡Œ</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¾ªç¯åé¢çš„ä»£ç æ”¾åˆ° return åé¢ï¼Œå¦‚æœä»£ç æ¯”è¾ƒå¤šï¼Œå°±åº”è¯¥æŠŠå®ƒä»¬æç‚¼æˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> print = <span class="hljs-keyword">function</span>(<span class="hljs-params"> i </span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( i ); <br>&#125;; <br><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++ )&#123; <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">10</span>; j++ )&#123; <br>            <span class="hljs-keyword">if</span> ( i * j &gt;<span class="hljs-number">30</span> )&#123; <br>                <span class="hljs-keyword">return</span> <span class="hljs-title function_">print</span>( i ); <br>            &#125; <br>        &#125; <br>    &#125; <br>&#125;; <br><span class="hljs-title function_">func</span>();<br></code></pre></td></tr></table></figure><h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>EDGå¤ºå† flagå®ç°äº†1/4ï¼Œç¬¬ä¸€æœ¬ä¹¦ç»“æŸäº†ï¼Œè¿™æœ¬ä¹¦ä¸­çš„ä¾‹å­å’Œè®²è§£éƒ½åšçš„éå¸¸å¥½ï¼Œæ–‡ç« ä¸­å¹¶æ²¡æœ‰å°†å…¶å…¨éƒ¨æç°å‡ºæ¥ï¼Œå€¼å¾—å¤šè¯»å‡ éç»†ç»†å“å‘³ï¼Œæµ…æ˜¾æ˜“æ‡‚çš„è¯­è¨€é£æ ¼ä¸­å¤¹æ‚ç€æ·±å¥¥çš„ç¼–ç¨‹æ€æƒ³ï¼Œå€¼å¾—å…¥æ‰‹ä¸€æœ¬ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡æ¨¡å¼ï¼‰ï¼ˆä¸‹ï¼‰</title>
    <link href="/2021/11/19/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%89%EF%BC%88%E4%B8%8B%EF%BC%89/"/>
    <url>/2021/11/19/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%89%EF%BC%88%E4%B8%8B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="è®¾è®¡æ¨¡å¼ï¼ˆä¸‹ï¼‰"><a href="#è®¾è®¡æ¨¡å¼ï¼ˆä¸‹ï¼‰" class="headerlink" title="è®¾è®¡æ¨¡å¼ï¼ˆä¸‹ï¼‰"></a>è®¾è®¡æ¨¡å¼ï¼ˆä¸‹ï¼‰</h1><h2 id="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"><a href="#æ¨¡æ¿æ–¹æ³•æ¨¡å¼" class="headerlink" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼"></a>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p></blockquote><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼ŒæŠ½è±¡çˆ¶ç±»å’Œå…·ä½“çš„å®ç°å­ç±»ã€‚é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°å…¬å…±æ–¹æ³•å’Œå°è£…å­ç±»ä¸­æ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå­ç±»é€šè¿‡ç»§æ‰¿å®ƒï¼Œä¹Ÿç»§æ‰¿äº†ç®—æ³•ç»“æ„ï¼Œä¸”å­ç±»å¯é€‰æ‹©åˆ™é‡å†™çˆ¶ç±»æ–¹æ³•ã€‚</p><h3 id="æ³¡èŒ¶æ³¡å’–å•¡"><a href="#æ³¡èŒ¶æ³¡å’–å•¡" class="headerlink" title="æ³¡èŒ¶æ³¡å’–å•¡"></a>æ³¡èŒ¶æ³¡å’–å•¡</h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆå¯¹æ¯”ä¸€ä¸‹æ³¡èŒ¶å’Œæ³¡å’–å•¡çš„æ­¥éª¤</p><table><thead><tr><th>æ­¥éª¤</th><th>èŒ¶</th><th>å’–å•¡</th></tr></thead><tbody><tr><td>1</td><td>çƒ§æ°´</td><td>çƒ§æ°´</td></tr><tr><td>2</td><td>æ³¡èŒ¶å¶</td><td>å†²æ³¡å’–å•¡</td></tr><tr><td>3</td><td>å€’å…¥æ¯å­</td><td>å€’å…¥æ¯å­</td></tr><tr><td>4</td><td>åŠ æŸ æª¬</td><td>åŠ ç³–åŠ å¥¶</td></tr></tbody></table><p>å¯ä»¥çœ‹å‡ºå®ƒä»¬åªæœ‰åœ¨2å’Œ4ä¸Šæœ‰ç€å·®åˆ«ï¼Œè¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°æ­¥éª¤æŠ½è±¡æˆå››æ­¥ï¼šçƒ§æ°´ï¼Œå†²æ³¡ï¼Œå€’å…¥æ¯å­ï¼ŒåŠ è°ƒæ–™ã€‚æ¥ä¸‹æ¥ç”¨ä»£ç æè¿°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Beverage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;; <br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">boilWater</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;æŠŠæ°´ç…®æ²¸&#x27;</span> ); <br>&#125;; <br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;; <span class="hljs-comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;; <span class="hljs-comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;; <span class="hljs-comment">// ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">boilWater</span>(); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">brew</span>(); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pourInCup</span>(); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addCondiments</span>(); <br>&#125;;<br></code></pre></td></tr></table></figure><p>æŠ½è±¡ç±»é¥®æ–™å®šä¹‰å®Œæ¯•ï¼Œæ¥ä¸‹æ¥åˆ›å»ºå’–å•¡ç±»ï¼Œç»§æ‰¿é¥®æ–™ç±»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Coffee</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><br><span class="hljs-title class_">Coffee</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Beverage</span>()<br><br><span class="hljs-title class_">Coffee</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ²¸æ°´å†²æ³¡â˜•&#x27;</span>)<br>&#125;<br><br><span class="hljs-title class_">Coffee</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æŠŠâ˜•å€’è¿›æ¯å­&#x27;</span>)<br>&#125;<br><br><span class="hljs-title class_">Coffee</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;åŠ ç³–åŠ å¥¶&#x27;</span>)<br>&#125;<br><br><span class="hljs-keyword">var</span> myCoffee = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Coffee</span>()<br>myCoffee.<span class="hljs-title function_">init</span>()<br></code></pre></td></tr></table></figure><p>myCoffeeè°ƒç”¨initæ—¶ï¼Œç”±äºmyCoffeeå’ŒCoffeeåŸå‹ä¸Šéƒ½æ²¡æœ‰å¯¹åº”æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šé¡ºç€åŸå‹é“¾å§”æ‰˜ç»™çˆ¶ç±»Beverageä¸Šçš„initæ–¹æ³•ï¼Œè€ŒBeverage.prototype.initä¸­å·²ç»å®šä¹‰å¥½äº†åˆ¶ä½œé¥®æ–™çš„é¡ºåºã€‚</p><p>åŒç†ã€‚åˆ›å»ºèŒ¶ç±»</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Tea</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;; <br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Beverage</span>(); <br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶&#x27;</span> ); <br>&#125;; <br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;æŠŠèŒ¶å€’è¿›æ¯å­&#x27;</span> ); <br>&#125;; <br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;åŠ æŸ æª¬&#x27;</span> ); <br>&#125;; <br><span class="hljs-keyword">var</span> tea = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tea</span>(); <br>tea.<span class="hljs-title function_">init</span>();<br></code></pre></td></tr></table></figure><p>Beverage.prototype.initæ–¹æ³•å°±æ˜¯æ¨¡ç‰ˆæ–¹æ³•ï¼Œå› ä¸ºè¯¥æ–¹æ³•ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºå»æ‰§è¡Œé‚£äº›æ–¹æ³•ã€‚</p><h3 id="ä¼˜åŒ–çš„æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"><a href="#ä¼˜åŒ–çš„æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼" class="headerlink" title="ä¼˜åŒ–çš„æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼"></a>ä¼˜åŒ–çš„æ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼</h3><p>æˆ‘ä»¬åœ¨Beverage.prototype.initä¸­å·²ç»å®šä¹‰äº†å››ä¸ªæ–¹æ³•çš„æ‰§è¡Œï¼Œå¦‚æœå­ç±»å¿˜è®°å®ç°è¿™å››ä¸ªæ–¹æ³•ä¸­çš„ä¸€ä¸ªæˆ–æ›´å¤šï¼Œå­ç±»ä¼šé¡ºç€åŸå‹é“¾æ‰¾åˆ°Beverage.prototypeä¸­å¯¹åº”çš„æ–¹æ³•ï¼Œè€Œå®ƒæ˜¯ä¸€ä¸ªç©ºæ–¹æ³•ï¼Œæ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œæé†’ç¼–ç äººå‘˜ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™brewæ–¹æ³•&#x27;</span>)<br>&#125; <span class="hljs-comment">// ç©ºæ–¹æ³•ï¼Œå­ç±»é‡å†™</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™pourInCupæ–¹æ³•&#x27;</span>)<br>&#125;<br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™addCondimentsæ–¹æ³•&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é’©å­æ–¹æ³•"><a href="#é’©å­æ–¹æ³•" class="headerlink" title="é’©å­æ–¹æ³•"></a>é’©å­æ–¹æ³•</h3><p>ä»¥å†²å’–å•¡ä¸ºä¾‹ï¼Œæœ‰äº›äººä¸åŠ è°ƒæ–™ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»å®šä¹‰å¥½äº†åˆ¶ä½œçš„æ­¥éª¤ï¼Œå¦‚ä½•æ‰èƒ½ä¸å—è¿™ä¸ªçº¦æŸå‘¢ï¼Ÿé’©å­å‡½æ•°å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨çˆ¶ç±»ä¸­å®¹æ˜“å˜åŒ–çš„åœ°æ–¹æ”¾ç½®é’©å­ï¼Œä½¿ä¸ä½¿ç”¨ç”±å­ç±»å†³å®šï¼Œé’©å­å‡½æ•°å†³å®šäº†åè¾¹çš„æ‰§è¡Œæ­¥éª¤å³ç¨‹åºèµ°å‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Beverage</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">boilWater</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;boil water&#x27;</span>);<br>&#125;<br><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™brewæ–¹æ³•&#x27;</span>)<br>&#125; <span class="hljs-comment">// ç©ºæ–¹æ³•ï¼Œå­ç±»é‡å†™</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™pourInCupæ–¹æ³•&#x27;</span>)<br>&#125;<br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&#x27;å­ç±»å¿…é¡»é‡å†™addCondimentsæ–¹æ³•&#x27;</span>)<br>&#125;<br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">customerWantsCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    Beverage.prototype.initæ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œå…¶ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºæ‰§è¡Œå“ªäº›æ–¹æ³•ã€‚</span><br><span class="hljs-comment">*/</span><br><span class="hljs-title class_">Beverage</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">boilWater</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">brew</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pourInCup</span>()<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">customerWantsCondiments</span>()) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addCondiments</span>()<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CoffeeWithHook</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br><span class="hljs-title class_">CoffeeWithHook</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Beverage</span>()<br><br><span class="hljs-title class_">CoffeeWithHook</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ²¸æ°´å†²â˜•&#x27;</span>);<br>&#125;<br><span class="hljs-title class_">CoffeeWithHook</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;â˜•å€’è¿›æ¯å­&#x27;</span>);<br>&#125;<br><span class="hljs-title class_">CoffeeWithHook</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;åŠ ç³–å’Œç‰›å¥¶&#x27;</span>);<br>&#125;<br><span class="hljs-title class_">CoffeeWithHook</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">customerWantsCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// äº¤äº’æ“ä½œæ˜¯å¦éœ€è¦è°ƒæ–™</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><span class="hljs-keyword">var</span> coffee = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CoffeeWithHook</span>()<br>coffee.<span class="hljs-title function_">init</span>()<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Tea</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Beverage</span>()<br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">brew</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ²¸æ°´å†²èŒ¶å¶&#x27;</span>);<br>&#125;<br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">pourInCup</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;èŒ¶å€’è¿›æ¯å­&#x27;</span>);<br>&#125;<br><span class="hljs-title class_">Tea</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">addCondiments</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;åŠ ğŸ‹&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">var</span> tea = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tea</span>()<br>tea.<span class="hljs-title function_">init</span>()<br></code></pre></td></tr></table></figure><h2 id="äº«å…ƒæ¨¡å¼"><a href="#äº«å…ƒæ¨¡å¼" class="headerlink" title="äº«å…ƒæ¨¡å¼"></a>äº«å…ƒæ¨¡å¼</h2><blockquote><p>è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p></blockquote><p>äº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±æ€§åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€ï¼ˆçŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æŒ‡å±æ€§ï¼‰ã€‚äº«å…ƒæ¨¡å¼çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘å…±äº«å¯¹è±¡çš„æ•°é‡ã€‚</p><ul><li>å†…éƒ¨çŠ¶æ€å­˜å‚¨äºå¯¹è±¡å†…éƒ¨ã€‚</li><li>å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº«ã€‚ </li><li>å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜ã€‚</li><li>å¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº«ã€‚</li></ul><h3 id="äº«å…ƒæ¨¡å¼é€‚ç”¨æ€§"><a href="#äº«å…ƒæ¨¡å¼é€‚ç”¨æ€§" class="headerlink" title="äº«å…ƒæ¨¡å¼é€‚ç”¨æ€§"></a>äº«å…ƒæ¨¡å¼é€‚ç”¨æ€§</h3><p>äº«å…ƒæ¨¡å¼å¸¦æ¥çš„å¥½å¤„å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå¦‚ä½•ä½¿ç”¨ä»¥åŠä½•æ—¶ä½¿ç”¨ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä»¥ä¸‹æƒ…å†µå‘ç”Ÿæ—¶ä¾¿å¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼ã€‚</p><ul><li>ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨äº†å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ã€‚</li><li>ç”±äºä½¿ç”¨äº†å¤§é‡å¯¹è±¡ï¼Œé€ æˆå¾ˆå¤§çš„å†…å­˜å¼€é”€ã€‚</li><li>å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯ä»¥å˜ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚</li><li>å‰¥ç¦»å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¹‹åï¼Œå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¤§é‡å¯¹è±¡ã€‚</li></ul><h2 id="èŒè´£é“¾æ¨¡å¼"><a href="#èŒè´£é“¾æ¨¡å¼" class="headerlink" title="èŒè´£é“¾æ¨¡å¼"></a>èŒè´£é“¾æ¨¡å¼</h2><blockquote><p>å°†å¤šä¸ªå¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œæ²¿è¿™ä¸ªé“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒï¼ŒåŒæ—¶ä¼ é€’è¿‡ç¨‹ä¹Ÿè¢«ç»ˆæ­¢ã€‚</p></blockquote><h3 id="çº¿ä¸Šå”®å–æ‰‹æœº"><a href="#çº¿ä¸Šå”®å–æ‰‹æœº" class="headerlink" title="çº¿ä¸Šå”®å–æ‰‹æœº"></a>çº¿ä¸Šå”®å–æ‰‹æœº</h3><p>æƒ…å¢ƒï¼šå‡è®¾æˆ‘ä»¬è´Ÿè´£ä¸€ä¸ªå”®å–æ‰‹æœºçš„ç”µå•†ç½‘ç«™ï¼Œç»è¿‡åˆ†åˆ«äº¤çº³500å…ƒå®šé‡‘å’Œ200å…ƒå®šé‡‘çš„ä¸¤è½®é¢„å®šåï¼ˆè®¢å•å·²åœ¨æ­¤æ—¶ç”Ÿæˆï¼‰ï¼Œç°åœ¨å·²ç»åˆ°äº†æ­£å¼è´­ä¹°çš„é˜¶æ®µã€‚å…¬å¸é’ˆå¯¹æ”¯ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·æœ‰ä¸€å®šçš„ä¼˜æƒ æ”¿ç­–ã€‚åœ¨æ­£å¼è´­ä¹°åï¼Œå·²ç»æ”¯ä»˜è¿‡500å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ°100å…ƒçš„å•†åŸä¼˜æƒ åˆ¸ï¼Œ200 å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ°50å…ƒçš„ä¼˜æƒ åˆ¸ï¼Œè€Œä¹‹å‰æ²¡æœ‰æ”¯ä»˜å®šé‡‘çš„ç”¨æˆ·åªèƒ½è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¼˜æƒ åˆ¸ï¼Œä¸”åœ¨åº“å­˜æœ‰é™çš„æƒ…å†µä¸‹ä¸ä¸€å®šä¿è¯èƒ½ä¹°åˆ°ã€‚</p><p>æˆ‘ä»¬ä¼šæ”¶åˆ°å‡ ä¸ªå­—æ®µï¼š</p><ul><li>orderTypeï¼šè®¢å•ç±»å‹ï¼ˆå®šé‡‘å’Œæ™®é€šè´­ä¹°ï¼‰ï¼Œ1ä»£è¡¨500å®šé‡‘ï¼Œ2ä»£è¡¨200å®šé‡‘ï¼Œ3ä»£è¡¨æ™®é€šç”¨æˆ·</li><li>payï¼šæ˜¯å¦å·²æ”¯ä»˜å®šé‡‘ã€‚å€¼ä¸ºtrueæˆ–è€…false,è™½ç„¶ç”¨æˆ·å·²ç»ä¸‹è¿‡500å…ƒå®šé‡‘çš„è®¢å•ï¼Œä½†å¦‚æœä»–ä¸€ç›´æ²¡æœ‰æ”¯ä»˜å®šé‡‘ï¼Œç°åœ¨åªèƒ½é™çº§è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ã€‚</li><li>stockï¼šæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜é‡ï¼Œæ”¯ä»˜è¿‡å®šé‡‘çš„ä¸å—å½±å“ã€‚</li></ul><p>å¦‚æœæˆ‘ä»¬æ­£å¸¸å†™ä¸šåŠ¡ä»£ç ï¼Œå¾ˆæœ‰å¯èƒ½å†™æˆif-else if-elseçš„å½¢å¼ï¼Œè™½ç„¶å¾—åˆ°äº†ç»“æœä½†ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§å¾ˆå·®ï¼Œæ¥ä¸‹æ¥ç”¨èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç ã€‚</p><h3 id="èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç "><a href="#èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç " class="headerlink" title="èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç "></a>èŒè´£é“¾æ¨¡å¼é‡æ„ä»£ç </h3><p>é¦–å…ˆæŠŠè´­ä¹°çš„ä¸‰ç§æƒ…å†µå˜æˆä¸‰ä¸ªå‡½æ•°,æ¥æ”¶ä¸Šè¾¹æ”¶åˆ°çš„ä¸‰ä¸ªå­—æ®µï¼Œå¹¶çº¦å®šå¦‚æœèŠ‚ç‚¹ä¸èƒ½å¤„ç†è¯·æ±‚ï¼Œè¿”å›æŒ‡å®šå­—ç¬¦ä¸²<code>nextSuccessor</code>è¡¨ç¤ºéœ€è¦å‘åä¼ é€’ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> order500 = <span class="hljs-keyword">function</span>(<span class="hljs-params"> orderType, pay, stock </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( orderType === <span class="hljs-number">1</span> &amp;&amp; pay === <span class="hljs-literal">true</span> )&#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸&#x27;</span> ); <br>    &#125;<span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nextSuccessor&#x27;</span>; <span class="hljs-comment">// æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’</span><br>    &#125; <br>&#125;; <br><span class="hljs-keyword">var</span> order200 = <span class="hljs-keyword">function</span>(<span class="hljs-params"> orderType, pay, stock </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( orderType === <span class="hljs-number">2</span> &amp;&amp; pay === <span class="hljs-literal">true</span> )&#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸&#x27;</span> ); <br>    &#125;<span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nextSuccessor&#x27;</span>; <span class="hljs-comment">// æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’</span><br>    &#125; <br>&#125;; <br><span class="hljs-keyword">var</span> orderNormal = <span class="hljs-keyword">function</span>(<span class="hljs-params"> orderType, pay, stock </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( stock &gt; <span class="hljs-number">0</span> )&#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸&#x27;</span> ); <br>    &#125;<span class="hljs-keyword">else</span>&#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;æ‰‹æœºåº“å­˜ä¸è¶³&#x27;</span> ); <br>    &#125; <br>&#125;;<br></code></pre></td></tr></table></figure><p>ç„¶åå°†å‡½æ•°åŒ…è£…é‡‘èŒè´£é“¾èŠ‚ç‚¹ï¼Œå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œnew Chainçš„æ—¶å€™ä¼ é€’çš„å‚æ•°ä¸ºéœ€è¦åŒ…è£…çš„å‡½æ•°ï¼ŒåŒæ—¶æ‹¥æœ‰å®ä¾‹å±æ€§this.successorï¼Œè¡¨ç¤ºåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Chain.prototype.setNextSuccessor æŒ‡å®šåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br><span class="hljs-comment">// Chain.prototype.passRequest ä¼ é€’è¯·æ±‚ç»™æŸä¸ªèŠ‚ç‚¹</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Chain</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> fn </span>)&#123; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fn</span> = fn; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span> = <span class="hljs-literal">null</span>; <br>&#125;; <br><span class="hljs-title class_">Chain</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">setNextSuccessor</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> successor </span>)&#123; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span> = successor; <br>&#125;;<br><br><span class="hljs-title class_">Chain</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">passRequest</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> ret = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fn</span>.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> ); <br>    <span class="hljs-keyword">if</span> ( ret === <span class="hljs-string">&#x27;nextSuccessor&#x27;</span> )&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span>.<span class="hljs-property">passRequest</span>.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span>, <span class="hljs-variable language_">arguments</span> ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°†ä¸‰ä¸ªè®¢å•å‡½æ•°åŒ…è£…æˆä¸ºèŒè´£é“¾çš„èŠ‚ç‚¹ï¼Œå¹¶å®šä¹‰é¡ºåºï¼Œæœ€åæŠŠè¯·æ±‚ä¼ é€’ç»™ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> chainOrder500 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>( order500 ); <br><span class="hljs-keyword">var</span> chainOrder200 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>( order200 ); <br><span class="hljs-keyword">var</span> chainOrderNormal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>( orderNormal );<br><br>chainOrder500.<span class="hljs-title function_">setNextSuccessor</span>( chainOrder200 ); <br>chainOrder200.<span class="hljs-title function_">setNextSuccessor</span>( chainOrderNormal );<br><br>chainOrder500.<span class="hljs-title function_">passRequest</span>( <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 100 ä¼˜æƒ åˆ¸</span><br>chainOrder500.<span class="hljs-title function_">passRequest</span>( <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ° 50 ä¼˜æƒ åˆ¸</span><br>chainOrder500.<span class="hljs-title function_">passRequest</span>( <span class="hljs-number">3</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼šæ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸</span><br>chainOrder500.<span class="hljs-title function_">passRequest</span>( <span class="hljs-number">1</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">0</span> ); <span class="hljs-comment">// è¾“å‡ºï¼šæ‰‹æœºåº“å­˜ä¸è¶³</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç å®Œæˆä¸€ä¸ªçµæ´»çš„èŒè´£é“¾æ¨¡å¼çš„å®ç°ï¼Œå¦‚æœåˆæ¨å‡ºäº†300å…ƒå®šé‡‘çš„æ´»åŠ¨ï¼Œé‚£æˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹å³å¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> order300 = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br> <span class="hljs-comment">// å…·ä½“å®ç°ç•¥ </span><br>&#125;; <br>chainOrder300= <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>( order300 ); <br>chainOrder500.<span class="hljs-title function_">setNextSuccessor</span>( chainOrder300); <br>chainOrder300.<span class="hljs-title function_">setNextSuccessor</span>( chainOrder200);<br></code></pre></td></tr></table></figure><h3 id="å¼‚æ­¥çš„èŒè´£é“¾"><a href="#å¼‚æ­¥çš„èŒè´£é“¾" class="headerlink" title="å¼‚æ­¥çš„èŒè´£é“¾"></a>å¼‚æ­¥çš„èŒè´£é“¾</h3><p>åœ¨ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨èŠ‚ç‚¹ä¸­å‘èµ·AJAXè¯·æ±‚ï¼Œè¯·æ±‚è¿”å›çš„ç»“æœå†³å®šæ˜¯å¦ç»§ç»­åœ¨èŒè´£é“¾ä¸­passRequestã€‚è¿™æ—¶å€™éœ€è¦æˆ‘ä»¬æš´éœ²ä¸€ä¸ªæ‰‹åŠ¨ä¼ é€’è¯·æ±‚çš„æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Chain</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">next</span>= <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span>.<span class="hljs-property">passRequest</span>.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">successor</span>, <span class="hljs-variable language_">arguments</span> ); <br>&#125;;<br></code></pre></td></tr></table></figure><p>ä¸¾ä¸ª<del>æ —å­</del>ä¾‹å­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> fn1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-number">1</span> ); <br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;nextSuccessor&#x27;</span>; <br>&#125;); <br><span class="hljs-keyword">var</span> fn2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-number">2</span> ); <br>    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>; <br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        self.<span class="hljs-title function_">next</span>(); <br>    &#125;, <span class="hljs-number">1000</span> ); <br>&#125;); <br><span class="hljs-keyword">var</span> fn3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chain</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-number">3</span> ); <br>&#125;); <br>fn1.<span class="hljs-title function_">setNextSuccessor</span>( fn2 ).<span class="hljs-title function_">setNextSuccessor</span>( fn3 ); <br>fn1.<span class="hljs-title function_">passRequest</span>();<br></code></pre></td></tr></table></figure><h3 id="ç”¨AOPå®ç°èŒè´£é“¾"><a href="#ç”¨AOPå®ç°èŒè´£é“¾" class="headerlink" title="ç”¨AOPå®ç°èŒè´£é“¾"></a>ç”¨AOPå®ç°èŒè´£é“¾</h3><p>åœ¨ä¹‹å‰çš„èŒè´£é“¾å®ç°ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†ä¸€ä¸ªChainç±»æ¥æŠŠæ™®é€šå‡½æ•°åŒ…è£…æˆèŒè´£é“¾çš„èŠ‚ç‚¹ã€‚å…¶å®åˆ©ç”¨JavaScriptçš„å‡½æ•°å¼ç‰¹æ€§ï¼Œæœ‰ä¸€ç§æ›´åŠ æ–¹ä¾¿çš„æ–¹æ³•æ¥åˆ›å»ºèŒè´£é“¾ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ”¹å†™ä¸€ä¸‹<a href="https://juejin.cn/post/7031003499898880037#heading-16">é«˜é˜¶å‡½æ•°å®ç°AOP</a>ä¸­çš„Function.prototype.afterå‡½æ•°ï¼Œä½¿å¾—ç¬¬ä¸€ä¸ªå‡½æ•°è¿”å›â€™nextSuccessorâ€™æ—¶ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‡½æ•°ï¼Œæ— è®ºæ˜¯è¿”å›å­—ç¬¦ä¸²â€™nextSuccessorâ€™æˆ–è€…falseéƒ½åªæ˜¯ä¸€ä¸ªçº¦å®šï¼Œå½“ç„¶åœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è®©å‡½æ•°è¿”å›falseè¡¨ç¤ºä¼ é€’è¯·æ±‚ï¼Œé€‰æ‹©â€™nextSuccessorâ€™å­—ç¬¦ä¸²æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥æ›´èƒ½è¡¨è¾¾æˆ‘ä»¬çš„ç›®çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">after</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> fn </span>)&#123;<br>    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-keyword">var</span> ret = self.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> );<br>        <span class="hljs-keyword">if</span> ( ret === <span class="hljs-string">&#x27;nextSuccessor&#x27;</span> )&#123;<br>            <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> );<br>        &#125;<br>        <span class="hljs-keyword">return</span> ret;<br>    &#125;<br>&#125;;<br><span class="hljs-keyword">var</span> order = order500yuan.<span class="hljs-title function_">after</span>( order200yuan ).<span class="hljs-title function_">after</span>( orderNormal );<br><span class="hljs-title function_">order</span>( <span class="hljs-number">1</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š500å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°100ä¼˜æƒ åˆ¸</span><br><span class="hljs-title function_">order</span>( <span class="hljs-number">2</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š200å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°50ä¼˜æƒ åˆ¸</span><br><span class="hljs-title function_">order</span>( <span class="hljs-number">1</span>, <span class="hljs-literal">false</span>, <span class="hljs-number">500</span> ); <span class="hljs-comment">// è¾“å‡ºï¼šæ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸</span><br></code></pre></td></tr></table></figure><p>ç”¨AOPæ¥å®ç°èŒè´£é“¾æ—¢ç®€å•åˆå·§å¦™ï¼Œä½†è¿™ç§æŠŠå‡½æ•°å åœ¨ä¸€èµ·çš„æ–¹å¼ï¼ŒåŒæ—¶ä¹Ÿå åŠ äº†å‡½æ•°çš„ä½œç”¨åŸŸï¼Œå¦‚æœé“¾æ¡å¤ªé•¿çš„è¯ï¼Œä¹Ÿä¼šå¯¹æ€§èƒ½æœ‰è¾ƒå¤§çš„å½±å“ã€‚</p><h2 id="ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä¸­ä»‹è€…æ¨¡å¼"></a>ä¸­ä»‹è€…æ¨¡å¼</h2><blockquote><p>å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´å€ŸåŠ©ç¬¬ä¸‰æ–¹ä¸­ä»‹è€…è¿›è¡Œé€šä¿¡ã€‚</p></blockquote><h3 id="ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼"><a href="#ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼"></a>ä»€ä¹ˆæ˜¯ä¸­ä»‹è€…æ¨¡å¼</h3><p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸»è¦è§£å†³<strong>å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤§é‡çš„å…³è”å…³ç³»</strong>ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿçš„ç»“æ„å˜å¾—å¾ˆå¤æ‚ï¼ŒåŒæ—¶è‹¥ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è·Ÿè¸ªä¸ä¹‹ç›¸å…³è”çš„å¯¹è±¡ï¼ŒåŒæ—¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚åœ¨å¤šä¸ªç±»ç›¸äº’è€¦åˆå½¢æˆ<strong>ç½‘çŠ¶ç»“æ„</strong>æ—¶ï¼Œå¯ä½¿ç”¨è¯¥æ¨¡å¼å°†å…¶åˆ†ç¦»ä¸ºæ˜Ÿå‹ç»“æ„ã€‚å®ƒ<strong>é™ä½äº†ç±»çš„å¤æ‚åº¦</strong>ï¼Œä½†ä¸­ä»‹è€…ä¼šå˜å¾—å¤æ‚ä¸”éš¾ä»¥ç»´æŠ¤ã€‚</p><h3 id="æ³¡æ³¡å ‚æ¸¸æˆ"><a href="#æ³¡æ³¡å ‚æ¸¸æˆ" class="headerlink" title="æ³¡æ³¡å ‚æ¸¸æˆ"></a>æ³¡æ³¡å ‚æ¸¸æˆ</h3><p>åˆ©ç”¨ä¸­ä»‹è€…æ¨¡å¼å®ç°è¯¥æ¸¸æˆï¼Œç©å®¶ä¸ä¸­ä»‹è€…çš„å…³ç³»å¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f042f3bd72bb43c996a51e6eecbb0b80~tplv-k3u1fbpfcp-watermark.image" alt="image"></p><p>æˆ‘ä»¬å®šä¹‰Playeræ„é€ å‡½æ•°å’Œplayerå¯¹è±¡ï¼Œåœ¨playerä¸­ä¸æ‰§è¡Œå…·ä½“é€»è¾‘ï¼Œå°†æ“ä½œäº¤ç»™ä¸­ä»‹è€…å¯¹è±¡playerDirectorã€‚è€Œä¸­ä»‹è€…å¯¹è±¡playerDirectorçš„å®ç°ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šå°†playerDirectorå®ç°ä¸ºè®¢é˜…è€…ï¼Œplayerä¸ºå‘å¸ƒè€…ï¼ŒplayerçŠ¶æ€æ”¹å˜ä¼šæ¨é€æ¶ˆæ¯ç»™playerDirectorï¼ŒplayerDirectorå¤„ç†åå°†åé¦ˆå‘é€ç»™å…¶ä»–playerã€‚</li><li>åœ¨ playerDirector ä¸­å¼€æ”¾ä¸€äº›æ¥æ”¶æ¶ˆæ¯çš„æ¥å£ï¼Œå„playerå¯ä»¥ç›´æ¥è°ƒç”¨è¯¥æ¥å£æ¥ç»™playerDirectorå‘é€æ¶ˆæ¯ï¼Œplayeråªéœ€ä¼ é€’ä¸€ä¸ªå‚æ•°ç»™ playerDirectorï¼Œè¿™ä¸ªå‚æ•°çš„ç›®çš„æ˜¯ä½¿ playerDirector å¯ä»¥è¯†åˆ«å‘é€è€…ã€‚åŒæ ·ï¼ŒplayerDirector æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åä¼šå°†å¤„ç†ç»“<br>æœåé¦ˆç»™å…¶ä»– playerã€‚</li></ul><p>è¿™é‡Œé‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* </span><br><span class="hljs-comment">    playerDirectorå¼€æ”¾ä¸€ä¸ªå¯¹å¤–æš´éœ²çš„æ¥å£receiveMessageï¼Œè´Ÿè´£æ¥æ”¶playerå¯¹è±¡å‘é€çš„æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">    playerå‘é€æ¶ˆæ¯æ—¶å°†è‡ªèº«thisä¼ ç»™å…¶ï¼Œä»¥ä¾¿è¯†åˆ«æ¶ˆæ¯æ¥è‡ªäºå“ªä¸ªç©å®¶å¯¹è±¡ã€‚</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">var</span> playerDirector = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> players = &#123;&#125; <span class="hljs-comment">// ä¿å­˜æ‰€æœ‰ç©å®¶</span><br>    <span class="hljs-keyword">var</span> operations = &#123;&#125; <span class="hljs-comment">// ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ</span><br><br>    operations.<span class="hljs-property">addPlayer</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">player</span>) &#123;<br>        <span class="hljs-keyword">var</span> teamColor = player.<span class="hljs-property">teamColor</span><br>        players[teamColor] = players[teamColor] || []<br>        players[teamColor].<span class="hljs-title function_">push</span>(player)<br>    &#125;<br><br>    operations.<span class="hljs-property">removePlayer</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">player</span>) &#123;<br>        <span class="hljs-keyword">var</span> teamColor = player.<span class="hljs-property">teamColor</span><br>        <span class="hljs-keyword">var</span> teamPlayers = players[teamColor] || []<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = teamPlayers.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>            <span class="hljs-keyword">if</span> (teamPlayers[i] === player) &#123;<br>                teamPlayers.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>)<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    operations.<span class="hljs-property">changeTeam</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">player, newTeamColor</span>) &#123;<br>        operations.<span class="hljs-title function_">removePlayer</span>(player)<br>        player.<span class="hljs-property">teamColor</span> = newTeamColor<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(player);<br>        operations.<span class="hljs-title function_">addPlayer</span>(player)<br>    &#125;<br><br>    operations.<span class="hljs-property">playerDead</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">player</span>) &#123;<br>        <span class="hljs-keyword">var</span> teamColor = player.<span class="hljs-property">teamColor</span><br>        <span class="hljs-keyword">var</span> teamPlayers = players[teamColor]<br>        <span class="hljs-keyword">var</span> all_dead = <span class="hljs-literal">true</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, player; player = teamPlayers[i++];) &#123;<br>            <span class="hljs-keyword">if</span> (player.<span class="hljs-property">state</span> !== <span class="hljs-string">&#x27;dead&#x27;</span>) &#123;<br>                all_dead = <span class="hljs-literal">false</span><br>                <span class="hljs-keyword">break</span><br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (all_dead) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, player; player = teamPlayers[i++];) &#123;<br>                player.<span class="hljs-title function_">lose</span>()<br>            &#125;<br><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> color <span class="hljs-keyword">in</span> players) &#123;<br>                <span class="hljs-keyword">if</span> (color !== teamColor) &#123;<br>                    <span class="hljs-keyword">var</span> teamPlayers = players[color]<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, player; player = teamPlayers[i++];) &#123;<br>                        player.<span class="hljs-title function_">win</span>()<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">var</span> receiveMessage = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> message = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>)<br>        operations[message].<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> &#123;<br>        receiveMessage,<br>        players<br>    &#125;<br>&#125;)()<br></code></pre></td></tr></table></figure><h2 id="è£…é¥°è€…æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼</h2><blockquote><p>åœ¨ä¸æ”¹å˜åŸå¯¹è±¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¯¹å…¶æ·»åŠ å±æ€§æˆ–æ–¹æ³•æ¥è¿›è¡ŒåŒ…è£…æ‹“å±•ï¼Œä½¿å¾—åŸæœ‰å¯¹è±¡å¯ä»¥åŠ¨æ€å…·æœ‰æ›´å¤šåŠŸèƒ½ã€‚</p></blockquote><h3 id="è£…ä¿®æˆ¿å­"><a href="#è£…ä¿®æˆ¿å­" class="headerlink" title="è£…ä¿®æˆ¿å­"></a>è£…ä¿®æˆ¿å­</h3><p>æˆ‘ä»¬åœ¨æ¯›å¯æˆ¿å»ºå¥½åï¼Œéƒ½ä¼šå¯¹æˆ¿å­è¿›è¡Œè£…ä¿®å’Œæ·»ç½®å®¶å…·ï¼Œè®©æˆ¿å­é€æ¸ç¾è§‚èˆ’é€‚ï¼Œä½†è¿™äº›å¹¶æ²¡æœ‰å½±å“æˆ¿å­æœ¬èº«çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯è£…é¥°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">OriginHouse</span>(<span class="hljs-params"></span>) &#123; &#125;<br><br><span class="hljs-title class_">OriginHouse</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getDesc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ç©ºæˆ¿å­&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Furniture</span>(<span class="hljs-params">house</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">house</span> = house;<br>&#125;<br><span class="hljs-title class_">Furniture</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getDesc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">house</span>.<span class="hljs-title function_">getDesc</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;æ¬å…¥å®¶å…·&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Painting</span>(<span class="hljs-params">house</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">house</span> = house;<br>&#125;<br><br><span class="hljs-title class_">Painting</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getDesc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">house</span>.<span class="hljs-title function_">getDesc</span>();<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;åˆ·æˆ¿å­&quot;</span>)<br>&#125;<br><span class="hljs-keyword">let</span> house = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OriginHouse</span>()<br>house = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Furniture</span>(house)<br>house = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Painting</span>(house)<br><br><span class="hljs-comment">// house.getDesc()</span><br><br><span class="hljs-keyword">var</span> originHouse = &#123;<br>    <span class="hljs-title function_">getDesc</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;origin house&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">furniture</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;furniture&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">painting</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;painting&quot;</span>);<br>&#125;<br>originHouse.<span class="hljs-property">getDesc</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> getDesc = originHouse.<span class="hljs-property">getDesc</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title function_">getDesc</span>();<br>        <span class="hljs-title function_">furniture</span>();<br>        <span class="hljs-title function_">painting</span>();<br>    &#125;<br>&#125;()<br>originHouse.<span class="hljs-title function_">getDesc</span>();<br></code></pre></td></tr></table></figure><h3 id="è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼"><a href="#è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼" class="headerlink" title="è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼"></a>è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼</h3><p>ä»ç»“æ„ä¸Šçœ‹ä¸¤è€…éå¸¸åƒï¼Œéƒ½æ˜¯æè¿°äº†æ€ä¹ˆä¸ºå¯¹è±¡æä¾›ä¸€å®šç¨‹åº¦çš„é—´æ¥å¼•ç”¨ï¼Œéƒ½ä¿ç•™äº†å¯¹å¦ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨å¹¶å‘å…¶å‘é€è¯·æ±‚ã€‚</p><p>ä¸¤è€…æœ€å¤§çš„åŒºåˆ«åœ¨ä»–ä»¬çš„è®¾è®¡å’Œæ„å›¾ï¼Œä»£ç†æ¨¡å¼çš„ç›®çš„æ˜¯ï¼Œå½“ç›´æ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–å’Œéœ€è¦ä¸ç¬¦æ—¶ï¼Œä¸ºå…¶æä¾›ä¸€ä¸ªä»£æ›¿è€…ï¼Œæœ¬ä½“åªæä¾›å…³é”®åŠŸèƒ½ï¼Œä»£ç†è´Ÿè´£æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®æˆ–åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„å·¥ä½œã€‚è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯å¯¹è±¡åŠ¨æ€åŠ å…¥è¡Œä¸ºã€‚</p><p>ä»£ç†æ¨¡å¼æ›´å¼ºè°ƒä»£ç†ä¸å®ä½“ä¹‹é—´çš„å…³ç³»ï¼Œè¿™ç§å…³ç³»åœ¨ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®šï¼Œé€šå¸¸åªæœ‰ä¸€å±‚ä»£ç†-æœ¬ä½“çš„å¼•ç”¨ã€‚è£…é¥°è€…æ¨¡å¼åˆ™ç”¨äºä¸€å¼€å§‹æ— æ³•ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½ï¼Œåç»­é€æ­¥æ·»åŠ è£…é¥°ï¼Œå¯èƒ½ä¼šå½¢æˆä¸€æ¡è£…é¥°é“¾ã€‚</p><h2 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h2><blockquote><p>å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</p></blockquote><p>å°†çŠ¶æ€å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œå¹¶å°†è¯·æ±‚å§”æ‰˜ç»™å½“å‰çŠ¶æ€å¯¹è±¡ï¼Œå¯¹è±¡å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ä¼šæœ‰ä¸åŒçš„è¡Œä¸ºå˜åŒ–ã€‚</p><p>ä¸¾ä¸¤ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹</p><h3 id="ç”µç¯ç¨‹åº"><a href="#ç”µç¯ç¨‹åº" class="headerlink" title="ç”µç¯ç¨‹åº"></a>ç”µç¯ç¨‹åº</h3><p>é¦–å…ˆå®šä¹‰äº†Lightç±»ï¼ŒLightç±»åœ¨è¿™é‡Œä¹Ÿè¢«ç§°ä¸ºä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ã€‚éšååœ¨Lightçš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è¦åˆ›å»ºæ¯ä¸€ä¸ªçŠ¶æ€ç±»çš„å®ä¾‹å¯¹è±¡ï¼ŒContextå°†æŒæœ‰è¿™äº›çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿æŠŠè¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡ã€‚ç”¨æˆ·çš„è¯·æ±‚ï¼Œå³ç‚¹å‡»buttonçš„åŠ¨ä½œä¹Ÿæ˜¯å®ç°åœ¨Contextä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Light</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">offLightState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OffLightState</span>( <span class="hljs-variable language_">this</span> ); <span class="hljs-comment">// æŒæœ‰çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">weakLightState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeakLightState</span>( <span class="hljs-variable language_">this</span> ); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">strongLightState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StrongLightState</span>( <span class="hljs-variable language_">this</span> ); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">superStrongLightState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SuperStrongLightState</span>( <span class="hljs-variable language_">this</span> ); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">button</span> = <span class="hljs-literal">null</span>; <br>&#125;;<br><br><span class="hljs-title class_">Light</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> button = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;button&#x27;</span> ),<br>    self = <span class="hljs-variable language_">this</span>; <br> <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">button</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>( button ); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">button</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;å¼€å…³&#x27;</span>; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currState</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">offLightState</span>; <span class="hljs-comment">// è®¾ç½®é»˜è®¤åˆå§‹çŠ¶æ€</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">button</span>.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <span class="hljs-comment">// å®šä¹‰ç”¨æˆ·çš„è¯·æ±‚åŠ¨ä½œ</span><br>        self.<span class="hljs-property">currState</span>.<span class="hljs-title function_">buttonWasPressed</span>(); <br>    &#125; <br>&#125;;<br><br><span class="hljs-comment">// ç¼–å†™å„ç§çŠ¶æ€ç±»ï¼Œlightå¯¹è±¡è¢«ä¼ å…¥çŠ¶æ€ç±»çš„æ„é€ å‡½æ•°ï¼ŒçŠ¶æ€å¯¹è±¡ä¹Ÿéœ€è¦æŒæœ‰lightå¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿è°ƒç”¨lightä¸­çš„æ–¹æ³•æˆ–è€…ç›´æ¥æ“ä½œlightå¯¹è±¡ã€‚</span><br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">OffLightState</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> light </span>)&#123; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">light</span> = light; <br>&#125;; <br><span class="hljs-title class_">OffLightState</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">buttonWasPressed</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;å¼±å…‰&#x27;</span> ); <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">light</span>.<span class="hljs-title function_">setState</span>( <span class="hljs-variable language_">this</span>.<span class="hljs-property">light</span>.<span class="hljs-property">weakLightState</span> ); <br>&#125;;<br></code></pre></td></tr></table></figure><h3 id="è¶…çº§ç›ä¸½"><a href="#è¶…çº§ç›ä¸½" class="headerlink" title="è¶…çº§ç›ä¸½"></a>è¶…çº§ç›ä¸½</h3><p>è¶…çº§ç›ä¸½æ‹¥æœ‰å¤šä¸ªçŠ¶æ€æ¯”å¦‚ è·³è·ƒã€ç§»åŠ¨ã€è¹²ä¸‹ã€å°„å‡»ï¼Œå¦‚æœå¯¹å®ƒä»¬æ„ä¹‰åˆ¤æ–­ï¼Œéœ€è¦å¤šä¸ªif-elseç»“æ„æˆ–switchç»“æ„ï¼Œå•ä¸ªåŠ¨ä½œå°šä¸”å¯ä»¥å®ç°ï¼Œå¦‚æœé‡åˆ°äº†ç»„åˆåŠ¨ä½œï¼Œå®ç°ä¼šæ›´åŠ å¤æ‚ï¼Œä½¿ç”¨çŠ¶æ€æ¨¡å¼å¯ä»¥ç®€å•å®ç°ã€‚</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªçŠ¶æ€å¯¹è±¡æ•°ç»„ï¼Œå†…éƒ¨å¯¹çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œå°è£…å¥½æ¯ç§åŠ¨ä½œå¯¹åº”çš„çŠ¶æ€ï¼Œæš´éœ²ä¸€ä¸ªæ¥å£å¯¹è±¡ï¼Œå®ƒå¯ä»¥å¯¹å†…éƒ¨çŠ¶æ€ä¿®æ”¹æˆ–è°ƒç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SuperMarry</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_currentState</span> = []<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span> = &#123;<br>      <span class="hljs-title function_">jump</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;è·³è·ƒ!&#x27;</span>)&#125;,<br>      <span class="hljs-title function_">move</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ç§»åŠ¨!&#x27;</span>)&#125;,<br>      <span class="hljs-title function_">shoot</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å°„å‡»!&#x27;</span>)&#125;,<br>      <span class="hljs-title function_">squat</span>(<span class="hljs-params"></span>) &#123;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;è¹²ä¸‹!&#x27;</span>)&#125;<br>    &#125;<br>  &#125;<br>  <br>  <span class="hljs-title function_">change</span>(<span class="hljs-params">arr</span>) &#123;  <span class="hljs-comment">// æ›´æ”¹å½“å‰åŠ¨ä½œ</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_currentState</span> = arr<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><br>  &#125;<br>  <br>  <span class="hljs-title function_">go</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;è§¦å‘åŠ¨ä½œ&#x27;</span>)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_currentState</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>[T] &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>[T]())<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">SuperMarry</span>()<br>    .<span class="hljs-title function_">change</span>([<span class="hljs-string">&#x27;jump&#x27;</span>, <span class="hljs-string">&#x27;shoot&#x27;</span>])<br>    .<span class="hljs-title function_">go</span>()                    <span class="hljs-comment">// è§¦å‘åŠ¨ä½œ  è·³è·ƒ!  å°„å‡»!</span><br>    .<span class="hljs-title function_">go</span>()                    <span class="hljs-comment">// è§¦å‘åŠ¨ä½œ  è·³è·ƒ!  å°„å‡»!</span><br>    .<span class="hljs-title function_">change</span>([<span class="hljs-string">&#x27;squat&#x27;</span>])<br>    .<span class="hljs-title function_">go</span>()                    <span class="hljs-comment">// è§¦å‘åŠ¨ä½œ  è¹²ä¸‹!</span><br></code></pre></td></tr></table></figure><h3 id="çŠ¶æ€æ¨¡å¼ä¼˜ç¼ºç‚¹"><a href="#çŠ¶æ€æ¨¡å¼ä¼˜ç¼ºç‚¹" class="headerlink" title="çŠ¶æ€æ¨¡å¼ä¼˜ç¼ºç‚¹"></a>çŠ¶æ€æ¨¡å¼ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼š</p><ul><li>çŠ¶æ€æ¨¡å¼å®šä¹‰äº†çŠ¶æ€ä¸è¡Œä¸ºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶å°†å®ƒä»¬å°è£…åœ¨ä¸€ä¸ªç±»é‡Œã€‚é€šè¿‡å¢åŠ æ–°çš„çŠ¶æ€ç±»ï¼Œå¾ˆå®¹æ˜“å¢åŠ æ–°çš„çŠ¶æ€å’Œè½¬æ¢ã€‚</li><li>é¿å… Context æ— é™è†¨èƒ€ï¼ŒçŠ¶æ€åˆ‡æ¢çš„é€»è¾‘è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»ä¸­ï¼Œä¹Ÿå»æ‰äº† Context ä¸­åŸæœ¬è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯ã€‚</li><li>ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶ã€‚</li><li>Context ä¸­çš„è¯·æ±‚åŠ¨ä½œå’ŒçŠ¶æ€ç±»ä¸­å°è£…çš„è¡Œä¸ºå¯ä»¥éå¸¸å®¹æ˜“åœ°ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“ã€‚</li></ul><p>ç¼ºç‚¹ï¼šç³»ç»Ÿä¸­å®šä¹‰è®¸å¤šçŠ¶æ€ç±»ï¼Œç¼–å†™20ä¸ªçŠ¶æ€ç±»æ˜¯ä¸€é¡¹æ¯ç‡¥ä¹å‘³çš„å·¥ä½œï¼Œè€Œä¸”ç³»ç»Ÿä¸­ä¼šå› æ­¤è€Œå¢åŠ ä¸å°‘å¯¹è±¡ã€‚å¦å¤–ï¼Œç”±äºé€»è¾‘åˆ†æ•£åœ¨çŠ¶æ€ç±»ä¸­ï¼Œè™½ç„¶é¿å¼€äº†ä¸å—æ¬¢è¿çš„æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œä½†ä¹Ÿé€ æˆäº†é€»è¾‘åˆ†æ•£çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ä¸€ä¸ªåœ°æ–¹å°±çœ‹å‡ºæ•´ä¸ªçŠ¶æ€æœºçš„é€»è¾‘ã€‚</p><h3 id="ä¸ç­–ç•¥æ¨¡å¼çš„å…³ç³»"><a href="#ä¸ç­–ç•¥æ¨¡å¼çš„å…³ç³»" class="headerlink" title="ä¸ç­–ç•¥æ¨¡å¼çš„å…³ç³»"></a>ä¸ç­–ç•¥æ¨¡å¼çš„å…³ç³»</h3><p>ç­–ç•¥æ¨¡å¼å’ŒçŠ¶æ€æ¨¡å¼çš„ç›¸åŒç‚¹æ˜¯ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ã€ä¸€äº›ç­–ç•¥æˆ–è€…çŠ¶æ€ç±»ï¼Œä¸Šä¸‹æ–‡æŠŠè¯·æ±‚å§”æ‰˜ç»™è¿™äº›ç±»æ¥æ‰§è¡Œã€‚</p><p>å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ç­–ç•¥æ¨¡å¼ä¸­çš„å„ä¸ªç­–ç•¥ç±»ä¹‹é—´æ˜¯å¹³ç­‰åˆå¹³è¡Œçš„ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ï¼Œæ‰€ä»¥å®¢æˆ·å¿…é¡»ç†ŸçŸ¥è¿™äº›ç­–ç•¥ç±»çš„ä½œç”¨ï¼Œä»¥ä¾¿å®¢æˆ·å¯ä»¥éšæ—¶ä¸»åŠ¨åˆ‡æ¢ç®—æ³•ï¼›è€Œåœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼ŒçŠ¶æ€å’ŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºæ˜¯æ—©å·²è¢«å°è£…å¥½çš„ï¼ŒçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢ä¹Ÿæ—©è¢«è§„å®šå®Œæˆï¼Œâ€œæ”¹å˜è¡Œä¸ºâ€è¿™ä»¶äº‹æƒ…å‘ç”Ÿåœ¨çŠ¶æ€æ¨¡å¼å†…éƒ¨ã€‚å¯¹å®¢æˆ·æ¥è¯´ï¼Œå¹¶ä¸éœ€è¦äº†è§£è¿™äº›ç»†èŠ‚ã€‚è¿™æ­£æ˜¯çŠ¶æ€æ¨¡å¼çš„ä½œç”¨æ‰€åœ¨ã€‚</p><h2 id="é€‚é…å™¨æ¨¡å¼"><a href="#é€‚é…å™¨æ¨¡å¼" class="headerlink" title="é€‚é…å™¨æ¨¡å¼"></a>é€‚é…å™¨æ¨¡å¼</h2><blockquote><p>å°†ä¸€ä¸ªç±»ï¼ˆå¯¹è±¡ï¼‰çš„æ¥å£ï¼ˆæ–¹æ³•æˆ–å±æ€§ï¼‰è½¬åŒ–æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼ˆæ–¹æ³•æˆ–å±æ€§ï¼‰ï¼Œé€‚é…å™¨æ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»ï¼ˆå¯¹è±¡ï¼‰å¯ä»¥ä¸€äº›å·¥ä½œã€‚</p></blockquote><p>é€‚é…å™¨æ¨¡å¼æ˜¯ä¸€ç§â€œäº¡ç¾Šè¡¥ç‰¢â€æ¨¡å¼ï¼Œæ²¡æœ‰äººä¼šåœ¨ç¨‹åºè®¾è®¡ä¹‹åˆä½¿ç”¨ï¼Œå› ä¸ºæ— æ³•é¢„æ–™åˆ°æœªæ¥çš„æ”¹åŠ¨ï¼Œåœ¨æœªæ¥çš„æŸå¤©ä¹Ÿè®¸æˆ‘ä»¬éœ€è¦ç”¨é€‚é…å™¨æ¨¡å¼å°†æ—§æ¥å£åŒ…è£…æˆæ–°æ¥å£ï¼Œä¿è¯å…¶å¯ç”¨æ€§ã€‚</p><h3 id="æ•°æ®å¤„ç†"><a href="#æ•°æ®å¤„ç†" class="headerlink" title="æ•°æ®å¤„ç†"></a>æ•°æ®å¤„ç†</h3><p>å‰ç«¯åœ¨å¤„ç†æ•°æ®çš„æ—¶å€™å…¶å®å°±ä½¿ç”¨äº†é€‚é…å™¨æ¨¡å¼ã€‚æˆ‘ä»¬éœ€è¦å°†ç°æœ‰æ•°æ®æ„é€ æˆæˆ‘ä»¬éœ€è¦çš„æ ¼å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> arr = [<span class="hljs-string">&#x27;Javascript&#x27;</span>, <span class="hljs-string">&#x27;book&#x27;</span>, <span class="hljs-string">&#x27;è®¾è®¡æ¨¡å¼&#x27;</span>, <span class="hljs-string">&#x27;1æœˆ1æ—¥&#x27;</span>]<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">arr2objAdapter</span>(<span class="hljs-params">arr</span>) &#123;    <span class="hljs-comment">// è½¬åŒ–æˆæˆ‘ä»¬éœ€è¦çš„æ•°æ®ç»“æ„</span><br>  <span class="hljs-keyword">return</span> &#123;<br>    <span class="hljs-attr">name</span>: arr[<span class="hljs-number">0</span>],<br>    <span class="hljs-attr">type</span>: arr[<span class="hljs-number">1</span>],<br>    <span class="hljs-attr">title</span>: arr[<span class="hljs-number">2</span>],<br>    <span class="hljs-attr">time</span>: arr[<span class="hljs-number">3</span>]<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> adapterData = <span class="hljs-title function_">arr2objAdapter</span>(arr)<br></code></pre></td></tr></table></figure><h3 id="é€‚ç”¨èŒƒå›´"><a href="#é€‚ç”¨èŒƒå›´" class="headerlink" title="é€‚ç”¨èŒƒå›´"></a>é€‚ç”¨èŒƒå›´</h3><ul><li>ä½¿ç”¨ä¸€ä¸ªç°æœ‰å¯¹è±¡ï¼Œä½†å…¶å±æ€§æˆ–æ–¹æ³•ä¸ç¬¦åˆä½ çš„ä½¿ç”¨è¦æ±‚ã€‚</li><li>æƒ³åˆ›å»ºä¸€ä¸ªå¯å¤ç”¨çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥ä¸å…¶å®ƒä¸ç›¸å…³çš„å¯¹è±¡æˆ–ä¸å¯è§å¯¹è±¡ï¼ˆå³æ¥å£æ–¹æ³•æˆ–å±æ€§ä¸å…¼å®¹çš„å¯¹è±¡ï¼‰ååŒå·¥ä½œã€‚</li><li>æƒ³ä½¿ç”¨ç°æœ‰å¯¹è±¡ï¼Œä½†ä¸èƒ½å¯¹æ¯ä¸€ä¸ªéƒ½è¿›è¡ŒåŸå‹ç»§æ‰¿ï¼Œå¯¹è±¡é€‚é…å™¨å¯ä»¥é€‚é…å®ƒçš„çˆ¶ç±»æ¥å£æ–¹æ³•æˆ–å±æ€§ã€‚</li></ul><h3 id="ä¸å…¶ä»–æ¨¡å¼çš„åŒºåˆ«"><a href="#ä¸å…¶ä»–æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="ä¸å…¶ä»–æ¨¡å¼çš„åŒºåˆ«"></a>ä¸å…¶ä»–æ¨¡å¼çš„åŒºåˆ«</h3><ul><li>é€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨æ¥è§£å†³ä¸¤ä¸ªå·²æœ‰æ¥å£ä¹‹é—´ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå®ƒä¸è€ƒè™‘è¿™äº›æ¥å£æ˜¯æ€æ ·å®ç°çš„ï¼Œä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”åŒ–ã€‚é€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æ¥å£ï¼Œå°±èƒ½å¤Ÿä½¿å®ƒä»¬ååŒä½œç”¨ã€‚</li><li>è£…é¥°è€…æ¨¡å¼å’Œä»£ç†æ¨¡å¼ä¹Ÿä¸ä¼šæ”¹å˜åŸæœ‰å¯¹è±¡çš„æ¥å£ï¼Œä½†è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨æ˜¯ä¸ºäº†ç»™å¯¹è±¡å¢åŠ åŠŸèƒ½ã€‚è£…é¥°è€…æ¨¡å¼å¸¸å¸¸å½¢æˆä¸€æ¡é•¿çš„è£…é¥°é“¾ï¼Œè€Œé€‚é…å™¨æ¨¡å¼é€šå¸¸åªåŒ…è£…ä¸€æ¬¡ã€‚ä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†æ§åˆ¶å¯¹å¯¹è±¡çš„è®¿é—®ï¼Œé€šå¸¸ä¹ŸåªåŒ…è£…ä¸€æ¬¡ã€‚</li><li>å¤–è§‚æ¨¡å¼çš„ä½œç”¨å€’æ˜¯å’Œé€‚é…å™¨æ¯”è¾ƒç›¸ä¼¼ï¼Œæœ‰äººæŠŠå¤–è§‚æ¨¡å¼çœ‹æˆä¸€ç»„å¯¹è±¡çš„é€‚é…å™¨ï¼Œä½†å¤–è§‚æ¨¡å¼æœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ¥å£ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡æ¨¡å¼ï¼‰ï¼ˆä¸Šï¼‰</title>
    <link href="/2021/11/17/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%89%EF%BC%88%E4%B8%8A%EF%BC%89/"/>
    <url>/2021/11/17/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%89%EF%BC%88%E4%B8%8A%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="è®¾è®¡æ¨¡å¼ï¼ˆä¸Šï¼‰"><a href="#è®¾è®¡æ¨¡å¼ï¼ˆä¸Šï¼‰" class="headerlink" title="è®¾è®¡æ¨¡å¼ï¼ˆä¸Šï¼‰"></a>è®¾è®¡æ¨¡å¼ï¼ˆä¸Šï¼‰</h1><h2 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h2><blockquote><p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹</p></blockquote><h3 id="å®ç°å•ä¾‹æ¨¡å¼"><a href="#å®ç°å•ä¾‹æ¨¡å¼" class="headerlink" title="å®ç°å•ä¾‹æ¨¡å¼"></a>å®ç°å•ä¾‹æ¨¡å¼</h3><p>ä¸¾ä¸ªæœ€å¸¸ç”¨çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç™»å½•çš„æ—¶å€™ï¼Œé¡µé¢ä¸­ä¼šå‡ºç°ä¸€ä¸ªç™»å½•æµ®çª—ï¼Œè€Œå®ƒæ˜¯å”¯ä¸€çš„ï¼Œæ— è®ºç‚¹å¤šå°‘æ¬¡ç™»å½•æŒ‰é’®ï¼Œæµ®çª—åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œä¸ä¼šæ¯æ¬¡ç‚¹å‡»éƒ½åˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p><p>ç®€æ˜“çš„å•ä¾‹æ¨¡å¼å®ç°èµ·æ¥å¹¶ä¸å¤æ‚ï¼Œæ— éå°±æ˜¯ç”¨ä¸€ä¸ªå˜é‡æ¥è®°å½•å½“å‰æ˜¯å¦å·²ä¸ºè¯¥ç±»åˆ›å»ºè¿‡å¯¹è±¡ï¼Œæ˜¯åˆ™åœ¨ä¸‹æ¬¡è·å–è¯¥ç±»å®ä¾‹æ—¶ç›´æ¥è¿”å›ä¹‹å‰åˆ›å»ºçš„å¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Singleton</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> name </span>)&#123; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name; <br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span> = <span class="hljs-literal">null</span>; <br>&#125;; <br><span class="hljs-title class_">Singleton</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    alert ( <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> ); <br>&#125;; <br><span class="hljs-title class_">Singleton</span>.<span class="hljs-property">getInstance</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> name </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( !<span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span> )&#123; <br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>( name ); <br>    &#125; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">instance</span>; <br>&#125;; <br><span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Singleton</span>.<span class="hljs-title function_">getInstance</span>( <span class="hljs-string">&#x27;sven1&#x27;</span> ); <br><span class="hljs-keyword">var</span> b = <span class="hljs-title class_">Singleton</span>.<span class="hljs-title function_">getInstance</span>( <span class="hljs-string">&#x27;sven2&#x27;</span> ); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a === b ); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>ä»£ç å¾ˆç®€å•ï¼Œä½†æ˜¯è¿™æ ·çš„å†™æ³•æ„ä¹‰ä¸å¤§ï¼Œå› ä¸ºç±»æ˜¯â€œä¸é€æ˜â€çš„ï¼Œä½¿ç”¨è€…å¿…é¡»çŸ¥é“è¿™æ˜¯ä¸€ä¸ªå•ä¾‹ç±»ï¼Œä¸”éœ€è¦ä½¿ç”¨Singleton.getInstanceè·å–å¯¹è±¡ã€‚</p><h3 id="é€æ˜çš„å•ä¾‹æ¨¡å¼ï¼ˆä»£ç†ï¼‰"><a href="#é€æ˜çš„å•ä¾‹æ¨¡å¼ï¼ˆä»£ç†ï¼‰" class="headerlink" title="é€æ˜çš„å•ä¾‹æ¨¡å¼ï¼ˆä»£ç†ï¼‰"></a>é€æ˜çš„å•ä¾‹æ¨¡å¼ï¼ˆä»£ç†ï¼‰</h3><p>æˆ‘ä»¬éœ€è¦åšçš„æ˜¯èƒ½å¤Ÿå®ç°ä¸€ä¸ªé€æ˜çš„å•ä¾‹ç±»ï¼Œä½¿ç”¨æ–¹å¼åƒå…¶ä»–ä»»ä½•æ™®é€šç±»ä¸€æ ·ä¸”è¶³å¤Ÿçµæ´»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">CreateDiv</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> html </span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> = html<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>()<br>&#125;<br><span class="hljs-title class_">CreateDiv</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;div&#x27;</span>)<br>    div.<span class="hljs-property">innerHTML</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(div)<br>&#125;<br><br><span class="hljs-comment">// ä»£ç†ç±»</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">ProxySingletonCreateDiv</span> = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> instance<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">html</span>) &#123;<br>        <span class="hljs-keyword">if</span>(!instance) &#123;<br>            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateDiv</span>(html)<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance<br>    &#125;<br>&#125;)()<br><br><span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxySingletonCreateDiv</span>(<span class="hljs-string">&#x27;a&#x27;</span>)<br><span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxySingletonCreateDiv</span>(<span class="hljs-string">&#x27;b&#x27;</span>)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a === b)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬é€šè¿‡ä»£ç†ç±»<code>ProxySingletonCreateDiv</code>å®ç°äº†å¯¹CreateDivçš„å•ä¾‹åŒ–ï¼ˆä»£ç†æ¨¡å¼ï¼Œåœ¨åé¢ä»‹ç»ï¼‰ï¼Œä¸ä¹‹å‰ä¸åŒçš„æ˜¯ï¼Œ<code>CreateDiv</code>å˜æˆäº†æ™®é€šçš„ç±»ï¼Œå¦‚æœä¸šåŠ¡åœºæ™¯ä¸­éœ€è¦åˆ›å»ºå¤šä¸ªå®ä¾‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>CreateDiv</code>åˆ›å»ºã€‚äºŒè€…ç»„åˆè¾¾åˆ°äº†å•ä¾‹æ¨¡å¼çš„æ•ˆæœã€‚</p><h3 id="æƒ°æ€§å•ä¾‹"><a href="#æƒ°æ€§å•ä¾‹" class="headerlink" title="æƒ°æ€§å•ä¾‹"></a>æƒ°æ€§å•ä¾‹</h3><p>é¡¾åæ€ä¹‰ï¼Œæƒ°æ€§å•ä¾‹åªæœ‰åœ¨<em>éœ€è¦çš„æ—¶å€™</em>æ‰åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚å®ç°æ€è·¯å¦‚æœ€å¼€å§‹ï¼Œç”¨ä¸€ä¸ªå˜é‡æ¥æ ‡å¿—æ˜¯å¦åˆ›å»ºè¿‡å¯¹è±¡ï¼Œæ˜¯åˆ™è¿”å›åˆ›å»ºå¥½çš„å¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> getSingle = <span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) &#123;<br>    <span class="hljs-keyword">var</span> result <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> result || (result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,<span class="hljs-variable language_">arguments</span>))<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»“åˆäº†<a href="https://juejin.cn/post/7031003499898880037">åŸºç¡€ç¯‡</a>ä¸­çš„è®¸å¤šçŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä»»ä½•æ–¹æ³•ï¼Œä¹‹åè®©getSingleè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ç”¨resultä¿å­˜fnçš„è®¡ç®—ç»“æœï¼Œå› ä¸ºresultåœ¨é—­åŒ…ä¸­ï¼Œå®ƒæ°¸è¿œä¸ä¼šè¢«é”€æ¯ï¼Œä»¥åå†è¯·æ±‚æ—¶ï¼Œå¦‚æœresultå­˜åœ¨ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›è¿™ä¸ªå€¼ã€‚</p><h2 id="ç­–ç•¥æ¨¡å¼"><a href="#ç­–ç•¥æ¨¡å¼" class="headerlink" title="ç­–ç•¥æ¨¡å¼"></a>ç­–ç•¥æ¨¡å¼</h2><blockquote><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼çš„ç›®çš„å°±æ˜¯å°†ç®—æ³•çš„ä½¿ç”¨ä¸ç®—æ³•çš„å®ç°åˆ†ç¦»ã€‚</p></blockquote><h3 id="è®¡ç®—å¥–é‡‘"><a href="#è®¡ç®—å¥–é‡‘" class="headerlink" title="è®¡ç®—å¥–é‡‘"></a>è®¡ç®—å¥–é‡‘</h3><p>ä¹¦é‡Œä¸¾äº†ä¸€ä¸ªè®¡ç®—å¥–é‡‘çš„ä¾‹å­ã€‚</p><p>å¾ˆå¤šå…¬å¸çš„å¹´ç»ˆå¥–æ˜¯æ ¹æ®å‘˜å·¥çš„å·¥èµ„åŸºæ•°å’Œå¹´åº•ç»©æ•ˆæƒ…å†µæ¥å‘æ”¾çš„ã€‚ä¾‹å¦‚ï¼Œç»©æ•ˆä¸º S çš„äººå¹´ç»ˆå¥–æœ‰ 4 å€å·¥èµ„ï¼Œç»©æ•ˆä¸º Açš„äººå¹´ç»ˆå¥–æœ‰ 3 å€å·¥èµ„ï¼Œè€Œç»©æ•ˆä¸º B çš„äººå¹´ç»ˆå¥–æ˜¯ 2 å€å·¥èµ„ã€‚å‡è®¾è´¢åŠ¡éƒ¨è¦æ±‚æˆ‘ä»¬æä¾›ä¸€æ®µä»£ç ï¼Œæ¥æ–¹ä¾¿ä»–ä»¬è®¡ç®—å‘˜å·¥çš„å¹´ç»ˆå¥–ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç®—æ³•çš„ä½¿ç”¨æ–¹æ³•ä¸å˜ï¼Œç›®çš„éƒ½æ˜¯ä¸ºäº†å–å¾—è®¡ç®—åçš„å¥–é‡‘ï¼Œè€Œç®—æ³•çš„å®ç°ä¸ä¸€å®šç›¸åŒï¼Œæ¯ç§ç»©æ•ˆå¯¹åº”ä¸åŒè®¡ç®—è§„åˆ™ã€‚</p><p>åŸºäºç­–ç•¥æ¨¡å¼çš„ç¨‹åºç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ç­–ç•¥ç±»ï¼Œå…¶ä¸­å°è£…å…·ä½“ç®—æ³•ï¼Œå¹¶è´Ÿè´£å…·ä½“è®¡ç®—è¿‡ç¨‹ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯ç¯å¢ƒç±»ï¼Œè´Ÿè´£æ¥å—å®¢æˆ·è¯·æ±‚ï¼Œå¹¶æŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸ªç­–ç•¥ç±»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> strategies = &#123;<br>    <span class="hljs-string">&#x27;S&#x27;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) &#123;<br>        <span class="hljs-keyword">return</span> num * <span class="hljs-number">4</span><br>    &#125;,<br>    <span class="hljs-string">&#x27;A&#x27;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) &#123;<br>        <span class="hljs-keyword">return</span> num * <span class="hljs-number">3</span><br>    &#125;,<br>    <span class="hljs-string">&#x27;B&#x27;</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">num</span>) &#123;<br>        <span class="hljs-keyword">return</span> num * <span class="hljs-number">2</span><br>    &#125;,<br>&#125;<br><span class="hljs-comment">// </span><br><span class="hljs-keyword">var</span> calculate = <span class="hljs-keyword">function</span>(<span class="hljs-params">level , num</span>) &#123;<br>    <span class="hljs-keyword">return</span> strategies[level](num)<br>&#125; <br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">calculate</span>(<span class="hljs-string">&#x27;S&#x27;</span> , <span class="hljs-number">4</span>));<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">calculate</span>(<span class="hljs-string">&#x27;A&#x27;</span> , <span class="hljs-number">3</span>));<br></code></pre></td></tr></table></figure><h3 id="å¤šæ€åœ¨ç­–ç•¥æ¨¡å¼ä¸­çš„ä½“ç°"><a href="#å¤šæ€åœ¨ç­–ç•¥æ¨¡å¼ä¸­çš„ä½“ç°" class="headerlink" title="å¤šæ€åœ¨ç­–ç•¥æ¨¡å¼ä¸­çš„ä½“ç°"></a>å¤šæ€åœ¨ç­–ç•¥æ¨¡å¼ä¸­çš„ä½“ç°</h3><p>é€šè¿‡ä½¿ç”¨ç­–ç•¥æ¨¡å¼é‡æ„ä»£ç ï¼Œæˆ‘ä»¬æ¶ˆé™¤äº†åŸç¨‹åºä¸­å¤§ç‰‡çš„æ¡ä»¶åˆ†æ”¯è¯­å¥ã€‚æ‰€æœ‰è·Ÿè®¡ç®—å¥–é‡‘æœ‰å…³çš„é€»è¾‘ä¸å†æ”¾åœ¨Contextä¸­ï¼Œè€Œæ˜¯åˆ†å¸ƒåœ¨å„ä¸ªç­–ç•¥å¯¹è±¡ä¸­ã€‚Contextå¹¶æ²¡æœ‰è®¡ç®—å¥–é‡‘çš„èƒ½åŠ›ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªèŒè´£å§”æ‰˜ç»™äº†æŸä¸ªç­–ç•¥å¯¹è±¡ã€‚æ¯ä¸ªç­–ç•¥å¯¹è±¡è´Ÿè´£çš„ç®—æ³•å·²è¢«å„è‡ªå°è£…åœ¨å¯¹è±¡å†…éƒ¨ã€‚å½“æˆ‘ä»¬å¯¹è¿™äº›ç­–ç•¥å¯¹è±¡å‘å‡ºâ€œè®¡ç®—å¥–é‡‘â€çš„è¯·æ±‚æ—¶ï¼Œå®ƒä»¬ä¼šè¿”å›å„è‡ªä¸åŒçš„è®¡ç®—ç»“æœï¼Œè¿™æ­£æ˜¯å¯¹è±¡å¤šæ€æ€§çš„ä½“ç°ï¼Œä¹Ÿæ˜¯â€œå®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢â€çš„ç›®çš„ã€‚æ›¿æ¢ Context ä¸­å½“å‰ä¿å­˜çš„ç­–ç•¥å¯¹è±¡ï¼Œä¾¿èƒ½æ‰§è¡Œä¸åŒçš„ç®—æ³•æ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p><h3 id="ç­–ç•¥æ¨¡å¼ä¼˜ç¼ºç‚¹"><a href="#ç­–ç•¥æ¨¡å¼ä¼˜ç¼ºç‚¹" class="headerlink" title="ç­–ç•¥æ¨¡å¼ä¼˜ç¼ºç‚¹"></a>ç­–ç•¥æ¨¡å¼ä¼˜ç¼ºç‚¹</h3><ul><li><p>ä¼˜ç‚¹</p><ul><li>ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆã€å§”æ‰˜ã€å¤šæ€ç­‰æŠ€æœ¯åŠæ€æƒ³ï¼Œé¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ã€‚</li><li>ç­–ç•¥æ¨¡å¼å®Œç¾æ”¯æŒ<em>å¼€æ”¾-å°é—­åŸåˆ™</em>ï¼Œå°†ç®—æ³•å°è£…åœ¨strategyä¸­ï¼Œæ˜“äºåˆ‡æ¢ã€ç†è§£å’Œæ‰©å±•ã€‚</li><li>ç­–ç•¥æ¨¡å¼ä¸­çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨å…¶ä»–åœ°æ–¹ã€‚</li><li>ç­–ç•¥æ¨¡å¼ä¸­åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®© Context æ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆã€‚</li></ul></li><li><p>ç¼ºç‚¹</p><ul><li>åœ¨ç¨‹åºä¸­æ·»åŠ è®¸å¤šç­–ç•¥ç±»æˆ–ç­–ç•¥å¯¹è±¡</li><li>å¿…é¡»äº†è§£æ‰€æœ‰çš„ strategyï¼Œå¿…é¡»äº†è§£å„ä¸ª strategy ä¹‹é—´çš„ä¸åŒç‚¹ï¼Œè¿™æ ·æ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ strategyã€</li></ul></li></ul><h2 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h2><blockquote><p>ä»£ç†æ¨¡å¼ç»™æŸä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¹¶ç”±ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå¯¹è±¡çš„å¼•ç”¨ã€‚é€šä¿—çš„æ¥è®²ä»£ç†æ¨¡å¼å°±æ˜¯æˆ‘ä»¬ç”Ÿæ´»ä¸­å¸¸è§çš„ä¸­ä»‹ã€‚</p></blockquote><h3 id="é€èŠ±é—®é¢˜"><a href="#é€èŠ±é—®é¢˜" class="headerlink" title="é€èŠ±é—®é¢˜"></a>é€èŠ±é—®é¢˜</h3><p>åœ¨å››æœˆä¸€ä¸ªæ™´æœ—çš„æ—©æ™¨ï¼Œå°æ˜é‡è§äº†ä»–çš„ç™¾åˆ†ç™¾å¥³å­©ï¼Œæˆ‘ä»¬æš‚ä¸”ç§°å‘¼å°æ˜çš„å¥³ç¥ä¸ºAã€‚ä¸¤å¤©ä¹‹åï¼Œå°æ˜å†³å®šç»™Aé€ä¸€æŸèŠ±æ¥è¡¨ç™½ã€‚åˆšå¥½å°æ˜æ‰“å¬åˆ° A å’Œä»–æœ‰ä¸€ä¸ªå…±åŒçš„æœ‹å‹Bï¼Œäºæ˜¯å†…å‘çš„å°æ˜å†³å®šè®©Bæ¥ä»£æ›¿è‡ªå·±å®Œæˆé€èŠ±è¿™ä»¶äº‹æƒ…ã€‚å½“Aåœ¨å¿ƒæƒ…å¥½çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½æˆåŠŸçš„å‡ ç‡æœ‰60%ï¼Œè€Œå½“ A åœ¨å¿ƒæƒ…å·®çš„æ—¶å€™æ”¶åˆ°èŠ±ï¼Œå°æ˜è¡¨ç™½çš„æˆåŠŸç‡æ— é™è¶‹è¿‘äº0ã€‚</p><p>è¿™æ—¶å€™éœ€è¦ç”¨åˆ°ä»£ç†æ¨¡å¼ï¼Œå°æ˜æ— æ³•å¾—çŸ¥Açš„å¿ƒæƒ…ï¼Œè€ŒBå´äº†è§£ï¼ŒæŠŠèŠ±äº¤ç»™Bï¼ŒBä¼šç›‘å¬Açš„å¿ƒæƒ…å˜åŒ–ï¼Œé€‰æ‹©å¿ƒæƒ…å¥½çš„æ—¶å€™å†è½¬äº¤ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Flower</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;<br><br><span class="hljs-keyword">var</span> xiaoming = &#123;<br>    <span class="hljs-attr">sendFlower</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) &#123;<br>        <span class="hljs-keyword">var</span> flower = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flower</span>()<br>        target.<span class="hljs-title function_">receiveFlower</span>(flower)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> B = &#123;<br>    <span class="hljs-attr">receiveFlower</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">flower</span>) &#123;<br>        A.<span class="hljs-title function_">listenGoodMood</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            A.<span class="hljs-title function_">receiveFlower</span>(flower)<br>        &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> A = &#123;<br>    <span class="hljs-attr">receiveFlower</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">flower</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ”¶åˆ°èŠ±&#x27;</span>, flower)<br>    &#125;,<br>    <span class="hljs-attr">listenGoodMood</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"> fn </span>) &#123;<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-title function_">fn</span>()<br>        &#125;,<span class="hljs-number">1000</span>)<br>    &#125;<br>&#125;<br><br>xiaoming.<span class="hljs-title function_">sendFlower</span>(B)<br><br></code></pre></td></tr></table></figure><h3 id="ä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†"><a href="#ä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†" class="headerlink" title="ä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†"></a>ä¿æŠ¤ä»£ç†å’Œè™šæ‹Ÿä»£ç†</h3><p>ä¿æŠ¤ä»£ç†ï¼šä»£ç†Bå¯ä»¥å¸®åŠ©Aè¿‡æ»¤æ‰ä¸€äº›è¯·æ±‚ï¼Œä¸ç¬¦åˆè¦æ±‚çš„è¯·æ±‚åœ¨ä»£ç†Bå¤„è¢«æ‹’ç»æ‰,å¦‚ä¸Šæ–‡çš„ä¾‹å­ã€‚</p><p>è™šæ‹Ÿä»£ç†ï¼šæŠŠæ“ä½œäº¤ç»™ä»£ç†Bå»æ‰§è¡Œï¼Œä»£ç†Bå†³å®šä½•æ—¶å»æ‰§è¡Œæ“ä½œã€‚è™šæ‹Ÿæ“ä½œæŠŠä¸€äº›å¼€é”€å¾ˆå¤§çš„å¯¹è±¡å»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦çš„æ—¶å€™å†åˆ›å»ºã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> B = &#123;<br>    <span class="hljs-attr">receiveFlower</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">flower</span>) &#123;<br>        A.<span class="hljs-title function_">listenGoodMood</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">var</span> flower = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Flower</span>()<br>            A.<span class="hljs-title function_">receiveFlower</span>(flower)<br>        &#125;)<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="ç¼“å­˜ä»£ç†"><a href="#ç¼“å­˜ä»£ç†" class="headerlink" title="ç¼“å­˜ä»£ç†"></a>ç¼“å­˜ä»£ç†</h3><p>ç¼“å­˜ä»£ç†å¯ä»¥ä¸ºä¸€äº›å¼€é”€å¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„å­˜å‚¨ï¼Œåœ¨ä¸‹æ¬¡è¿ç®—æ—¶ï¼Œå¦‚æœä¼ é€’è¿›æ¥çš„å‚æ•°è·Ÿä¹‹å‰ä¸€è‡´ï¼Œåˆ™å¯ä»¥ç›´æ¥è¿”å›å‰é¢å­˜å‚¨çš„è¿ç®—ç»“æœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> mult = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;å¼€å§‹è®¡ç®—ä¹˜ç§¯&#x27;</span> ); <br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i &lt; l; i++ )&#123; <br>        a = a * <span class="hljs-variable language_">arguments</span>[i]; <br>    &#125; <br>    <span class="hljs-keyword">return</span> a; <br>&#125;; <br><span class="hljs-title function_">mult</span>( <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š6 </span><br><span class="hljs-title function_">mult</span>( <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š24 </span><br><span class="hljs-keyword">var</span> proxyMult = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> cache = &#123;&#125;; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        <span class="hljs-keyword">var</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">join</span>.<span class="hljs-title function_">call</span>( <span class="hljs-variable language_">arguments</span>, <span class="hljs-string">&#x27;,&#x27;</span> ); <br>        <span class="hljs-keyword">if</span> ( args <span class="hljs-keyword">in</span> cache )&#123; <br>            <span class="hljs-keyword">return</span> cache[ args ]; <br>        &#125; <br>        <span class="hljs-keyword">return</span> cache[ args ] = mult.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> ); <br>    &#125; <br>&#125;)(); <br><span class="hljs-title function_">proxyMult</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š24 </span><br><span class="hljs-title function_">proxyMult</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š24</span><br></code></pre></td></tr></table></figure><h3 id="é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†"><a href="#é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†" class="headerlink" title="é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†"></a>é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºä»£ç†</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**************** è®¡ç®—ä¹˜ç§¯ *****************/</span> <br><span class="hljs-keyword">var</span> mult = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i &lt; l; i++ )&#123; <br>        a = a * <span class="hljs-variable language_">arguments</span>[i]; <br>    &#125; <br>    <span class="hljs-keyword">return</span> a; <br>&#125;; <br><span class="hljs-comment">/**************** è®¡ç®—åŠ å’Œ *****************/</span> <br><span class="hljs-keyword">var</span> plus = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i &lt; l; i++ )&#123; <br>        a = a + <span class="hljs-variable language_">arguments</span>[i]; <br>    &#125; <br>    <span class="hljs-keyword">return</span> a; <br>&#125;; <br><span class="hljs-comment">/**************** åˆ›å»ºç¼“å­˜ä»£ç†çš„å·¥å‚ *****************/</span> <br><span class="hljs-keyword">var</span> createProxyFactory = <span class="hljs-keyword">function</span>(<span class="hljs-params"> fn </span>)&#123; <br>    <span class="hljs-keyword">var</span> cache = &#123;&#125;; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        <span class="hljs-keyword">var</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">join</span>.<span class="hljs-title function_">call</span>( <span class="hljs-variable language_">arguments</span>, <span class="hljs-string">&#x27;,&#x27;</span> ); <br>        <span class="hljs-keyword">if</span> ( args <span class="hljs-keyword">in</span> cache )&#123; <br>            <span class="hljs-keyword">return</span> cache[ args ]; <br>        &#125; <br>        <span class="hljs-keyword">return</span> cache[ args ] = fn.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> ); <br>    &#125; <br>&#125;; <br><span class="hljs-keyword">var</span> proxyMult = <span class="hljs-title function_">createProxyFactory</span>( mult ), <br>proxyPlus = <span class="hljs-title function_">createProxyFactory</span>( plus ); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">proxyMult</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ) ); <span class="hljs-comment">// è¾“å‡ºï¼š24 </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">proxyMult</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ) ); <span class="hljs-comment">// è¾“å‡ºï¼š24 </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">proxyPlus</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ) ); <span class="hljs-comment">// è¾“å‡ºï¼š10 </span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">proxyPlus</span>( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> ) ); <span class="hljs-comment">// è¾“å‡ºï¼š10</span><br></code></pre></td></tr></table></figure><h2 id="è¿­ä»£å™¨æ¨¡å¼"><a href="#è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼"></a>è¿­ä»£å™¨æ¨¡å¼</h2><blockquote><p>æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„å…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p></blockquote><p>è¿­ä»£å™¨æ¨¡å¼å¯ä»¥æŠŠè¿­ä»£çš„è¿‡ç¨‹ä»ä¸šåŠ¡é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œåœ¨ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼ä¹‹åï¼Œå³ä½¿ä¸å…³å¿ƒå¯¹è±¡çš„å†…éƒ¨æ„é€ ï¼Œä¹Ÿå¯ä»¥æŒ‰é¡ºåºè®¿é—®å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç»Ÿä¸€â€œé›†åˆâ€å‹æ•°æ®ç»“æ„çš„éå†æ¥å£ï¼Œå®ç°å¯å¾ªç¯éå†è·å–é›†åˆä¸­å„æ•°æ®é¡¹ï¼ˆä¸å…³å¿ƒæ•°æ®é¡¹çš„æ•°æ®ç»“æ„ï¼‰ã€‚</p><h3 id="å®ç°è‡ªå·±çš„è¿­ä»£å™¨"><a href="#å®ç°è‡ªå·±çš„è¿­ä»£å™¨" class="headerlink" title="å®ç°è‡ªå·±çš„è¿­ä»£å™¨"></a>å®ç°è‡ªå·±çš„è¿­ä»£å™¨</h3><p>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¢«å¾ªç¯æ•°ç»„ã€å¾ªç¯æ¯ä¸€æ­¥åè§¦å‘çš„å›è°ƒ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> each = <span class="hljs-keyword">function</span>(<span class="hljs-params">ary, callback</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>,l = ary.<span class="hljs-property">length</span>;i&lt; l;i++) &#123;<br>        callback.<span class="hljs-title function_">call</span>(ary[i] , i , ary[i])<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]<br><span class="hljs-title function_">each</span>(<span class="hljs-params">arr , <span class="hljs-keyword">function</span>(i , n)</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([i , n])<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨"><a href="#å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨" class="headerlink" title="å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨"></a>å†…éƒ¨è¿­ä»£å™¨å’Œå¤–éƒ¨è¿­ä»£å™¨</h3><ol><li>å†…éƒ¨è¿­ä»£å™¨</li></ol><p>æˆ‘ä»¬åˆšåˆšç¼–å†™çš„ each å‡½æ•°å±äºå†…éƒ¨è¿­ä»£å™¨ï¼Œeachå‡½æ•°çš„å†…éƒ¨å·²ç»å®šä¹‰å¥½äº†è¿­ä»£è§„åˆ™ï¼Œå®ƒå®Œå…¨æ¥æ‰‹æ•´ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå¤–éƒ¨åªéœ€è¦ä¸€æ¬¡åˆå§‹è°ƒç”¨ã€‚å†…éƒ¨è¿­ä»£å™¨åœ¨è°ƒç”¨çš„æ—¶å€™éå¸¸æ–¹ä¾¿ï¼Œå¤–ç•Œä¸ç”¨å…³å¿ƒè¿­ä»£å™¨å†…éƒ¨çš„å®ç°ï¼Œè·Ÿè¿­ä»£å™¨çš„äº¤äº’ä¹Ÿä»…ä»…æ˜¯ä¸€æ¬¡åˆå§‹è°ƒç”¨ï¼Œä½†è¿™ä¹Ÿåˆšå¥½æ˜¯å†…éƒ¨è¿­ä»£å™¨çš„ç¼ºç‚¹ã€‚ç”±äºå†…éƒ¨è¿­ä»£å™¨çš„è¿­ä»£è§„åˆ™å·²ç»è¢«æå‰è§„å®šï¼Œä¸Šé¢çš„eachå‡½æ•°å°±æ— æ³•åŒæ—¶è¿­ä»£2ä¸ªæ•°ç»„äº†ã€‚æ¯”å¦‚ç°åœ¨æœ‰ä¸ªéœ€æ±‚ï¼Œè¦åˆ¤æ–­ 2 ä¸ªæ•°ç»„é‡Œå…ƒç´ çš„å€¼æ˜¯å¦å®Œå…¨ç›¸ç­‰ï¼Œ å¦‚æœä¸æ”¹å†™eachå‡½æ•°æœ¬èº«çš„ä»£ç ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå…¥æ‰‹çš„åœ°æ–¹ä¼¼ä¹åªå‰©ä¸‹eachçš„å›è°ƒå‡½æ•°äº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> compare = <span class="hljs-keyword">function</span>(<span class="hljs-params"> ary1, ary2 </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( ary1.<span class="hljs-property">length</span> !== ary2.<span class="hljs-property">length</span> )&#123; <br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span> ( <span class="hljs-string">&#x27;ary1 å’Œ ary2 ä¸ç›¸ç­‰&#x27;</span> ); <br>    &#125; <br>    <span class="hljs-title function_">each</span>( ary1, <span class="hljs-keyword">function</span>(<span class="hljs-params"> i, n </span>)&#123; <br>        <span class="hljs-keyword">if</span> ( n !== ary2[ i ] )&#123; <br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span> ( <span class="hljs-string">&#x27;ary1 å’Œ ary2 ä¸ç›¸ç­‰&#x27;</span> ); <br>        &#125; <br>    &#125;); <br>    alert ( <span class="hljs-string">&#x27;ary1 å’Œ ary2 ç›¸ç­‰&#x27;</span> ); <br>&#125;; <br><span class="hljs-title function_">compare</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ], [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span> ] ); <span class="hljs-comment">// throw new Error ( &#x27;ary1 å’Œ ary2 ä¸ç›¸ç­‰&#x27; );</span><br></code></pre></td></tr></table></figure><ol start="2"><li>å¤–éƒ¨è¿­ä»£å™¨</li></ol><p>å¤–éƒ¨è¿­ä»£å™¨å¿…é¡»æ˜¾å¼åœ°è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚<br>å¤–éƒ¨è¿­ä»£å™¨å¢åŠ äº†ä¸€äº›è°ƒç”¨çš„å¤æ‚åº¦ï¼Œä½†ç›¸å¯¹ä¹Ÿå¢å¼ºäº†è¿­ä»£å™¨çš„çµæ´»æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹å·¥æ§åˆ¶è¿­ä»£çš„è¿‡ç¨‹æˆ–è€…é¡ºåºã€‚å¤–éƒ¨è¿­ä»£å™¨è™½ç„¶è°ƒç”¨æ–¹å¼å¤æ‚ï¼Œä½†é€‚ç”¨é¢æ›´å¹¿ï¼Œæ›´èƒ½æ»¡è¶³å¤šå˜çš„éœ€æ±‚ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">Iterator</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> obj </span>)&#123; <br>    <span class="hljs-keyword">var</span> current = <span class="hljs-number">0</span>; <br>    <span class="hljs-keyword">var</span> next = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        current += <span class="hljs-number">1</span>; <br>    &#125;; <br>    <span class="hljs-keyword">var</span> isDone = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        <span class="hljs-keyword">return</span> current &gt;= obj.<span class="hljs-property">length</span>; <br>    &#125;; <br>    <span class="hljs-keyword">var</span> getCurrItem = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        <span class="hljs-keyword">return</span> obj[ current ]; <br>    &#125;; <br>    <span class="hljs-keyword">return</span> &#123; <br>        <span class="hljs-attr">next</span>: next, <br>        <span class="hljs-attr">isDone</span>: isDone, <br>        <span class="hljs-attr">getCurrItem</span>: getCurrItem <br>    &#125; <br>&#125;;<br><br><span class="hljs-comment">// æ”¹å†™compareå‡½æ•°</span><br><br><span class="hljs-keyword">var</span> compare = <span class="hljs-keyword">function</span>(<span class="hljs-params"> iterator1, iterator2 </span>)&#123; <br>    <span class="hljs-keyword">while</span>( !iterator1.<span class="hljs-title function_">isDone</span>() &amp;&amp; !iterator2.<span class="hljs-title function_">isDone</span>() )&#123; <br>        <span class="hljs-keyword">if</span> ( iterator1.<span class="hljs-title function_">getCurrItem</span>() !== iterator2.<span class="hljs-title function_">getCurrItem</span>() )&#123; <br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span> ( <span class="hljs-string">&#x27;iterator1 å’Œ iterator2 ä¸ç›¸ç­‰&#x27;</span> ); <br>        &#125; <br>        iterator1.<span class="hljs-title function_">next</span>(); <br>        iterator2.<span class="hljs-title function_">next</span>(); <br>    &#125; <br>    alert ( <span class="hljs-string">&#x27;iterator1 å’Œ iterator2 ç›¸ç­‰&#x27;</span> ); <br>&#125;<br><br><span class="hljs-keyword">var</span> iterator1 = <span class="hljs-title class_">Iterator</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ] ); <br><span class="hljs-keyword">var</span> iterator2 = <span class="hljs-title class_">Iterator</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ] ); <br><span class="hljs-title function_">compare</span>( iterator1, iterator2 ); <span class="hljs-comment">// è¾“å‡ºï¼šiterator1 å’Œ iterator2 ç›¸ç­‰</span><br></code></pre></td></tr></table></figure><h3 id="è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡"><a href="#è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡" class="headerlink" title="è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡"></a>è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡</h3><p>è¿­ä»£å™¨æ¨¡å¼ä¸ä»…å¯ä»¥è¿­ä»£æ•°ç»„ï¼Œè¿˜å¯ä»¥è¿­ä»£ä¸€äº›ç±»æ•°ç»„çš„å¯¹è±¡ã€‚æ¯”å¦‚argumentsã€{â€œ0â€:â€™aâ€™,â€1â€:â€™bâ€™}ç­‰ã€‚é€šè¿‡ä¸Šé¢çš„ä»£ç å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæ— è®ºæ˜¯å†…éƒ¨è¿­ä»£å™¨è¿˜æ˜¯å¤–éƒ¨è¿­ä»£å™¨ï¼Œåªè¦è¢«è¿­ä»£çš„èšåˆå¯¹è±¡æ‹¥æœ‰ length å±æ€§è€Œä¸”å¯ä»¥ç”¨ä¸‹æ ‡è®¿é—®ï¼Œé‚£å®ƒå°±å¯ä»¥è¢«è¿­ä»£ã€‚åœ¨ JavaScript ä¸­ï¼Œfor in è¯­å¥å¯ä»¥ç”¨æ¥è¿­ä»£æ™®é€šå­—é¢é‡å¯¹è±¡çš„å±æ€§ã€‚</p><h3 id="å€’åºè¿­ä»£å™¨"><a href="#å€’åºè¿­ä»£å™¨" class="headerlink" title="å€’åºè¿­ä»£å™¨"></a>å€’åºè¿­ä»£å™¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> reverseEach = <span class="hljs-keyword">function</span>(<span class="hljs-params">ary , callback</span>) &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> l = ary.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;l &gt;= <span class="hljs-number">0</span>; l--) &#123;<br>        <span class="hljs-title function_">callback</span>(l,ary[l])<br>    &#125;<br>&#125;<br><br><span class="hljs-title function_">reverseEach</span>([<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>] , <span class="hljs-keyword">function</span>(<span class="hljs-params">i, n</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n)  <br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="ä¸­æ­¢è¿­ä»£å™¨"><a href="#ä¸­æ­¢è¿­ä»£å™¨" class="headerlink" title="ä¸­æ­¢è¿­ä»£å™¨"></a>ä¸­æ­¢è¿­ä»£å™¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> each = <span class="hljs-keyword">function</span>(<span class="hljs-params"> ary, callback </span>)&#123; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = ary.<span class="hljs-property">length</span>; i &lt; l; i++ )&#123; <br>        <span class="hljs-keyword">if</span> ( <span class="hljs-title function_">callback</span>( i, ary[ i ] ) === <span class="hljs-literal">false</span> )&#123; <span class="hljs-comment">// callback çš„æ‰§è¡Œç»“æœè¿”å› falseï¼Œæå‰ç»ˆæ­¢è¿­ä»£</span><br>            <span class="hljs-keyword">break</span>; <br>        &#125; <br>    &#125; <br>&#125;; <br><span class="hljs-title function_">each</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span> ], <span class="hljs-keyword">function</span>(<span class="hljs-params"> i, n </span>)&#123; <br>    <span class="hljs-keyword">if</span> ( n &gt; <span class="hljs-number">3</span> )&#123; <span class="hljs-comment">// n å¤§äº 3 çš„æ—¶å€™ç»ˆæ­¢å¾ªç¯</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <br>    &#125; <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( n ); <span class="hljs-comment">// åˆ†åˆ«è¾“å‡ºï¼š1, 2, 3 </span><br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</h2><blockquote><p>å®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-comment">/* é€šç”¨å‘å¸ƒè®¢é˜… */</span><br><span class="hljs-comment">// æ—¶é—´ä¸Šè§£è€¦ã€å¯¹è±¡ä¹‹é—´è§£è€¦ï¼Œå¯¹åº”çš„ä¼šæ¶ˆè€—æ—¶é—´å’Œå†…å­˜</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Event</span> = (<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> clientList = &#123;&#125;,<br>        listen, trigger, remove<br>    listen = <span class="hljs-keyword">function</span> (<span class="hljs-params">key, fn</span>) &#123;<br>        <span class="hljs-keyword">if</span> (!clientList[key]) &#123;<br>            clientList[key] = []<br>        &#125;<br>        clientList[key].<span class="hljs-title function_">push</span>(fn)<br>    &#125;<br>    trigger = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> key = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>)<br>        <span class="hljs-keyword">var</span> fns = clientList[key]<br>        <span class="hljs-keyword">if</span> (!fns || fns.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, fn; fn = fns[i++];) &#123;<br>            fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span>)<br>        &#125;<br>    &#125;<br>    remove = <span class="hljs-keyword">function</span> (<span class="hljs-params">key, fn</span>) &#123;<br>        <span class="hljs-keyword">var</span> fns = clientList[key]<br>        <span class="hljs-keyword">if</span> (!fns) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (!fn) &#123;<br>            fns &amp;&amp; (fns.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = fns.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>                <span class="hljs-keyword">var</span> _fn = fns[i]<br>                <span class="hljs-keyword">if</span> (_fn === fn) &#123;<br>                    fns.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>)<br>                &#125;<br>            &#125;<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        listen, trigger, remove<br>    &#125;<br>&#125;)()<br><br><span class="hljs-title class_">Event</span>.<span class="hljs-title function_">listen</span>(<span class="hljs-string">&#x27;square88&#x27;</span> , <span class="hljs-keyword">function</span>(<span class="hljs-params">price</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;price:&#x27;</span> , price);<br>&#125;)<br><br><span class="hljs-title class_">Event</span>.<span class="hljs-title function_">trigger</span>(<span class="hljs-string">&#x27;square88&#x27;</span> , <span class="hljs-number">2000000</span>)<br></code></pre></td></tr></table></figure><h3 id="å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åº”ç”¨"><a href="#å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åº”ç”¨" class="headerlink" title="å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åº”ç”¨"></a>å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„åº”ç”¨</h3><p>ä¹¦ä¸­è®²çš„åœ¨è¿™å°±ä¸å¤šè¯´äº†ï¼Œè¯´ç‚¹ä¹¦é‡Œæ²¡æœ‰çš„ã€‚</p><p>æƒ³è¦å¯¹å‘å¸ƒ-è®¢é˜…æ¨¡å¼æœ‰æ›´åŠ æ·±å…¥çš„å­¦ä¹ ï¼Œæ¨èè‡ªå·±åŠ¨æ‰‹å®ç°ä¸€ä¸ªvueï¼Œvue2çš„å“åº”å¼å°±æ˜¯é€šè¿‡è¯¥æ¨¡å¼å®ç°çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªç‰¹æ€§æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚</p><h4 id="vueå“åº”å¼åŸç†"><a href="#vueå“åº”å¼åŸç†" class="headerlink" title="vueå“åº”å¼åŸç†"></a>vueå“åº”å¼åŸç†</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> v = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;<br>            <span class="hljs-attr">a</span>:<span class="hljs-string">&#x27;a&#x27;</span><br>        &#125;<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b327fc81be69401faddd887b6caef99c~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p><p>å®˜ç½‘æœ‰ä¸€å¼ å…³äºå“åº”å¼çš„å›¾ï¼Œæˆ‘ä»¬æ¥ç»“åˆå›¾ç‰‡åˆ†æä¸€ä¸‹ã€‚</p><h5 id="æ•°æ®åŠ«æŒ"><a href="#æ•°æ®åŠ«æŒ" class="headerlink" title="æ•°æ®åŠ«æŒ"></a>æ•°æ®åŠ«æŒ</h5><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ•°æ®åŠ«æŒçš„æ ¸å¿ƒæ˜¯<code>Object.defineProperty</code>å°†å±æ€§è½¬åŒ–æˆå¯¹åº”çš„<code>getter\setter</code>ï¼ˆvueä¸æ”¯æŒie8ä»¥ä¸‹çš„åŸå› ï¼‰ã€‚åœ¨æ•°æ®ä¼ é€’å˜æ›´çš„æ—¶å€™ï¼Œä¼šè¿›å…¥Depå’ŒWatcherä¸­å¤„ç†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">walk</span>(<span class="hljs-params">obj</span>) &#123;<br>    <span class="hljs-keyword">const</span> keys = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keys.<span class="hljs-property">length</span>; ++i) &#123;<br>        <span class="hljs-title function_">defineReactive</span>(obj, keys[i], obj[keys[i]])<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åŠ«æŒç›¸å…³å‡½æ•°åŠè®¢é˜…å‘å¸ƒ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Define a reactive property on an Object.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params"></span><br><span class="hljs-params">  obj: <span class="hljs-built_in">Object</span>,</span><br><span class="hljs-params">  key: string,</span><br><span class="hljs-params">  val: any,</span><br><span class="hljs-params">  customSetter?: <span class="hljs-built_in">Function</span></span><br><span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">/*åœ¨é—­åŒ…ä¸­å®šä¹‰ä¸€ä¸ªdepå¯¹è±¡*/</span><br>  <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>()<br><br>  <span class="hljs-keyword">const</span> property = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">getOwnPropertyDescriptor</span>(obj, key)<br>  <span class="hljs-keyword">if</span> (property &amp;&amp; property.<span class="hljs-property">configurable</span> === <span class="hljs-literal">false</span>) &#123;<br>    <span class="hljs-keyword">return</span><br>  &#125;<br><br>  <span class="hljs-comment">/*å¦‚æœä¹‹å‰è¯¥å¯¹è±¡å·²ç»é¢„è®¾äº†getterä»¥åŠsetterå‡½æ•°åˆ™å°†å…¶å–å‡ºæ¥ï¼Œæ–°å®šä¹‰çš„getter/setterä¸­ä¼šå°†å…¶æ‰§è¡Œï¼Œä¿è¯ä¸ä¼šè¦†ç›–ä¹‹å‰å·²ç»å®šä¹‰çš„getter/setterã€‚*/</span><br>  <span class="hljs-comment">// cater for pre-defined getter/setters</span><br>  <span class="hljs-keyword">const</span> getter = property &amp;&amp; property.<span class="hljs-property">get</span><br>  <span class="hljs-keyword">const</span> setter = property &amp;&amp; property.<span class="hljs-property">set</span><br><br>  <span class="hljs-comment">/*å¯¹è±¡çš„å­å¯¹è±¡é€’å½’è¿›è¡Œobserveå¹¶è¿”å›å­èŠ‚ç‚¹çš„Observerå¯¹è±¡*/</span><br>  <span class="hljs-keyword">let</span> childOb = <span class="hljs-title function_">observe</span>(val)<br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, &#123;<br>    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveGetter</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">/*å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰getteræ–¹æ³•åˆ™æ‰§è¡Œ*/</span><br>      <span class="hljs-keyword">const</span> value = getter ? getter.<span class="hljs-title function_">call</span>(obj) : val<br>      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) &#123;<br>        <span class="hljs-comment">/*è¿›è¡Œä¾èµ–æ”¶é›†*/</span><br>        dep.<span class="hljs-title function_">depend</span>()<br>        <span class="hljs-keyword">if</span> (childOb) &#123;<br>          <span class="hljs-comment">/*å­å¯¹è±¡è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå…¶å®å°±æ˜¯å°†åŒä¸€ä¸ªwatcherè§‚å¯Ÿè€…å®ä¾‹æ”¾è¿›äº†ä¸¤ä¸ªdependä¸­ï¼Œä¸€ä¸ªæ˜¯æ­£åœ¨æœ¬èº«é—­åŒ…ä¸­çš„dependï¼Œå¦ä¸€ä¸ªæ˜¯å­å…ƒç´ çš„depend*/</span><br>          childOb.<span class="hljs-property">dep</span>.<span class="hljs-title function_">depend</span>()<br>        &#125;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value)) &#123;<br>          <span class="hljs-comment">/*æ˜¯æ•°ç»„åˆ™éœ€è¦å¯¹æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå¦‚æœæ•°ç»„çš„æˆå‘˜è¿˜æ˜¯æ•°ç»„ï¼Œåˆ™é€’å½’ã€‚*/</span><br>          <span class="hljs-title function_">dependArray</span>(value)<br>        &#125;<br>      &#125;<br>      <span class="hljs-keyword">return</span> value<br>    &#125;,<br>    <span class="hljs-attr">set</span>: <span class="hljs-keyword">function</span> <span class="hljs-title function_">reactiveSetter</span>(<span class="hljs-params">newVal</span>) &#123;<br>      <span class="hljs-comment">/*é€šè¿‡getteræ–¹æ³•è·å–å½“å‰å€¼ï¼Œä¸æ–°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´åˆ™ä¸éœ€è¦æ‰§è¡Œä¸‹é¢çš„æ“ä½œ*/</span><br>      <span class="hljs-keyword">const</span> value = getter ? getter.<span class="hljs-title function_">call</span>(obj) : val<br>      <span class="hljs-comment">/* eslint-disable no-self-compare */</span><br>      <span class="hljs-keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;<br>        <span class="hljs-keyword">return</span><br>      &#125;<br>      <span class="hljs-comment">/* eslint-enable no-self-compare */</span><br>      <span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span> &amp;&amp; customSetter) &#123;<br>        <span class="hljs-title function_">customSetter</span>()<br>      &#125;<br>      <span class="hljs-keyword">if</span> (setter) &#123;<br>        <span class="hljs-comment">/*å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰setteræ–¹æ³•åˆ™æ‰§è¡Œsetter*/</span><br>        setter.<span class="hljs-title function_">call</span>(obj, newVal)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        val = newVal<br>      &#125;<br><br>      <span class="hljs-comment">/*æ–°çš„å€¼éœ€è¦é‡æ–°è¿›è¡Œobserveï¼Œä¿è¯æ•°æ®å“åº”å¼*/</span><br>      childOb = <span class="hljs-title function_">observe</span>(newVal)<br><br>      <span class="hljs-comment">/*depå¯¹è±¡é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…*/</span><br>      dep.<span class="hljs-title function_">notify</span>()<br>    &#125;<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨åˆå§‹åŒ–æ—¶å¯¹dataå†…æ•°æ®å¼€å§‹åŠ«æŒç›‘å¬ï¼Œåˆå§‹åŒ–æ—¶è°ƒç”¨<code>observe</code>ï¼Œè¿”å›çš„æ˜¯<code>Observer</code>å®ä¾‹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Attempt to create an observer instance for a value,</span><br><span class="hljs-comment"> * returns the new observer if successfully observed,</span><br><span class="hljs-comment"> * or the existing observer if the value already has one.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> å°è¯•åˆ›å»ºä¸€ä¸ªObserverå®ä¾‹ï¼ˆ__ob__ï¼‰ï¼Œå¦‚æœæˆåŠŸåˆ›å»ºObserverå®ä¾‹åˆ™è¿”å›æ–°çš„Observerå®ä¾‹ï¼Œå¦‚æœå·²æœ‰Observerå®ä¾‹åˆ™è¿”å›ç°æœ‰çš„Observerå®ä¾‹ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">observe</span>(<span class="hljs-params">value: any, asRootData: ?boolean</span>): <span class="hljs-title class_">Observer</span> | <span class="hljs-keyword">void</span> &#123;<br>  <span class="hljs-comment">/*åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªå¯¹è±¡*/</span><br>  <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isObject</span>(value)) &#123;<br>    <span class="hljs-keyword">return</span><br>  &#125;<br>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ob</span>: <span class="hljs-title class_">Observer</span> | <span class="hljs-keyword">void</span><br><br>  <span class="hljs-comment">/*è¿™é‡Œç”¨__ob__è¿™ä¸ªå±æ€§æ¥åˆ¤æ–­æ˜¯å¦å·²ç»æœ‰Observerå®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰Observerå®ä¾‹åˆ™ä¼šæ–°å»ºä¸€ä¸ªObserverå®ä¾‹å¹¶èµ‹å€¼ç»™__ob__è¿™ä¸ªå±æ€§ï¼Œå¦‚æœå·²æœ‰Observerå®ä¾‹åˆ™ç›´æ¥è¿”å›è¯¥Observerå®ä¾‹*/</span><br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">hasOwn</span>(value, <span class="hljs-string">&#x27;__ob__&#x27;</span>) &amp;&amp; value.<span class="hljs-property">__ob__</span> <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Observer</span>) &#123;<br>    ob = value.<span class="hljs-property">__ob__</span><br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<br>    <span class="hljs-comment">/*è¿™é‡Œçš„åˆ¤æ–­æ˜¯ä¸ºäº†ç¡®ä¿valueæ˜¯å•çº¯çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°æˆ–è€…æ˜¯Regexpç­‰æƒ…å†µã€‚*/</span><br>    observerState.<span class="hljs-property">shouldConvert</span> &amp;&amp;<br>    !<span class="hljs-title function_">isServerRendering</span>() &amp;&amp;<br>    (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(value) || <span class="hljs-title function_">isPlainObject</span>(value)) &amp;&amp;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">isExtensible</span>(value) &amp;&amp;<br>    !value.<span class="hljs-property">_isVue</span><br>  ) &#123;<br>    ob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(value)<br>  &#125;<br>  <span class="hljs-keyword">if</span> (asRootData &amp;&amp; ob) &#123;<br>    <span class="hljs-comment">/*å¦‚æœæ˜¯æ ¹æ•°æ®åˆ™è®¡æ•°ï¼Œåé¢Observerä¸­çš„observeçš„asRootDataétrue*/</span><br>    ob.<span class="hljs-property">vmCount</span>++<br>  &#125;<br>  <span class="hljs-keyword">return</span> ob<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="Depä¸Watcher"><a href="#Depä¸Watcher" class="headerlink" title="Depä¸Watcher"></a>Depä¸Watcher</h5><p>åœ¨æ•°æ®åŠ«æŒæ—¶ï¼Œæ•°æ®çš„è·å–å’Œä¿®æ”¹éƒ½ä¼šåšå‡ºå¯¹åº”æ“ä½œã€‚æ“ä½œç›®çš„å°±æ˜¯ä¸ºäº†é€šçŸ¥â€œä¸­è½¬ç«™â€ï¼Œå®ƒä¸»è¦æ˜¯å¯¹æ•°æ®å˜æ›´èµ·é€šçŸ¥ä½œç”¨åŠå­˜æ”¾ä¾èµ–è¿™äº›æ•°æ®çš„åœ°æ–¹ã€‚</p><h6 id="Dep"><a href="#Dep" class="headerlink" title="Dep"></a>Dep</h6><p>Depç”¨æ¥æ”¶é›†ä¾èµ–ï¼Œé€šçŸ¥å¯¹åº”çš„è®¢é˜…è€…ï¼Œè®©å®ƒæ‰§è¡Œè‡ªå·±çš„æ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * A dep is an observable that can have multiple</span><br><span class="hljs-comment"> * directives subscribing to it.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> &#123;<br>  <span class="hljs-keyword">static</span> <span class="hljs-attr">target</span>: ?<span class="hljs-title class_">Watcher</span><br>  <span class="hljs-attr">id</span>: number<br>  <span class="hljs-attr">subs</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Watcher</span>&gt;<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = uid++<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = []<br>  &#125;<br><br>  <span class="hljs-comment">/*æ·»åŠ ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/</span><br>  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">sub: Watcher</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(sub)<br>  &#125;<br><br>  <span class="hljs-comment">/*ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡*/</span><br>  <span class="hljs-title function_">removeSub</span>(<span class="hljs-params">sub: Watcher</span>) &#123;<br>    <span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>, sub)<br>  &#125;<br><br>  <span class="hljs-comment">/*ä¾èµ–æ”¶é›†ï¼Œå½“å­˜åœ¨Dep.targetçš„æ—¶å€™æ·»åŠ è§‚å¯Ÿè€…å¯¹è±¡*/</span><br>  <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) &#123;<br>      <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>.<span class="hljs-title function_">addDep</span>(<span class="hljs-variable language_">this</span>)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/*é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…*/</span><br>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// stabilize the subscriber list first</span><br>    <span class="hljs-keyword">const</span> subs = <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">slice</span>()<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, l = subs.<span class="hljs-property">length</span>; i &lt; l; i++) &#123;<br>      subs[i].<span class="hljs-title function_">update</span>()<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// the current target watcher being evaluated.</span><br><span class="hljs-comment">// this is globally unique because there could be only one</span><br><span class="hljs-comment">// watcher being evaluated at any time.</span><br><span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span><br><span class="hljs-comment">/*ä¾èµ–æ”¶é›†å®Œéœ€è¦å°†Dep.targetè®¾ä¸ºnullï¼Œé˜²æ­¢åé¢é‡å¤æ·»åŠ ä¾èµ–ã€‚*/</span><br><span class="hljs-keyword">const</span> targetStack = []<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">pushTarget</span>(<span class="hljs-params">_target: Watcher</span>) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>) targetStack.<span class="hljs-title function_">push</span>(<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>)<br>  <span class="hljs-comment">// æ”¹å˜ç›®æ ‡æŒ‡å‘</span><br>  <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = _target<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">popTarget</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// åˆ é™¤å½“å‰ç›®æ ‡ï¼Œé‡ç®—æŒ‡å‘</span><br>  <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = targetStack.<span class="hljs-title function_">pop</span>()<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸»è¦è¿›è¡Œäº†ä¸¤ä¸ªåŠ¨ä½œï¼š</p><ul><li>å®šä¹‰subsæ•°ç»„ï¼Œç”¨æ¥æœé›†è®¢é˜…è€…Watcherã€‚</li><li>åŠ«æŒæ•°æ®å˜æ›´æ—¶ï¼Œé€šçŸ¥Watcherè¿›è¡Œupdateæ“ä½œã€‚</li></ul><h6 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h6><p>Watcheræ˜¯è®¢é˜…è€…ï¼Œä¸»è¦ä½œç”¨æ˜¯è®¢é˜…Depï¼Œå½“Depå‘å‡ºæ¶ˆæ¯<code>notify</code>çš„æ—¶å€™ï¼Œæ‰€æœ‰è®¢é˜…äº†Depçš„Watcheræ‰§è¡Œè‡ªå·±çš„updateæ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>  <span class="hljs-attr">vm</span>: <span class="hljs-title class_">Component</span><br>  <span class="hljs-attr">expression</span>: string<br>  <span class="hljs-attr">cb</span>: <span class="hljs-title class_">Function</span><br>  <span class="hljs-attr">id</span>: number<br>  <span class="hljs-attr">deep</span>: boolean<br>  <span class="hljs-attr">user</span>: boolean<br>  <span class="hljs-attr">lazy</span>: boolean<br>  <span class="hljs-attr">sync</span>: boolean<br>  <span class="hljs-attr">dirty</span>: boolean<br>  <span class="hljs-attr">active</span>: boolean<br>  <span class="hljs-attr">deps</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Dep</span>&gt;<br>  <span class="hljs-attr">newDeps</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Dep</span>&gt;<br>  <span class="hljs-attr">depIds</span>: <span class="hljs-title class_">ISet</span><br>  <span class="hljs-attr">newDepIds</span>: <span class="hljs-title class_">ISet</span><br>  <span class="hljs-attr">getter</span>: <span class="hljs-title class_">Function</span><br>  <span class="hljs-attr">value</span>: any<br><br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span><br><span class="hljs-params">    vm: Component,</span><br><span class="hljs-params">    expOrFn: string | <span class="hljs-built_in">Function</span>,</span><br><span class="hljs-params">    cb: <span class="hljs-built_in">Function</span>,</span><br><span class="hljs-params">    options?: <span class="hljs-built_in">Object</span></span><br><span class="hljs-params">  </span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm<br>    <span class="hljs-comment">/*_watcherså­˜æ”¾è®¢é˜…è€…å®ä¾‹*/</span><br>    vm.<span class="hljs-property">_watchers</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>)<br>    <span class="hljs-comment">// options</span><br>    <span class="hljs-keyword">if</span> (options) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span> = !!options.<span class="hljs-property">deep</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = !!options.<span class="hljs-property">user</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = !!options.<span class="hljs-property">lazy</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sync</span> = !!options.<span class="hljs-property">sync</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sync</span> = <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = ++uid <span class="hljs-comment">// uid for batching</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span> = <span class="hljs-literal">true</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> <span class="hljs-comment">// for lazy watchers</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = []<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDeps</span> = []<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">expression</span> =<br>      process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span> ? expOrFn.<span class="hljs-title function_">toString</span>() : <span class="hljs-string">&#x27;&#x27;</span><br>    <span class="hljs-comment">// parse expression for getter</span><br>    <span class="hljs-comment">/*æŠŠè¡¨è¾¾å¼expOrFnè§£ææˆgetter*/</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> expOrFn === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = expOrFn<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = <span class="hljs-title function_">parsePath</span>(expOrFn)<br>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;&#125;<br>        process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">&#x27;production&#x27;</span> &amp;&amp;<br>          <span class="hljs-title function_">warn</span>(<br>            <span class="hljs-string">`Failed watching path: &quot;<span class="hljs-subst">$&#123;expOrFn&#125;</span>&quot; `</span> +<br>              <span class="hljs-string">&#x27;Watcher only accepts simple dot-delimited paths. &#x27;</span> +<br>              <span class="hljs-string">&#x27;For full control, use a function instead.&#x27;</span>,<br>            vm<br>          )<br>      &#125;<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span> ? <span class="hljs-literal">undefined</span> : <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Evaluate the getter, and re-collect dependencies.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*è·å¾—getterçš„å€¼å¹¶ä¸”é‡æ–°è¿›è¡Œä¾èµ–æ”¶é›†*/</span><br>  <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">/*å°†è‡ªèº«watcherè§‚å¯Ÿè€…å®ä¾‹è®¾ç½®ç»™Dep.targetï¼Œç”¨ä»¥ä¾èµ–æ”¶é›†ã€‚*/</span><br>    <span class="hljs-title function_">pushTarget</span>(<span class="hljs-variable language_">this</span>)<br>    <span class="hljs-keyword">let</span> value<br>    <span class="hljs-keyword">const</span> vm = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span><br><br>    <span class="hljs-comment">/*</span><br><span class="hljs-comment">    æ‰§è¡Œäº†getteræ“ä½œï¼Œçœ‹ä¼¼æ‰§è¡Œäº†æ¸²æŸ“æ“ä½œï¼Œå…¶å®æ˜¯æ‰§è¡Œäº†ä¾èµ–æ”¶é›†ã€‚</span><br><span class="hljs-comment">    åœ¨å°†Dep.targetè®¾ç½®ä¸ºè‡ªç”Ÿè§‚å¯Ÿè€…å®ä¾‹ä»¥åï¼Œæ‰§è¡Œgetteræ“ä½œã€‚</span><br><span class="hljs-comment">    è­¬å¦‚è¯´ç°åœ¨çš„çš„dataä¸­å¯èƒ½æœ‰aã€bã€cä¸‰ä¸ªæ•°æ®ï¼Œgetteræ¸²æŸ“éœ€è¦ä¾èµ–aè·Ÿcï¼Œ</span><br><span class="hljs-comment">    é‚£ä¹ˆåœ¨æ‰§è¡Œgetterçš„æ—¶å€™å°±ä¼šè§¦å‘aè·Ÿcä¸¤ä¸ªæ•°æ®çš„getterå‡½æ•°ï¼Œ</span><br><span class="hljs-comment">    åœ¨getterå‡½æ•°ä¸­å³å¯åˆ¤æ–­Dep.targetæ˜¯å¦å­˜åœ¨ç„¶åå®Œæˆä¾èµ–æ”¶é›†ï¼Œ</span><br><span class="hljs-comment">    å°†è¯¥è§‚å¯Ÿè€…å¯¹è±¡æ”¾å…¥é—­åŒ…ä¸­çš„Depçš„subsä¸­å»ã€‚</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>) &#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>        value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span>.<span class="hljs-title function_">call</span>(vm, vm)<br>      &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-title function_">handleError</span>(e, vm, <span class="hljs-string">`getter for watcher &quot;<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.expression&#125;</span>&quot;`</span>)<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">getter</span>.<span class="hljs-title function_">call</span>(vm, vm)<br>    &#125;<br>    <span class="hljs-comment">// &quot;touch&quot; every property so they are all tracked as</span><br>    <span class="hljs-comment">// dependencies for deep watching</span><br>    <span class="hljs-comment">/*å¦‚æœå­˜åœ¨deepï¼Œåˆ™è§¦å‘æ¯ä¸ªæ·±å±‚å¯¹è±¡çš„ä¾èµ–ï¼Œè¿½è¸ªå…¶å˜åŒ–*/</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span>) &#123;<br>      <span class="hljs-comment">/*é€’å½’æ¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œè§¦å‘å®ƒä»¬çš„getterï¼Œä½¿å¾—å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¢«ä¾èµ–æ”¶é›†ï¼Œå½¢æˆä¸€ä¸ªâ€œæ·±ï¼ˆdeepï¼‰â€ä¾èµ–å…³ç³»*/</span><br>      <span class="hljs-title function_">traverse</span>(value)<br>    &#125;<br><br>    <span class="hljs-comment">/*å°†è§‚å¯Ÿè€…å®ä¾‹ä»targetæ ˆä¸­å–å‡ºå¹¶è®¾ç½®ç»™Dep.target*/</span><br>    <span class="hljs-title function_">popTarget</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupDeps</span>()<br>    <span class="hljs-keyword">return</span> value<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Add a dependency to this directive.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*æ·»åŠ ä¸€ä¸ªä¾èµ–å…³ç³»åˆ°Depsé›†åˆä¸­*/</span><br>  <span class="hljs-title function_">addDep</span>(<span class="hljs-params">dep: Dep</span>) &#123;<br>    <span class="hljs-keyword">const</span> id = dep.<span class="hljs-property">id</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span>.<span class="hljs-title function_">has</span>(id)) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span>.<span class="hljs-title function_">add</span>(id)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDeps</span>.<span class="hljs-title function_">push</span>(dep)<br>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span>.<span class="hljs-title function_">has</span>(id)) &#123;<br>        dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-variable language_">this</span>)<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Clean up for dependency collection.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*æ¸…ç†ä¾èµ–æ”¶é›†*/</span><br>  <span class="hljs-title function_">cleanupDeps</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">/*ç§»é™¤æ‰€æœ‰è§‚å¯Ÿè€…å¯¹è±¡*/</span><br>    <span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-property">length</span><br>    <span class="hljs-keyword">while</span> (i--) &#123;<br>      <span class="hljs-keyword">const</span> dep = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>[i]<br>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span>.<span class="hljs-title function_">has</span>(dep.<span class="hljs-property">id</span>)) &#123;<br>        dep.<span class="hljs-title function_">removeSub</span>(<span class="hljs-variable language_">this</span>)<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">let</span> tmp = <span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">depIds</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span> = tmp<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDepIds</span>.<span class="hljs-title function_">clear</span>()<br>    tmp = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDeps</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDeps</span> = tmp<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">newDeps</span>.<span class="hljs-property">length</span> = <span class="hljs-number">0</span><br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Subscriber interface.</span><br><span class="hljs-comment">   * Will be called when a dependency changes.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  è°ƒåº¦è€…æ¥å£ï¼Œå½“ä¾èµ–å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è¿›è¡Œå›è°ƒã€‚</span><br><span class="hljs-comment">  */</span><br>  <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">/* istanbul ignore else */</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">lazy</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">true</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">sync</span>) &#123;<br>      <span class="hljs-comment">/*åŒæ­¥åˆ™æ‰§è¡Œrunç›´æ¥æ¸²æŸ“è§†å›¾*/</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">run</span>()<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">/*å¼‚æ­¥æ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œç”±è°ƒåº¦è€…è°ƒç”¨ã€‚*/</span><br>      <span class="hljs-title function_">queueWatcher</span>(<span class="hljs-variable language_">this</span>)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Scheduler job interface.</span><br><span class="hljs-comment">   * Will be called by the scheduler.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">        è°ƒåº¦è€…å·¥ä½œæ¥å£ï¼Œå°†è¢«è°ƒåº¦è€…å›è°ƒã€‚</span><br><span class="hljs-comment">        */</span><br>  <span class="hljs-title function_">run</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>) &#123;<br>      <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>      <span class="hljs-keyword">if</span> (<br>        value !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> ||<br>        <span class="hljs-comment">// Deep watchers and watchers on Object/Arrays should fire even</span><br>        <span class="hljs-comment">// when the value is the same, because the value may</span><br>        <span class="hljs-comment">// have mutated.</span><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">          å³ä¾¿å€¼ç›¸åŒï¼Œæ‹¥æœ‰Deepå±æ€§çš„è§‚å¯Ÿè€…ä»¥åŠåœ¨å¯¹è±¡ï¼æ•°ç»„ä¸Šçš„è§‚å¯Ÿè€…åº”è¯¥è¢«è§¦å‘æ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚</span><br><span class="hljs-comment">        */</span><br>        <span class="hljs-title function_">isObject</span>(value) ||<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deep</span><br>      ) &#123;<br>        <span class="hljs-comment">// set new value</span><br>        <span class="hljs-keyword">const</span> oldValue = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span><br>        <span class="hljs-comment">/*è®¾ç½®æ–°çš„å€¼*/</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value<br><br>        <span class="hljs-comment">/*è§¦å‘å›è°ƒæ¸²æŸ“è§†å›¾*/</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span>) &#123;<br>          <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>, value, oldValue)<br>          &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-title function_">handleError</span>(e, <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>, <span class="hljs-string">`callback for watcher &quot;<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.expression&#125;</span>&quot;`</span>)<br>          &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>, value, oldValue)<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Evaluate the value of the watcher.</span><br><span class="hljs-comment">   * This only gets called for lazy watchers.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*è·å–è§‚å¯Ÿè€…çš„å€¼*/</span><br>  <span class="hljs-title function_">evaluate</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">get</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dirty</span> = <span class="hljs-literal">false</span><br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Depend on all deps collected by this watcher.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*æ”¶é›†è¯¥watcherçš„æ‰€æœ‰depsä¾èµ–*/</span><br>  <span class="hljs-title function_">depend</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-property">length</span><br>    <span class="hljs-keyword">while</span> (i--) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>[i].<span class="hljs-title function_">depend</span>()<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Remove self from all dependencies&#x27; subscriber list.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-comment">/*å°†è‡ªèº«ä»æ‰€æœ‰ä¾èµ–æ”¶é›†è®¢é˜…åˆ—è¡¨åˆ é™¤*/</span><br>  <span class="hljs-title function_">teardown</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>) &#123;<br>      <span class="hljs-comment">// remove self from vm&#x27;s watcher list</span><br>      <span class="hljs-comment">// this is a somewhat expensive operation so we skip it</span><br>      <span class="hljs-comment">// if the vm is being destroyed.</span><br>      <span class="hljs-comment">/*ä»vmå®ä¾‹çš„è§‚å¯Ÿè€…åˆ—è¡¨ä¸­å°†è‡ªèº«ç§»é™¤ï¼Œç”±äºè¯¥æ“ä½œæ¯”è¾ƒè€—è´¹èµ„æºï¼Œæ‰€ä»¥å¦‚æœvmå®ä¾‹æ­£åœ¨è¢«é”€æ¯åˆ™è·³è¿‡è¯¥æ­¥éª¤ã€‚*/</span><br>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>.<span class="hljs-property">_isBeingDestroyed</span>) &#123;<br>        <span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>.<span class="hljs-property">_watchers</span>, <span class="hljs-variable language_">this</span>)<br>      &#125;<br>      <span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>.<span class="hljs-property">length</span><br>      <span class="hljs-keyword">while</span> (i--) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deps</span>[i].<span class="hljs-title function_">removeSub</span>(<span class="hljs-variable language_">this</span>)<br>      &#125;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span> = <span class="hljs-literal">false</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ¨¡å¼"><a href="#å‘½ä»¤æ¨¡å¼" class="headerlink" title="å‘½ä»¤æ¨¡å¼"></a>å‘½ä»¤æ¨¡å¼</h2><blockquote><p>å‘½ä»¤æ¨¡å¼æ˜¯æœ€ç®€å•å’Œä¼˜é›…çš„æ¨¡å¼ä¹‹ä¸€ï¼Œå‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤ï¼ˆcommandï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤ã€‚</p></blockquote><p>å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼ï¼Œä½¿è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…æ¶ˆé™¤å½¼æ­¤çš„è€¦åˆå…³ç³»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/* </span><br><span class="hljs-comment">    æœ¬è´¨æ˜¯å¯¹å‘½ä»¤å°è£…ï¼Œæ‹†åˆ†å‘å‡ºå‘½ä»¤çš„è´£ä»»å’Œæ‰§è¡Œå‘½ä»¤çš„è´£ä»»</span><br><span class="hljs-comment">    ä¼˜ç‚¹ï¼šé™ä½å¯¹è±¡è€¦åˆåº¦ï¼Œæ˜“æ‰©å±•ç»„åˆå‘½ä»¤ï¼Œè°ƒç”¨åŒä¸€æ–¹æ³•å®ç°ä¸åŒåŠŸèƒ½</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">// å‘½ä»¤</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">CreateCommand</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">receiver</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span> = receiver<br>&#125;<br><span class="hljs-title class_">CreateCommand</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">execute</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span>.<span class="hljs-title function_">action</span>()<br>&#125;<br><br><span class="hljs-comment">// æ¥æ”¶è€…</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">TVOn</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br><span class="hljs-title class_">TVOn</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">action</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;TV on now&#x27;</span>);<br>&#125;<br><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">TVOff</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br><span class="hljs-title class_">TVOff</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">action</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;TV off now&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// è°ƒç”¨è€…</span><br><span class="hljs-keyword">var</span> <span class="hljs-title class_">Invoker</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">tvOnCommand, tvOffCommand</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tvOnCommand</span> = tvOnCommand<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tvOffCommand</span> = tvOffCommand<br>&#125;<br><span class="hljs-title class_">Invoker</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">tvOn</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tvOnCommand</span>.<span class="hljs-title function_">execute</span>()<br>&#125;<br><span class="hljs-title class_">Invoker</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">tvOff</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tvOffCommand</span>.<span class="hljs-title function_">execute</span>()<br>&#125;<br><br><span class="hljs-keyword">var</span> tvOnCommand = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateCommand</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TVOn</span>())<br><span class="hljs-keyword">var</span> tvOffCommand = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateCommand</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TVOff</span>())<br><br><span class="hljs-keyword">var</span> myInvoker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Invoker</span>(tvOnCommand, tvOffCommand)<br>myInvoker.<span class="hljs-title function_">tvOn</span>()<br>myInvoker.<span class="hljs-title function_">tvOff</span>()<br></code></pre></td></tr></table></figure><h2 id="ç»„åˆæ¨¡å¼"><a href="#ç»„åˆæ¨¡å¼" class="headerlink" title="ç»„åˆæ¨¡å¼"></a>ç»„åˆæ¨¡å¼</h2><blockquote><p>ç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿè®¸æ˜¯ç”±æ›´å°çš„â€œå­™å¯¹è±¡â€æ„æˆçš„ã€‚</p></blockquote><h3 id="ç»„åˆæ¨¡å¼ç”¨é€”"><a href="#ç»„åˆæ¨¡å¼ç”¨é€”" class="headerlink" title="ç»„åˆæ¨¡å¼ç”¨é€”"></a>ç»„åˆæ¨¡å¼ç”¨é€”</h3><p>ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å‹ç»“æ„ï¼Œä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚çº§ç»“æ„ã€‚ç»„åˆæ¨¡å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p><p>ä»¥å®å‘½ä»¤ä¸ºä¾‹ï¼Œè¯·æ±‚ä»æ ‘æœ€é¡¶ç«¯çš„å¯¹è±¡å¾€ä¸‹ä¼ é€’ï¼Œå¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯å¶å¯¹è±¡ï¼ˆæ™®é€šå­å‘½ä»¤ï¼‰ï¼Œå¶å¯¹è±¡è‡ªèº«ä¼šå¯¹è¯·æ±‚ä½œå‡ºç›¸åº”çš„å¤„ç†ï¼›å¦‚æœå½“å‰å¤„ç†è¯·æ±‚çš„å¯¹è±¡æ˜¯ç»„åˆå¯¹è±¡ï¼ˆå®å‘½ä»¤ï¼‰ï¼Œç»„åˆå¯¹è±¡åˆ™ä¼šéå†å®ƒå±ä¸‹çš„å­èŠ‚ç‚¹ï¼Œå°†è¯·æ±‚ç»§ç»­ä¼ é€’ç»™è¿™äº›å­èŠ‚ç‚¹ã€‚</p><p>è¯·æ±‚ä»ä¸Šè‡³ä¸‹ä¼ é€’ç›´åˆ°å°½å¤´ï¼Œç”¨æˆ·åªéœ€è¦å…³å¿ƒæœ€é¡¶å±‚çš„ç»„åˆå¯¹è±¡ï¼Œè¯·æ±‚è¯¥å¯¹è±¡è¯·æ±‚ä¾¿ä¼šå‘ä¸‹ä¼ é€’ã€‚</p><p>è§’è‰²ï¼š<br>ï¼ˆ1ï¼‰å­å¯¹è±¡<br>ï¼ˆ2ï¼‰ç»„åˆå¯¹è±¡<br>ï¼ˆ3ï¼‰æŠ½è±¡ç±»ï¼šä¸»è¦å®šä¹‰äº†å‚ä¸ç»„åˆçš„å¯¹è±¡çš„å…¬å…±æ¥å£ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨ç»„åˆå¯¹è±¡ä¸­å®šä¹‰</p><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p>githubä¸ŠåŸæœ‰<a href="https://github.com/sohamkamani/javascript-design-patterns-for-humans#-bridge">ä¾‹å­</a></p><p>åœºæ™¯ï¼šç»„ç»‡å†…æœ‰å„ç§å‘˜å·¥ï¼Œå‘˜å·¥æœ‰ä¸åŒå§“åã€å·¥èµ„ï¼Œå¯è¿›è¡Œæ·»åŠ æ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// åœºæ™¯ ä»¥å‘˜å·¥ä¸ºä¾‹ã€‚è¿™é‡Œæˆ‘ä»¬æœ‰ä¸åŒçš„å‘˜å·¥ç±»å‹</span><br><span class="hljs-comment">// å¼€å‘è€…</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Developer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, salary</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span> = salary<br>    &#125;<br>    <span class="hljs-title function_">getName</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>    &#125;<br>    <span class="hljs-title function_">setSalary</span>(<span class="hljs-params">salary</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span> = salary<br>    &#125;<br>    <span class="hljs-title function_">getSalary</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span><br>    &#125;<br>    <span class="hljs-title function_">getRoles</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roles</span><br>    &#125;<br>    <span class="hljs-title function_">develop</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">/* */</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">// è®¾è®¡å¸ˆ</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Designer</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name, salary</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span> = salary<br>    &#125;<br>    <span class="hljs-title function_">getName</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>    &#125;<br>    <span class="hljs-title function_">setSalary</span>(<span class="hljs-params">salary</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span> = salary<br>    &#125;<br>    <span class="hljs-title function_">getSalary</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">salary</span><br>    &#125;<br>    <span class="hljs-title function_">getRoles</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">roles</span><br>    &#125;<br>    <span class="hljs-title function_">design</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">/* */</span><br>    &#125;<br>&#125;<br><span class="hljs-comment">// ä¸€ä¸ªç”±å‡ ç§ä¸åŒç±»å‹çš„å‘˜å·¥ç»„æˆçš„ç»„ç»‡</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Organization</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">employees</span> = []<br>    &#125;<br>    <span class="hljs-comment">// è¿½åŠ å…ƒç´ </span><br>    <span class="hljs-title function_">addEmployee</span>(<span class="hljs-params">employee</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">employees</span>.<span class="hljs-title function_">push</span>(employee)<br>    &#125;<br>    <span class="hljs-comment">//  å¶å¯¹è±¡éƒ½æœ‰ä¸€æ ·çš„getSalaryæ–¹æ³•ã€‚åœ¨æ ¹å¯¹è±¡æ‰§è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨leaf.executeçš„æ¨¡å¼æ¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ã€‚</span><br>    <span class="hljs-title function_">getNetSalaries</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> netSalary = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">employees</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">employee</span> =&gt;</span> &#123;<br>            netSalary += employee.<span class="hljs-title function_">getSalary</span>()<br>        &#125;)<br>        <span class="hljs-keyword">return</span> netSalary<br>    &#125;<br>&#125;<br><span class="hljs-comment">// è°ƒç”¨</span><br><span class="hljs-comment">// Prepare the employees</span><br><span class="hljs-keyword">const</span> john = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Developer</span>(<span class="hljs-string">&#x27;John Doe&#x27;</span>, <span class="hljs-number">12000</span>)<br><span class="hljs-keyword">const</span> jane = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Designer</span>(<span class="hljs-string">&#x27;Jane&#x27;</span>, <span class="hljs-number">10000</span>)<br><span class="hljs-comment">// Add them to organization ä¼˜åŠ¿ï¼šæ— è®ºå¤šå°‘å‘˜å·¥ç±»å‹ å¯¹æ•´ä¸ªç»„åˆå¯¹è±¡åªè°ƒç”¨ä¸€æ¬¡</span><br><span class="hljs-keyword">const</span> organization = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Organization</span>()<br>organization.<span class="hljs-title function_">addEmployee</span>(john)<br>organization.<span class="hljs-title function_">addEmployee</span>(jane)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Net salaries: &quot;</span> , organization.<span class="hljs-title function_">getNetSalaries</span>()) <span class="hljs-comment">// Net Salaries: 22000</span><br></code></pre></td></tr></table></figure><h3 id="éœ€è¦æ³¨æ„çš„åœ°æ–¹"><a href="#éœ€è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„åœ°æ–¹"></a>éœ€è¦æ³¨æ„çš„åœ°æ–¹</h3><ul><li>ç»„åˆæ¨¡å¼ä¸æ˜¯çˆ¶å­å…³ç³»</li><li>å¯¹å¶å¯¹è±¡æ“ä½œçš„ä¸€è‡´æ€§</li><li>åŒå‘æ˜ å°„å…³ç³»</li><li>ç”¨èŒè´£é“¾æ¨¡å¼æé«˜ç»„åˆæ¨¡å¼æ€§èƒ½</li></ul><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>å«æœ‰æŸç§å±‚çº§ç»“æ„çš„å¯¹è±¡é›†åˆ(å…·ä½“ç»“æ„åœ¨å¼€å‘è¿‡ç¨‹ä¸­æ— æ³•ç¡®å®š)</li><li>å¸Œæœ›å¯¹è¿™äº›å¯¹è±¡æˆ–è€…å…¶ä¸­çš„æŸäº›å¯¹è±¡æ‰§è¡ŒæŸç§æ“ä½œ</li></ul><p>ç¼ºç‚¹ï¼šå› ä¸ºç»„åˆå¯¹è±¡çš„ä»»ä½•æ“ä½œéƒ½ä¼šå¯¹æ‰€æœ‰çš„å­å¯¹è±¡è°ƒç”¨åŒæ ·çš„æ“ä½œï¼Œæ‰€ä»¥å½“ç»„åˆçš„ç»“æ„å¾ˆå¤§æ—¶ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆåŸºç¡€ç¯‡ï¼‰</title>
    <link href="/2021/11/16/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/"/>
    <url>/2021/11/16/w%E5%AD%97%E6%80%BB%E7%BB%93%E3%80%8AJavaScript%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%BC%80%E5%8F%91%E5%AE%9E%E8%B7%B5%E3%80%8B%EF%BC%88%E5%9F%BA%E7%A1%80%E7%AF%87%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h1><p><a href="https://juejin.cn/post/7031461636158259214">wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡æ¨¡å¼ï¼‰ï¼ˆä¸Šï¼‰</a></p><p><a href="https://juejin.cn/post/7032152388773675021/">wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡æ¨¡å¼ï¼‰ï¼ˆä¸‹ï¼‰</a></p><p><a href="https://juejin.cn/post/7033225292252446727">wå­—æ€»ç»“ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹ï¼ˆè®¾è®¡åŸåˆ™å’Œç¼–ç¨‹æŠ€å·§ï¼‰</a></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸ºä»€ä¹ˆæˆ‘è¦å¼€å§‹å†™è¿™ç±»æ–‡ç« äº†ï¼Œä¸€åˆ‡éƒ½å¾—ä»EDGå¤ºå† å¼€å§‹è¯´èµ·ï¼Œåœ¨æ‰“å®Œç¬¬ä¸‰å±€åæˆ‘å‘äº†ä¸€æ¡æœ‹å‹åœˆâ€¦â€¦å¦‚ä¸‹å›¾ã€‚</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d7688362f0b446bfaa951be25da9a265~tplv-k3u1fbpfcp-watermark.image?" alt="" width="400" height="175" align="bottom" /><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9202c2afe9084f09af98fd238a8c65c5~tplv-k3u1fbpfcp-watermark.image?" alt="" width="190" height="320" align="bottom" /><p>æˆ‘ä¹Ÿæ˜¯æ²¡æƒ³åˆ°EDGéŸ§æ€§è¿™ä¹ˆå¼ºï¼Œæ±‰å­å“¥è¿™ä¹ˆçƒ­çˆ±ä¸­å›½ã€‚<br>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ­å–œEDGï¼Œè‡ªå·±ç«‹çš„flagï¼Œå“­ç€ä¹Ÿè¦æŠŠå®ƒå®ç°ã€‚ï¼ˆå…¶å®è›®ä¸é”™çš„ï¼Œå……å®è‡ªå·±ã€‚ï¼‰<br>ç°åœ¨æ¯å¤©å’Œå‘¨æœ«ç©ºé—²æ—¶é—´å°±è¯»ä¸€äº›ï¼Œåšåšç¬”è®°ï¼Œå‘¨æœ«æ•´åˆä¸€ä¸‹å½¢æˆæ–‡ç« ï¼Œå¾€æ˜é‡‘è¿™ä¹ˆä¸€å‘ã€‚</p><h1 id="thisï¼Œcallå’Œapply"><a href="#thisï¼Œcallå’Œapply" class="headerlink" title="thisï¼Œcallå’Œapply"></a>thisï¼Œcallå’Œapply</h1><h2 id="this"><a href="#this" class="headerlink" title="this"></a><a href="http://127.0.0.1:3334/mdEditor/?defaultMode=view&fileId=WEB541c2b212bcf1974b4ee1275b9b7acf2#this"></a>this</h2><blockquote><p>åœ¨JavaScriptä¸­ï¼ŒthisæŒ‡å‘çš„å¯¹è±¡æ˜¯åœ¨è¿è¡Œæ—¶åŸºäºå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒåŠ¨æ€ç»‘å®šçš„ï¼Œè€Œéå£°æ˜å‡½æ•°æ—¶çš„ç¯å¢ƒ</p></blockquote><h3 id="thisæŒ‡å‘"><a href="#thisæŒ‡å‘" class="headerlink" title="thisæŒ‡å‘"></a><a href="http://127.0.0.1:3334/mdEditor/?defaultMode=view&fileId=WEB541c2b212bcf1974b4ee1275b9b7acf2#this%E6%8C%87%E5%90%91"></a>thisæŒ‡å‘</h3><p>é™¤å»<code>with</code>å’Œ<code>eval</code>è¿™ä¸¤ç§ä¼šâ€œç ´åâ€æˆ‘ä»¬å¯¹ä½œç”¨åŸŸç†è§£çš„æƒ…å†µï¼Œthisçš„æŒ‡å‘å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç§ã€‚</p><ul><li>  ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•</li><li>  ä½œä¸ºæ™®é€šå‡½æ•°</li><li>  æ„é€ å™¨è°ƒç”¨</li><li>  <code>Function.prototype.call</code>Â æˆ–Â <code>Function.prototype.apply</code>Â è°ƒç”¨</li></ul><p><strong>ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘è¯¥å¯¹è±¡</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;moe&#x27;</span>,<br>    <span class="hljs-attr">getName</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span> === obj) <span class="hljs-comment">// true</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>) <span class="hljs-comment">// moe</span><br>    &#125;<br>&#125;<br><br>obj.<span class="hljs-title function_">getName</span>()<br></code></pre></td></tr></table></figure><p><strong>å½“å‡½æ•°ä¸ä½œä¸ºå¯¹è±¡å±æ€§è€Œä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨æ—¶ï¼ŒthisæŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨çš„JavaScriptä¸­ï¼Œå…¨å±€å¯¹è±¡ä¸ºwindow</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">window</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;moe&#x27;</span><br><br><span class="hljs-keyword">var</span> getName = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>&#125;<br><br><span class="hljs-keyword">var</span> person = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;kid&#x27;</span>,<br>    <span class="hljs-attr">getName</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> globalGetName = person.<span class="hljs-property">getName</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">getName</span>() ) <span class="hljs-comment">// moe</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">globalGetName</span>() ) <span class="hljs-comment">// moe</span><br></code></pre></td></tr></table></figure><p><strong>ä½œä¸ºæ„é€ å™¨è°ƒç”¨</strong></p><ol><li> ç”¨newè¿ç®—ç¬¦è°ƒç”¨æ—¶ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ„é€ å™¨å†…thisæŒ‡å‘è¿”å›çš„è¿™ä¸ªå¯¹è±¡ã€‚</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">MyClass</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;moe&#x27;</span><br>&#125;<br><br><span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>()<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>) <span class="hljs-comment">// moe</span><br></code></pre></td></tr></table></figure><p>ä½†å¦‚æœæ„é€ å™¨æ˜¾å¼è¿”å›äº†ä¸€ä¸ªobjectç±»å‹å¯¹è±¡ï¼Œåˆ™è¿”å›çš„ä¸ºè¯¥å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸Šè¿°çš„thisã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> <span class="hljs-title class_">MyClass</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;moe&#x27;</span><br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;kid&#x27;</span><br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>()<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">name</span>) <span class="hljs-comment">// kid</span><br></code></pre></td></tr></table></figure><blockquote><p>æ„é€ å™¨ä¸æ˜¾å¼è¿”å›æ•°æ®æˆ–è¿”å›éå¯¹è±¡ç±»å‹æ•°æ®ï¼Œåˆ™æ— ä¸Šè¿°é—®é¢˜ã€‚</p></blockquote><p><strong>Function.prototype.callæˆ–Function.prototype.applyè°ƒç”¨å¯ä»¥åŠ¨æ€æ”¹å˜ä¼ å…¥å‡½æ•°çš„this</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> obj1 = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;a&#x27;</span>,<br>    <span class="hljs-attr">getName</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> obj2 = &#123;<br>    <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;b&#x27;</span><br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1.<span class="hljs-title function_">getName</span>()) <span class="hljs-comment">// a</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj1.<span class="hljs-property">getName</span>.<span class="hljs-title function_">call</span>(obj2)) <span class="hljs-comment">// b</span><br></code></pre></td></tr></table></figure><h2 id="callå’Œapply"><a href="#callå’Œapply" class="headerlink" title="callå’Œapply"></a><a href="http://127.0.0.1:3334/mdEditor/?defaultMode=view&fileId=WEB541c2b212bcf1974b4ee1275b9b7acf2#call%E5%92%8Capply"></a>callå’Œapply</h2><blockquote><p>callå’Œapplyéƒ½æ˜¯ç”¨æ¥ä¿®æ”¹thisæŒ‡å‘ï¼Œå¹¶æ‰§è¡Œå‡½æ•°ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å…¥å‚å½¢å¼ä¸åŒ</p></blockquote><ul><li>  applyæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†å‡½æ•°ä½“å†…thiså¯¹è±¡çš„æŒ‡å‘ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºé›†åˆï¼ˆæ•°ç»„æˆ–ç±»æ•°ç»„ï¼‰ï¼Œapplyæ–¹æ³•æŠŠè¿™ä¸ªé›†åˆä¸­çš„å…ƒç´ ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</li><li>  callæœ¬è´¨ä¸Šä¸ºapplyçš„è¯­æ³•ç³–ï¼Œå®ƒä¼ å…¥å‚æ•°æ•°é‡ä¸å®šï¼Œç¬¬ä¸€ä¸ªå‚æ•°åŒapplyä¸€æ ·ï¼Œä¹Ÿæ˜¯ä»£è¡¨å‡½æ•°ä½“å†…thisæŒ‡å‘ï¼Œä»ç¬¬äºŒä¸ªå‚æ•°å¾€åï¼Œæ¯ä¸ªå‚æ•°è¢«ä¾æ¬¡ä¼ å…¥å‡½æ•°ã€‚</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([a, b, c]) <span class="hljs-comment">// [1, 2, 3]</span><br>&#125;<br>foo.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br>foo.<span class="hljs-title function_">call</span>(<span class="hljs-literal">null</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™å‡½æ•°ä½“å†…çš„thisä¼šæŒ‡å‘é»˜è®¤çš„å®¿ä¸»å¯¹è±¡ã€‚</p><h3 id="callå’Œapplyçš„ç”¨é€”"><a href="#callå’Œapplyçš„ç”¨é€”" class="headerlink" title="callå’Œapplyçš„ç”¨é€”"></a><a href="http://127.0.0.1:3334/mdEditor/?defaultMode=view&fileId=WEB541c2b212bcf1974b4ee1275b9b7acf2#call%E5%92%8Capply%E7%9A%84%E7%94%A8%E9%80%94"></a>callå’Œapplyçš„ç”¨é€”</h3><ol><li> æ”¹å˜thisæŒ‡å‘</li><li> å€Ÿç”¨å…¶ä»–å¯¹è±¡æ–¹æ³•</li></ol><p>åˆ©ç”¨applyæˆ–callï¼Œå¯ä»¥å®ç°ç±»ä¼¼äºç»§æ‰¿çš„æ•ˆæœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> A = <span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name<br>&#125;<br><br><span class="hljs-keyword">var</span> B = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    A.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>,<span class="hljs-variable language_">arguments</span>)<br>&#125;<br><br>B.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">getName</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>&#125;<br><br><span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>(<span class="hljs-string">&#x27;newBee&#x27;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( b.<span class="hljs-title function_">getName</span>() ) <span class="hljs-comment">// newBee</span><br> <br></code></pre></td></tr></table></figure><p>å‡½æ•°çš„argumentsæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œå› ä¸ºå…¶ä¸æ˜¯çœŸæ­£çš„æ•°ç»„ï¼Œæ‰€ä»¥æ— æ³•åƒæ•°ç»„ä¸€æ ·è¿›è¡Œæ’åºæˆ–å‘é›†åˆä¸­æ·»åŠ åˆ é™¤å…ƒç´ ä¹‹ç±»çš„æ“ä½œã€‚è¿™ç§æƒ…å†µæˆ‘ä»¬å¯ä»¥å€Ÿç”¨<code>Array.prototype</code>å¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼Œæ¯”å¦‚pushã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">push</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>, <span class="hljs-number">3</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>); <span class="hljs-comment">// [1, 2, 3]</span><br>&#125;)(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><h1 id="é—­åŒ…å’Œé«˜é˜¶å‡½æ•°"><a href="#é—­åŒ…å’Œé«˜é˜¶å‡½æ•°" class="headerlink" title="é—­åŒ…å’Œé«˜é˜¶å‡½æ•°"></a>é—­åŒ…å’Œé«˜é˜¶å‡½æ•°</h1><h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h2><h3 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h3><p>åœ¨å‡½æ•°ä¸­å£°æ˜å˜é‡ï¼Œå¦‚æœè¯¥å˜é‡å‰æ²¡æœ‰å…³é”®å­—varï¼Œè¯¥å˜é‡å°±ä¼šæˆä¸ºå…¨å±€å˜é‡ï¼Œè€Œåœ¨å‡½æ•°ä¸­ç”¨varå…³é”®å­—å£°æ˜çš„å˜é‡ä¸ºè¯¥å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œåªæœ‰åœ¨è¯¥å‡½æ•°å†…æ‰èƒ½è®¿é—®åˆ°è¯¥å˜é‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    a = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;in foo:&#x27;</span> , b) <span class="hljs-comment">// in foo: 2</span><br>&#125;<br><span class="hljs-title function_">foo</span>()<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a ) <span class="hljs-comment">// 1</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( b ) <span class="hljs-comment">// Uncaught ReferenceError: b is not defined</span><br></code></pre></td></tr></table></figure><p>å‡½æ•°å¯ä»¥ç”¨æ¥åˆ›é€ å‡½æ•°ä½œç”¨åŸŸï¼Œæ­¤æ—¶å‡½æ•°åƒä¸€å±‚åŠé€æ˜ç»ç’ƒï¼Œå‡½æ•°å†…å¯ä»¥çœ‹åˆ°å¤–é¢çš„å˜é‡ï¼Œè€Œå‡½æ•°å¤–æ— æ³•çœ‹åˆ°å‡½æ•°å†…éƒ¨çš„å˜é‡ã€‚è¿™æ˜¯å› ä¸ºåœ¨å‡½æ•°ä¸­æœç´¢ä¸€ä¸ªå˜é‡æ—¶ï¼Œè‹¥å‡½æ•°å†…æ²¡æœ‰å£°æ˜è¿™ä¸ªå˜é‡ï¼Œæœç´¢åˆ™ä¼šéšç€ä»£ç æ‰§è¡Œç¯å¢ƒåˆ›å»ºçš„ä½œç”¨åŸŸé“¾å‘å¤–é€å±‚æœç´¢ï¼Œç›´åˆ°å…¨å±€å¯¹è±¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">var</span> bar = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span><br>    <span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> c = <span class="hljs-number">3</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( b ) <span class="hljs-comment">// 2</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a ) <span class="hljs-comment">// 1</span><br>    &#125;<br>    <span class="hljs-title function_">foo</span>()<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( c ) <span class="hljs-comment">// Uncaught ReferenceError: c is not defined</span><br>&#125;<br><span class="hljs-title function_">bar</span>()<br></code></pre></td></tr></table></figure><h3 id="å˜é‡çš„ç”Ÿå­˜å‘¨æœŸ"><a href="#å˜é‡çš„ç”Ÿå­˜å‘¨æœŸ" class="headerlink" title="å˜é‡çš„ç”Ÿå­˜å‘¨æœŸ"></a>å˜é‡çš„ç”Ÿå­˜å‘¨æœŸ</h3><ul><li>å…¨å±€å˜é‡çš„ç”Ÿå­˜å‘¨æœŸä¸ºæ°¸ä¹…ï¼Œé™¤éä¸»åŠ¨é”€æ¯ã€‚</li><li>å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ä¼šéšç€å‡½æ•°è°ƒç”¨çš„ç»“æŸè€Œè¢«é”€æ¯ã€‚</li></ul><p>è€Œé—­åŒ…çš„å­˜åœ¨å¯ä»¥è®©æˆ‘ä»¬å»¶ç»­å‡½æ•°å†…å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> func = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        a++<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)<br>    &#125;<br>&#125;<br><span class="hljs-keyword">var</span> f = <span class="hljs-title function_">func</span>()<br><span class="hljs-title function_">f</span>() <span class="hljs-comment">// 2</span><br><span class="hljs-title function_">f</span>() <span class="hljs-comment">// 3</span><br><span class="hljs-title function_">f</span>() <span class="hljs-comment">// 4</span><br></code></pre></td></tr></table></figure><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä¸€å®šé‡åˆ°è¿‡è¿™æ ·çš„é¢˜ç›®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment">    ä»¥ä¸‹æ‰“å°ç»“æœæ˜¯5ä¸ª5ï¼Œä¸ºä»€ä¹ˆï¼Œå¦‚ä½•æ‰“å°å‡º0åˆ°4ï¼Ÿ</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( i ); <br>    &#125;, <span class="hljs-number">1000</span>); <br>&#125; <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>, i);<br><br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢çš„iå…¶å®å¼•ç”¨çš„æ˜¯æœ€åä¸€æ¬¡içš„å€¼ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯0,1,2,3,4â€¦å‘¢ï¼Ÿå› ä¸ºåœ¨ä½ forå¾ªç¯çš„æ—¶å€™ï¼Œä½ å¹¶æ²¡æœ‰æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œä½ è¿™ä¸ªå‡½æ•°æ˜¯è¿‡ä¸€ç§’æ‰æ‰§è¡Œçš„ï¼Œå½“æ‰§è¡Œè¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œå®ƒå‘ç°å®ƒè‡ªå·±æ²¡æœ‰è¿™ä¸ªå˜é‡iï¼Œäºæ˜¯å‘å®ƒçš„ä½œç”¨åŸŸé“¾ä¸­æŸ¥æ‰¾è¿™ä¸ªå˜é‡iï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™å·²ç»forå¾ªç¯å®Œäº†ï¼Œæ‰€ä»¥å‚¨å­˜åœ¨ä½œç”¨åŸŸé“¾é‡Œé¢çš„içš„å€¼å°±æ˜¯5ï¼Œæœ€åå°±æ‰“å°å‡ºæ¥5äº†ã€‚</p><p>åˆ©ç”¨é—­åŒ…è§£å†³ï¼Œé€šè¿‡è‡ªæ‰§è¡Œå‡½æ•°ï¼Œå°†å˜é‡iä¿å­˜åˆ°è¯¥å‡½æ•°çš„å‚æ•°ä¸­ï¼Œå»¶é•¿å…¶ç”Ÿå‘½å‘¨æœŸã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123; <br>    (<span class="hljs-keyword">function</span>(<span class="hljs-params">j</span>) &#123;  <br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; <br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(j);<br>        &#125;, <span class="hljs-number">1000</span>); <br>    &#125;)(i); <br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i);<br></code></pre></td></tr></table></figure><h3 id="é—­åŒ…çš„æ›´å¤šä½œç”¨"><a href="#é—­åŒ…çš„æ›´å¤šä½œç”¨" class="headerlink" title="é—­åŒ…çš„æ›´å¤šä½œç”¨"></a>é—­åŒ…çš„æ›´å¤šä½œç”¨</h3><ol><li>å°è£…å˜é‡</li></ol><p>å¦‚æœä¸€å¤§å—ä»£ç ä¸­ä¸­å­˜åœ¨å¯ç‹¬ç«‹çš„å°ä»£ç å—ï¼Œæˆ‘ä»¬é€šå¸¸å°†å…¶å°è£…åœ¨ç‹¬ç«‹çš„å°å‡½æ•°ä¸­ï¼Œç‹¬ç«‹å‡ºæ¥çš„å°å‡½æ•°æœ‰åŠ©äºå¤ç”¨ï¼Œå¦‚æœå®ƒä»¬ä¸éœ€è¦åœ¨ç¨‹åºçš„å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œæœ€å¥½ç”¨é—­åŒ…å°†å®ƒä»¬å°é—­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> mult = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> cache = &#123;&#125;<br>    <span class="hljs-keyword">var</span> calculate = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i &lt; l; i++ ) &#123;<br>            a = a * <span class="hljs-variable language_">arguments</span>[i]<br>        &#125;<br>        <span class="hljs-keyword">return</span> a<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> args = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">join</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>, <span class="hljs-string">&#x27;,&#x27;</span>);<br>        <span class="hljs-keyword">if</span>(args <span class="hljs-keyword">in</span> cache) &#123;<br>            <span class="hljs-keyword">return</span> cache[args]<br>        &#125;<br>        <span class="hljs-keyword">return</span> cache[args] = calculate.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, <span class="hljs-variable language_">arguments</span>)<br>    &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure><ol start="2"><li>å»¶ç»­å±€éƒ¨å˜é‡å¯¿å‘½</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> report = (<span class="hljs-title function_">fucntion</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> imgs = []<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">src</span>) &#123;<br>        <span class="hljs-keyword">var</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>()<br>        imgs.<span class="hljs-title function_">push</span>(img)<br>        img.<span class="hljs-property">src</span> = src<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="é—­åŒ…å’Œé¢å‘å¯¹è±¡è®¾è®¡"><a href="#é—­åŒ…å’Œé¢å‘å¯¹è±¡è®¾è®¡" class="headerlink" title="é—­åŒ…å’Œé¢å‘å¯¹è±¡è®¾è®¡"></a>é—­åŒ…å’Œé¢å‘å¯¹è±¡è®¾è®¡</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// é—­åŒ…å†™æ³•</span><br><span class="hljs-keyword">var</span> extent = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> value = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">call</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>            value++<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value)<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> extent = <span class="hljs-title function_">extent</span>();<br>extent.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š1 </span><br>extent.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š2 </span><br>extent.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š3</span><br><br><span class="hljs-comment">// é¢å‘å¯¹è±¡</span><br><span class="hljs-keyword">var</span> extent2 = &#123;<br>    <span class="hljs-attr">value</span>:<span class="hljs-number">0</span>,<br>    <span class="hljs-attr">call</span>:<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>++<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>)<br>    &#125;<br>&#125;<br><br>extent2.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š1 </span><br>extent2.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š2 </span><br>extent2.<span class="hljs-title function_">call</span>(); <span class="hljs-comment">// è¾“å‡ºï¼š3</span><br></code></pre></td></tr></table></figure><h3 id="ç”¨é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼"><a href="#ç”¨é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼" class="headerlink" title="ç”¨é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼"></a>ç”¨é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span> <br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;undo&quot;</span>&gt;</span>ç‚¹å‡»æˆ‘æ‰§è¡Œå‘½ä»¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;execute&quot;</span>&gt;</span>ç‚¹å‡»æˆ‘æ‰§è¡Œå‘½ä»¤<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"> </span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> <span class="hljs-title class_">Tv</span> = &#123; </span><br><span class="language-javascript">                 <span class="hljs-attr">open</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;æ‰“å¼€ç”µè§†æœº&#x27;</span> ); </span><br><span class="language-javascript">                 &#125;, </span><br><span class="language-javascript">                 <span class="hljs-attr">close</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-string">&#x27;å…³ä¸Šç”µè§†æœº&#x27;</span> ); </span><br><span class="language-javascript">                 &#125; </span><br><span class="language-javascript">            &#125;; </span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> <span class="hljs-title class_">OpenTvCommand</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"> receiver </span>)&#123; </span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span> = receiver; </span><br><span class="language-javascript">            &#125;; </span><br><span class="language-javascript">            <span class="hljs-title class_">OpenTvCommand</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">execute</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span>.<span class="hljs-title function_">open</span>(); <span class="hljs-comment">// æ‰§è¡Œå‘½ä»¤ï¼Œæ‰“å¼€ç”µè§†æœº</span></span><br><span class="language-javascript">            &#125;; </span><br><span class="language-javascript">            <span class="hljs-title class_">OpenTvCommand</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">undo</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">receiver</span>.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// æ’¤é”€å‘½ä»¤ï¼Œå…³é—­ç”µè§†æœº</span></span><br><span class="language-javascript">            &#125;; </span><br><span class="language-javascript">            <span class="hljs-keyword">var</span> setCommand = <span class="hljs-keyword">function</span>(<span class="hljs-params"> command </span>)&#123; </span><br><span class="language-javascript">                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>( <span class="hljs-string">&#x27;execute&#x27;</span> ).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                    command.<span class="hljs-title function_">execute</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šæ‰“å¼€ç”µè§†æœº</span></span><br><span class="language-javascript">                 &#125; </span><br><span class="language-javascript">                 <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>( <span class="hljs-string">&#x27;undo&#x27;</span> ).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; </span><br><span class="language-javascript">                    command.<span class="hljs-title function_">undo</span>(); <span class="hljs-comment">// è¾“å‡ºï¼šå…³é—­ç”µè§†æœº</span></span><br><span class="language-javascript">                 &#125; </span><br><span class="language-javascript">            &#125;; </span><br><span class="language-javascript">            <span class="hljs-title function_">setCommand</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">OpenTvCommand</span>( <span class="hljs-title class_">Tv</span> ) ); </span><br><span class="language-javascript">        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span> <br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h2><blockquote><p>å³å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ŒæŒ‡å‡½æ•°ä½œä¸ºå‚æ•°æˆ–å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡ºçš„å‡½æ•°ã€‚</p></blockquote><h3 id="å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’"><a href="#å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’" class="headerlink" title="å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’"></a>å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’</h3><ol><li><p>å›è°ƒå‡½æ•°</p><ul><li>å¼‚æ­¥å›è°ƒ</li></ul> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">var</span> getUserInfo = <span class="hljs-keyword">function</span>(<span class="hljs-params">userId, cb</span>) &#123;<br>    $.<span class="hljs-title function_">ajax</span>(<span class="hljs-string">&#x27;http://xxx.com/getUserInfo?&#x27;</span> + userId , <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> cb === <span class="hljs-string">&#x27;function&#x27;</span>) &#123;<br>            <span class="hljs-title function_">cb</span>(data)<br>        &#125;<br>    &#125;)<br>&#125;<br><br><span class="hljs-title function_">getUserInfo</span>(<span class="hljs-number">10086</span>, <span class="hljs-function">(<span class="hljs-params">data</span>)=&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>&#125;)<br><br></code></pre></td></tr></table></figure><ul><li>äº‹ä»¶å§”æ‰˜</li></ul> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> appendDiv = <span class="hljs-keyword">function</span>(<span class="hljs-params"> callback </span>)&#123; <br>    <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++ )&#123; <br>        <span class="hljs-keyword">var</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;div&#x27;</span> ); <br>        div.<span class="hljs-property">innerHTML</span> = i; <br>        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>( div ); <br>        <span class="hljs-keyword">if</span> ( <span class="hljs-keyword">typeof</span> callback === <span class="hljs-string">&#x27;function&#x27;</span> )&#123; <br>        <span class="hljs-title function_">callback</span>( div ); <br>        &#125; <br>    &#125; <br>&#125;; <br><span class="hljs-title function_">appendDiv</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"> node </span>)&#123; <br>    node.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>; <br>&#125;);<br></code></pre></td></tr></table></figure></li><li><p>Array.prototype.sort</p></li></ol><p>Array.prototype.sortæ¥å—ä¸€ä¸ªå‡½æ•°å½“ä½œå‚æ•°ï¼Œå‡½æ•°å†…å°è£…äº†æ•°ç»„å…ƒç´ çš„æ’åºè§„åˆ™ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨ç”¨ä»€ä¹ˆè§„åˆ™æ’åºï¼Œè¿™æ˜¯å¯å˜çš„ï¼Œè€Œå¯¹æ•°ç»„æ’åºåˆ™æ˜¯ä¸å˜çš„ã€‚æŠŠå¯å˜çš„éƒ¨åˆ†å°è£…åœ¨å‡½æ•°å‚æ•°é‡Œï¼ŒåŠ¨æ€ä¼ å…¥Array.prototype.sortï¼Œä½¿ä¹‹æ›´åŠ çµæ´»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// ä»å°åˆ°å¤§</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> a - b<br>&#125;)<br><span class="hljs-comment">// ä»å¤§åˆ°å°</span><br>[<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span>].<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>)=&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> b - a<br>&#125;)<br></code></pre></td></tr></table></figure><h3 id="å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡º"><a href="#å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡º" class="headerlink" title="å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡º"></a>å‡½æ•°ä½œä¸ºè¿”å›å€¼è¾“å‡º</h3><ol><li>åˆ¤æ–­æ•°æ®ç±»å‹</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> isType = <span class="hljs-keyword">function</span>(<span class="hljs-params"> type </span>)&#123; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"> obj </span>)&#123; <br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>( obj ) === <span class="hljs-string">&#x27;[object &#x27;</span>+ type +<span class="hljs-string">&#x27;]&#x27;</span>; <br>    &#125; <br>&#125;;<br><br><span class="hljs-keyword">var</span> isString = <span class="hljs-title function_">isType</span>( <span class="hljs-string">&#x27;String&#x27;</span> ); <br><span class="hljs-keyword">var</span> isArray = <span class="hljs-title function_">isType</span>( <span class="hljs-string">&#x27;Array&#x27;</span> ); <br><span class="hljs-keyword">var</span> isNumber = <span class="hljs-title function_">isType</span>( <span class="hljs-string">&#x27;Number&#x27;</span> ); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">isArray</span>( [ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ] ) ); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span><br></code></pre></td></tr></table></figure><ol start="2"><li>getSingle</li></ol><p>å•ä¾‹æ¨¡å¼ï¼Œåç»­è®¾è®¡æ¨¡å¼ç« èŠ‚ä¼šæœ‰è¯¦ç»†ä»‹ç»</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> getSingle = <span class="hljs-keyword">function</span> (<span class="hljs-params"> fn </span>) &#123; <br>    <span class="hljs-keyword">var</span> ret; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <br>        <span class="hljs-keyword">return</span> ret || ( ret = fn.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, <span class="hljs-variable language_">arguments</span> ) ); <br>    &#125;; <br>&#125;;<br></code></pre></td></tr></table></figure><p>è¿™é‡ŒgetSingleæ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œå°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œåˆè®©å‡½æ•°æ‰§è¡Œåè¿”å›å¦ä¸€ä¸ªå‡½æ•°ï¼Œçœ‹çœ‹æ•ˆæœã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> getScript = <span class="hljs-title function_">getSingle</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>( <span class="hljs-string">&#x27;script&#x27;</span> ); <br>&#125;); <br><span class="hljs-keyword">var</span> script1 = <span class="hljs-title function_">getScript</span>(); <br><span class="hljs-keyword">var</span> script2 = <span class="hljs-title function_">getScript</span>(); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( script1 === script2 ); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><h3 id="é«˜é˜¶å‡½æ•°å®ç°AOP"><a href="#é«˜é˜¶å‡½æ•°å®ç°AOP" class="headerlink" title="é«˜é˜¶å‡½æ•°å®ç°AOP"></a>é«˜é˜¶å‡½æ•°å®ç°AOP</h3><p>AOPå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œä¸»è¦ä½œç”¨æ˜¯å°†ä¸€äº›ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ— å…³çš„ä»£ç æŠ½ç¦»ï¼Œé€šå¸¸åŒ…æ‹¬æ—¥å¿—ç»Ÿè®¡ã€å®‰å…¨æ§åˆ¶ã€å¼‚å¸¸å¤„ç†ç­‰ã€‚æŠŠè¿™äº›åŠŸèƒ½æŠ½ç¦»å‡ºæ¥åï¼Œå†é€šè¿‡â€œåŠ¨æ€ç»‡å…¥â€çš„æ–¹å¼æºå…¥ä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥ä¿æŒä¸šåŠ¡é€»è¾‘çš„çº¯å‡€ä¸é«˜å†…èšï¼Œä¸”å¯ä»¥æ–¹ä¾¿çš„å¤ç”¨æŠ½ç¦»çš„åŠŸèƒ½æ¨¡å—ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">before</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">beforeFn</span>) &#123;<br>    <span class="hljs-keyword">var</span> _self = <span class="hljs-variable language_">this</span> <span class="hljs-comment">// ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; <span class="hljs-comment">// è¿”å›åŒ…å«åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„ä»£ç†å‡½æ•°</span><br>        beforeFn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span> , <span class="hljs-variable language_">arguments</span>) <span class="hljs-comment">// æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¿®æ­£this</span><br>        <span class="hljs-keyword">return</span> _self.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span> , <span class="hljs-variable language_">arguments</span>) <span class="hljs-comment">// æ‰§è¡ŒåŸå‡½æ•°</span><br>    &#125;<br>&#125;<br><br><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">after</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">afterFn</span>) &#123;<br>    <span class="hljs-keyword">var</span> _self = <span class="hljs-variable language_">this</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> ret = _self.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span> , <span class="hljs-variable language_">arguments</span>)<br>        afterFn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span> , <span class="hljs-variable language_">arguments</span>)<br>        <span class="hljs-keyword">return</span> ret<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;å‡½æ•°æ‰§è¡Œ&#x27;</span>)<br>&#125;<br><br>foo = foo.<span class="hljs-title function_">before</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;before&#x27;</span>)<br>&#125;).<span class="hljs-title function_">after</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;after&#x27;</span>)<br>&#125;)<br><br><span class="hljs-title function_">foo</span>()<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa517e1c9c7149c5b640782e6afff01c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h3 id="é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨"><a href="#é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨" class="headerlink" title="é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨"></a>é«˜é˜¶å‡½æ•°çš„å…¶ä»–åº”ç”¨</h3><ol><li>å‡½æ•°æŸ¯é‡ŒåŒ–ï¼ˆcurryingï¼‰</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> currying = <span class="hljs-keyword">function</span>(<span class="hljs-params"> fn </span>)&#123; <br>    <span class="hljs-keyword">var</span> args = []; <br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>            <span class="hljs-keyword">if</span> ( <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> )&#123; <br>                <span class="hljs-keyword">return</span> fn.<span class="hljs-title function_">apply</span>( <span class="hljs-variable language_">this</span>, args ); <br>            &#125;<span class="hljs-keyword">else</span>&#123; <br>                [].<span class="hljs-property">push</span>.<span class="hljs-title function_">apply</span>( args, <span class="hljs-variable language_">arguments</span> ); <br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">callee</span>; <br>            &#125; <br>        &#125; <br>    &#125;; <br>    <span class="hljs-keyword">var</span> cost = (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-keyword">var</span> money = <span class="hljs-number">0</span>; <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>        <span class="hljs-keyword">for</span> ( <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>; i &lt; l; i++ )&#123; <br>            money += <span class="hljs-variable language_">arguments</span>[ i ]; <br>        &#125; <br>        <span class="hljs-keyword">return</span> money; <br>    &#125; <br>&#125;)(); <br><span class="hljs-keyword">var</span> cost = <span class="hljs-title function_">currying</span>( cost ); <span class="hljs-comment">// è½¬åŒ–æˆ currying å‡½æ•°</span><br><span class="hljs-title function_">cost</span>( <span class="hljs-number">100</span> ); <span class="hljs-comment">// æœªçœŸæ­£æ±‚å€¼</span><br><span class="hljs-title function_">cost</span>( <span class="hljs-number">200</span> ); <span class="hljs-comment">// æœªçœŸæ­£æ±‚å€¼ </span><br><span class="hljs-title function_">cost</span>( <span class="hljs-number">300</span> ); <span class="hljs-comment">// æœªçœŸæ­£æ±‚å€¼</span><br>alert ( <span class="hljs-title function_">cost</span>() ); <span class="hljs-comment">// æ±‚å€¼å¹¶è¾“å‡ºï¼š600</span><br></code></pre></td></tr></table></figure><ol start="2"><li>uncurrying</li></ol><p>ç®€å•æ¥è¯´ï¼Œuncurryingå‡½æ•°æ˜¯å®ç°ä»åˆ«çš„å¯¹è±¡ä¸­èµ‹å€¼æ–¹æ³•ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸å¸¸è®©ç±»æ•°ç»„å¯¹è±¡å»å€Ÿç”¨Array.prototypeä¸Šçš„æ–¹æ³•ï¼Œè¿™æ˜¯callå’Œapplyæœ€å¸¸è§çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">push</span>.<span class="hljs-title function_">call</span>( <span class="hljs-variable language_">arguments</span>, <span class="hljs-number">4</span> ); <span class="hljs-comment">// arguments å€Ÿç”¨ Array.prototype.push æ–¹æ³•</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">arguments</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š[1, 2, 3, 4] </span><br>&#125;)( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> );<br></code></pre></td></tr></table></figure><p>uncurryingç”¨æ¥è§£å†³å°†æ³›åŒ–thisçš„è¿‡ç¨‹æå–å‡ºæ¥çš„é—®é¢˜ã€‚ä¸‹é¢æ˜¯uncurryingçš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">uncurrying</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> obj = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">arguments</span>);<br>        <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">apply</span>(obj , <span class="hljs-variable language_">arguments</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹çœ‹å®ƒçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œåœ¨ç±»æ•°ç»„å¯¹è±¡argumentså€Ÿç”¨Array.prototypeçš„æ–¹æ³•ä¹‹å‰ï¼Œå…ˆæŠŠArray.prototype.push.callè½¬æ¢ä¸ºä¸€ä¸ªé€šç”¨çš„pushå‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> push = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">push</span>.<span class="hljs-title function_">uncurrying</span>(); <br>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123; <br>    <span class="hljs-title function_">push</span>( <span class="hljs-variable language_">arguments</span>, <span class="hljs-number">4</span> ); <br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">arguments</span> ); <span class="hljs-comment">// è¾“å‡ºï¼š[1, 2, 3, 4] </span><br>&#125;)( <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> );<br></code></pre></td></tr></table></figure><p>é€šè¿‡uncurryingï¼Œå°†Array.prototype.push.callå˜æˆäº†ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œè¿™æ ·pushçš„ä½œç”¨ä¸Array.prototype.pushç›¸åŒï¼Œä¸ä»…ä»…å±€é™äºæ™ºèƒ½æ“ä½œæ•°ç»„ï¼Œè€Œä½¿ç”¨è€…å¯¹æ–¹æ³•ä¹Ÿæ›´ç®€æ´å’Œæ„å›¾æ˜äº†ã€‚ç°åœ¨é€šè¿‡pushæ¥çœ‹çœ‹è°ƒç”¨uncurryingæ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Function</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">uncurrying</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <br>    <span class="hljs-keyword">var</span> self = <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// self æ­¤æ—¶æ˜¯ Array.prototype.push </span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123; <br>        <span class="hljs-keyword">var</span> obj = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">shift</span>.<span class="hljs-title function_">call</span>( <span class="hljs-variable language_">arguments</span> ); <br>        <span class="hljs-comment">// obj æ˜¯&#123; </span><br>        <span class="hljs-comment">// &quot;length&quot;: 1, </span><br>        <span class="hljs-comment">// &quot;0&quot;: 1 </span><br>        <span class="hljs-comment">// &#125; </span><br>        <span class="hljs-comment">// arguments å¯¹è±¡çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¢«æˆªå»ï¼Œå‰©ä¸‹[2] </span><br>        <span class="hljs-keyword">return</span> self.<span class="hljs-title function_">apply</span>( obj, <span class="hljs-variable language_">arguments</span> ); <br>        <span class="hljs-comment">// ç›¸å½“äº Array.prototype.push.apply( obj, 2 ) </span><br>    &#125;; <br>&#125;; <br><span class="hljs-keyword">var</span> push = <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">push</span>.<span class="hljs-title function_">uncurrying</span>(); <br><span class="hljs-keyword">var</span> obj = &#123; <br>    <span class="hljs-string">&quot;length&quot;</span>: <span class="hljs-number">1</span>, <br>    <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-number">1</span> <br>&#125;; <br><span class="hljs-title function_">push</span>( obj, <span class="hljs-number">2</span> ); <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( obj ); <span class="hljs-comment">// è¾“å‡ºï¼š&#123;0: 1, 1: 2, length: 2&#125;</span><br></code></pre></td></tr></table></figure><ol start="3"><li>å‡½æ•°èŠ‚æµï¼ˆä¸å±•å¼€è¯´äº†ï¼Œå…«è‚¡æ–‡ç³»åˆ—ï¼‰</li></ol>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆäºŒï¼‰</title>
    <link href="/2021/06/21/Cesium%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84/"/>
    <url>/2021/06/21/Cesium%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84/</url>
    
    <content type="html"><![CDATA[<h3 id="Web-Worker"><a href="#Web-Worker" class="headerlink" title="Web Worker"></a>Web Worker</h3><h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavaScriptæ˜¯å•çº¿ç¨‹æ¨¡å‹ï¼Œæ‰€æœ‰çš„ä»»åŠ¡åªèƒ½åœ¨åŒä¸€æ¡çº¿ç¨‹ä¸Šè¿›è¡Œå®Œæˆï¼Œå‰è¾¹çš„ä»»åŠ¡æœªå®Œæˆåˆ™åç»­ä»»åŠ¡åªèƒ½ç­‰å¾…ï¼Œæ‰€ä»¥åœ¨Hä¸­å¼•å…¥äº†Web Workerï¼Œä¸ºJavaScriptåˆ›å»ºä¸€ä¸ªå¤šçº¿ç¨‹çš„ç¯å¢ƒï¼Œå°†éƒ¨åˆ†ä»»åŠ¡æä¾›ç»™å®ƒåœ¨åå°è¿è¡Œï¼Œå‰å°åå°åŒæ—¶è¿è¡Œã€‚</p><p>Web Workeræ˜¯åå°è¿è¡Œçš„JavaScriptï¼Œå®ƒç‹¬ç«‹äºå…¶ä»–è„šæœ¬ä¸”ä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚å¼•å…¥Web Workerçš„å¥½å¤„æ˜¯ä¸€äº›è®¡ç®—å¯†é›†å‹æˆ–é«˜å»¶è¿Ÿçš„ä»»åŠ¡ï¼Œè¢« Web Worker çº¿ç¨‹æ‰€å¤„ç†ï¼Œä¸»çº¿ç¨‹å°±ä¼šå¾ˆæµç•…ï¼Œä¸ä¼šè¢«é˜»å¡æˆ–æ‹–æ…¢ï¼Œè€Œæ­¤æ—¶ Web Worker åœ¨åå°è¿è¡Œã€‚ä½†æ˜¯è¿™ä¹Ÿæ­£æ˜¯ Web Worker æ¯”è¾ƒè€—è´¹èµ„æºçš„åŸå› ã€‚</p><h4 id="æµè§ˆå™¨æ”¯æŒåŠä½¿ç”¨"><a href="#æµè§ˆå™¨æ”¯æŒåŠä½¿ç”¨" class="headerlink" title="æµè§ˆå™¨æ”¯æŒåŠä½¿ç”¨"></a>æµè§ˆå™¨æ”¯æŒåŠä½¿ç”¨</h4><p>é™¤äº†IEå¤–æ‰€æœ‰ä¸»æµæµè§ˆå™¨å‡æ”¯æŒWeb Workerã€‚</p><p>å¯åœ¨åˆ›å»ºWorkerä¹‹å‰æ£€æµ‹æ˜¯å¦æ”¯æŒ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span>(<span class="hljs-title function_">typeof</span>(<span class="hljs-title class_">Worker</span>)!==<span class="hljs-string">&quot;undefined&quot;</span>) &#123;<br>    <span class="hljs-comment">// æ”¯æŒ.....</span><br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// ä¸æ”¯æŒ..</span><br>&#125;<br></code></pre></td></tr></table></figure><p>Web Workeråœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸­è¿è¡Œï¼Œæ‰€ä»¥ä»£ç éœ€è¦æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚åŠ è½½æ—¶å¦‚æœå­˜åœ¨æŒ‡å®šæ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šåœ¨æ–‡ä»¶ä¸‹è½½å®Œæ¯•åæ‰§è¡Œï¼Œç”Ÿæˆæ–°çš„Workerçº¿ç¨‹ï¼Œå¦‚æœåŠ è½½æ–‡ä»¶å¤±è´¥ä¸ä¼šæœ‰ä»»ä½•æç¤ºã€‚</p><p>åˆ›å»ºWorkerååˆ©ç”¨<code>postMessage()</code>å¯åŠ¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">&#x27;worker.js&#x27;</span>);<br><span class="hljs-keyword">var</span> info = <span class="hljs-string">&#x27;start worker!&#x27;</span><br>worker.<span class="hljs-title function_">postMessage</span>(info);<br></code></pre></td></tr></table></figure><p>åœ¨Workerä¸­ä½¿ç”¨<code>onmessge</code>äº‹ä»¶æ¥æ”¶ä¸»çº¿ç¨‹çš„æ¶ˆæ¯æ¥å®ç°ä¸€äº›æ“ä½œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">onmessage = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> data = e.<span class="hljs-property">data</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œä»Workerå‘æ¶ˆæ¯åˆ°ä¸»çº¿ç¨‹ä¹Ÿé‡‡ç”¨åŒæ ·æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Receive the message from the main thread</span><br>onmessage = <span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-keyword">var</span> info = e.<span class="hljs-property">data</span>;<br>    <span class="hljs-keyword">var</span> result = info + <span class="hljs-string">&#x27; get&#x27;</span>;<br>    <span class="hljs-title function_">postMessage</span>(result);<br>&#125;;<br></code></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ä½¿ç”¨<code>addEventListener</code>æ¥æ›¿æ¢<code>onmessage</code></p></blockquote><p>åœæ­¢Workeræœ‰ä¸¤ç§æ–¹æ³•ï¼Œåœ¨ä¸»çº¿ç¨‹ä¸­è°ƒç”¨<code>worker.terminate()</code>æˆ–åœ¨å†…éƒ¨è°ƒç”¨<code>self.close()</code>å‡å¯ã€‚åœ¨ä»»åŠ¡ç»“æŸåä¸€å®šè¦åœæ­¢ï¼Œå› ä¸ºWorkerä¼šä¸€ç›´åœ¨åå°è¿è¡Œè€—è´¹èµ„æºï¼Œä¸åº”è¯¥è¿‡åº¦ä½¿ç”¨ã€‚</p><h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><ul><li>ä¸»çº¿ç¨‹ä¸Workerä¹‹é—´ä¼ é€’çš„æ¶ˆæ¯ä¸æ˜¯å…±äº«çš„ï¼Œå› ä¸ºç³»ç»Ÿå°†æ¶ˆæ¯å¯¹è±¡ä¼ é€’ç»™Workeråä¼šå°†å…¶åºåˆ—åŒ–ï¼Œåœ¨å¦ä¸€ç«¯å†å–æ¶ˆåºåˆ—åŒ–ã€‚å¤§éƒ¨åˆ†æµè§ˆå™¨é€šè¿‡JSONçš„ç¼–ç è§£ç å®ç°ã€‚</li><li>Workerçš„selfå’Œthiséƒ½æ˜¯Workerçš„å…¨å±€ä½œç”¨åŸŸã€‚</li><li>Workeræ— æ³•å¤„ç†DOMï¼Œæ— æ³•ä½¿ç”¨windowå¯¹è±¡ã€documentå¯¹è±¡ç­‰ã€‚</li><li>Workerå¯ä»¥ç”Ÿæˆå­Worker,ä½†éœ€è¦æ³¨æ„ï¼šå­Workerå¿…é¡»å’Œçˆ¶çº¿ç¨‹å¤„åœ¨ç›¸åŒoriginä¸­ï¼Œå…¶ä¸­çš„URIåº”ç›¸å¯¹äºçˆ¶Workerä½ç½®è§£æã€‚</li></ul><h3 id="Cesiumçš„å¼‚æ­¥ï¼‹å¤šçº¿ç¨‹"><a href="#Cesiumçš„å¼‚æ­¥ï¼‹å¤šçº¿ç¨‹" class="headerlink" title="Cesiumçš„å¼‚æ­¥ï¼‹å¤šçº¿ç¨‹"></a>Cesiumçš„å¼‚æ­¥ï¼‹å¤šçº¿ç¨‹</h3><p>Cesiumä¸­æ¶‰åŠåˆ°å¤§é‡ä¸‰ç»´çƒè®¡ç®—å’Œå¤§æ•°æ®é‡äº¤äº’ï¼Œæ¯”å¦‚ä¸‰è§’ç½‘ï¼Œå‚æ•°åŒ–Geometryç­‰ï¼Œéƒ½æ˜¯åœ¨Workerä¸­å®ç°çš„ï¼Œå‚æ•°çš„ä¼ é€’ä»¥åŠä¸åŒç±»å‹å¯¹åº”çš„ä¸åŒç®—æ³•ã€‚</p><p>Cesiumæºç ä¸­<code>Source\Core\TaskProcessor.js</code>å†…ä¸ºCesiumå°è£…çš„Workerã€‚æˆ‘ä»¬ç®€å•æ¥çœ‹ä¸€ä¸‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">TaskProcessor</span>(<span class="hljs-params">workerPath, maximumActiveTasks</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_workerPath</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(workerPath).<span class="hljs-title function_">isAbsolute</span>()<br>        ? workerPath<br>    : <span class="hljs-title class_">TaskProcessor</span>.<span class="hljs-property">_workerModulePrefix</span> + workerPath;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_maximumActiveTasks</span> = <span class="hljs-title function_">defaultValue</span>(<br>        maximumActiveTasks,<br>        <span class="hljs-title class_">Number</span>.<span class="hljs-property">POSITIVE_INFINITY</span><br>    );<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_activeTasks</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_deferreds</span> = &#123;&#125;;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_nextID</span> = <span class="hljs-number">0</span>;<br>&#125;<br><br><br><span class="hljs-title class_">TaskProcessor</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">scheduleTask</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span><br><span class="hljs-params">parameters,</span><br><span class="hljs-params"> transferableObjects</span><br><span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_worker</span>)) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_worker</span> = <span class="hljs-title function_">createWorker</span>(<span class="hljs-variable language_">this</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// â€¦â€¦</span><br><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">when</span>(<span class="hljs-title function_">canTransferArrayBuffer</span>(), <span class="hljs-keyword">function</span> (<span class="hljs-params">canTransferArrayBuffer</span>) &#123;<br>        <span class="hljs-comment">// â€¦â€¦</span><br><br>        <span class="hljs-keyword">return</span> deferred.<span class="hljs-property">promise</span>;<br>    &#125;);<br>&#125;;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨æ—¶åªéœ€è¦åˆ›å»ºä¸€ä¸ªTaskProcessorï¼ŒæŒ‡å®šç±»å‹ï¼Œç„¶åè°ƒç”¨scheduleTaskï¼Œæ¥æ”¶å¯¹åº”å…·ä½“å‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å¼‚æ­¥çš„è·å–çš„å¯¹åº”ç»“æœã€‚</p><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> taskProcessor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TaskProcessor</span>(<span class="hljs-string">&#x27;myWorkerPath&#x27;</span>);<br><span class="hljs-keyword">var</span> promise = taskProcessor.<span class="hljs-title function_">scheduleTask</span>(&#123;<br>    someParameter : <span class="hljs-literal">true</span>,<br>    another : <span class="hljs-string">&#x27;hello&#x27;</span><br>&#125;);<br><span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Cesium</span>.<span class="hljs-title function_">defined</span>(promise)) &#123;<br>    <span class="hljs-comment">// too many active tasks - try again later</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-title function_">when</span>(promise, <span class="hljs-keyword">function</span>(<span class="hljs-params">result</span>) &#123;<br>        <span class="hljs-comment">// use the result of the task</span><br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cesium | Primitiveå›¾å…ƒä»‹ç»åŠä¸Entityå¯¹æ¯”</title>
    <link href="/2021/06/17/Cesium%E4%B8%ADPrimitive%E5%9B%BE%E5%85%83%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%B8%8EEntity%E5%AF%B9%E6%AF%94/"/>
    <url>/2021/06/17/Cesium%E4%B8%ADPrimitive%E5%9B%BE%E5%85%83%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%B8%8EEntity%E5%AF%B9%E6%AF%94/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†ä½¿ç”¨çš„æ·»åŠ å®ä½“çš„æ–¹å¼éƒ½æ˜¯entityæ·»åŠ ï¼Œè€Œåœ¨æ€§èƒ½ä¼˜åŒ–ä¸­æˆ‘ä»¬æåˆ°äº†primitiveæ·»åŠ çš„æ–¹å¼ï¼Œentityåœ¨æœ¬æ–‡å°±ä¸å¤šåšä»‹ç»äº†ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»ä¸€ä¸‹primitiveç›¸å…³çŸ¥è¯†ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯Primitive"><a href="#ä»€ä¹ˆæ˜¯Primitive" class="headerlink" title="ä»€ä¹ˆæ˜¯Primitive"></a>ä»€ä¹ˆæ˜¯Primitive</h2><p>é¦–å…ˆæˆ‘ä»¬åœ¨Cesium APIæ–‡æ¡£ä¸­æœç´¢primitiveï¼Œçœ‹æ–‡æ¡£ä¸­å¯¹Primitiveç±»çš„ä»‹ç»ï¼Œç¿»è¯‘è¿‡æ¥å¤§è‡´å¦‚ä¸‹ï¼š</p><blockquote><p>å›¾å…ƒä»£è¡¨åœºæ™¯ä¸­çš„å‡ ä½•ä½“ã€‚ å‡ ä½•å¯ä»¥æ¥è‡ªå•ä¸ª GeometryInstanceï¼Œä¹Ÿå¯ä»¥æ¥è‡ªå®ä¾‹æ•°ç»„ï¼Œå³ä½¿geometry æ¥è‡ªä¸åŒçš„å‡ ä½•ç±»å‹ã€‚å›¾å…ƒå°†geometry å®ä¾‹ä¸æè¿°å®Œæ•´ç€è‰²çš„ Appearance ç›¸ç»“åˆï¼ŒåŒ…æ‹¬ Material å’Œ RenderStateã€‚ ç²—ç•¥åœ°è¯´ï¼Œgeometry å®ä¾‹å®šä¹‰äº†ç»“æ„å’Œä½ç½®ï¼Œappearance å®šä¹‰äº†è§†è§‰ç‰¹å¾ã€‚ è§£è€¦geometry å’Œappearance å…è®¸æˆ‘ä»¬æ··åˆå’ŒåŒ¹é…å®ƒä»¬ä¸­çš„å¤§éƒ¨åˆ†ï¼Œå¹¶ç›¸äº’ç‹¬ç«‹åœ°æ·»åŠ æ–°çš„geometry æˆ–appearance ã€‚</p><p>å°†å¤šä¸ªå®ä¾‹ç»„åˆæˆä¸€ä¸ªåŸè¯­ç§°ä¸ºæ‰¹å¤„ç†ï¼Œå¯æ˜¾ç€æé«˜é™æ€æ•°æ®çš„æ€§èƒ½ã€‚ å®ä¾‹å¯ä»¥å•ç‹¬æŒ‘é€‰ï¼› Scene#pick è¿”å›å®ƒä»¬çš„ GeometryInstance#idã€‚ ä½¿ç”¨ PerInstanceColorAppearance ç­‰æ¯ä¸ªå®ä¾‹çš„å¤–è§‚ï¼Œæ¯ä¸ªå®ä¾‹ä¹Ÿå¯ä»¥å…·æœ‰å”¯ä¸€çš„é¢œè‰²ã€‚</p><p><code>Geometry</code>å¯ä»¥åœ¨ web worker æˆ–ä¸»çº¿ç¨‹ä¸Šåˆ›å»ºå’Œæ‰¹å¤„ç†ã€‚</p></blockquote><p>é€šè¿‡é˜…è¯»æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œprimitiveä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šGeometryå’ŒAppearanceã€‚</p><p>Geometryä¸»è¦å®šä¹‰äº†primitiveçš„å‡ ä½•ç»“æ„ï¼Œè€ŒAppearanceä¸»è¦è´Ÿè´£å®šä¹‰primitiveçš„ç€è‰²ï¼ŒåŒ…æ‹¬GLSLé¡¶ç‚¹ç€è‰²å™¨ã€ç‰‡æ®µç€è‰²å™¨å’Œæ¸²æŸ“çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡Primitive APIæ¥æ“æ§å‡ ä½•å›¾å½¢åŠå…¶å¤–è§‚ï¼Œç»˜åˆ¶å„ç§å½¢çŠ¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">GeometryInstance</span>(&#123;<br>  geometry : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">EllipseGeometry</span>(&#123;<br>      center : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(-<span class="hljs-number">100.0</span>, <span class="hljs-number">20.0</span>),<br>      semiMinorAxis : <span class="hljs-number">500000.0</span>,<br>      semiMajorAxis : <span class="hljs-number">1000000.0</span>,<br>      rotation : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-property">PI_OVER_FOUR</span>,<br>      vertexFormat : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VertexFormat</span>.<span class="hljs-property">POSITION_AND_ST</span><br>  &#125;),<br>  id : <span class="hljs-string">&#x27;object returned when this instance is picked and to get/set per-instance attributes&#x27;</span><br>&#125;);<br>scene.<span class="hljs-property">primitives</span>.<span class="hljs-title function_">add</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Primitive</span>(&#123;<br>  geometryInstances : instance,<br>  appearance : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">EllipsoidSurfaceAppearance</span>(&#123;<br>    material : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Material</span>.<span class="hljs-title function_">fromType</span>(<span class="hljs-string">&#x27;Checkerboard&#x27;</span>)<br>  &#125;)<br>&#125;));<br></code></pre></td></tr></table></figure><h3 id="Geometry"><a href="#Geometry" class="headerlink" title="Geometry"></a>Geometry</h3><p>åœ¨Cesiumä¸­ï¼Œæ”¯æŒä»¥ä¸‹å‡ ç§Geometryå‡ ä½•å›¾å½¢</p><table><thead><tr><th>å‡ ä½•å›¾å½¢</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>BoxGeometry</td><td>ç«‹æ–¹ä½“</td></tr><tr><td>BoxOutlineGeometry</td><td>ä»…æœ‰è½®å»“çš„ç«‹æ–¹ä½“ï¼Œåªæœ‰å¤–éƒ¨çº¿æ¡çš„çš„ç›’å­</td></tr><tr><td>CircleGeometry</td><td>åœ†å½¢æˆ–è€…æ‹‰ä¼¸çš„åœ†å½¢ï¼Œåœ†åœˆæˆ–æŒ¤å‹åœ†</td></tr><tr><td>CircleOutlineGeometry</td><td>åªæœ‰è½®å»“çš„åœ†å½¢</td></tr><tr><td>CorridorGeometry</td><td>èµ°å»Šï¼šæ²¿ç€åœ°è¡¨çš„å¤šæ®µçº¿(å‚ç›´äºè¡¨é¢çš„æŠ˜çº¿)ï¼Œä¸”å…·æœ‰ä¸€å®šçš„å®½åº¦ï¼Œå¯ä»¥æ‹‰ä¼¸åˆ°ä¸€å®šçš„é«˜åº¦</td></tr><tr><td>CorridorOutlineGeometry</td><td>åªæœ‰è½®å»“çš„èµ°å»Š</td></tr><tr><td>CylinderGeometry</td><td>åœ†æŸ±ã€åœ†é”¥æˆ–è€…æˆªæ–­çš„åœ†é”¥</td></tr><tr><td>CylinderOutlineGeometry</td><td>åªæœ‰è½®å»“çš„åœ†æŸ±ã€åœ†é”¥æˆ–è€…æˆªæ–­çš„åœ†é”¥</td></tr><tr><td>EllipseGeometry</td><td>æ¤­åœ†æˆ–è€…æ‹‰ä¼¸çš„æ¤­åœ†</td></tr><tr><td>EllipseOutlineGeometry</td><td>åªæœ‰è½®å»“çš„æ¤­åœ†æˆ–è€…æ‹‰ä¼¸çš„æ¤­åœ†</td></tr><tr><td>EllipsoidGeometry</td><td>æ¤­çƒä½“</td></tr><tr><td>EllipsoidOutlineGeometry</td><td>åªæœ‰è½®å»“çš„æ¤­çƒä½“</td></tr><tr><td>RectangleGeometry</td><td>çŸ©å½¢æˆ–è€…æ‹‰ä¼¸çš„çŸ©å½¢</td></tr><tr><td>RectangleOutlineGeometry</td><td>åªæœ‰è½®å»“çš„çŸ©å½¢æˆ–è€…æ‹‰ä¼¸çš„çŸ©å½¢</td></tr><tr><td>PolygonGeometry</td><td>å¤šè¾¹å½¢ï¼Œå¯ä»¥å…·æœ‰ç©ºæ´æˆ–è€…æ‹‰ä¼¸ä¸€å®šçš„é«˜åº¦</td></tr><tr><td>PolygonOutlineGeometry</td><td>åªæœ‰è½®å»“çš„å¤šè¾¹å½¢</td></tr><tr><td>PolylineGeometry</td><td>å¤šæ®µçº¿ï¼Œå¯ä»¥å…·æœ‰ä¸€å®šçš„å®½åº¦</td></tr><tr><td>SimplePolylineGeometry</td><td>ç®€å•çš„å¤šæ®µçº¿</td></tr><tr><td>PolylineVolumeGeometry</td><td>å¤šæ®µçº¿æŸ±ä½“</td></tr><tr><td>PolylineVolumeOutlineGeometry</td><td>åªæœ‰è½®å»“çš„å¤šæ®µçº¿æŸ±ä½“</td></tr><tr><td>SphereGeometry</td><td>çƒä½“</td></tr><tr><td>SphereOutlineGeometry</td><td>åªæœ‰è½®å»“çš„çƒä½“</td></tr><tr><td>WallGeometry</td><td>å¢™</td></tr><tr><td>WallOutlineGeometry</td><td>åªæœ‰è½®å»“çš„å¢™</td></tr></tbody></table><h4 id="Geometry-Instances-å‡ ä½•å›¾å½¢å®ä¾‹"><a href="#Geometry-Instances-å‡ ä½•å›¾å½¢å®ä¾‹" class="headerlink" title="Geometry Instances - å‡ ä½•å›¾å½¢å®ä¾‹"></a>Geometry Instances - å‡ ä½•å›¾å½¢å®ä¾‹</h4><p>åœ¨å‰è¾¹çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç”¨åˆ°äº†å®ƒï¼Œå®ƒç›¸å½“äºGeometryçš„å®¹å™¨ï¼Œè€Œå¤šä¸ªInstanceå¯ä»¥å…¬ç”¨ä¸€ä¸ªGeomotryå¹¶åˆ©ç”¨<code>GeometryInstance.modelMatrix</code>æä¾›å¤šç§å±æ€§ä¿¡æ¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> geometry = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">BoxGeometry</span>.<span class="hljs-title function_">fromDimensions</span>(&#123;<br>  vertexFormat : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VertexFormat</span>.<span class="hljs-property">POSITION_AND_NORMAL</span>,<br>  dimensions : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">1000000.0</span>, <span class="hljs-number">1000000.0</span>, <span class="hljs-number">500000.0</span>)<br>&#125;);<br><span class="hljs-keyword">var</span> instanceBottom = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">GeometryInstance</span>(&#123;<br>  geometry : geometry,<br>  modelMatrix : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Matrix4</span>.<span class="hljs-title function_">multiplyByTranslation</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Transforms</span>.<span class="hljs-title function_">eastNorthUpToFixedFrame</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(-<span class="hljs-number">75.59777</span>, <span class="hljs-number">40.03883</span>)), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1000000.0</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Matrix4</span>()),<br>  attributes : &#123;<br>    color : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ColorGeometryInstanceAttribute</span>.<span class="hljs-title function_">fromColor</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">AQUA</span>)<br>  &#125;,<br>  id : <span class="hljs-string">&#x27;bottom&#x27;</span><br>&#125;);<br><span class="hljs-keyword">var</span> instanceTop = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">GeometryInstance</span>(&#123;<br>  geometry : geometry,<br>  modelMatrix : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Matrix4</span>.<span class="hljs-title function_">multiplyByTranslation</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Transforms</span>.<span class="hljs-title function_">eastNorthUpToFixedFrame</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(-<span class="hljs-number">75.59777</span>, <span class="hljs-number">40.03883</span>)), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">3000000.0</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Matrix4</span>()),<br>  attributes : &#123;<br>    color : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ColorGeometryInstanceAttribute</span>.<span class="hljs-title function_">fromColor</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">AQUA</span>)<br>  &#125;,<br>  id : <span class="hljs-string">&#x27;top&#x27;</span><br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="Combing-Geometries-åˆå¹¶å‡ ä½•å›¾å½¢"><a href="#Combing-Geometries-åˆå¹¶å‡ ä½•å›¾å½¢" class="headerlink" title="Combing Geometries - åˆå¹¶å‡ ä½•å›¾å½¢"></a>Combing Geometries - åˆå¹¶å‡ ä½•å›¾å½¢</h4><p>æˆ‘ä»¬å¯ä»¥åˆå¹¶å¤šä¸ªInstanceä¸ºä¸€ä¸ªPrimitiveï¼Œæé«˜æˆ‘ä»¬çš„æ€§èƒ½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> instances = [<span class="hljs-title class_">Instance1</span>, <span class="hljs-title class_">Instance2</span>, <span class="hljs-title class_">Instance3</span>, â€¦â€¦];<br>scene.<span class="hljs-property">primitives</span>.<span class="hljs-title function_">add</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Primitive</span>( &#123;<br>    geometryInstances : instances, <span class="hljs-comment">//åˆå¹¶</span><br>    <span class="hljs-comment">//æŸäº›å¤–è§‚å…è®¸æ¯ä¸ªå‡ ä½•å›¾å½¢å®ä¾‹åˆ†åˆ«æŒ‡å®šæŸä¸ªå±æ€§ï¼Œä¾‹å¦‚ï¼š</span><br>    appearance : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PerInstanceColorAppearance</span>(&#123;translucent : <span class="hljs-literal">false</span>,closed : <span class="hljs-literal">true</span>&#125;)<br>&#125; ) );<br></code></pre></td></tr></table></figure><h4 id="æ›´æ–°å•ä¸ªInstanceå±æ€§"><a href="#æ›´æ–°å•ä¸ªInstanceå±æ€§" class="headerlink" title="æ›´æ–°å•ä¸ªInstanceå±æ€§"></a>æ›´æ–°å•ä¸ªInstanceå±æ€§</h4><p>åœ¨æ·»åŠ åˆ°Primitiveåï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥é€šè¿‡Idè·å–æŒ‡å®šInstanceå¹¶ä¿®æ”¹å…¶å±æ€§ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> circleInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">GeometryInstance</span>( &#123;<br>    geometry : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">CircleGeometry</span>( &#123;<br>        center : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>( -<span class="hljs-number">95.0</span>, <span class="hljs-number">43.0</span> ),<br>        radius : <span class="hljs-number">250000.0</span>,<br>        vertexFormat : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">PerInstanceColorAppearance</span>.<span class="hljs-property">VERTEX_FORMAT</span><br>    &#125; ),<br>    attributes : &#123;<br>        color : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ColorGeometryInstanceAttribute</span>.<span class="hljs-title function_">fromColor</span>( <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Color</span>( <span class="hljs-number">1.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.5</span> ) ),<br>        show : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ShowGeometryInstanceAttribute</span>( <span class="hljs-literal">true</span> ) <span class="hljs-comment">//æ˜¾ç¤ºæˆ–è€…éšè—</span><br>    &#125;,<br>    id : <span class="hljs-string">&#x27;circle&#x27;</span><br>&#125; );<br><span class="hljs-keyword">var</span> primitive = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Primitive</span>( &#123;<br>    geometryInstances : circleInstance,<br>    appearance : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PerInstanceColorAppearance</span>( &#123;<br>        translucent : <span class="hljs-literal">false</span>,<br>        closed : <span class="hljs-literal">true</span><br>    &#125; )<br>&#125; );<br>scene.<span class="hljs-property">primitives</span>.<span class="hljs-title function_">add</span>( primitive );<br><br><span class="hljs-keyword">var</span> attributes = primitive.<span class="hljs-title function_">getGeometryInstanceAttributes</span>( <span class="hljs-string">&#x27;circle&#x27;</span> );<span class="hljs-comment">//è·å–æŸä¸ªå®ä¾‹çš„å±æ€§é›†</span><br>attributes.<span class="hljs-property">color</span> = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ColorGeometryInstanceAttribute</span>.<span class="hljs-title function_">toValue</span>( <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-title function_">fromRandom</span>( &#123;<br>    alpha : <span class="hljs-number">1.0</span><br>&#125; ) );<br></code></pre></td></tr></table></figure><h3 id="Appearance"><a href="#Appearance" class="headerlink" title="Appearance"></a>Appearance</h3><p>Cesiumæ”¯æŒä»¥ä¸‹åˆ—å‡ºçš„Appearance</p><table><thead><tr><th>å¤–è§‚</th><th>æè¿°</th></tr></thead><tbody><tr><td>MaterialAppearance</td><td>æ”¯æŒå„ç§Geometryç±»å‹çš„å¤–è§‚ï¼Œæ”¯æŒä½¿ç”¨æè´¨æ¥å®šä¹‰ç€è‰²ã€‚æ”¯æŒææ–™æè¿°é˜´å½±ã€‚</td></tr><tr><td>EllipsoidSurfaceAppearance</td><td>MaterialAppearanceçš„ä¸€ä¸ªç‰ˆæœ¬ã€‚å‡è®¾å‡ ä½•å›¾å½¢ä¸åœ°è¡¨æ˜¯å¹³è¡Œçš„ï¼Œå¹¶ä¸”ä¾æ­¤æ¥è¿›è¡Œé¡¶ç‚¹å±æ€§ï¼ˆvertex attributesï¼‰çš„è®¡ç®—ã€‚å’ŒMaterial Appearanceä¸€æ ·ï¼Œå°±åƒä¸€ä¸ªå¤šè¾¹å½¢ï¼Œå¹¶ä¸”ä½¿ç”¨è¿™ä¸ªå‡è®¾æ¥é€šè¿‡ç¨‹åºä¸Šè®¡ç®—è®¸å¤šé¡¶ç‚¹å±æ€§æ¥èŠ‚çœå†…å­˜ã€‚</td></tr><tr><td>PerInstanceColorAppearance</td><td>è®©æ¯ä¸ªå®ä¾‹ä½¿ç”¨è‡ªå®šä¹‰çš„é¢œè‰²æ¥ç€è‰²ï¼Œä½¿ç”¨æ¯ä¸ªå®ä¾‹çš„é¢œè‰²æ¥é®è”½æ¯ä¸ªå®ä¾‹ã€‚</td></tr><tr><td>PolylineMaterialAppearance</td><td>æ”¯æŒä½¿ç”¨æè´¨æ¥ç€è‰²å¤šæ®µçº¿ã€‚æ”¯æŒææ–™é®è”½Polylineã€‚</td></tr><tr><td>PolylineColorAppearance</td><td>ä½¿ç”¨æ¯é¡¶ç‚¹æˆ–è€…æ¯ç‰‡æ®µï¼ˆper-vertex or per-segment ï¼‰çš„é¢œè‰²æ¥ç€è‰²å¤šæ®µçº¿â€”ä½¿ç”¨æ¯é¡¶ç‚¹æˆ–æ¯æ®µç€è‰²æ¥é®è”½æŠ˜çº¿</td></tr></tbody></table><p>Appearanceå®šä¹‰äº†éœ€è¦åœ¨GPUä¸Šæ‰§è¡Œçš„GLSLç€è‰²å™¨ï¼Œè¿™éƒ¨åˆ†ä¸€èˆ¬åªæœ‰åœ¨è‡ªå®šä¹‰å¤–è§‚æ—¶éœ€è¦ä¿®æ”¹ã€‚</p><p><code>render state</code>ç”¨æ¥åœ¨ç»˜åˆ¶Primitiveçš„æ—¶å€™æ§åˆ¶GPUçŠ¶æ€ï¼Œä¸€æ—¦å¤–è§‚è¢«åˆ›å»ºï¼Œ<code>render state</code>å°±ä¸èƒ½å†æ”¹å˜äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å…¶æè´¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä¸‹é¢çš„å¤–è§‚å¯ç”¨äºå®šä¹‰ä¸€ä¸ªViewerä¸å¯è¿›å…¥çš„ä¸é€æ˜ç›’å­</span><br><span class="hljs-keyword">var</span> appearance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PerInstanceColorAppearance</span>( &#123;<br>    translucent : <span class="hljs-literal">false</span>,<br>    closed : <span class="hljs-literal">true</span><br>&#125; );<br><span class="hljs-comment">//ä¸‹é¢çš„ä»£ç æ•ˆæœåŒä¸Š</span><br><span class="hljs-keyword">var</span> translucent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PerInstanceColorAppearance</span>( &#123;<br>    renderState : &#123;<br>        depthTest : &#123;<br>            enabled : <span class="hljs-literal">true</span><br>        &#125;,<br>        cull : &#123;<br>            enabled : <span class="hljs-literal">true</span>,<br>            face : <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">CullFace</span>.<span class="hljs-property">BACK</span><br>        &#125;<br>    &#125;<br>&#125; );<br></code></pre></td></tr></table></figure><h2 id="Primitiveä¸Entityå¯¹æ¯”"><a href="#Primitiveä¸Entityå¯¹æ¯”" class="headerlink" title="Primitiveä¸Entityå¯¹æ¯”"></a>Primitiveä¸Entityå¯¹æ¯”</h2><p>çœ‹è¿‡ä¸Šè¾¹å¯¹Primitiveç›¸å…³æ¥å£çš„ç”¨æ³•ï¼Œæˆ‘ä»¬ä¼šæœ‰è¿™æ ·çš„ç–‘æƒ‘ï¼šentityè°ƒç”¨æ–¹ä¾¿ï¼Œå°è£…å®Œç¾ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨Primitiveï¼ŸåŒºåˆ«å°±æ˜¯è®°è½½çš„æ•ˆç‡é—®é¢˜ã€‚Primitveæ›´æ¥è¿‘webGLçš„åº•å±‚ï¼Œæ²¡æœ‰entityä¸€æ ·çš„é™„åŠ å±æ€§ï¼ŒåŠ è½½æ—¶æ•ˆç‡ä¼šæ›´é«˜ã€‚åœ¨å‰æ–‡<a href="https://juejin.cn/post/6972420331982028837">æ€§èƒ½ä¼˜åŒ–</a>ä¸­å·²ç»ä½“ç°å‡ºPrimitiveçš„ä¼˜åŠ¿äº†ï¼Œæ‰€ä»¥åœ¨åŠ è½½å‡ ä½•ä½“æ—¶äºŒè€…éƒ½æœ‰ä¼˜æœ‰åŠ£ï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cesium | æµ·é‡ç‚¹çš„åŠ è½½ä¸æ€§èƒ½ä¼˜åŒ–</title>
    <link href="/2021/06/11/Cesium%E6%B5%B7%E9%87%8F%E7%82%B9%E7%9A%84%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <url>/2021/06/11/Cesium%E6%B5%B7%E9%87%8F%E7%82%B9%E7%9A%84%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>åœ¨Cesiumä¸­æˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°åŠ è½½æµ·é‡æ•°æ®çš„æƒ…å†µï¼Œä½†å½“æˆ‘ä»¬è¿›è¡Œå®ç°çš„æ—¶å€™ä¼šå‘ç°é¡µé¢æ¸²æŸ“ä¼šå› ä¸ºæ•°æ®é‡è¿‡å¤§è€Œå˜å¾—è¿Ÿç¼“ï¼Œååˆ†å½±å“ç”¨æˆ·ä½“éªŒã€‚æ¥ä¸‹æ¥æˆ‘å°†å…ˆé€šè¿‡å¤§æ•°é‡çš„ç‚¹è¿›è¡Œæ€§èƒ½æ£€æµ‹ï¼Œç„¶åå¯¹å…¶è¿›è¡Œä¼˜åŒ–ã€‚</p><blockquote><p>æœ¬æ–‡åˆ©ç”¨Turfè¿›è¡Œæµ·é‡éšæœºç‚¹çš„ç”Ÿæˆ</p></blockquote><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡Turfç”Ÿæˆä¸‡é‡çº§çš„ç‚¹ä½ä¿¡æ¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> points = turf.<span class="hljs-title function_">randomPoint</span>(<span class="hljs-number">10000</span>, &#123; <span class="hljs-attr">bbox</span>: [<span class="hljs-number">40</span>, <span class="hljs-number">20</span>, <span class="hljs-number">255</span>, <span class="hljs-number">60</span>] &#125;);<br><span class="hljs-keyword">let</span> features = points.<span class="hljs-property">features</span>;<br><span class="hljs-keyword">let</span> feature, geom, coordinates, position;<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; features.<span class="hljs-property">length</span>; i++) &#123;<br>    feature = features[i];<br>    geom = feature.<span class="hljs-property">geometry</span>;<br>    coordinates = geom.<span class="hljs-property">coordinates</span>;<br>    position = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>        coordinates[<span class="hljs-number">0</span>],<br>        coordinates[<span class="hljs-number">1</span>],<br>        <span class="hljs-number">0</span><br>);<br><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addEntities</span>(position);<br></code></pre></td></tr></table></figure><p><code>addEntities</code>æ–¹æ³•ä¸­è¿›è¡Œæˆ‘ä»¬çš„<code>billboard</code>æ·»åŠ </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-attr">position</span>: position,<br>    <span class="hljs-attr">billboard</span>: &#123;<br>        <span class="hljs-attr">image</span>: <span class="hljs-string">&quot;./static/blueCamera.png&quot;</span>,<br>        <span class="hljs-attr">verticalOrigin</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VerticalOrigin</span>.<span class="hljs-property">BOTTOM</span>,<br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æ‰“å¼€æˆ‘ä»¬çš„é¡¹ç›®â€¦â€¦å¤©å•ŠçœŸæ˜¯è‚‰çœ¼å¯è§çš„å¡ä½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç”¨performanceæ¥åˆ†æä¸€ä¸‹ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3b71dc400ca24286b82189d24c873d01~tplv-k3u1fbpfcp-watermark.image" alt="image-20210607164830355.png"></p><p>æˆ‘ä»¬ç‚¹å‡»å·¦ä¸Šè§’çš„åˆ·æ–°æŒ‰é’®ï¼Œreloadä¸€ä¸‹é¡µé¢ï¼Œç­‰å¾…åˆ†ææŠ¥å‘Šçš„ç”Ÿæˆã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aea2c3b87ecf4f48a2e2a7769bbd6ab1~tplv-k3u1fbpfcp-watermark.image" alt="image-20210609141301351.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸‡çº§åˆ«çš„<code>billboard</code>åœ¨ä»¥<code>entity</code>ä¸ºè½½ä½“çš„æƒ…å†µä¸‹æ·»åŠ èŠ±è´¹äº†è¿‘30sçš„æ—¶é—´éå¸¸ä¹‹é•¿ã€‚</p><p>æˆ‘ä»¬ä¸Šè¿°æ˜¯é€šè¿‡åŠ è½½æœ¬åœ°å›¾ç‰‡èµ„æºï¼Œç„¶åç»™Cesiumç”Ÿæˆå¯¹åº”çš„billboardå»åˆ©ç”¨<code>entity</code>è¿›è¡Œæ¸²æŸ“ï¼Œæ…¢ä¼šä¸ä¼šæ˜¯å› ä¸ºé€šè¿‡<code>entity</code>ç”Ÿæˆçš„åŸå› ï¼Ÿï¼Œå¦‚æœæˆ‘ä»¬ç”¨<code>primitive</code>å‘¢ï¼Œè¿™é‡Œç®€å•è®²ä¸€ä¸‹<code>primitve</code>å’Œ<code>entity</code>çš„åŒºåˆ«ï¼Œè¯¦ç»†çš„æè¿°åç»­ä¼šå•ç‹¬å†™ä¸€ç¯‡æ–‡ç« ä½œè¿°ã€‚</p><h3 id="primitiveå’Œentity"><a href="#primitiveå’Œentity" class="headerlink" title="primitiveå’Œentity"></a><code>primitive</code>å’Œ<code>entity</code></h3><ul><li><code>primitive</code>æ›´å¤šçš„æ˜¯é¢å‘å›¾å½¢å¼€å‘äººå‘˜çš„åº•å±‚APIï¼Œæš´éœ²æœ€å°é™åº¦çš„æŠ½è±¡ï¼Œæ›´å¤šä½¿ç”¨å›¾å½¢å­¦æœ¯è¯­ï¼Œå…·æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚</li><li><code>entity</code>æ˜¯æ›´é«˜çº§åˆ«çš„æ•°æ®é©±åŠ¨APIï¼Œå®ƒä½¿ç”¨ä¸€è‡´æ€§è®¾è®¡çš„ã€é«˜çº§åˆ«å¯¹è±¡æ¥ç®¡ç†ä¸€ç»„ç›¸å…³æ€§çš„å¯è§†åŒ–å¯¹è±¡ï¼Œå…¶åº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨çš„<code>primitive</code>ã€‚</li></ul><p><code>primitive</code>åˆ©ç”¨<code>Geometry</code>å’Œ<code>Appearance</code>æ„å»ºï¼Œå…¶å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p><ol><li>æ€§èƒ½ï¼šç»˜åˆ¶å¤§é‡Primitiveæ—¶ï¼Œå¯ä»¥å°†å…¶åˆå¹¶ä¸ºå•ä¸ª<code>Geometry</code>ï¼Œå‡è½»CPUè´Ÿæ‹…ï¼Œæ›´å¥½ä½¿ç”¨GPUã€‚</li><li>çµæ´»ï¼š<code>Geometry</code>å’Œ<code>Appearance</code>è§£è€¦ï¼Œä¸¤è€…å¯ç‹¬ç«‹ä¿®æ”¹ã€‚</li></ol><p>åŒæ ·çš„ï¼Œä½¿ç”¨<code>primitive</code>å°±æ„å‘³ç€éœ€è¦ç¼–å†™æ›´å¤šä»£ç ï¼Œä»¥åŠå¯¹å›¾å½¢å­¦æ·±å…¥çš„äº†è§£ã€‚</p><h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><p>Cesiumå†…éƒ¨ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ä¸ªå¯æ¸²æŸ“çš„é›†åˆåƒ<code>PointPrimitiveCollection</code>ã€<code>BillboardCollection</code>ç­‰ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç”¨åˆ°<code>BillboardCollection</code>ï¼Œå®˜æ–¹APIæ˜¯è¿™æ ·è®²å…³äºå®ƒçš„æ€§èƒ½çš„ï¼ˆè‡ªå·±æ ¹æ®ç†è§£ç¿»è¯‘çš„å¯èƒ½æœ‰é”™ï¼Œæ‰€ä»¥è¿™é‡ŒæŠŠåŸæ–‡ä¹Ÿæ”¾ä¸Šå§ï¼‰ï¼š</p><blockquote><h5 id="Performance"><a href="#Performance" class="headerlink" title="Performance:"></a>Performance:</h5><p>For best performance, prefer a few collections, each with many billboards, to many collections with only a few billboards each. Organize collections so that billboards with the same update frequency are in the same collection, i.e., billboards that do not change should be in one collection; billboards that change every frame should be in another collection; and so on.</p></blockquote><p>ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæœ€å¥½ä½¿ç”¨æ›´å°‘çš„å†…éƒ¨æ‹¥æœ‰æ›´å¤šbillboardçš„é›†åˆï¼Œè€Œä¸æ˜¯æ¯ä¸ªé›†åˆé‡Œåªæœ‰é›¶æ˜Ÿçš„billboardï¼Œè€Œå¯¹äºé›†åˆçš„ç»„ç»‡ä¸Šï¼Œè®©æ‹¥æœ‰åŒæ ·æ›´æ–°é¢‘ç‡ï¼ˆå³ä¸ä¼šå˜åŒ–ï¼‰çš„billboardå­˜åœ¨äºä¸€ä¸ªé›†åˆä¸­ï¼Œè€ŒæŠŠæ¯ä¸€å¸§éƒ½å˜åŒ–çš„billboardæ”¾åˆ°å¦ä¸€ä¸ªé›†åˆå½“ä¸­ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨<code>BillboardCollection</code>ç”Ÿæˆ10000ä¸ªç‚¹å¹¶åˆ©ç”¨æ§åˆ¶å°åˆ†æä¸€ä¸‹æ€§èƒ½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">billboards</span> = viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">primitives</span>.<span class="hljs-title function_">add</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">BillboardCollection</span>()<br>);<br><span class="hljs-comment">// ...</span><br><br><span class="hljs-title function_">addPrimitive</span>(<span class="hljs-params">position</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">billboards</span>.<span class="hljs-title function_">add</span>(&#123;<br>        <span class="hljs-attr">position</span>: position,<br>        <span class="hljs-attr">image</span>:  <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./images/blueCamera.png&quot;</span>),<br>        <span class="hljs-attr">verticalOrigin</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VerticalOrigin</span>.<span class="hljs-property">BOTTOM</span>,<br>    &#125;);<br>&#125;,<br><br></code></pre></td></tr></table></figure><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7df04ec763f46f09d1c4f248edb32b0~tplv-k3u1fbpfcp-watermark.image" alt="image-20210609162506922.png"></p><p>å¯ä»¥çœ‹åˆ°ç”Ÿæˆé€Ÿåº¦æé«˜äº†è®¸å¤šã€‚</p><p>æ—¢ç„¶è¿™æ ·é‚£æˆ‘ä»¬å†æµ‹è¯•ä¸€ä¸‹åä¸‡é‡çº§çš„ç‚¹çš„åŠ è½½é€Ÿåº¦ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/869207da3f7c4edc98ee0130da25eff1~tplv-k3u1fbpfcp-watermark.image" alt="image-20210609162137395.png"><br>ä¸¤è€…ç«Ÿç„¶ä¸åˆ†ä¸Šä¸‹ï¼Œå¯è§<code>primitive</code>æœ‰å¤šä¹ˆå¼ºå¤§ã€‚</p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>åç»­å…¶å®æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ›´æ·±å±‚çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚å›¾ç‰‡æˆ‘ä»¬ç°åœ¨æ˜¯ä»æœ¬åœ°è·å–çš„ï¼Œèƒ½ä¸èƒ½å°†å®ƒå­˜åˆ°æ•°æ®åº“æˆ–è€…æµè§ˆå™¨ä¸­å¿«é€Ÿå–å‡ºèŠ‚çœæ—¶é—´ç­‰ç­‰ã€‚åƒæˆ‘ä»¬å¦‚æœåšåœ°çº§å¸‚çš„ç³»ç»Ÿï¼Œé‚£æˆ¿å±‹ã€é“è·¯è¿™äº›è¦ç´ éƒ½æ˜¯è‡³å°‘ä¸‡ä»¥ä¸Šé‡çº§ï¼Œè¿™äº›åˆè¯¥æ€ä¹ˆä¼˜åŒ–ï¼Œå¦‚ä½•ä¿è¯ç”¨æˆ·ä½“éªŒç­‰ç­‰ã€‚<a href="https://echarts.apache.org/examples/zh/editor.html?c=scatterGL-gps&gl=1">Echart</a>éƒ½å¯ä»¥å®ç°åƒä¸‡çº§åˆ«é‡çº§çš„ç‚¹å±•ç¤ºï¼Œè¯´æ˜æ€§èƒ½ä¼˜åŒ–è¿™é‡Œçš„æ°´å¾ˆæ·±å•Šå“ˆå“ˆã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cesium | åˆ©ç”¨Propertyæœºåˆ¶å®ç°è½¨è¿¹å›æ”¾</title>
    <link href="/2021/06/10/Cesium%E5%88%A9%E7%94%A8Property%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E8%BD%A8%E8%BF%B9%E5%9B%9E%E6%94%BE/"/>
    <url>/2021/06/10/Cesium%E5%88%A9%E7%94%A8Property%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E8%BD%A8%E8%BF%B9%E5%9B%9E%E6%94%BE/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä»¬åœ¨å‰é¢çš„<a href="https://juejin.cn/post/6970884378759004174">æ–‡ç« </a>ä¸­ä»‹ç»è¿‡Cesiumçš„Propertyæœºåˆ¶ï¼Œäº†è§£äº†å®ƒçš„ä½œç”¨ä»¥åŠå®ƒçš„ç”¨æ³•ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…åœºæ™¯æ¥æ·±å…¥å­¦ä¹ å’Œå¤ä¹ ä¸€ä¸‹Propertyæœºåˆ¶ã€‚</p><p>åœ¨æ™ºæ…§åŸå¸‚ç³»ç»Ÿä¸­ï¼Œå¿…ä¸å¯å°‘çš„å°±æ˜¯è½¨è¿¹å›æ”¾æˆ–è€…è®©æ¨¡å‹æ²¿ç€æŒ‡å®šè·¯å¾„è¡Œèµ°ï¼Œè€ŒCesiumæä¾›çš„Propertyæœºåˆ¶èƒ½å¤Ÿåœ¨å¾ˆå¥½çš„å®ç°è¿™æ ·çš„åœºæ™¯çš„åŒæ—¶ä¿è¯æ€§èƒ½ã€‚ä¸‹é¢ç®€å•æ¥è®²ä¸€ä¸‹Propertyï¼Œæ›´å¤šçš„çŸ¥è¯†å¯ä»¥é˜…è¯»<a href="https://juejin.cn/post/6970884378759004174">Cesiumçš„Propertyæœºåˆ¶ç©¶ç«Ÿæœ‰å¤šé¦™</a></p><h2 id="property"><a href="#property" class="headerlink" title="property"></a>property</h2><p>ç®€å•æ¥è¯´ï¼ŒPropertyå°±æ˜¯Cesiumæä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥è®©æŒ‡å®šçš„å±æ€§éšæ—¶é—´è‡ªåŠ¨å˜åŒ–å¹¶èµ‹å€¼ï¼Œæ“ä½œä¾¿æ·çš„åŒæ—¶èƒ½å¤ŸèŠ‚çœæ€§èƒ½ã€‚åœ¨Cesiumä¸­Propertyå¯ä»¥ä¸æ—¶é—´è½´è¿›è¡Œå…³è”ï¼Œå¹¶æ ¹æ®æ—¶é—´è¿”å›å¯¹åº”çš„å±æ€§ï¼Œæˆ‘ä»¬å†é€šè¿‡è¿”å›çš„å€¼å»æ”¹å˜æˆ‘iä»¬æƒ³è¦ä¿®æ”¹çš„çŠ¶æ€å€¼ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>ä¸€æ ·çš„ï¼Œé¦–å…ˆæˆ‘ä»¬æ•´ç†æ€è·¯ï¼Œæƒ³è¦å®ç°è½¨è¿¹å›æ”¾ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç»„è½¨è¿¹åæ ‡ä¸²ã€ä¸€ä¸ªå®šä¹‰å¥½æ—¶é—´ç‚¹çŠ¶æ€çš„Propertyï¼Œä»¥åŠä¸€ä¸ªç”¨æ¥åœ¨è½¨è¿¹ä¸Šè¡Œèµ°çš„modelï¼ˆæœ¬æ–‡ç”¨billboardä»£æ›¿ï¼‰ã€‚</p><p>æˆ‘ä»¬æ‹¿åˆ°äº†è½¨è¿¹åæ ‡ä¸²åï¼Œéœ€è¦é€šè¿‡è®¡ç®—è·å¾—å‡ ä¸ªå…³é”®èŠ‚ç‚¹çš„è·ç¦»ã€æ—¶é—´ï¼Œç”Ÿæˆå®Œæ•´çš„propertyä½œä¸ºæˆ‘ä»¬å®ä½“çš„positionå±æ€§ã€‚</p><p>åŸºæœ¬æ€è·¯å¦‚ä¸Šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹åŠ¨æ‰‹å®ç°ã€‚æ€è·¯åªæä¾›å¤§è‡´æ–¹å‘ï¼Œåœ¨å®ç°ä¸­å¯èƒ½ä¼šå¯¹æŸäº›æ–¹é¢è¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ã€‚ä¸€èˆ¬åœºæ™¯ä¸‹æˆ‘ä»¬å¾—åˆ°çš„éƒ½æ˜¯ç»çº¬åº¦åæ ‡ï¼Œè€Œæ“ä½œæ—¶éœ€è¦ä½¿ç”¨ç¬›å¡å°”åæ ‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> lnglatArr = [<br>    [<span class="hljs-number">121.527589</span>, <span class="hljs-number">38.957547</span>],<br>    [<span class="hljs-number">121.527825</span>, <span class="hljs-number">38.960166</span>],<br>    [<span class="hljs-number">121.536472</span>, <span class="hljs-number">38.959098</span>],<br>    [<span class="hljs-number">121.540442</span>, <span class="hljs-number">38.958464</span>],<br>    [<span class="hljs-number">121.543489</span>, <span class="hljs-number">38.958131</span>],<br>    [<span class="hljs-number">121.542888</span>, <span class="hljs-number">38.955861</span>],<br>    [<span class="hljs-number">121.542266</span>, <span class="hljs-number">38.953325</span>],<br>]<br><br><span class="hljs-keyword">let</span> positions = lnglatArr.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(item[<span class="hljs-number">0</span>] , item[<span class="hljs-number">1</span>] , <span class="hljs-number">0.5</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦è·å–å›æ”¾ä¸­æ¯æ®µçš„æ—¶é—´ä»¥åŠæ€»æ—¶é—´ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦é€šè¿‡é€Ÿåº¦å’Œåæ ‡ç‚¹ä¹‹é—´çš„è·ç¦»ç®—å‡ºæ‰€éœ€æ—¶é—´ï¼ˆè¿™æ˜¯å°å­¦çŸ¥è¯†å§ï¼Œt = l/sï¼‰ã€‚</p><p>æˆ‘ä»¬éœ€è¦è®°å½•æ¯ä¸ªç‚¹ä½çš„æ—¶é—´ï¼Œç”¨æ¥ä¸ºpropertyæ·»åŠ èŠ‚ç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å®ƒå†™æˆä¸€ä¸ªæ–¹æ³•æ–¹ä¾¿è°ƒç”¨ã€‚å…¥å‚å°±æ˜¯æˆ‘ä»¬çš„åæ ‡ä¸²ä¸é€Ÿåº¦ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// è®¡ç®—æ¯ä¸ªç‚¹ä½æ—¶é—´å’Œæ€»æ—¶é—´</span><br><span class="hljs-title function_">getSiteTimes</span>(<span class="hljs-params">positions, speed</span>) &#123;<br>    <span class="hljs-keyword">let</span> timeSum = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">let</span> times = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; positions.<span class="hljs-property">length</span>; i++) &#123;<br>        <span class="hljs-keyword">if</span> (i === <span class="hljs-number">0</span>) &#123;<br>            times.<span class="hljs-title function_">push</span>(<span class="hljs-number">0</span>);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        timeSum += <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">spaceDistance</span>([positions[i - <span class="hljs-number">1</span>], positions[i]]) / speed;<br>        times.<span class="hljs-title function_">push</span>(timeSum);<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>        timeSum,<br>        <span class="hljs-attr">siteTimes</span>: times,<br>    &#125;;<br>&#125;,<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨å¾ªç¯å†…åˆå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•<code>spaceDisatance</code>ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥è®¡ç®—ä¼ å…¥çš„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è·ç¦»ã€‚Cesiumä¸ºæˆ‘ä»¬æä¾›äº†ç›¸å…³æ–¹æ³•è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// è®¡ç®—è·ç¦»</span><br><span class="hljs-title function_">spaceDistance</span>(<span class="hljs-params">positions</span>) &#123;<br>    <span class="hljs-keyword">let</span> distance = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; positions.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> point1cartographic = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartographic</span>.<span class="hljs-title function_">fromCartesian</span>(<br>            positions[i]<br>        );<br>        <span class="hljs-keyword">let</span> point2cartographic = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartographic</span>.<span class="hljs-title function_">fromCartesian</span>(<br>            positions[i + <span class="hljs-number">1</span>]<br>        );<br>        <span class="hljs-comment">/**æ ¹æ®ç»çº¬åº¦è®¡ç®—å‡ºè·ç¦»**/</span><br>        <span class="hljs-keyword">let</span> geodesic = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">EllipsoidGeodesic</span>();<br>        geodesic.<span class="hljs-title function_">setEndPoints</span>(point1cartographic, point2cartographic);<br>        <span class="hljs-keyword">let</span> s = geodesic.<span class="hljs-property">surfaceDistance</span>;<br>        <span class="hljs-comment">//è¿”å›ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦» å¦‚æœå¸¦é«˜åº¦çš„è¯</span><br>        s = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(<br>            <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(s, <span class="hljs-number">2</span>) +<br>            <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(point2cartographic.<span class="hljs-property">height</span> - point1cartographic.<span class="hljs-property">height</span>, <span class="hljs-number">2</span>)<br>        );<br>        distance = distance + s;<br>    &#125;<br>    <span class="hljs-keyword">return</span> distance.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);<br>&#125;,<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æ‹¿åˆ°äº†æ€»æ—¶é—´å’Œæ¯ä¸¤ä¸ªç‚¹ä¹‹é—´çš„æ—¶é—´ï¼Œç°åœ¨å¯ä»¥å¼€å§‹æ„å»ºpropertyå’Œæ—¶é—´è½´äº†ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰å¼€å§‹æ—¶é—´ç»“æŸæ—¶é—´å¹¶ç»™åˆ°<code>viewer</code>çš„<code>clock</code>å®ä¾‹ä¸Šä»£è¡¨æ—¶é—´æ®µï¼Œæ¥ç€æ„ç­‘Propertyå®ä¾‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> timeObj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSiteTimes</span>(positions, speed);<br><span class="hljs-keyword">let</span> startTime = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><span class="hljs-keyword">let</span> stopTime = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>    startTime,<br>    timeObj.<span class="hljs-property">timeSum</span>,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>);<br><br>viewer.<span class="hljs-property">clock</span>.<span class="hljs-property">startTime</span> = startTime.<span class="hljs-title function_">clone</span>();<br>viewer.<span class="hljs-property">clock</span>.<span class="hljs-property">stopTime</span> = stopTime.<span class="hljs-title function_">clone</span>();<br>viewer.<span class="hljs-property">clock</span>.<span class="hljs-property">currentTime</span> = startTime.<span class="hljs-title function_">clone</span>();<br><br><span class="hljs-comment">// ç”Ÿæˆproperty</span><br><span class="hljs-keyword">var</span> property = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">SampledPositionProperty</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; positions.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">const</span> time = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>        startTime,<br>        timeObj.<span class="hljs-property">siteTimes</span>[i],<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>    );<br>    property.<span class="hljs-title function_">addSample</span>(time, positions[i]);<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªEntityå®ä½“ï¼Œåšè½¨è¿¹å›æ”¾çš„ç‰©ä½“ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ä»»ä½•å®ä½“ã€‚æ·»åŠ åˆ°åœºæ™¯ä¸­åéœ€è¦åˆ©ç”¨<code>viewer.trackedEntity</code>åŠ¨æ€è¿½è¸ªå®ä½“ã€‚æˆ‘ä»¬çš„è½¨è¿¹å›æ”¾å°±å¤§åŠŸå‘Šæˆäº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">animateEntity</span> = viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-comment">// å®ä½“å¯ç”¨æ€§ï¼Œåœ¨æŒ‡å®šæ—¶é—´å†…è¿”å›æœ‰æ•ˆæ•°æ®</span><br>    <span class="hljs-attr">availability</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeIntervalCollection</span>([<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>            <span class="hljs-attr">start</span>: startTime,<br>            <span class="hljs-attr">stop</span>: stopTime,<br>        &#125;),<br>    ]),<br>    <span class="hljs-comment">// ä½ç½®ä¿¡æ¯éšæ—¶é—´å˜åŒ–property</span><br>    <span class="hljs-attr">position</span>: property,<br>    <span class="hljs-comment">// å®ä½“æ–¹å‘</span><br>    <span class="hljs-attr">orientation</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">VelocityOrientationProperty</span>(property),<br>    <span class="hljs-attr">billboard</span>: &#123;<br>        <span class="hljs-attr">image</span>: <span class="hljs-string">&quot;./static/blueCamera.png&quot;</span>,<br>        <span class="hljs-attr">verticalOrigin</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VerticalOrigin</span>.<span class="hljs-property">BOTTOM</span>,<br>    &#125;,<br>    <span class="hljs-comment">// è½¨è¿¹è·¯å¾„</span><br>    <span class="hljs-attr">path</span>: &#123;<br>        <span class="hljs-attr">resolution</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">width</span>: <span class="hljs-number">10</span>,<br>        <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">RED</span>,<br>    &#125;,<br>&#125;);<br><br>viewer.<span class="hljs-property">trackedEntity</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animateEntity</span>;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f95ccb3b7f66409aabca65f4ea854d82~tplv-k3u1fbpfcp-watermark.image" alt="animate1.gif"></p><h2 id="å°è£…"><a href="#å°è£…" class="headerlink" title="å°è£…"></a>å°è£…</h2><p>è¿™é‡Œç®€å•æä¸€ä¸‹åˆ©ç”¨Classè¿›è¡Œå°è£…å§ï¼Œæ²¡æœ‰ä»€ä¹ˆå¤§çš„éš¾ç‚¹ï¼Œå°±æ˜¯æŠŠå®ç°æ­¥éª¤æ‹†åˆ†ï¼Œé€‰å®šå‚æ•°è¿›è¡Œæš´éœ²ã€‚è¿™é‡Œç®€å•ä¹¦å†™ä¸€ä¸‹ä»£ç ç»“æ„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TrackedAnimate</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">viewer, cb</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span> = viewer;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb;<br>    &#125;<br><br>    <span class="hljs-title function_">startRoam</span>(<span class="hljs-params">positions, speed</span>) &#123;<br>        <span class="hljs-keyword">let</span> newPositions = positions.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(item[<span class="hljs-number">0</span>], item[<span class="hljs-number">1</span>], <span class="hljs-number">0.5</span>);<br>        &#125;);<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addRoamLine</span>(newPositions, speed);<br>    &#125;<br><br>    <span class="hljs-comment">//æ·»åŠ æ¼«æ¸¸è·¯çº¿</span><br>    <span class="hljs-title function_">addRoamLine</span>(<span class="hljs-params">positions, speed</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">endRoam</span>();<br><br>        <span class="hljs-keyword">let</span> timeObj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSiteTimes</span>(positions, speed);<br>        <span class="hljs-keyword">let</span> startTime = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()); <br>        <span class="hljs-keyword">let</span> stopTime = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            startTime,<br>            timeObj.<span class="hljs-property">timeSum</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        );<br><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">clock</span>.<span class="hljs-property">startTime</span> = startTime.<span class="hljs-title function_">clone</span>();<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">clock</span>.<span class="hljs-property">stopTime</span> = stopTime.<span class="hljs-title function_">clone</span>();<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">clock</span>.<span class="hljs-property">currentTime</span> = startTime.<span class="hljs-title function_">clone</span>();<br><br>        <span class="hljs-keyword">let</span> property = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSampledPositionProperty</span>(<br>            positions,<br>            startTime,<br>            timeObj.<span class="hljs-property">siteTimes</span><br>        );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addModel</span>(startTime, stopTime, property);<br><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">trackedEntity</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animateEntity</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">timoutId</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">endRoam</span>();<br>        &#125;, timeObj.<span class="hljs-property">timeSum</span> * <span class="hljs-number">1000</span>);<br>    &#125;<br><br>    <span class="hljs-title function_">addModel</span>(<span class="hljs-params">startTime, stopTime, property</span>) &#123;<br>        <span class="hljs-comment">//â€¦â€¦</span><br>    &#125;<br><br>    <span class="hljs-title function_">endRoam</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//â€¦â€¦</span><br>    &#125;<br><br>    <span class="hljs-title function_">getSampledPositionProperty</span>(<span class="hljs-params">positions, startTime, siteTimes</span>) &#123;<br>        <span class="hljs-comment">//â€¦â€¦</span><br>    &#125;<br><br>    <span class="hljs-comment">//è®¡ç®—æ¯ä¸ªç‚¹ä½æ—¶é—´ä¸æ€»æ—¶é—´</span><br>    <span class="hljs-title function_">getSiteTimes</span>(<span class="hljs-params">positions, speed</span>) &#123;<br>        <span class="hljs-comment">//â€¦â€¦</span><br>    &#125;<br><br>    <span class="hljs-comment">//è®¡ç®—è·ç¦»</span><br>    <span class="hljs-title function_">spaceDistance</span>(<span class="hljs-params">positions</span>) &#123;<br>        <span class="hljs-comment">//â€¦â€¦</span><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è°ƒç”¨ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">trackEntity</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TrackedAnimate</span>(viewer , <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;moe_&#x27;</span>);<br>&#125;);<br><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">trackEntity</span>.<span class="hljs-title function_">startRoam</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">movePositions</span>, <span class="hljs-number">25</span>);<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">trackEntity</span>.<span class="hljs-title function_">endRoam</span>();<br></code></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸Šè¿°æˆ‘ä»¬ç®€å•å®ç°äº†è½¨è¿¹å›æ”¾çš„åœºæ™¯ï¼Œå¯ä»¥çœ‹åˆ°åœ¨å°è£…ä¸­æˆ‘ä»¬è¿˜è®¾ç½®äº†å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œåç»­å¯ä»¥è¿›è¡Œå¾ˆå¤šæ‰©å±•æ¯”å¦‚å¤šè§†è§’å›æ”¾ï¼Œç‰¹å®šä½ç½®åšç‰¹å®šåŠŸèƒ½ç­‰ç­‰ï¼Œéƒ½å¯ä»¥è¿›è¡Œæ‰©å±•ã€‚Propertyçš„ä½¿ç”¨åœºæ™¯æœ‰å¾ˆå¤šï¼Œè¿™åªæ˜¯å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥æ·±å…¥ç ”ç©¶å…±åŒæ¢è®¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Electronå®ç°å¯åŠ¨LoadingåŠ¨ç”»æ•ˆæœ</title>
    <link href="/2021/06/09/Electron%E5%AE%9E%E7%8E%B0%E5%90%AF%E5%8A%A8Loading%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C/"/>
    <url>/2021/06/09/Electron%E5%AE%9E%E7%8E%B0%E5%90%AF%E5%8A%A8Loading%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="Electronæ˜¯ä»€ä¹ˆ"><a href="#Electronæ˜¯ä»€ä¹ˆ" class="headerlink" title="Electronæ˜¯ä»€ä¹ˆ"></a>Electronæ˜¯ä»€ä¹ˆ</h2><blockquote><p>ä½¿ç”¨ JavaScriptï¼ŒHTML å’Œ CSS æ„å»ºè·¨å¹³å°çš„æ¡Œé¢åº”ç”¨ç¨‹åº â€”â€”å®˜ç½‘</p></blockquote><blockquote><p>Electronæ˜¯GitHubå¼€å‘çš„ä¸€ä¸ªå¼€æºæ¡†æ¶ã€‚å®ƒå…è®¸ä½¿ç”¨Node.jsï¼ˆä½œä¸ºåç«¯ï¼‰å’ŒChromiumï¼ˆä½œä¸ºå‰ç«¯ï¼‰å®Œæˆæ¡Œé¢GUIåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚Electronç°å·²è¢«å¤šä¸ªå¼€æºWebåº”ç”¨ç¨‹åºç”¨äºå‰ç«¯ä¸åç«¯çš„å¼€å‘ï¼Œè‘—åé¡¹ç›®åŒ…æ‹¬GitHubçš„Atomå’Œå¾®è½¯çš„Visual Studio Codeã€‚â€”â€”çŸ¥ä¹</p></blockquote><p>Electronè´Ÿè´£æå®šæ£˜æ‰‹çš„éƒ¨åˆ†ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨æˆ‘ä»¬çš„webæŠ€æœ¯æ„å»ºåº”ç”¨ç¨‹åºå³å¯ã€‚</p><h2 id="æ­å»ºElectroné¡¹ç›®"><a href="#æ­å»ºElectroné¡¹ç›®" class="headerlink" title="æ­å»ºElectroné¡¹ç›®"></a>æ­å»ºElectroné¡¹ç›®</h2><p>æœ€æ–¹ä¾¿çš„å°±æ˜¯ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºï¼Œç°åœ¨å¸‚é¢ä¸Šæ¯”è¾ƒæˆç†Ÿçš„è„šæ‰‹æ¶ä¾‹å¦‚<a href="https://www.electronforge.io/">electronforge</a>ï¼Œelectron-vueç­‰ç­‰ï¼Œæˆ–è€…è‡ªå·±æ­å»ºä¸€ä¸ªæ‹¥æœ‰è‡ªå·±æ–‡æ¡£ç»“æ„çš„é¡¹ç›®ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªå¿«é€Ÿå¯åŠ¨çš„æ–¹å¼ã€‚</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs crmsh"><span class="hljs-comment"># å…‹éš†ç¤ºä¾‹é¡¹ç›®çš„ä»“åº“</span><br>$ git <span class="hljs-keyword">clone</span> <span class="hljs-title">https</span>://github.com/electron/electron-quick-<span class="hljs-literal">start</span><br><br><span class="hljs-comment"># è¿›å…¥è¿™ä¸ªä»“åº“</span><br>$ cd electron-quick-<span class="hljs-literal">start</span><br><br><span class="hljs-comment"># å®‰è£…ä¾èµ–å¹¶è¿è¡Œ</span><br>$ npm install &amp;&amp; npm <span class="hljs-literal">start</span><br></code></pre></td></tr></table></figure><h2 id="ä¸ºä»€ä¹ˆè¦æ·»åŠ å¯åŠ¨åŠ¨ç”»"><a href="#ä¸ºä»€ä¹ˆè¦æ·»åŠ å¯åŠ¨åŠ¨ç”»" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ·»åŠ å¯åŠ¨åŠ¨ç”»"></a>ä¸ºä»€ä¹ˆè¦æ·»åŠ å¯åŠ¨åŠ¨ç”»</h2><p>å½“ç„¶æ˜¯ä¸ºäº†ä¼˜åŒ–ç”¨æˆ·çš„ä½¿ç”¨ä½“éªŒï¼ˆæ©ç›–è‡ªå·±é¡¹ç›®å¯åŠ¨æ…¢çš„äº‹å®ï¼‰ã€‚é¡¹ç›®ä¸šåŠ¡ä¸åŒåˆ™åœ¨å¯åŠ¨æ—¶å€™çš„éœ€æ±‚ä¹Ÿä¸åŒï¼Œæ¯”å¦‚æœ‰çš„åº”ç”¨éœ€è¦æ£€æµ‹å‡çº§çŠ¶æ€ã€ç™»å½•çŠ¶æ€æˆ–ä¸€äº›é™„åŠ ä¸šåŠ¡æ£€æµ‹æ¯”å¦‚éº¦å…‹é£å’Œæ‘„åƒå¤´ï¼Œæœ‰äº›åº”ç”¨éœ€è¦åœ¨åœ¨å¼€å§‹åŠ è½½å¤§é‡æ•°æ®åšæ”¯æ’‘ç­‰ç­‰ã€‚æˆ‘ä»¬å½“ç„¶æƒ³å®ç°ç”¨æˆ·åŒå‡»å›¾æ ‡åç«‹å³è¿›å…¥åº”ç”¨ï¼Œä½†ä»£ç çš„è¿è¡Œå’Œæ•°æ®åŠ è½½ç­‰æ˜¯éœ€è¦æ—¶é—´çš„ã€‚æ—¢ç„¶è¿™æ ·ï¼Œä¸å…¶æˆ‘ä»¬ç»™ç”¨æˆ·å±•ç¤ºä»£ç è¿è¡Œçš„è¿‡ç¨‹ï¼Œä½•ä¸ç»™ç”¨æˆ·å±•ç¤ºä¸€å¼ å›¾ç‰‡ï¼Œè¿™ä¹Ÿæ˜¯ç”¨æˆ·ä½“éªŒã€‚è®©ç”¨æˆ·æ˜ç™½æ­¤æ—¶æ­¤åˆ»æ˜¯åº”ç”¨åœ¨åŠ è½½ï¼Œè€Œä¸æ˜¯è®¤ä¸ºåº”ç”¨å¡æ­»æˆ–è€…å´©æºƒçš„çŒœæµ‹ã€‚</p><h2 id="æ€è·¯åŠå®ç°"><a href="#æ€è·¯åŠå®ç°" class="headerlink" title="æ€è·¯åŠå®ç°"></a>æ€è·¯åŠå®ç°</h2><p>è¯´ç™½äº†ï¼Œå¯åŠ¨çª—å£å®ƒä¹Ÿæ˜¯ä¸€ä¸ªçª—å£ï¼Œæˆ‘ä»¬æƒ³è®©å®ƒåœ¨é¡¹ç›®å°šæœªå‡†å¤‡å®Œæ¯•æ—¶å‡ºç°åœ¨ç”¨æˆ·çš„è§†ç•Œä¸­å‘Šè¯‰ç”¨æˆ·æˆ‘æ­£åœ¨å¯åŠ¨ï¼Œå‡†å¤‡å®Œæ¯•åå…³é—­ã€‚è€Œæˆ‘ä»¬ä¹Ÿæ— éœ€ä½¿ç”¨å¤šä¹ˆå¤æ‚çš„æ‰‹æ®µï¼Œä¸»è¦æ–¹æ³•æ˜¯ç›‘å¬æˆ‘ä»¬ä¸»çª—å£è¿›ç¨‹ï¼Œå‡†å¤‡å°±ç»ªåå…³é—­å¯åŠ¨çª—å£å³å¯ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªloadingçš„HTMLé¡µé¢ï¼Œå…¶ä¸­å¯ä»¥å¯¹æˆ‘ä»¬çš„å¯åŠ¨çª—å£è¿›è¡Œç»˜åˆ¶ä»¥åŠå„ç§å¹³æ»‘çš„ç­‰å¾…æ•ˆæœã€‚æ¥ç€åœ¨ä¸»è¿›ç¨‹ä¸­åˆ›å»ºç”ŸæˆLoadingçª—å£çš„æ–¹æ³•ï¼ŒåŒæ—¶æ¥æ”¶ä¸€ä¸ªå›è°ƒå‡½æ•°åœ¨Loadingçª—å£ç”Ÿæˆæ—¶è§¦å‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">showLoading</span> = (<span class="hljs-params">cb</span>) =&gt; &#123;<br>    loading = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>(&#123;<br>        <span class="hljs-attr">show</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">frame</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// æ— è¾¹æ¡†ï¼ˆçª—å£ã€å·¥å…·æ ç­‰ï¼‰ï¼ŒåªåŒ…å«ç½‘é¡µå†…å®¹</span><br>        <span class="hljs-attr">width</span>: <span class="hljs-number">160</span>,<br>        <span class="hljs-attr">height</span>: <span class="hljs-number">180</span>,<br>        <span class="hljs-attr">resizable</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">transparent</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// çª—å£æ˜¯å¦æ”¯æŒé€æ˜ï¼Œå¦‚æœæƒ³åšé«˜çº§æ•ˆæœæœ€å¥½ä¸ºtrue</span><br>    &#125;);<br><br>    loading.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;show&quot;</span>, cb);<br>    loading.<span class="hljs-title function_">loadFile</span>(<span class="hljs-string">&quot;loading.html&quot;</span>);<br>    loading.<span class="hljs-title function_">show</span>();<br>&#125;;<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬åœ¨é¡¹ç›®å¯åŠ¨æ—¶è°ƒç”¨<code>showLoading</code>æ–¹æ³•ï¼Œå¹¶ä¼ å…¥åˆ›å»ºä¸»çª—å£çš„æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">createWindow</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-variable language_">window</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>(&#123;<br>    <span class="hljs-attr">webPreferences</span>: &#123;<br>      <span class="hljs-attr">nativeWindowOpen</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;ä¸»çª—å£&quot;</span>,<br>    &#125;,<br>    <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,<br>    <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,<br>    <span class="hljs-attr">show</span>: <span class="hljs-literal">false</span>,<br>  &#125;);<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">loadFile</span>(<span class="hljs-string">&quot;index.html&quot;</span>);  <span class="hljs-comment">// æ¨¡æ‹Ÿå¯åŠ¨å‡†å¤‡æ—¶é—´</span><br>  &#125;, <span class="hljs-number">2000</span>);<br>  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">once</span>(<span class="hljs-string">&quot;ready-to-show&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    loading.<span class="hljs-title function_">hide</span>();<br>    loading.<span class="hljs-title function_">close</span>();<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">show</span>();<br>  &#125;);<br>&#125;;<br><br>app.<span class="hljs-title function_">on</span>(<span class="hljs-string">&quot;ready&quot;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">showLoading</span>(createWindow);<br>&#125;);<br></code></pre></td></tr></table></figure><p>åœ¨æˆ‘ä»¬çš„ä¸»çª—å£å‡†å¤‡å°±ç»ªçš„æ—¶å€™å…³é—­æˆ‘ä»¬çš„å¯åŠ¨çª—å£å¹¶å±•ç¤ºæˆ‘ä»¬çš„ä¸»çª—å£ã€‚æ³¨æ„ï¼Œå¦‚æœç›´æ¥å…³é—­å¯åŠ¨çª—å£å¯èƒ½ä¼šå­˜åœ¨é—ªçƒç°è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆå°†çª—å£éšè—å†è¿›è¡Œå…³é—­ã€‚</p><p>çœ‹æ•ˆæœ:</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/507edb8d6e3d496e9f74ef6aa9193efb~tplv-k3u1fbpfcp-watermark.image" alt="electron1.gif"></p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>é€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥äº†è§£å…³äº<code>BrowerWindow</code>çš„å®ä¾‹äº‹ä»¶ï¼Œå¹¶èƒ½é€šè¿‡è¿™äº›å¯¹åº”çš„äº‹ä»¶å®ç°æˆ‘ä»¬æƒ³è¦çš„ä¸€äº›æ•ˆæœï¼Œæ¯”å¦‚ç”¨æˆ·é¼ æ ‡èšç„¦ã€å¤±ç„¦åº”ç”¨çš„æ—¶å€™ï¼Œæ˜¾ç¤ºã€éšè—çª—å£çš„æ—¶å€™çš„æ“ä½œç­‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Electron</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Electron</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cesiumçš„Propertyæœºåˆ¶ç©¶ç«Ÿæœ‰å¤šé¦™</title>
    <link href="/2021/06/07/Cesium%E7%9A%84Property%E6%9C%BA%E5%88%B6%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E9%A6%99/"/>
    <url>/2021/06/07/Cesium%E7%9A%84Property%E6%9C%BA%E5%88%B6%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E9%A6%99/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸¤å¤©åœ¨ç ”ç©¶Cesiumä¸­å¦‚ä½•å®ç°æ²¿çº¿é£è¡Œæˆ–æ¼«æ¸¸åŠŸèƒ½ï¼Œä¸Šç½‘æŸ¥èµ„æ–™å‘ç°æœ‰å¥½å¤šåšä¸»çš„è§£å†³åŠæ³•éƒ½åŒ…å«äº†ä»€ä¹ˆä»€ä¹ˆPropertyâ€¦â€¦å‹¾èµ·äº†æˆ‘å¼ºçƒˆçš„å¥½å¥‡å¿ƒï¼Œé‚å»äº†<a href="https://cesium.com/docs/tutorials/creating-entities/#the-property-system">Cesiumå®˜ç½‘</a>ä¸€æ¢ç©¶ç«Ÿï¼Œä¸€ä¸‹æˆ‘å°±è¢«ç¬¬ä¸€å¥è¯éœ‡æƒŠåˆ°äº†ã€‚</p><blockquote><p>All values we define for our entities are stored as <code>Property</code> objects.</p></blockquote><p>å®ä½“çš„æ‰€æœ‰å€¼éƒ½è¢«ç»´æŠ¤æˆäº†<code>Property</code>å¯¹è±¡ï¼Œè¿™è®©æˆ‘ä¸å¾—ä¸å¾€ä¸‹çœ‹ï¼Œä½†æˆ‘è¶Šçœ‹è¶Šæ°”ï¼Œè¿™ä¹ˆé‡è¦çš„ä¸œè¥¿ï¼Œä½ è¿™å•¥ä¹Ÿæ²¡è®²å•Šã€‚ç®—äº†è¿˜æ˜¯æˆ‘è‡ªå·±ç ”ç©¶å§ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9a6b5c8b8dff453ab719bee1f111e456~tplv-k3u1fbpfcp-watermark.image" alt="image-20210603163511040.png"></p><h2 id="ä»€ä¹ˆæ˜¯Propertyæœºåˆ¶"><a href="#ä»€ä¹ˆæ˜¯Propertyæœºåˆ¶" class="headerlink" title="ä»€ä¹ˆæ˜¯Propertyæœºåˆ¶"></a>ä»€ä¹ˆæ˜¯Propertyæœºåˆ¶</h2><p>ä¸ªäººæ„Ÿè§‰Cesiumçš„Propertyæœ¬è´¨ä¸Šä¸<code>Object.defineProperties</code>ç±»ä¼¼ï¼Œ<code>defineProperties</code>ç›´æ¥å°è£…äº†åŸºæœ¬ç±»å‹ï¼Œå¦‚æœæ˜¯Objectï¼Œåˆ™æ˜¯å¼•ç”¨å½¢å¼ã€‚é€šè¿‡Propertyçš„å°è£…ï¼Œå°†å¼•ç”¨æˆ–å¤åˆ¶çš„æƒåŠ›äº¤ç»™äº†è®¾è®¡è€…ï¼ŒåŒæ—¶æä¾›ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ä»¥æ»¡è¶³éœ€æ±‚ã€‚</p><h2 id="ä¸ºä»€ä¹ˆè¦ç”¨Property"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨Property" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨Property"></a>ä¸ºä»€ä¹ˆè¦ç”¨Property</h2><p>é¦–å…ˆç”¨ä¸€ä¸ªä¾‹å­æ¥ç®€å•å±•ç¤ºä¸€ä¸‹Propertyçš„ä½œç”¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// åˆ›å»ºç›’å­</span><br><span class="hljs-keyword">var</span> box = viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;box&quot;</span>,<br>    <span class="hljs-attr">position</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<span class="hljs-number">121.54035</span>, <span class="hljs-number">38.92146</span>, <span class="hljs-number">2000</span>),<br>    <span class="hljs-attr">box</span>: &#123;<br>        <span class="hljs-attr">dimensions</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>),<br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>å‡å¦‚æˆ‘ä»¬æƒ³å®ç°ç›’å­çš„å¤§å°éšæ—¶é—´å˜åŒ–è€Œå˜åŒ–ï¼Œç¬¬ä¸€æƒ³åˆ°çš„åº”è¯¥å°±æ˜¯ç”¨<code>setInterval</code>å»æ”¹å˜ç›’å­çš„<code>dimensions</code>ï¼Œä½†è¿™æ ·å¯¹æ€§èƒ½æ˜¯ä¸ªä¸å°çš„æŒ‘æˆ˜ã€‚è€ŒCesiumæä¾›ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥è®©å…¶éšæ—¶é—´è‡ªåŠ¨å˜åŒ–å¹¶èµ‹å€¼ï¼Œè¿™å°±æ˜¯Propertyã€‚ä»¥ä¸‹ä»£ç æ˜¯åœ¨5ç§’å†…è®©ç›’å­å¤§å°å˜åŒ–ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> property = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">SampledProperty</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>);<br><br>property.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>)<br>);<br><br>property.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>        <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        <span class="hljs-number">5</span>,<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>    ),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">2000.0</span>, <span class="hljs-number">2000.0</span>, <span class="hljs-number">2000.0</span>)<br>);<br><br>box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = property;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡<code>addSample</code>å‘Propertyå®ä¾‹æ·»åŠ å…³é”®å¸§å¹¶å®šä¹‰æƒ³è¦ä¿®æ”¹çš„å±æ€§ï¼Œæœ€åèµ‹å€¼ç»™boxçš„<code>dimensions</code>ï¼Œæ•ˆæœå¦‚ä¸‹</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dde462283c494bd1a7feee67cb351356~tplv-k3u1fbpfcp-watermark.image" alt="property1.gif"></p><p>æ‰€ä»¥è¯´ï¼Œ<strong>Propertyå¯ä»¥å’Œæ—¶é—´è½´è¿›è¡Œå…³è”ï¼Œå¹¶æ ¹æ®æ—¶é—´è¿”å›å¯¹åº”çš„å±æ€§å€¼</strong>ï¼Œè€ŒEntityåˆ™å¯ä»¥é€šè¿‡è¿”å›çš„å€¼åŠ¨æ€æ”¹å˜å®ä½“çš„ä½ç½®ã€å¤§å°ç­‰ã€‚</p><h2 id="Propertyåˆ†ç±»åŠä½¿ç”¨æ–¹æ³•"><a href="#Propertyåˆ†ç±»åŠä½¿ç”¨æ–¹æ³•" class="headerlink" title="Propertyåˆ†ç±»åŠä½¿ç”¨æ–¹æ³•"></a>Propertyåˆ†ç±»åŠä½¿ç”¨æ–¹æ³•</h2><p>ä¸Šæ–‡ä¸­æˆ‘ä»¬ä¸¾ä¾‹ä½¿ç”¨çš„<code>SampledProperty</code>æä¾›äº†æ’å€¼åŠŸèƒ½ï¼Œè¿˜æœ‰å¾ˆå¤šPropertyçš„ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<a href="https://cesium.com/docs/cesiumjs-ref-doc/">APIæ–‡æ¡£</a>ä¸­æœç´¢ä¸€ä¸‹Propertyï¼Œæ•´æ•´æœ‰29ä¸ªä¹‹å¤šã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eb8bd5dc606949e8a060baf0f1f06f63~tplv-k3u1fbpfcp-watermark.image" alt="image-20210604095802707.png"></p><p>ç®€å•å½’ç±»ä¸€ä¸‹å¯ä»¥åˆ†ä¸ºå‡ ç±»ï¼š</p><ul><li>åŸºæœ¬ç±»å‹ï¼š<code>ConstantProperty</code>ï¼Œ<code>SampledProperty</code>ï¼Œ<code>TimeIntervalCollectionProperty</code>ï¼Œ<code>CompositeProperty</code></li><li>å…¶ä»–ç±»å‹ï¼š<code>CallbackProperty</code>ï¼Œ<code>ReferenceProperty</code>ï¼Œ<code>PropertyArray</code>ï¼Œ<code>PropertyBag</code>ï¼Œ<code>VelocityOrientationProperty</code>ï¼Œ<code>VelocityVectorProperty</code></li><li>æè´¨ç±»å‹ï¼š<code>MaterialProperty</code>åŠå¸¦materialå­—æ ·çš„</li><li>ä½ç½®ç±»å‹ï¼šå¸¦Positionå­—æ ·çš„</li></ul><p>åŒæ—¶Cesiumæä¾›äº†ä¸€ä¸ª<code>Property</code>ç±»ä½œä¸ºæ‰€æœ‰ç±»å‹çš„åŸºç±»ï¼Œå¹¶å®šä¹‰äº†å‡ ä¸ªå…¬å…±å±æ€§åŠæ¥å£ã€‚</p><p><strong>getValue(time, result) â†’ Cartesian3</strong></p><p>è·å–ç‰¹å®šæ—¶é—´ç‚¹ä¸‹çš„å±æ€§å€¼</p><table><thead><tr><th align="left">Name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>time</code></td><td align="left"><a href="https://cesium.com/docs/cesiumjs-ref-doc/JulianDate.html">JulianDate</a></td><td align="left">æ£€ç´¢å€¼çš„æ—¶é—´</td></tr><tr><td align="left"><code>result</code></td><td align="left"><a href="https://cesium.com/docs/cesiumjs-ref-doc/Cartesian3.html">Cartesian3</a></td><td align="left">å°†å€¼å­˜å‚¨åˆ°çš„å¯¹è±¡ã€‚è‹¥ç¼ºçœåˆ™åˆ›å»ºå¹¶è¿”å›æ–°å®ä¾‹</td></tr></tbody></table><p><strong>equal</strong></p><p>ç”¨æ¥åˆ¤æ–­å±æ€§å€¼æ˜¯å¦ç›¸ç­‰ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€äº›å¸¸ç”¨çš„Propertyåšä¸€ä¸‹è®²è§£å’Œä»£ç å®ç°ã€‚</p><h3 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h3><h4 id="SampledProperty"><a href="#SampledProperty" class="headerlink" title="SampledProperty"></a>SampledProperty</h4><p>ç¬¬ä¸€ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨çš„å°±æ˜¯å®ƒï¼Œé€šè¿‡æ·»åŠ ä¸åŒæ—¶é—´ç‚¹çš„Sampleï¼Œåœ¨æ¯ä¸¤ä¸ªæ—¶é—´ç‚¹ä¹‹é—´è¿›è¡Œçº¿æ€§æ’å€¼ï¼Œè¿™é‡Œä¸åšæ¼”ç¤ºï¼Œä»£ç å’Œæ•ˆæœéƒ½åœ¨ç¬¬ä¸€ä¸ªä¾‹å­ä¸­äº†ã€‚</p><h4 id="TimeIntervalCollectionProperty"><a href="#TimeIntervalCollectionProperty" class="headerlink" title="TimeIntervalCollectionProperty"></a>TimeIntervalCollectionProperty</h4><p>ç”¨æ¥æŒ‡å®šå…·ä½“æ—¶é—´æ®µå†…çš„å±æ€§å€¼ï¼Œæ¯ä¸ªæ—¶é—´æ®µå†…å±æ€§å€¼ä¸å˜ã€‚æ‰€ä»¥å’Œ<code>SampledProperty</code>ä¸åŒï¼Œå®ƒå‘ˆç°å‡ºçš„å˜åŒ–ä¸ºè·³è·ƒå¼ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3831511fc064adda66b8eac39162d2e~tplv-k3u1fbpfcp-watermark.image" alt="property2.gif"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> property = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeIntervalCollectionProperty</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span><br>);<br><br><br>property.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">2</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>:<span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>),<br>    &#125;)<br>);<br>property.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">6</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>:<span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">2000.0</span>, <span class="hljs-number">2000.0</span>, <span class="hljs-number">2000.0</span>),<br>    &#125;)<br>);<br>property.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">10</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>),<br>    &#125;)<br>);<br><br>box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = property;<br></code></pre></td></tr></table></figure><h4 id="ConstantProperty"><a href="#ConstantProperty" class="headerlink" title="ConstantProperty"></a>ConstantProperty</h4><p>ä¸éšæ—¶é—´çš„å˜åŒ–è€Œå˜åŒ–çš„å±æ€§ã€‚</p><p>ç›¸å¯¹äºä¸Šè¿°ä¸¤ç§Propertyï¼Œæ›´åŠ å¸¸ç”¨çš„å¯èƒ½å°±æ˜¯è¿™ä¸ª<code>ConstantProperty</code>äº†ï¼Œåœ¨æˆ‘ä»¬å¹³å¸¸è®¾ç½®å®ä½“çš„å±æ€§æ—¶ä¸€èˆ¬éƒ½æ˜¯å¦‚ä¸‹è®¾ç½®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å®é™…ä¸Šå…¶å®å®Œæ•´çš„å†™æ³•åº”è¯¥æ˜¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantProperty</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>));<br></code></pre></td></tr></table></figure><p>è¿™ä¹ˆçœ‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œboxä¸­çš„<code>dismensions</code>å±æ€§å…¶å®æ˜¯<code>Property</code>ç±»å‹ï¼Œåœ¨Cesiumå†…éƒ¨å·å·çš„å°†æˆ‘ä»¬ä¼ å…¥çš„Cartesian3è½¬åŒ–æˆäº†<code>ConstantProperty</code>ç±»å‹ã€‚</p><p><code>ConstantProperty</code>ä¹Ÿå¹¶éä¸èƒ½æ›´æ”¹ï¼Œå®ƒæä¾›äº†<code>setValue</code>æ–¹æ³•å»ä¿®æ”¹å±æ€§å€¼ï¼Œåˆ©ç”¨<code>setValue</code>ä¼šä¿®æ”¹åŸæœ‰çš„å±æ€§å€¼ï¼Œè€Œéåˆ›å»ºæ–°çš„<code>ConstantProperty</code>ã€‚</p><h4 id="CompositeProperty"><a href="#CompositeProperty" class="headerlink" title="CompositeProperty"></a>CompositeProperty</h4><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7c16a6acef6647d9a2f98852d276c413~tplv-k3u1fbpfcp-watermark.image" alt="property3.gif"></p><p>é¡¾åæ€ä¹‰è¿™æ˜¯ä¸ªå¤åˆå±æ€§ï¼Œå®ƒå¯ä»¥å°†å¤šç§Propertyè¿›è¡Œç»„åˆæ“ä½œï¼Œä¾‹å¦‚åœ¨ä¸€æ®µæ—¶é—´å†…éœ€è¦è·³è·ƒæ€§å˜åŒ–ï¼Œç„¶åè¿›è¡Œå¹³æ»‘å˜åŒ–ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿™ç§ç±»å‹ã€‚çœ‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> lineProperty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">SampledProperty</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>);<br><br>lineProperty.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>, <span class="hljs-number">1000.0</span>)<br>);<br><br>lineProperty.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>        <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        <span class="hljs-number">5</span>,<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>    ),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>)<br>);<br><br><span class="hljs-keyword">var</span> timeProperty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeIntervalCollectionProperty</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span><br>);<br><br>timeProperty.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>, <span class="hljs-number">3000.0</span>),<br>    &#125;)<br>);<br>timeProperty.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">10</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">4000.0</span>, <span class="hljs-number">4000.0</span>, <span class="hljs-number">4000.0</span>),<br>    &#125;)<br>);<br>timeProperty.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">15</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isStopIncluded</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">5000.0</span>, <span class="hljs-number">5000.0</span>, <span class="hljs-number">5000.0</span>),<br>    &#125;)<br>);<br><br><span class="hljs-keyword">var</span> compositeProperty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">CompositeProperty</span>();<br>compositeProperty.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">isStopIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: lineProperty,<br>    &#125;)<br>);<br>compositeProperty.<span class="hljs-property">intervals</span>.<span class="hljs-title function_">addInterval</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">TimeInterval</span>(&#123;<br>        <span class="hljs-attr">start</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">stop</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>            <span class="hljs-number">20</span>,<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>        ),<br>        <span class="hljs-attr">isStartIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">isStopIncluded</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">data</span>: timeProperty,<br>    &#125;)<br>);<br><br>box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = compositeProperty;<br></code></pre></td></tr></table></figure><h3 id="ä½ç½®ç±»å‹"><a href="#ä½ç½®ç±»å‹" class="headerlink" title="ä½ç½®ç±»å‹"></a>ä½ç½®ç±»å‹</h3><h4 id="PositionProperty"><a href="#PositionProperty" class="headerlink" title="PositionProperty"></a>PositionProperty</h4><p>åŒPropertyï¼ŒPositionPropertyæ˜¯ä¸€ä¸ªè™šåŸºç±»ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œå®ƒå¢åŠ äº†<code>referenceFrame</code>ï¼Œåªèƒ½è¡¨ç¤º<code>position</code>ã€‚</p><p><code>referenceFrame</code>ç”¨æ¥è·å–positionçš„å‚è€ƒç³»ï¼Œç›®å‰Cesiumæä¾›ä¸¤ç§å‚è€ƒç³»<code>FIXED</code>å’Œ<code>INERTIAL</code>ã€‚é»˜è®¤ä½¿ç”¨çš„<code>FIXED</code>å‚è€ƒç³»ï¼Œå³åæ ‡åœ¨åœ°çƒä¸Šçš„ä½ç½®æ˜¯å›ºå®šçš„ã€‚</p><p>åŸºäºPositionPropertyçš„ç±»å‹æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>CompositePositionProperty</li><li>ConstantPositionProperty</li><li>PositionProperty</li><li>PositionPropertyArray</li><li>SampledPositionProperty</li><li>TimeIntervalCollectionPositionProperty</li></ul><p>ç”¨æ³•ä¸Šå’ŒåŸºæœ¬ç±»å‹åŸºæœ¬ç›¸åŒï¼Œåªä¸è¿‡å®ƒä»¬ä¸“é—¨ç”¨æ¥è¡¨ç¤ºä½ç½®ä¿¡æ¯ã€‚è¿™é‡Œä¸åšä¸¾ä¾‹ã€‚</p><h3 id="æè´¨ç±»å‹"><a href="#æè´¨ç±»å‹" class="headerlink" title="æè´¨ç±»å‹"></a>æè´¨ç±»å‹</h3><h4 id="MaterialProperty"><a href="#MaterialProperty" class="headerlink" title="MaterialProperty"></a>MaterialProperty</h4><p>ä¸“é—¨ç”¨æ¥è¡¨ç¤ºæè´¨ï¼Œæ‰©å±•äº†<code>getType</code>æ–¹æ³•æ¥è·å–æè´¨ç±»å‹ã€‚</p><p>åŒæ ·å®ƒä¹Ÿæœ‰å¾ˆå¤šæ´¾ç”Ÿç±»ï¼Œæ¯”å¦‚<code>ColorMaterialProperty</code>ï¼Œ<code>ImageMaterialProperty</code>ç­‰ç­‰ï¼Œæˆ‘ä»¬åœ¨å¹³æ—¶çš„demoå’Œé¡¹ç›®ä¸­ä¹Ÿéƒ½æœ‰ä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åŸºæœ¬ç±»å‹å’Œæè´¨ç±»å‹å®ç°ä¸€ä¸ªé¢œè‰²çš„åŠ¨æ€æ•ˆæœã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0ffdccbf9898430c8b462b9ef48220f1~tplv-k3u1fbpfcp-watermark.image" alt="property4.gif"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> colorProperty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">SampledProperty</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>);<br><br>colorProperty.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Color</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>)<br>);<br><br>colorProperty.<span class="hljs-title function_">addSample</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>        <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>        <span class="hljs-number">5</span>,<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>    ),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Color</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>);<br><br>box.<span class="hljs-property">box</span>.<span class="hljs-property">material</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ColorMaterialProperty</span>(colorProperty);<br><br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–ç±»å‹"><a href="#å…¶ä»–ç±»å‹" class="headerlink" title="å…¶ä»–ç±»å‹"></a>å…¶ä»–ç±»å‹</h3><h4 id="CallbackProperty"><a href="#CallbackProperty" class="headerlink" title="CallbackProperty"></a>CallbackProperty</h4><p>è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹<code>CallbackProperty</code>ï¼Œå®ƒæ˜¯è‡ªç”±åº¦æœ€é«˜çš„ä¸€ç§ç±»å‹ï¼Œæˆ‘ä»¬åªéœ€è¦æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥è¿”å›æˆ‘ä»¬éœ€è¦çš„å€¼å³å¯ï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥éšæ„è¿›è¡Œæ“ä½œã€‚åœ¨è¿™æˆ‘ä»¬å®ç°ä¸€ä¸ªéšæœºå˜åŒ–é¢œè‰²å¹¶ä¸”ä¸æ–­å¢é«˜çš„boxã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e7314edd2e84eccb663544a1245136d~tplv-k3u1fbpfcp-watermark.image" alt="property5.gif"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> l = <span class="hljs-number">2000.0</span>;<br>box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">CallbackProperty</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">time, result</span>) &#123;<br>    result = result || <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br><br>    l += <span class="hljs-number">20.0</span>;<br>    <span class="hljs-keyword">if</span> (l &gt; <span class="hljs-number">7000.0</span>) &#123;<br>        l = <span class="hljs-number">2000.0</span>;<br>    &#125;<br><br>    result.<span class="hljs-property">x</span> = <span class="hljs-number">4000.0</span>;<br>    result.<span class="hljs-property">y</span> = <span class="hljs-number">3000.0</span>;<br>    result.<span class="hljs-property">z</span> = l;<br>    <span class="hljs-keyword">return</span> result;<br>&#125;, <span class="hljs-literal">false</span>);<br>box.<span class="hljs-property">box</span>.<span class="hljs-property">material</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ColorMaterialProperty</span>(<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">CallbackProperty</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-title function_">fromRandom</span>(&#123;<br>            <span class="hljs-attr">alpha</span>: <span class="hljs-number">1.0</span>,<br>        &#125;);<br>    &#125;, <span class="hljs-literal">false</span>)<br>);<br></code></pre></td></tr></table></figure><h4 id="ReferenceProperty"><a href="#ReferenceProperty" class="headerlink" title="ReferenceProperty"></a>ReferenceProperty</h4><p>è¯¥propertyå¯ä»¥ç›´æ¥é“¾æ¥åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„Propertyï¼Œåšå¼•ç”¨æ•ˆæœã€‚</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>targetCollection</code></td><td align="left">EntityCollection</td><td align="left">å°†ç”¨äºè§£æå¼•ç”¨çš„å®ä½“é›†åˆã€‚</td></tr><tr><td align="left"><code>targetId</code></td><td align="left">String</td><td align="left">è¢«å¼•ç”¨çš„å®ä½“çš„ idã€‚</td></tr><tr><td align="left"><code>targetPropertyNames</code></td><td align="left">Array.<String></td><td align="left">å°†ä½¿ç”¨çš„ç›®æ ‡å®ä½“ä¸Šçš„å±æ€§åç§°ã€‚</td></tr></tbody></table><h4 id="PropertyBag"><a href="#PropertyBag" class="headerlink" title="PropertyBag"></a>PropertyBag</h4><p>å®ƒç”¨æ¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡ŒåŒ…è£…ï¼Œä½¿å¾—è¯¥å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§éƒ½å¯ä½œä¸ºä¸€ä¸ªåŠ¨æ€çš„Propertyè¿›è¡Œä¿®æ”¹ã€‚æ¯”å¦‚ä¹‹å‰ä¿®æ”¹dimensionsçš„è¯ï¼Œdimensionsæ˜¯ä½œä¸ºä¸€ä¸ªCartesian3ç±»å‹å˜é‡æ•´ä½“å°è£…åˆ°Propertyä¸­å»çš„ï¼Œå¦‚æœæˆ‘ä»¬åªæƒ³ä¿®æ”¹dimensionsçš„xã€‚åˆ™å¯ä»¥ä½¿ç”¨PropertyBagæ¥å®ç°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> zp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">SampledProperty</span>(<span class="hljs-title class_">Number</span>);<br>zp.<span class="hljs-title function_">addSample</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()), <span class="hljs-number">2000.0</span>);<br>zp.<span class="hljs-title function_">addSample</span>(<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">addSeconds</span>(<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">fromDate</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()),<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">JulianDate</span>()<br>),, <span class="hljs-number">7000.0</span>);<br><br>box.<span class="hljs-property">box</span>.<span class="hljs-property">dimensions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PropertyBag</span>(&#123;<br>    <span class="hljs-attr">x</span>: <span class="hljs-number">4000.0</span>,<br>    <span class="hljs-attr">y</span>: <span class="hljs-number">3000.0</span>,<br>    <span class="hljs-attr">z</span>: zp<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="VelocityOrientationProperty"><a href="#VelocityOrientationProperty" class="headerlink" title="VelocityOrientationProperty"></a>VelocityOrientationProperty</h4><p>è¯¥Propertyç”¨æ¥Entityçš„positionçš„ä½ç½®å˜åŒ–ï¼Œæ¥è®¡ç®—å‡ºç§»åŠ¨çš„æ–¹å‘ï¼Œæœ€åæŠŠé€Ÿåº¦æ–¹å‘è¾“å‡ºæˆOrientationã€‚Cesiumè‡ªå¸¦çš„ç¤ºä¾‹ä¸­æœ‰ä¸€ä¸ª<a href="https://sandcastle.cesium.com/?src=Interpolation.html">Interpolation</a>ä¸­æœ‰å…¶ç”¨æ³•ï¼Œä¸å†èµ˜è¿°ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>Propertyæœºåˆ¶å¾ˆå¼ºå¤§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¾ˆå¤šåœºæ™¯ä¸­ä½¿ç”¨å®ƒï¼Œæ¯”å¦‚å®ç°ä¸€äº›æ²¿çº¿é£è¡Œã€è·¯å¾„æ¼«æ¸¸æˆ–è€…å®ä½“çš„å¤§å°å±æ€§å˜åŒ–ç­‰ã€‚å¯ä»¥è¯´åªè¦æœ‰ä¿®æ”¹å±æ€§çš„åœ°æ–¹æˆ‘ä»¬éƒ½å¯ä»¥ç”¨åˆ°å®ƒã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆäº”ï¼‰</title>
    <link href="/2021/06/03/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%BA%94%EF%BC%89/"/>
    <url>/2021/06/03/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%BA%94%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd9637ac16fa465d88ec4ece08f0ae58~tplv-k3u1fbpfcp-watermark.image" alt="åˆ†å±‚å±•ç¤º.gif"></p><p>è¿™ä¸ªæ•ˆæœä¹Ÿæ˜¯æˆ‘å¶ç„¶é—´åœ¨ä¸€ä¸ªè§†é¢‘ä¸­çœ‹åˆ°çš„ï¼Œç„¶åå¼€å§‹é€æ­¥ç†æ¸…æ€è·¯åŠ¨æ‰‹å¼€å§‹å®ç°ï¼Œç®€å•æ¥è®²å°±æ˜¯åˆ©ç”¨Entityçš„æ˜¾ç¤ºéšè—ä»¥åŠåæ ‡çš„è½¬æ¢å®ç°ã€‚å› ä¸ºæ˜¯é‡è·¯å­æ‰€ä»¥å¯èƒ½å®ç°è¿‡ç¨‹ç•¥æ˜¾ç²—ç³™æˆ–å†—ä½™ï¼Œæ¥ä¸‹æ¥æ¥æˆ‘ä»¬å¼€å§‹ã€‚</p><h3 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h3><p>æˆ‘ä»¬éœ€è¦åˆ©ç”¨ç‚¹å‡»äº‹ä»¶è·å–æˆ‘ä»¬é€‰ä¸­çš„è¿™ä¸ªå®ä½“ï¼Œéšè—å½“å‰å®ä½“å¹¶è·å–åˆ°å®ƒçš„å¤–å›´åæ ‡é›†æ¥ç”Ÿæˆæ–°çš„å¤šè¾¹å½¢ï¼Œå¹¶ä¸”è¦å¯¹è¿™ä¸ªå¤šè¾¹å½¢è¿›è¡Œæ”¾å¤§å¹³ç§»ç­‰æ“ä½œã€‚åŒæ—¶æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå…³é—­æŒ‰é’®è®©å…¶èƒ½å¤Ÿé€€å‡ºæ‰€è°“çš„åˆ†å±‚æ¨¡å¼ã€‚</p><p>æˆ‘ä»¬å¦‚ä½•å¯¹ä¸€ä¸ªåæ ‡é›†è¿›è¡Œæ“ä½œè®©å®ƒæ‰€ä»£è¡¨çš„å¤šè¾¹å½¢èƒ½å¤Ÿç¼©æ”¾æˆ–å¹³ç§»å‘¢ï¼Ÿè¿™å°±è¦ç”¨åˆ°æˆ‘ä»¬çš„åœ°ç†åˆ†æåº“<code>Turf.js</code>äº†ï¼Œå…³äºTurfçš„ä»‹ç»åŠåŸºæœ¬ä½¿ç”¨æ–¹æ³•æˆ‘åœ¨<a href="https://juejin.cn/post/6968626897156603918">Turf.jsâ€”è®©ä½ åœ¨æµè§ˆå™¨ä¸Šå®ç°åœ°ç†åˆ†æ</a>é‡Œåšäº†ç›¸å…³ä»‹ç»ï¼Œéœ€è¦çš„å°ä¼™ä¼´å¯ä»¥è¿›è¡Œæµè§ˆã€‚</p><p>å…³é—­æŒ‰é’®è¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿè¿˜è®°å¾—å‰é¢çš„æ–‡ç« ä¸­æˆ‘ä»¬è¿›è¡Œçš„ç®€å•çš„æ–‡æœ¬æ ‡è®°ç±»å°è£…å—ï¼Œé“ç†æ˜¯ä¸€æ ·çš„ï¼Œå°†æˆ‘ä»¬æŒ‡å®šçš„divå…ƒç´ æ¸²æŸ“åˆ°Cesiumçš„å®¹å™¨ä¸­ï¼Œå¹¶åœ¨ç±»ä¸­æŒ‡å®šæ‰€éœ€çš„é€»è¾‘ã€æ–¹æ³•ç­‰å³å¯ã€‚</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><h4 id="åˆ†å±‚æ•ˆæœ"><a href="#åˆ†å±‚æ•ˆæœ" class="headerlink" title="åˆ†å±‚æ•ˆæœ"></a>åˆ†å±‚æ•ˆæœ</h4><p>æ€è·¯æ¸…æ™°åæˆ‘ä»¬å¯ä»¥å¼€å§‹åŠŸèƒ½å®ç°ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå®ç°åŠŸèƒ½åå¯¹å…¶å°è£…ï¼Œåœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬åªè´´å‡ºå…³é”®ä»£ç ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥è¯»å®Œæ–‡ç« åäº²è‡ªåŠ¨æ‰‹å®ç°ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è‚¯å®šæ˜¯åŠ è½½ä¸€ä¸ª<code>entity</code>å®ä½“ï¼Œè¿™é‡Œè€ç”Ÿå¸¸è°ˆï¼Œæˆ‘å°±ä¸å¤šåšè¯´æ˜äº†ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ³¨å†Œä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œç”¨æ¥è§¦å‘ç‚¹å‡»å®ä½“åçš„å“åº”å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br><br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-function">(<span class="hljs-params">movement</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">let</span> pick = viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(movement.<span class="hljs-property">position</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Cesium</span>.<span class="hljs-title function_">defined</span>(pick)) &#123;<br>        <span class="hljs-keyword">if</span>(!pick.<span class="hljs-property">id</span>.<span class="hljs-property">isFloor</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFloor</span>(pick.<span class="hljs-property">id</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">selectFloor</span>(pick.<span class="hljs-property">id</span>);<br>        &#125;<br>    &#125;<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br></code></pre></td></tr></table></figure><p>åœ¨å“åº”å‡½æ•°ä¸­æˆ‘ä»¬é¦–å…ˆéšè—ç‚¹å‡»çš„è¿™ä¸ªå®ä½“ï¼Œä¸ºæˆ‘ä»¬çš„åˆ†å±‚å®ä½“é›†è…¾ä½ç½®ï¼Œæ¥ç€è·å–åˆ°è¿™ä¸ªå®ä½“çš„å¤–å›´åæ ‡é›†ï¼Œå¹¶ç”¨å®ƒä½œä¸ºæˆ‘ä»¬çš„åˆ†å±‚å®ä½“çš„åæ ‡é›†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">showFloor</span>(<span class="hljs-params">entity</span>) &#123;<br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">getById</span>(entity.<span class="hljs-property">id</span>).<span class="hljs-property">show</span> = <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">let</span> height = <span class="hljs-number">30</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; entity.<span class="hljs-property">floor</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> floor = &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;floor&quot;</span> + i,<br>            <span class="hljs-attr">id</span>: entity.<span class="hljs-property">id</span> + <span class="hljs-string">&quot;F&quot;</span> + i,<br>            <span class="hljs-attr">isFloor</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">floor</span>: i + <span class="hljs-number">1</span>,<br>          <span class="hljs-attr">positions</span>: entity.<span class="hljs-property">positions</span>,<br>            <span class="hljs-attr">polygon</span>: &#123;<br>                <span class="hljs-comment">// hierarchy: Cesium.Cartesian3.fromDegreesArray(floorPos),</span><br>                <span class="hljs-attr">hierarchy</span>: entity.<span class="hljs-property">polygon</span>.<span class="hljs-property">hierarchy</span>.<span class="hljs-property">_value</span>,<br>                <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">YELLOW</span>.<span class="hljs-title function_">withAlpha</span>(<span class="hljs-number">0.4</span>),<br>                height,<br>                <span class="hljs-attr">outline</span>: <span class="hljs-literal">true</span>,<br>                <span class="hljs-attr">ouelineColor</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">BLACK</span>,<br>            &#125;,<br>        &#125;;<br>        height += <span class="hljs-number">60</span>;<br>        viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(floor);<br>    &#125;<br>&#125;,<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬åŸºæœ¬çš„åˆ†å±‚æ•ˆæœå°±åšå‡ºæ¥äº†ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7dc64dfc11b4473e8822fa53baf471a2~tplv-k3u1fbpfcp-watermark.image" alt="åˆ†å±‚å±•ç¤º1.gif"></p><h4 id="é€‰ä¸­æ•ˆæœ"><a href="#é€‰ä¸­æ•ˆæœ" class="headerlink" title="é€‰ä¸­æ•ˆæœ"></a>é€‰ä¸­æ•ˆæœ</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°é€‰ä¸­æ•ˆæœï¼Œé€‰ä¸­æ•ˆæœæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é«˜äº®ã€å¹³ç§»ã€æ”¾å¤§ä»¥åŠå®ƒä»¬çš„ç»„åˆå±•ç¤ºï¼Œé«˜äº®è¿™é‡Œä¸åšé˜è¿°ï¼Œæ•ˆæœåœ¨æˆ‘ä»¬ç½‘æ ¼å®ç°é‚£ç¯‡æ–‡ç« å·²ç»å®ç°ï¼Œæœ¬æ–‡ä¸»è¦å®ç°æ”¾å¤§æ•ˆæœã€‚</p><p>æƒ³å®ç°æ”¾å¤§æ•ˆæœæˆ‘ä»¬éœ€è¦åˆ©ç”¨<code>Turf.js</code>è¿›è¡Œåæ ‡çš„å˜æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆåœ¨é¡¹ç›®ä¸­å®‰è£…Turf</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">npm i @turf/turf<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦åˆ©ç”¨<code>Turf.js</code>ä¸­çš„<code>polygon</code>å’Œ<code>transformScale</code>å®ç°ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œåœ¨æœ€å¼€å§‹<code>Entity</code>ç”Ÿæˆçš„æ—¶å€™æˆ‘å°†å®ƒçš„äºŒç»´åæ ‡ç»„ä½œä¸ºä¸€ä¸ªå±æ€§ç»‘å®šåˆ°å®ä½“ä¸Šï¼Œä»¥ä¾¿åç»­ä½¿ç”¨ã€‚åœ¨å®é™…é¡¹ç›®ä¸­æ ¹æ®å…·ä½“çš„æƒ…å†µè¿›è¡Œè°ƒæ•´ï¼Œæ¯”å¦‚åˆ©ç”¨ä¸‰ç»´åæ ‡è½¬æ¢æˆ–æ ¹æ®å®ä½“<code>ID</code>è°ƒå–æ¥å£è·å–ç­‰ã€‚</p><p>æˆ‘ä»¬æƒ³ä½¿ç”¨Turfå°±è¦éµå¾ªå®ƒçš„æ ¼å¼ã€‚æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”ŸæˆTurfæ‰¿è®¤çš„Polygonå®ä½“ï¼Œç„¶åå°†å…¶è¿›è¡Œæ”¾å¤§æˆ–ç¼©å°å¹¶è·å–å…¶æ”¾å¤§åçš„åæ ‡æ•°ç»„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> poly = turf.<span class="hljs-title function_">polygon</span>([positions]);<br><span class="hljs-keyword">let</span> translatedPoly = turf.<span class="hljs-title function_">transformScale</span>(poly, <span class="hljs-number">1.4</span>);<br><span class="hljs-keyword">let</span> transPoints = translatedPoly.<span class="hljs-property">geometry</span>.<span class="hljs-property">coordinates</span>[<span class="hljs-number">0</span>];<br></code></pre></td></tr></table></figure><p>ç„¶åç”Ÿæˆä¸€ä¸ªå®ä½“å¹¶æ·»åŠ åˆ°å®ä½“é›†ä¸­å³å¯ã€‚</p><p>è¿™é‡Œåªæ˜¯åšäº†æœ€åŸºæœ¬çš„å®ç°ï¼Œå®Œæ•´çš„æ€è€ƒä¸‹æ¥å…¶å®ä¼šå‘ç°è¿˜æœ‰å¾ˆå¤šéœ€è¦å®Œå–„çš„åœ°æ–¹ã€‚æ¯”å¦‚ï¼šç‚¹å‡»å·²é€‰ä¸­æ¥¼å±‚åå–æ¶ˆé€‰ä¸­ã€é€‰ä¸­æ¥¼å±‚çš„å”¯ä¸€æ€§ç­‰ç­‰ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ac587743c20942a3aadc5fd6fe8285d3~tplv-k3u1fbpfcp-watermark.image" alt="åˆ†å±‚å±•ç¤º2.gif"></p><p>å®Œæ•´æ–¹æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">selectFloor</span>(<span class="hljs-params">floor</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(floor);<br>    <span class="hljs-keyword">let</span> positions = floor.<span class="hljs-property">positions</span>;<br>    <span class="hljs-keyword">let</span> poly, translatedPoly, transPoints, floorPosSingle = [];<br>    poly = turf.<span class="hljs-title function_">polygon</span>([positions]);<br>    translatedPoly = turf.<span class="hljs-title function_">transformScale</span>(poly, <span class="hljs-number">1.4</span>);<br>    transPoints = translatedPoly.<span class="hljs-property">geometry</span>.<span class="hljs-property">coordinates</span>[<span class="hljs-number">0</span>];<br>    transPoints.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>        floorPosSingle.<span class="hljs-title function_">push</span>(item[<span class="hljs-number">0</span>], item[<span class="hljs-number">1</span>]);<br>    &#125;);<br><br>    <span class="hljs-keyword">let</span> selectFloor = &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;select_floor&quot;</span>,<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;active_&#x27;</span> + floor.<span class="hljs-property">id</span>,<br>        <span class="hljs-attr">isFloor</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">polygon</span>: &#123;<br>            <span class="hljs-attr">hierarchy</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>(floorPosSingle),<br>            <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">RED</span>.<span class="hljs-title function_">withAlpha</span>(<span class="hljs-number">0.4</span>),<br>            <span class="hljs-attr">height</span>: floor.<span class="hljs-property">polygon</span>.<span class="hljs-property">height</span>.<span class="hljs-property">_value</span>,<br>            <span class="hljs-attr">outline</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-attr">outlineColor</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">BLACK</span>,<br>        &#125;,<br>    &#125;;<br><br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">getById</span>(floor.<span class="hljs-property">id</span>).<span class="hljs-property">show</span> = <span class="hljs-literal">false</span><br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(selectFloor)<br>&#125;,<br></code></pre></td></tr></table></figure><h4 id="å…³é—­æŒ‰é’®"><a href="#å…³é—­æŒ‰é’®" class="headerlink" title="å…³é—­æŒ‰é’®"></a>å…³é—­æŒ‰é’®</h4><p>å…³é—­æŒ‰é’®è¿™é‡Œä¹Ÿä¸åšè¿‡å¤šè¯´æ˜ï¼Œå’ŒåŠ¨æ€æ–‡æœ¬æ ‡è®°çš„æ€è·¯å¤§è‡´ç›¸åŒï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ç°åœ¨çš„DOMä¸­ç»‘å®šä¸€ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œéœ€è¦é€šè¿‡è¿™ä¸ªäº‹ä»¶è§¦å‘åˆ é™¤åˆ†å±‚å®ä½“é›†å’Œæ¢å¤æ˜¾ç¤ºæ¥¼å±‚ã€‚è¿™é‡Œæˆ‘ç®€å•è¯´æ˜ä¸€ä¸‹å¦‚ä½•åœ¨å°è£…çš„ç±»ä¸­è°ƒç”¨vueæ–‡ä»¶ä¸‹çš„æ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// classç±»ä¸­</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">_vmInstance</span>.<span class="hljs-property">closeEvent</span> = <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">close</span>();<br>&#125;;<br><br><span class="hljs-title function_">close</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_vmInstance</span>.<span class="hljs-property">show</span> = <span class="hljs-literal">false</span>; <span class="hljs-comment">//åˆ é™¤dom</span><br>    <span class="hljs-comment">// do somethingâ€¦â€¦</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vue">// vueæ–‡ä»¶ä¸­<br>&lt;div :id=&quot;id&quot; class=&quot;close-container&quot; v-if=&quot;show&quot; @click=&quot;closeClick&quot;&gt;&lt;/div&gt;<br><br>closeClick() &#123;<br>    if (this.closeEvent) &#123;<br>    this.closeEvent();<br>    &#125;<br>&#125;,<br></code></pre></td></tr></table></figure><h4 id="ç‰¹æ®Šæƒ…å†µ"><a href="#ç‰¹æ®Šæƒ…å†µ" class="headerlink" title="ç‰¹æ®Šæƒ…å†µ"></a>ç‰¹æ®Šæƒ…å†µ</h4><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/20d92729e36846688dfe0fe31e94a514~tplv-k3u1fbpfcp-watermark.image" alt="åˆ†å±‚å±•ç¤º3.gif"></p><p>æœ‰æ—¶å€™æˆ‘ä»¬ä¼šå‘ç°ï¼Œæˆ‘ä»¬çš„å®ä½“å¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¤šè¾¹å½¢ä½“ï¼Œæœ‰å¯èƒ½æ˜¯ç¯çŠ¶æˆ–å¸¦æ´çš„å¤šè¾¹å½¢ï¼Œè¿™æ—¶å€™åˆ©ç”¨ä¸Šè¿°çš„æ–¹æ³•ä¼šå‘ç°ç–¯ç‹‚æŠ¥é”™ã€‚åŸå› æ˜¯æ— è®ºæ˜¯Ceisumä¸­è¿˜æ˜¯Turfä¸­ï¼Œå¸¦æ´å¤šè¾¹å½¢çš„åæ ‡æ ¼å¼éƒ½å’Œæ™®é€šçš„å¤šè¾¹å½¢æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸‹é¢ç®€å•è¯´æ˜ä¸€ä¸‹ä¸¤ä¸ªåº“ä¸­å¸¦æ´å¤šè¾¹å½¢çš„ç”Ÿæˆæ–¹å¼ã€‚</p><h5 id="Cesium"><a href="#Cesium" class="headerlink" title="Cesium"></a>Cesium</h5><p>åœ¨Ceisumä¸­ï¼Œ<code>entity.polygon.hierarchy</code>ä½œä¸ºå¤šè¾¹å½¢çš„å¤–å›´åæ ‡é›†ï¼Œæä¾›äº†ä¸¤ç§å†™æ³•ï¼Œä¸Šæ–‡ä¸­çš„å†™æ³•ä¸ºç®€å†™ï¼Œé»˜è®¤ä¸å¸¦æ´ï¼Œè€Œå¸¦æ´å¤šè¾¹å½¢åˆ™éœ€è¦æä¾›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªå­—æ®µ<code>positions</code>å’Œ<code>holes</code>ã€‚é¡¾åæ€ä¹‰ï¼Œä¸€ä¸ªæ˜¯å¤–å›´åæ ‡é›†ï¼Œä¸€ä¸ªæ˜¯æ´åæ ‡é›†ã€‚å…¶ä¸­<code>holes</code>å¯ä»¥æä¾›å¤šä¸ªåæ ‡é›†ï¼Œç›¸å½“äºæŒ–å¤šä¸ªæ´ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> entity = &#123;<br>    <span class="hljs-attr">polygon</span>:&#123;<br>        <span class="hljs-attr">hierarchy</span>:&#123;<br>            <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>(outPos),<br>            <span class="hljs-attr">holes</span>: [<br>                &#123; <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>(inPos) &#125;<br>            ]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="Turf-js"><a href="#Turf-js" class="headerlink" title="Turf.js"></a>Turf.js</h5><p>è€Œåœ¨Turfä¸­ï¼Œæˆ‘ä»¬æ— æ³•å®ç°ç›´æ¥ææ´ï¼Œåªèƒ½æ›²çº¿æ•‘å›½ï¼Œå°†æ´çš„åæ ‡é›†å’Œå¤–å›´åæ ‡é›†ç”Ÿæˆå¤šè¾¹å½¢å¹¶åˆ†åˆ«è¿›è¡Œæ”¾å¤§æ“ä½œï¼Œè·å–åæ ‡åè¿›è¡Œæˆ‘ä»¬æƒ³è¦çš„å®ç°ã€‚</p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è¿™ä¸ªä¾‹å­ç»“åˆäº†å‰é¢çš„å°è£…DOMç±»ä»¥åŠç‚¹å‡»äº‹ä»¶çš„è¿ç”¨ï¼Œä¾‹å­è™½ç„¶ç²—ç³™ä½†æ˜¯èƒ½å¤Ÿå¸®æˆ‘ä»¬å·©å›ºç›¸å…³çŸ¥è¯†ã€‚è¿™ç¯‡æ–‡ç« ä¹Ÿä¼šæ”¶å½•åˆ°æˆ‘çš„ä¸“æ ä¸­ï¼Œé‡Œé¢ä¹Ÿæœ‰å…¶ä»–æ•ˆæœçš„å®ç°ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥ç‚¹å‡»è®¢é˜…ã€‚å¦‚æœæœ‰å¥½çš„å»ºè®®æˆ–æé†’æ¬¢è¿è¯„è®ºåŒºæµè§ˆæˆ–æ·»åŠ è”ç³»æ–¹å¼å…±åŒå­¦ä¹ è¿›æ­¥ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Cesiumæºç è·Ÿè¯»ä¹‹CesiumWidgetçš„å®ç°</title>
    <link href="/2021/06/02/Cesium%E6%BA%90%E7%A0%81%E8%B7%9F%E8%AF%BB%E4%B9%8BCesiumWidget%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
    <url>/2021/06/02/Cesium%E6%BA%90%E7%A0%81%E8%B7%9F%E8%AF%BB%E4%B9%8BCesiumWidget%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ²¡é”™ï¼Œæˆ‘ä¹Ÿæ¥è¯»æºç äº†ï¼Œå› ä¸ºä¹‹å‰çš„æ–‡ç« ä¸­ç®€å•æåˆ°äº†ä¸€ä¸‹Cesiumçš„æ¸²æŸ“æœºåˆ¶ï¼Œæ‰€ä»¥æˆ‘ç´¢æ€§ä¸€å’¬ç‰™å°†è¿™å—çš„æºç é€šè¯»ä¸€éï¼Œè‡ªå·±ä¹Ÿèƒ½æ›´æ·±å…¥çš„äº†è§£Cesiumï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿå°±ä½œä¸ºæˆ‘çš„ä¸€ä¸ªè®°å½•ã€‚å‡†å¤‡å·¥ä½œåªæœ‰ä¸€æ­¥ï¼šä»GitHubä¸Šæ‹‰å–ä¸€ä»½Cesiumæœ€æ–°çš„ä»£ç ï¼Œæ‰¾åˆ°<code>Source\Widgets\CesiumWidget\CesiumWidget.js</code>æ–‡ä»¶ã€‚</p><blockquote><p>æ–‡ç« ä¸­ä»£ç ä»…ä¸ºæ¶‰åŠåˆ°è®²è§£éƒ¨åˆ†çš„ä»£ç ï¼Œæœªå…¨éƒ¨æ”¾å‡º</p></blockquote><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>CesiumWidgetçš„ç”¨æ³•å’ŒViewerçš„ç”¨æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªidæ¥ç”Ÿæˆå®¹å™¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> widget = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">CesiumWidget</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<br><span class="hljs-keyword">const</span> viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<br></code></pre></td></tr></table></figure><p>ä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œåªè¦å®ä¾‹åŒ–äº†Vieweråˆ™å¿…å®šä¼šå®ä¾‹åŒ–ä¸€ä¸ªCesiumWidgetã€‚Vieweré™¤äº†å¯è§†åŒºåŸŸå¤–è¿˜å›Šæ‹¬äº†å„ç§æ§ä»¶ï¼Œæ¯”å¦‚æ—¶é—´è½´ã€æ—¶é—´æ‹¨ç›˜ã€æœç´¢æ¡†ç­‰ã€‚</p><blockquote><p>Cesiumä¸­ä½¿ç”¨WebGLè¿›è¡Œç»˜å›¾çš„æ˜¯å®ä¾‹åŒ–çš„Sceneæ¨¡å—ã€‚CesiumWidgetæ›´åƒä¸€ä¸ªæ¡¥æ¢ï¼ŒæŠŠæ„é€ æ—¶ä¼ é€’çš„DOMå…ƒç´ ï¼ˆæˆ–IDé€‰æ‹©å™¨ï¼‰å†å†…åµŒäº†ä¸€ä¸ªcanvaså…ƒç´ ï¼Œå†å°†æ­¤canvaså…ƒç´ ä¼ é€’ç»™Sceneè®©å…¶ç»˜å›¾ã€‚</p></blockquote><h3 id="å†…éƒ¨æ–¹æ³•"><a href="#å†…éƒ¨æ–¹æ³•" class="headerlink" title="å†…éƒ¨æ–¹æ³•"></a>å†…éƒ¨æ–¹æ³•</h3><ul><li>[24è¡Œ]<code>getDefaultSkyBoxUrl</code>ï¼šè·å–é»˜è®¤å¤©ç©ºç›’èµ„æºåœ°å€</li><li>[30è¡Œ]<code>startRenderLoop</code>ï¼šå¼€å¯æ¸²æŸ“å¾ªç¯ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸Šä¸€ç¯‡ä¸­æåˆ°çš„Cesiumçš„æ¸²æŸ“æœºåˆ¶ã€‚åˆ©ç”¨<code>requestAnimationFrame</code>æ¥ä¸åœçš„åˆ·æ–°æ¸²æŸ“é¡µé¢ã€‚</li><li>[71è¡Œ]<code>configurePixelRatio</code>ï¼šé…ç½®åƒç´ æ¯”ã€‚</li><li>[86è¡Œ]<code>configureCanvasSize</code>ï¼šé…ç½®ç”»å¸ƒå¤§å°ã€‚</li><li>[105è¡Œ]<code>configureCameraFrustum</code>ï¼šé…ç½®ç›¸æœºè§†é”¥ã€‚</li></ul><h3 id="æ„é€ "><a href="#æ„é€ " class="headerlink" title="æ„é€ "></a>æ„é€ </h3><h4 id="DOMæ„é€ "><a href="#DOMæ„é€ " class="headerlink" title="DOMæ„é€ "></a>DOMæ„é€ </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">CesiumWidget</span>(<span class="hljs-params">container, options</span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(container)) &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeveloperError</span>(<span class="hljs-string">&quot;container is required.&quot;</span>);<br>    &#125;<br>    <br>  container = <span class="hljs-title function_">getElement</span>(container);<br>  options = <span class="hljs-title function_">defaultValue</span>(options, defaultValue.<span class="hljs-property">EMPTY_OBJECT</span>);<br>    <span class="hljs-comment">//Configure the widget DOM elements</span><br>    <span class="hljs-keyword">var</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>    element.<span class="hljs-property">className</span> = <span class="hljs-string">&quot;cesium-widget&quot;</span>;<br>    container.<span class="hljs-title function_">appendChild</span>(element);<br>    <span class="hljs-keyword">var</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;canvas&quot;</span>);<br>    <br>    <span class="hljs-comment">// â€¦â€¦</span><br>    <br>  element.<span class="hljs-title function_">appendChild</span>(canvas);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™éƒ¨åˆ†ä»£ç å®Œæˆäº†Viewerå®ä¾‹çš„DOMå…ƒç´ åˆ¤æ–­ã€æœ¬çº§DOMå…ƒç´ åˆ›å»ºå’Œä¸‹çº§DOMï¼ˆ<code>canvas</code>ï¼‰çš„åˆ›å»ºï¼Œä»¥åŠä¼ å…¥çš„<code>options</code>æ˜¯å¦ä¸ºç©ºã€‚</p><p>å¦‚æ­¤DOMçš„å±‚çº§ä¾¿ç”Ÿæˆå®Œæ¯•äº†ï¼Œä¸‹æ–¹ä»£ç ï¼ˆ227~263è¡Œï¼‰ä¸»è¦æ˜¯åƒå•†æ ‡è¿™ç§éƒ¨åˆ†ä»¥åŠåˆ†è¾¨ç‡ç­‰è®¾ç½®ã€å°†CesiumWidgetçš„ç§æœ‰å˜é‡èµ‹å€¼å¹¶è°ƒç”¨<code>configureCanvasSize</code>æ¥ä¿®æ”¹<code>canvas</code>çš„å¤§å°ã€‚</p><h4 id="åœºæ™¯æ„é€ "><a href="#åœºæ™¯æ„é€ " class="headerlink" title="åœºæ™¯æ„é€ "></a>åœºæ™¯æ„é€ </h4><p>ä»265è¡Œå¼€å§‹æˆ‘ä»¬ä¼šçœ‹åˆ°ä¸€ä¸ªå·¨å¤§çš„<code>try/catch</code>æ¨¡å—ã€‚è¿™éƒ¨åˆ†ä»£ç å®Œæˆäº†<code>Scene</code>ã€<code>Globe</code>ã€<code>SkyBox</code>ã€<code>SkyAtmosphere</code>å››ä¸ªæ¨¡å—çš„å®ä¾‹åŒ–ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨<code>CesiumWidget</code>çš„æ—¶å€™ï¼Œæ˜æ˜æœ‰åƒ<code>Camera</code>ã€<code>ImageryLayers</code>ä¹‹ç±»çš„APIï¼Œæ˜¯ä»å“ªæ¥çš„å‘¢ã€‚è¿™é‡Œå…ˆå–ä¸ªå…³å­ï¼Œæˆ‘ä»¬å…ˆä¸“æ³¨äº<code>Scene</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> scene = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scene</span>(&#123;<br>    <span class="hljs-attr">canvas</span>: canvas,<br>    <span class="hljs-attr">contextOptions</span>: options.<span class="hljs-property">contextOptions</span>,<br>    <span class="hljs-attr">creditContainer</span>: innerCreditContainer,<br>    <span class="hljs-attr">creditViewport</span>: creditViewport,<br>    <span class="hljs-attr">mapProjection</span>: options.<span class="hljs-property">mapProjection</span>,<br>    <span class="hljs-attr">orderIndependentTranslucency</span>: options.<span class="hljs-property">orderIndependentTranslucency</span>,<br>    <span class="hljs-attr">scene3DOnly</span>: <span class="hljs-title function_">defaultValue</span>(options.<span class="hljs-property">scene3DOnly</span>, <span class="hljs-literal">false</span>),<br>    <span class="hljs-attr">terrainExaggeration</span>: options.<span class="hljs-property">terrainExaggeration</span>,<br>    <span class="hljs-attr">shadows</span>: options.<span class="hljs-property">shadows</span>,<br>    <span class="hljs-attr">mapMode2D</span>: options.<span class="hljs-property">mapMode2D</span>,<br>    <span class="hljs-attr">requestRenderMode</span>: options.<span class="hljs-property">requestRenderMode</span>,<br>    <span class="hljs-attr">maximumRenderTimeChange</span>: options.<span class="hljs-property">maximumRenderTimeChange</span>,<br>&#125;);<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">_scene</span> = scene;<br></code></pre></td></tr></table></figure><p>å®ä¾‹åŒ–Sceneå¯¹è±¡ï¼Œä¼ é€’æ„é€ çš„å‚æ•°ï¼ˆç»å¤§éƒ¨åˆ†æ¥è‡ªäºoptionsï¼‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">scene.<span class="hljs-property">camera</span>.<span class="hljs-property">constrainedAxis</span> = <span class="hljs-title class_">Cartesian3</span>.<span class="hljs-property">UNIT_Z</span>;<br><br><span class="hljs-title function_">configurePixelRatio</span>(<span class="hljs-variable language_">this</span>);<br><span class="hljs-title function_">configureCameraFrustum</span>(<span class="hljs-variable language_">this</span>);<br></code></pre></td></tr></table></figure><p>æŒ‡å®š<code>camera</code>çš„çº¦æŸè½´ä¸ºZè½´ï¼Œè°ƒç”¨å‡½æ•°æ¥é…ç½®åƒç´ æ¯”ã€ç›¸æœºè§†é”¥ä½“ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> ellipsoid = <span class="hljs-title function_">defaultValue</span>(<br>    scene.<span class="hljs-property">mapProjection</span>.<span class="hljs-property">ellipsoid</span>,<br>    <span class="hljs-title class_">Ellipsoid</span>.<span class="hljs-property">WGS84</span><br>);<br><span class="hljs-keyword">var</span> globe = options.<span class="hljs-property">globe</span>;<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(globe)) &#123;<br>    globe = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Globe</span>(ellipsoid);<br>&#125;<br><span class="hljs-keyword">if</span> (globe !== <span class="hljs-literal">false</span>) &#123;<br>    scene.<span class="hljs-property">globe</span> = globe;<br>    scene.<span class="hljs-property">globe</span>.<span class="hljs-property">shadows</span> = <span class="hljs-title function_">defaultValue</span>(<br>        options.<span class="hljs-property">terrainShadows</span>,<br>        <span class="hljs-title class_">ShadowMode</span>.<span class="hljs-property">RECEIVE_ONLY</span><br>    );<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ›å»º<code>ellipsoid</code>å’Œ<code>globe</code>å¹¶ä¼ é€’ç»™<code>scene</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> skyBox = options.<span class="hljs-property">skyBox</span>;<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(skyBox)) &#123;<br>    skyBox = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SkyBox</span>(&#123;<br>        <span class="hljs-attr">sources</span>: &#123;<br>            <span class="hljs-attr">positiveX</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;px&quot;</span>),<br>            <span class="hljs-attr">negativeX</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;mx&quot;</span>),<br>            <span class="hljs-attr">positiveY</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;py&quot;</span>),<br>            <span class="hljs-attr">negativeY</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;my&quot;</span>),<br>            <span class="hljs-attr">positiveZ</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;pz&quot;</span>),<br>            <span class="hljs-attr">negativeZ</span>: <span class="hljs-title function_">getDefaultSkyBoxUrl</span>(<span class="hljs-string">&quot;mz&quot;</span>),<br>        &#125;,<br>    &#125;);<br>&#125;<br><span class="hljs-keyword">if</span> (skyBox !== <span class="hljs-literal">false</span>) &#123;<br>    scene.<span class="hljs-property">skyBox</span> = skyBox;<br>    scene.<span class="hljs-property">sun</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sun</span>();<br>    scene.<span class="hljs-property">moon</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Moon</span>();<br>&#125;<br><br><span class="hljs-comment">// Blue sky, and the glow around the Earth&#x27;s limb.</span><br><span class="hljs-keyword">var</span> skyAtmosphere = options.<span class="hljs-property">skyAtmosphere</span>;<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(skyAtmosphere)) &#123;<br>    skyAtmosphere = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SkyAtmosphere</span>(ellipsoid);<br>&#125;<br><span class="hljs-keyword">if</span> (skyAtmosphere !== <span class="hljs-literal">false</span>) &#123;<br>    scene.<span class="hljs-property">skyAtmosphere</span> = skyAtmosphere;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åˆ›å»ºå¤©ç©ºç›’ã€å¤§æ°”ç¯å¢ƒç­‰ç¯å¢ƒå› ç´ ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//Set the base imagery layer</span><br><span class="hljs-keyword">var</span> imageryProvider =<br>    options.<span class="hljs-property">globe</span> === <span class="hljs-literal">false</span> ? <span class="hljs-literal">false</span> : options.<span class="hljs-property">imageryProvider</span>;<br><span class="hljs-keyword">if</span> (!<span class="hljs-title function_">defined</span>(imageryProvider)) &#123;<br>    imageryProvider = <span class="hljs-title function_">createWorldImagery</span>();<br>&#125;<br><br><span class="hljs-keyword">if</span> (imageryProvider !== <span class="hljs-literal">false</span>) &#123;<br>    scene.<span class="hljs-property">imageryLayers</span>.<span class="hljs-title function_">addImageryProvider</span>(imageryProvider);<br>&#125;<br><br><span class="hljs-comment">//Set the terrain provider if one is provided.</span><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_">defined</span>(options.<span class="hljs-property">terrainProvider</span>) &amp;&amp; options.<span class="hljs-property">globe</span> !== <span class="hljs-literal">false</span>) &#123;<br>    scene.<span class="hljs-property">terrainProvider</span> = options.<span class="hljs-property">terrainProvider</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®¾ç½®å½±åƒæ•°æ®æºï¼Œå¦‚æœæ²¡æœ‰é…ç½®ï¼Œåˆ™è°ƒç”¨<code>createWorldImagery</code>æ¨¡å—åˆ›å»ºä¸–ç•Œå½±åƒå¹¶ä¼ é€’ç»™<code>scene</code>ï¼Œå¦‚æœé…ç½®ä¸­æœ‰åœ°å½¢æ•°æ®æºï¼Œåˆ™å°†å…¶ä¼ é€’ç»™<code>scene</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">_screenSpaceEventHandler</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ScreenSpaceEventHandler</span>(canvas);<br></code></pre></td></tr></table></figure><p>åˆ›å»ºäº‹ä»¶å¤„ç†å™¨ï¼Œç”¨äºä¸‹æ–¹æš´éœ²åœ¨åŸå‹ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (<span class="hljs-title function_">defined</span>(options.<span class="hljs-property">sceneMode</span>)) &#123;    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">sceneMode</span> === <span class="hljs-title class_">SceneMode</span>.<span class="hljs-property">SCENE2D</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_scene</span>.<span class="hljs-title function_">morphTo2D</span>(<span class="hljs-number">0</span>);    &#125;    <span class="hljs-keyword">if</span> (options.<span class="hljs-property">sceneMode</span> === <span class="hljs-title class_">SceneMode</span>.<span class="hljs-property">COLUMBUS_VIEW</span>) &#123;        <span class="hljs-variable language_">this</span>.<span class="hljs-property">_scene</span>.<span class="hljs-title function_">morphToColumbusView</span>(<span class="hljs-number">0</span>);    &#125;&#125;<br></code></pre></td></tr></table></figure><p>åˆ¤æ–­<code>scene</code>çš„è§†å›¾æ¨¡å¼æ˜¯äºŒç»´ã€ä¸‰ç»´è¿˜æ˜¯2.5çš„ã€‚</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> that = <span class="hljs-variable language_">this</span>;<span class="hljs-variable language_">this</span>.<span class="hljs-property">_onRenderError</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">scene, error</span>) &#123;    that.<span class="hljs-property">_useDefaultRenderLoop</span> = <span class="hljs-literal">false</span>;    that.<span class="hljs-property">_renderLoopRunning</span> = <span class="hljs-literal">false</span>;    <span class="hljs-keyword">if</span> (that.<span class="hljs-property">_showRenderLoopErrors</span>) &#123;        <span class="hljs-keyword">var</span> title =            <span class="hljs-string">&quot;An error occurred while rendering.  Rendering has stopped.&quot;</span>;        that.<span class="hljs-title function_">showErrorPanel</span>(title, <span class="hljs-literal">undefined</span>, error);    &#125;&#125;;scene.<span class="hljs-property">renderError</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">_onRenderError</span>);<br></code></pre></td></tr></table></figure><p>ç»™<code>scene</code>ç»‘å®šäº†æ¸²æŸ“é”™è¯¯äº‹ä»¶çš„å¤„ç†å‡½æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">_useDefaultRenderLoop</span> = <span class="hljs-literal">undefined</span>;<span class="hljs-variable language_">this</span>.<span class="hljs-property">useDefaultRenderLoop</span> = <span class="hljs-title function_">defaultValue</span>(    options.<span class="hljs-property">useDefaultRenderLoop</span>,    <span class="hljs-literal">true</span>);<span class="hljs-variable language_">this</span>.<span class="hljs-property">_targetFrameRate</span> = <span class="hljs-literal">undefined</span>;<span class="hljs-variable language_">this</span>.<span class="hljs-property">targetFrameRate</span> = options.<span class="hljs-property">targetFrameRate</span>;<br></code></pre></td></tr></table></figure><p>ç¡®è®¤æ˜¯å¦ä½¿ç”¨é»˜è®¤å¾ªç¯æœºåˆ¶ï¼Œå¦‚æœé…ç½®ä¸ºfalseåˆ™éœ€è¦æ‰‹åŠ¨è°ƒç”¨<code>render()</code>æ–¹æ³•ï¼Œå¦åˆ™ä½¿ç”¨ç›®æ ‡å¸§é€Ÿç‡è¿›è¡Œæ¸²æŸ“ã€‚</p><h4 id="åŸå‹å®šä¹‰"><a href="#åŸå‹å®šä¹‰" class="headerlink" title="åŸå‹å®šä¹‰"></a>åŸå‹å®šä¹‰</h4><p>æˆ‘ä»¬åœ¨ä¸Šè¾¹æè¿‡ï¼Œ<code>CesiumWidget</code>é‚£ä¹ˆå¤šçš„APIéƒ½æ˜¯ä»å“ªæ¥çš„ï¼Œä»£ç è¯»åˆ°è¿™é‡Œæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œä»390è¡Œå‘ä¸‹ï¼Œéƒ½æ˜¯åˆ©ç”¨<code>Object.defineProperties()</code>åœ¨CesiumWidgetçš„åŸå‹ä¸Šæ·»åŠ å±æ€§ä»¥åŠæ–¹æ³•ã€‚</p><h5 id="å±æ€§å®šä¹‰"><a href="#å±æ€§å®šä¹‰" class="headerlink" title="å±æ€§å®šä¹‰"></a>å±æ€§å®šä¹‰</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperties</span>(<span class="hljs-title class_">CesiumWidget</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>, &#123;    <span class="hljs-attr">container</span>: &#123;        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_container</span>;        &#125;,    &#125;,    <span class="hljs-attr">canvas</span>: &#123;        <span class="hljs-attr">get</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_canvas</span>;        &#125;,    &#125;,    <span class="hljs-comment">// â€¦â€¦&#125;</span><br></code></pre></td></tr></table></figure><h5 id="æ–¹æ³•å®šä¹‰"><a href="#æ–¹æ³•å®šä¹‰" class="headerlink" title="æ–¹æ³•å®šä¹‰"></a>æ–¹æ³•å®šä¹‰</h5><ul><li>[640è¡Œ] <code>CesiumWidget.prototype.showErrorPanel</code>ï¼šå‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯é¢æ¿ï¼Œå…¶ä¸­åŒ…å«æ ‡é¢˜å’Œè¾ƒé•¿çš„é”™è¯¯æ¶ˆæ¯ï¼Œå¯ä»¥ä½¿ç”¨â€™ç¡®å®šâ€™æŒ‰é’®å°†å…¶å…³é—­ã€‚è¯¥é¢æ¿è‡ªåŠ¨æ˜¾ç¤ºå‘ç”Ÿæ¸²æŸ“å¾ªç¯é”™è¯¯æ—¶ï¼Œå¦‚æœshowRenderLoopErrorsä¸ä¸ºfalseï¼Œåˆ™å½“å°éƒ¨ä»¶å·²æ„å»ºã€‚</li><li>[740è¡Œ]<code>CesiumWidget.prototype.isDestroyed</code>ï¼šè¿”å›<code>CesiumWidget</code>æ˜¯å¦è¢«é”€æ¯ã€‚</li><li>[748è¡Œ]<code>CesiumWidget.prototype.destroy</code>ï¼šé”€æ¯è§†å›¾ã€‚</li><li>[763è¡Œ]<code>CesiumWidget.prototype.resize</code>ï¼šæ›´æ–°ç”»å¸ƒå¤§å°ã€ç›¸æœºçºµæ¨ªæ¯”å’Œè§†å£å¤§å°ã€‚è¿™ä¸ªå‡½æ•°é»˜è®¤ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œé™¤é<code>useDefaultRenderLoop</code>è®¾ç½®ä¸º<code>false</code>ã€‚</li><li>[785è¡Œ]<code>CesiumWidget.prototype.render</code>ï¼šæ¸²æŸ“åœºæ™¯ï¼ŒåŒæ ·çš„å®ƒä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œé™¤é<code>useDefaultRenderLoop</code>è®¾ç½®ä¸º<code>false</code>ã€‚</li></ul><h4 id="å¯¼å‡º"><a href="#å¯¼å‡º" class="headerlink" title="å¯¼å‡º"></a>å¯¼å‡º</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">CesiumWidget</span>;<br></code></pre></td></tr></table></figure><p>æœ€åå¯¹æ•´ä¸ªæ¨¡å—è¿›è¡Œå¯¼å‡ºã€‚</p><h3 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h3><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6be7ebf0514d4f2b92013e23418e3c42~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531155553870.png"></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æˆ‘ä»¬åªæ˜¯é’ˆå¯¹è¿™ä¸ªæ–‡ä»¶ä¸­çš„ç§æœ‰å‡½æ•°ä»¥åŠæ„é€ å‡½æ•°è¿›è¡Œé˜…è¯»å’Œåˆ†æï¼Œå¹¶æœªå¯¹å…¶å¼•ç”¨çš„æ¨¡å—æ¯”å¦‚<code>Scene</code>ã€<code>Globe</code>ç­‰è¿›è¡Œé˜…è¯»ã€‚æ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥é’ˆå¯¹å…¶ä¸­ä¸€ä¸ªå¼•å…¥çš„æ¨¡å—è¿›è¡Œæ›´æ·±å…¥çš„é˜…è¯»ã€‚å¦‚æœæ˜¯æƒ³åœ¨Cesiumä¸Šæ·±å…¥ç ”ç©¶çš„è¯æˆ‘è®¤ä¸ºæœ‰äº›åŠŸèƒ½å’Œå®ç°çš„æºç å¤§æ¦‚é€šè¯»ä¸€ä¸‹ï¼Œäº†è§£ä¸€ä¸‹å®ç°åŸç†æ˜¯æœ‰å¿…è¦çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Turf.jsâ€”è®©ä½ åœ¨æµè§ˆå™¨ä¸Šå®ç°åœ°ç†åˆ†æ</title>
    <link href="/2021/06/01/Turf.js%E2%80%94%E8%AE%A9%E4%BD%A0%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E5%AE%9E%E7%8E%B0%E5%9C%B0%E7%90%86%E5%88%86%E6%9E%90/"/>
    <url>/2021/06/01/Turf.js%E2%80%94%E8%AE%A9%E4%BD%A0%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E5%AE%9E%E7%8E%B0%E5%9C%B0%E7%90%86%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä»¬åœ¨åœ°å›¾ç›¸å…³ç³»ç»Ÿä¸­å¿…ä¸å¯å°‘çš„å°±æ˜¯ç©ºé—´åˆ†ææ“ä½œç›¸å…³éœ€æ±‚ï¼Œä¾‹å¦‚ç¼“å†²åŒºã€è®¡ç®—ç­‰é«˜çº¿ç­‰ã€‚å‡­å€Ÿç®€å•çš„jsæˆ‘ä»¬æ— æ³•å°†ç‚¹çº¿é¢è¿›è¡Œç»“åˆåˆ†æï¼Œè€Œ<code>Turf.js</code>çš„å‡ºç°å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸€éš¾é¢˜ï¼Œè®©æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­ä¹Ÿå¯ä»¥è½»æ¾çš„ä½¿ç”¨ä»¥å‰åªå±äºæ¡Œé¢GISçš„åˆ†æåŠŸèƒ½ã€‚</p><h2 id="Turf-jsç®€ä»‹åŠå…¶æ„ä¹‰"><a href="#Turf-jsç®€ä»‹åŠå…¶æ„ä¹‰" class="headerlink" title="Turf.jsç®€ä»‹åŠå…¶æ„ä¹‰"></a>Turf.jsç®€ä»‹åŠå…¶æ„ä¹‰</h2><p>Turf.jsæ˜¯MapBoxå…¬å¸ç ”å‘çš„åŸºäºæµè§ˆå™¨ç«¯çš„ç©ºé—´åˆ†æåº“ï¼Œå®ƒä½¿ç”¨JavaScriptè¿›è¡Œç¼–å†™ï¼Œé€šè¿‡npmè¿›è¡ŒåŒ…ç®¡ç†ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè‰¯å¥½çš„æ¨¡å—åŒ–è®¾è®¡ä½¿å…¶ä¸ä»…èƒ½å¤Ÿä½œç”¨äºæµè§ˆå™¨ç«¯ã€è¿˜å¯é€šè¿‡Node.jsåœ¨æœåŠ¡ç«¯ä½¿ç”¨ã€‚Turf åŸç”Ÿæ”¯æŒ GeoJSON çŸ¢é‡æ•°æ®ã€‚GeoJSON çš„ä¼˜ç‚¹æ˜¯ç»“æ„ç®€å•ï¼Œå¹¶ä¸”å¾—åˆ°äº†æ‰€æœ‰ç½‘é¡µåœ°å›¾APIçš„æ”¯æŒï¼›ä½† GeoJSON ä¸æ”¯æŒç©ºé—´ç´¢å¼•ï¼Œè¿™ä¸ªç¼ºç‚¹å¯èƒ½ä¼šé™åˆ¶ Turf å¤„ç†å¤§å‹æ–‡ä»¶çš„èƒ½åŠ›æ•ˆç‡ã€‚å…¶é€‚ç”¨äºè½»é‡çº§ï¼ˆæ•°æ®è½»é‡è€ŒéåŠŸèƒ½è½»é‡ï¼‰çš„WebGISåº”ç”¨ã€‚</p><p>æµè§ˆå™¨ç«¯æ”¯æŒç©ºé—´åˆ†æçš„æ„ä¹‰åœ¨äºï¼Œé€šè¿‡ç½‘é¡µåœ°å›¾çš„ä¸ä»…å¯æä¾›åœ°åæœç´¢ä¸è·¯å¾„æŸ¥è¯¢ï¼ˆç›®å‰ Google Maps çš„åŠŸèƒ½å…¶å®ä¸åå¹´å‰å¹¶æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼‰ï¼Œè€Œä¸”å¯ä»¥åœ¨æµè§ˆå™¨ä¸­åˆ†äº«ç©ºé—´åˆ†ææ¨¡å‹ã€‚ä»¥å‰çš„ WebGIS åŠŸèƒ½å½“ç„¶ä¹Ÿæ”¯æŒç©ºé—´åˆ†æï¼Œä½†æ˜¯åˆ†æè¿‡ç¨‹éœ€è¦åœ¨æœåŠ¡å™¨ç«¯è¿›è¡Œï¼Œæœ¬åœ°èƒ½å¤Ÿè¿›è¡Œçš„è®¾ç½®æœ‰é™ï¼Œç°åœ¨ä½¿ç”¨ Turf.js å¯ä»¥å°†åˆ†æè¿‡ç¨‹å®Œå…¨ç§»åˆ°æœ¬åœ°ï¼Œå¦‚æœé¡µé¢ä¸­æä¾›äº†å‚æ•°è®¾ç½®çš„è¯ï¼Œå¯ä»¥åœ¨æœ¬åœ°å¯¹æ¨¡å‹è¿›è¡Œä¿®æ”¹å¹¶ç«‹å³çœ‹åˆ°åˆ†æç»“æœã€‚è¿™æ ·çš„ç›´æ¥å¥½å¤„æœ‰ä¸¤ä¸ªæ–¹é¢ï¼šæ›´æ¸²çš„æ•°æ®å±•ç¤ºï¼Œä»¥åŠæ›´åŠ å¤æ‚çš„ç”¨æˆ·äº¤äº’ï¼ˆå¤æ‚äº¤äº’æœ¬èº«éœ€è¦ç©ºé—´åˆ†æä½œä¸ºåŸºç¡€ï¼‰ã€‚</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å¼•å…¥å…¨éƒ¨åŠŸèƒ½</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-comment">// ä¸‹è½½</span><br>$ npm install <span class="hljs-meta">@turf</span>/turf<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// å¼•å…¥</span><br><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> turf <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@turf/turf&#x27;</span><br><span class="hljs-keyword">import</span> &#123; lineString, along &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@turf/turf&#x27;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœæƒ³å¼•ç”¨æŒ‡å®šæ¨¡å—ï¼Œå¯ä»¥ä¸‹è½½åŠŸèƒ½åç§°å¯¹åº”çš„npmåŒ…ï¼ˆåŠŸèƒ½åç§°å¯¹åº”å…¶åŒ…çš„åç§°ï¼‰</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$ <span class="hljs-built_in">npm</span> install @turf/collect<br></code></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> collect <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@turf/collect&#x27;</span>;<br></code></pre></td></tr></table></figure><h2 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h2><p>Turf æœ‰ç€è´¨é‡æé«˜çš„<a href="http://turfjs.org/examples/turf-within/">å®˜æ–¹æ–‡æ¡£</a>ï¼Œè¯¦ç»†ä»‹ç»äº†æ¯ä¸ªåŠŸèƒ½æ¨¡å—çš„ä½¿ç”¨ï¼Œå¹¶æœ‰åœ¨çº¿ç¤ºä¾‹å¯ä»¥ç›´æ¥ä¸Šæ‰‹è¯•ç”¨ã€‚</p><p>Turfçš„åŠŸèƒ½åˆ†ä¸ºå‡ å¤§ç±»ï¼Œæˆ‘ä»¬åˆ—ä¸¾å‡ ä¸ªå¸¸ç”¨ç±»å¹¶æŠ½å‡ºä¸€ä¸¤ä¸ªå¸¸ç”¨æ–¹æ³•åšå±•ç¤ºã€‚</p><h3 id="MEASUREMENT"><a href="#MEASUREMENT" class="headerlink" title="MEASUREMENT"></a>MEASUREMENT</h3><h4 id="areaï¼ˆè®¡ç®—åŒºåŸŸé¢ç§¯ï¼‰"><a href="#areaï¼ˆè®¡ç®—åŒºåŸŸé¢ç§¯ï¼‰" class="headerlink" title="areaï¼ˆè®¡ç®—åŒºåŸŸé¢ç§¯ï¼‰"></a>areaï¼ˆè®¡ç®—åŒºåŸŸé¢ç§¯ï¼‰</h4><blockquote><p>è·å–ä¸€ä¸ªæˆ–å¤šä¸ª<code>feature</code>ï¼Œå¹¶è¿”å›å…¶é¢ç§¯å¹³æ–¹ç±³ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">geojson</td><td align="left">GeoJSON</td><td align="left">input GeoJSON feature(s)</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>number - area in square meters</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> polygon = turf.<span class="hljs-title function_">polygon</span>([[<br>        [<span class="hljs-number">108.09876</span>, <span class="hljs-number">37.200787</span>],<br>        [<span class="hljs-number">106.398901</span>, <span class="hljs-number">33.648651</span>],<br>        [<span class="hljs-number">114.972103</span>, <span class="hljs-number">33.340483</span>],<br>        [<span class="hljs-number">113.715685</span>, <span class="hljs-number">37.845557</span>],<br>        [<span class="hljs-number">108.09876</span>, <span class="hljs-number">37.200787</span>]<br>      ]]);<br><br><span class="hljs-keyword">var</span> area = turf.<span class="hljs-title function_">area</span>(polygon);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/area</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e425077a384a4c5a9d942a0899e09367~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171407541.png"></p><h4 id="centerOfMassï¼ˆè®¡ç®—å¤šè¾¹å½¢è´¨å¿ƒï¼‰"><a href="#centerOfMassï¼ˆè®¡ç®—å¤šè¾¹å½¢è´¨å¿ƒï¼‰" class="headerlink" title="centerOfMassï¼ˆè®¡ç®—å¤šè¾¹å½¢è´¨å¿ƒï¼‰"></a>centerOfMassï¼ˆè®¡ç®—å¤šè¾¹å½¢è´¨å¿ƒï¼‰</h4><blockquote><p>å–ä»»ä½•<code>Feature</code>æˆ–<code>FeatureCollection</code>ï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªå…¬å¼è¿”å›å…¶è´¨å¿ƒ:å¤šè¾¹å½¢è´¨å¿ƒã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">geojson</td><td align="left">GeoJSON</td><td align="left">GeoJSON to be centered</td></tr><tr><td align="left">properties</td><td align="left">Object</td><td align="left">an Object that is used as the Feature â€˜s properties</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>Feature <Point> - the center of mass</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> polygon = turf.<span class="hljs-title function_">polygon</span>([[[-<span class="hljs-number">81</span>, <span class="hljs-number">41</span>], [-<span class="hljs-number">88</span>, <span class="hljs-number">36</span>], [-<span class="hljs-number">84</span>, <span class="hljs-number">31</span>], [-<span class="hljs-number">80</span>, <span class="hljs-number">33</span>], [-<span class="hljs-number">77</span>, <span class="hljs-number">39</span>], [-<span class="hljs-number">81</span>, <span class="hljs-number">41</span>]]]);<br><br><span class="hljs-keyword">var</span> center = turf.<span class="hljs-title function_">centerOfMass</span>(polygon);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/center-of-mass</code></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a7db45453f044f983729f314cba06d7~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171328729.png"></p><h3 id="TRANSFORMATION"><a href="#TRANSFORMATION" class="headerlink" title="TRANSFORMATION"></a>TRANSFORMATION</h3><h4 id="bufferï¼ˆè®¡ç®—ç¼“å†²åŒºï¼‰"><a href="#bufferï¼ˆè®¡ç®—ç¼“å†²åŒºï¼‰" class="headerlink" title="bufferï¼ˆè®¡ç®—ç¼“å†²åŒºï¼‰"></a>bufferï¼ˆè®¡ç®—ç¼“å†²åŒºï¼‰</h4><blockquote><p>ä¸ºç»™å®šåŠå¾„çš„<code>Feature</code>è®¡ç®—ä¸€ä¸ªç¼“å†²åŒºã€‚æ”¯æŒçš„å•ä½æ˜¯è‹±é‡Œã€å…¬é‡Œå’Œåº¦æ•°ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">geojson</td><td align="left">(FeatureCollection|Geometry|Feature )</td><td align="left">input to be buffered</td></tr><tr><td align="left">radius</td><td align="left">number</td><td align="left">distance to draw the buffer (negative values are allowed)</td></tr><tr><td align="left">options</td><td align="left">Object</td><td align="left">Optional parameters: see below</td></tr></tbody></table><p><strong>optionsé€‰é¡¹</strong></p><table><thead><tr><th align="left">å±æ€§</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">units</td><td align="left">string</td><td align="left">kilometers</td><td align="left">any of the options supported by turf units</td></tr><tr><td align="left">steps</td><td align="left">number</td><td align="left">64</td><td align="left">number of steps</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>(FeatureCollection|Feature &lt;(Polygon|MultiPolygon)&gt;|undefined) - buffered features</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> point = turf.<span class="hljs-title function_">point</span>([-<span class="hljs-number">90.548630</span>, <span class="hljs-number">14.616599</span>]);<br><span class="hljs-keyword">var</span> buffered = turf.<span class="hljs-title function_">buffer</span>(point, <span class="hljs-number">500</span>, &#123;<span class="hljs-attr">units</span>: <span class="hljs-string">&#x27;miles&#x27;</span>&#125;);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/buffer</code></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a01bb688c6f74483a33a52aa505a5ec1~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171448035.png"></p><h4 id="transformTranslateï¼ˆå¹³ç§»ï¼‰"><a href="#transformTranslateï¼ˆå¹³ç§»ï¼‰" class="headerlink" title="transformTranslateï¼ˆå¹³ç§»ï¼‰"></a>transformTranslateï¼ˆå¹³ç§»ï¼‰</h4><blockquote><p>åœ¨ç»™å®šçš„æ–¹å‘è§’ä¸Šæ²¿æ²¿æ’å‘çº¿ç§»åŠ¨æŒ‡å®šè·ç¦»çš„ä»»ä½•geojson<code>Feature</code>æˆ–å‡ ä½•å›¾å½¢ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">geojson</td><td align="left">GeoJSON</td><td align="left">object to be translated</td></tr><tr><td align="left">distance</td><td align="left">number</td><td align="left">length of the motion; negative values determine motion in opposite direction</td></tr><tr><td align="left">direction</td><td align="left">number</td><td align="left">of the motion; angle from North in decimal degrees, positive clockwise</td></tr><tr><td align="left">options</td><td align="left">Object</td><td align="left">Optional parameters: see below</td></tr></tbody></table><p><strong>optionsé€‰é¡¹</strong></p><table><thead><tr><th align="left">å±æ€§</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">units</td><td align="left">string</td><td align="left">kilometers</td><td align="left">in which</td></tr><tr><td align="left">zTranslation</td><td align="left">number</td><td align="left">0</td><td align="left">length of the vertical motion, same unit of distance</td></tr><tr><td align="left">mutate</td><td align="left">boolean</td><td align="left">false</td><td align="left">allows GeoJSON input to be mutated (significant performance increase if true)</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>GeoJSON - the translated GeoJSON object</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> poly = turf.<span class="hljs-title function_">polygon</span>([[[<span class="hljs-number">0</span>,<span class="hljs-number">29</span>],[<span class="hljs-number">3.5</span>,<span class="hljs-number">29</span>],[<span class="hljs-number">2.5</span>,<span class="hljs-number">32</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">29</span>]]]);<br><span class="hljs-keyword">var</span> translatedPoly = turf.<span class="hljs-title function_">transformTranslate</span>(poly, <span class="hljs-number">100</span>, <span class="hljs-number">35</span>);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/transform-translate</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea6705e11a7c4529a5fef7e5e1f09177~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171535520.png"></p><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="lineIntersectï¼ˆè®¡ç®—ä¸¤ç«¯çº¿æ®µç›¸äº¤ç‚¹ï¼‰"><a href="#lineIntersectï¼ˆè®¡ç®—ä¸¤ç«¯çº¿æ®µç›¸äº¤ç‚¹ï¼‰" class="headerlink" title="lineIntersectï¼ˆè®¡ç®—ä¸¤ç«¯çº¿æ®µç›¸äº¤ç‚¹ï¼‰"></a>lineIntersectï¼ˆè®¡ç®—ä¸¤ç«¯çº¿æ®µç›¸äº¤ç‚¹ï¼‰</h4><blockquote><p>è·å–ä»»ä½•<code>LineString</code>æˆ–<code>Polygon</code>GeoJSONï¼Œå¹¶è¿”å›ç›¸äº¤ç‚¹ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">line1</td><td align="left">(Geometry|FeatureCollection|Feature &lt;(LineString|MultiLineString|Polygon|MultiPolygon)&gt;)</td><td align="left">any LineString or Polygon</td></tr><tr><td align="left">line2</td><td align="left">(Geometry|FeatureCollection|Feature &lt;(LineString|MultiLineString|Polygon|MultiPolygon)&gt;)</td><td align="left">any LineString or Polygon</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>FeatureCollection <Point> - point(s) that intersect both</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> line1 = turf.<span class="hljs-title function_">lineString</span>([[<span class="hljs-number">126</span>, -<span class="hljs-number">11</span>], [<span class="hljs-number">129</span>, -<span class="hljs-number">21</span>]]);<span class="hljs-keyword">var</span> line2 = turf.<span class="hljs-title function_">lineString</span>([[<span class="hljs-number">123</span>, -<span class="hljs-number">18</span>], [<span class="hljs-number">131</span>, -<span class="hljs-number">14</span>]]);<span class="hljs-keyword">var</span> intersects = turf.<span class="hljs-title function_">lineIntersect</span>(line1, line2);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/line-intersect</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5aab8d3e07a14080a2062f5c8f7b2700~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171642600.png"></p><h4 id="mask-è¿”å›éé®ç½©å¤šè¾¹å½¢"><a href="#mask-è¿”å›éé®ç½©å¤šè¾¹å½¢" class="headerlink" title="mask(è¿”å›éé®ç½©å¤šè¾¹å½¢)"></a>mask(è¿”å›éé®ç½©å¤šè¾¹å½¢)</h4><blockquote><p>è·å–ä»»æ„ç±»å‹çš„å¤šè¾¹å½¢å’Œä¸€ä¸ªå¯é€‰çš„é®ç½©ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸¦å­”çš„å¤šè¾¹å½¢å¤–éƒ¨ç¯ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">polygon</td><td align="left">(FeatureCollection|Feature &lt;(Polygon|MultiPolygon)&gt;)</td><td align="left">GeoJSON Polygon used as interior rings or holes.</td></tr><tr><td align="left">mask</td><td align="left">(Feature <Polygon>)</td><td align="left">GeoJSON Polygon used as the exterior ring (if undefined, the world extent is used)</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>Feature <Polygon> - Masked Polygon (exterior ring with holes).</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> polygon = turf.<span class="hljs-title function_">polygon</span>([[[<span class="hljs-number">112</span>, -<span class="hljs-number">21</span>], [<span class="hljs-number">116</span>, -<span class="hljs-number">36</span>], [<span class="hljs-number">146</span>, -<span class="hljs-number">39</span>], [<span class="hljs-number">153</span>, -<span class="hljs-number">24</span>], [<span class="hljs-number">133</span>, -<span class="hljs-number">10</span>], [<span class="hljs-number">112</span>, -<span class="hljs-number">21</span>]]]);<span class="hljs-keyword">var</span> mask = turf.<span class="hljs-title function_">polygon</span>([[[<span class="hljs-number">90</span>, -<span class="hljs-number">55</span>], [<span class="hljs-number">170</span>, -<span class="hljs-number">55</span>], [<span class="hljs-number">170</span>, <span class="hljs-number">10</span>], [<span class="hljs-number">90</span>, <span class="hljs-number">10</span>], [<span class="hljs-number">90</span>, -<span class="hljs-number">55</span>]]]);<span class="hljs-keyword">var</span> masked = turf.<span class="hljs-title function_">mask</span>(polygon, mask);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/mask</code></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/285a8c794fb1488e810682ae96929526~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171716436.png"></p><h3 id="JOINS"><a href="#JOINS" class="headerlink" title="JOINS"></a>JOINS</h3><h4 id="pointsWithinPolygonï¼ˆè¿”å›åœ¨å¤šè¾¹å½¢å†…çš„ç‚¹ï¼‰"><a href="#pointsWithinPolygonï¼ˆè¿”å›åœ¨å¤šè¾¹å½¢å†…çš„ç‚¹ï¼‰" class="headerlink" title="pointsWithinPolygonï¼ˆè¿”å›åœ¨å¤šè¾¹å½¢å†…çš„ç‚¹ï¼‰"></a>pointsWithinPolygonï¼ˆè¿”å›åœ¨å¤šè¾¹å½¢å†…çš„ç‚¹ï¼‰</h4><blockquote><p>æ‰¾åˆ°è½åœ¨(å¤šä¸ª)å¤šè¾¹å½¢å†…çš„ç‚¹ã€‚</p></blockquote><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">points</td><td align="left">(Feauture|FeatureCollection <Point>)</td><td align="left">Points as input search</td></tr><tr><td align="left">polygons</td><td align="left">(FeatureCollection|Geometry|Feature &lt;(Polygon|MultiPolygon)&gt;)</td><td align="left">Points must be within these (Multi)Polygon(s)</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>FeatureCollection <Point> - points that land within at least one polygon</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> points = turf.<span class="hljs-title function_">points</span>([    [-<span class="hljs-number">46.6318</span>, -<span class="hljs-number">23.5523</span>],    [-<span class="hljs-number">46.6246</span>, -<span class="hljs-number">23.5325</span>],    [-<span class="hljs-number">46.6062</span>, -<span class="hljs-number">23.5513</span>],    [-<span class="hljs-number">46.663</span>, -<span class="hljs-number">23.554</span>],    [-<span class="hljs-number">46.643</span>, -<span class="hljs-number">23.557</span>]]);<span class="hljs-keyword">var</span> searchWithin = turf.<span class="hljs-title function_">polygon</span>([[    [-<span class="hljs-number">46.653</span>,-<span class="hljs-number">23.543</span>],    [-<span class="hljs-number">46.634</span>,-<span class="hljs-number">23.5346</span>],    [-<span class="hljs-number">46.613</span>,-<span class="hljs-number">23.543</span>],    [-<span class="hljs-number">46.614</span>,-<span class="hljs-number">23.559</span>],    [-<span class="hljs-number">46.631</span>,-<span class="hljs-number">23.567</span>],    [-<span class="hljs-number">46.653</span>,-<span class="hljs-number">23.560</span>],    [-<span class="hljs-number">46.653</span>,-<span class="hljs-number">23.543</span>]]]);<span class="hljs-keyword">var</span> ptsWithin = turf.<span class="hljs-title function_">pointsWithinPolygon</span>(points, searchWithin);<br></code></pre></td></tr></table></figure><p><code>npm install @turf/points-within-polygon</code></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c98c804ab1c84b7a9393477adac8cf52~tplv-k3u1fbpfcp-watermark.image" alt="image-20210531171955477.png"></p><h3 id="BOOLEANS"><a href="#BOOLEANS" class="headerlink" title="BOOLEANS"></a>BOOLEANS</h3><h4 id="booleanPointInPolygonï¼ˆåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼‰"><a href="#booleanPointInPolygonï¼ˆåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼‰" class="headerlink" title="booleanPointInPolygonï¼ˆåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼‰"></a>booleanPointInPolygonï¼ˆåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼‰</h4><blockquote><p>å–ä¸€ä¸ªç‚¹å’Œä¸€ä¸ªå¤šè¾¹å½¢æˆ–å¤šå¤šè¾¹å½¢ï¼Œå¹¶ç¡®å®šè¯¥ç‚¹æ˜¯å¦ä½äºè¯¥å¤šè¾¹å½¢å†…ã€‚å¤šè¾¹å½¢å¯ä»¥æ˜¯å‡¸çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡¹çš„ã€‚</p></blockquote><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">&gt; npm install @turf/boolean-point-in-polygon<br></code></pre></td></tr></table></figure><p><strong>å‚æ•°</strong></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">point</td><td align="left">Coord</td><td align="left">input point</td></tr><tr><td align="left">polygon</td><td align="left">Feature &lt;(Polygon|MultiPolygon)&gt;</td><td align="left">input polygon or multipolygon</td></tr><tr><td align="left">options</td><td align="left">Object</td><td align="left">Optional parameters: see below</td></tr></tbody></table><p><strong>optionsé€‰é¡¹</strong></p><table><thead><tr><th align="left">å±æ€§</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">ignoreBoundary</td><td align="left">boolean</td><td align="left">false</td><td align="left">True if polygon boundary should be ignored when determining if the point is inside the polygon otherwise false.</td></tr></tbody></table><p><strong>è¿”å›</strong></p><p>boolean - true if the Point is inside the Polygon; false if the Point is not inside the Polygon</p><p><strong>ç¤ºä¾‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> pt = turf.<span class="hljs-title function_">point</span>([-<span class="hljs-number">77</span>, <span class="hljs-number">44</span>]);<span class="hljs-keyword">var</span> poly = turf.<span class="hljs-title function_">polygon</span>([[  [-<span class="hljs-number">81</span>, <span class="hljs-number">41</span>],  [-<span class="hljs-number">81</span>, <span class="hljs-number">47</span>],  [-<span class="hljs-number">72</span>, <span class="hljs-number">47</span>],  [-<span class="hljs-number">72</span>, <span class="hljs-number">41</span>],  [-<span class="hljs-number">81</span>, <span class="hljs-number">41</span>]]]);turf.<span class="hljs-title function_">booleanPointInPolygon</span>(pt, poly);<span class="hljs-comment">//= true</span><br></code></pre></td></tr></table></figure><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><ul><li><p><a href="http://turfjs.org/">å®˜æ–¹æ–‡æ¡£</a></p></li><li><p><a href="https://turfjs.fenxianglu.cn/">Turf.jsä¸­æ–‡ç½‘</a></p></li><li><p><a href="https://www.mapbox.com/blog/turf-gis-for-web-maps/">Turf: GIS for web maps</a> ï¼ˆè¿™ä¸ªç½‘é¡µé‡Œæœ‰ mapbox.com åŸºäº Turf å¼€å‘çš„ç²¾ç¾åœ°å›¾â€¦â€¦çš„æˆªå›¾ï¼‰</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>GIS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>GIS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘é…·ç‚«è‡ªå®šä¹‰åŠ¨æ€æ ‡è®°ä½ ç¡®å®šä¸æƒ³å­¦ä¼šï¼Ÿ</title>
    <link href="/2021/05/28/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E9%85%B7%E7%82%AB%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E6%80%81%E6%A0%87%E8%AE%B0%E4%BD%A0%E7%A1%AE%E5%AE%9A%E4%B8%8D%E6%83%B3%E5%AD%A6%E4%BC%9A%EF%BC%9F/"/>
    <url>/2021/05/28/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E9%85%B7%E7%82%AB%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8A%A8%E6%80%81%E6%A0%87%E8%AE%B0%E4%BD%A0%E7%A1%AE%E5%AE%9A%E4%B8%8D%E6%83%B3%E5%AD%A6%E4%BC%9A%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a118da518c034d4597b0a9f09d877db4~tplv-k3u1fbpfcp-watermark.image" alt="1.gif"></p><p>å‰ä¸¤å¤©åœ¨èµ„æ–™ä¸­æ·»åŠ äº†è‡ªå·±çš„è”ç³»æ–¹å¼åï¼Œæœ‰äº›å°ä¼™ä¼´åŠ äº†æˆ‘ä¸€èµ·æ¢è®¨å…³äºCesiumæ•ˆæœåŠåŠŸèƒ½çš„å®ç°ï¼Œå…¶ä¸­æœ‰ä¸å°‘äººé—®åˆ°è¿™ä¸ªæ–‡æœ¬æ ‡è®°æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä¸€ä¸ªä¸ªè§£ç­”è´¹æ—¶è´¹åŠ›ï¼Œç´¢æ€§å†™ä¸€ç¯‡æ–‡ç« æŠŠæˆ‘å®ç°çš„æ€è·¯æä¾›å‡ºæ¥ï¼Œå¹¶ç®€å•è¿›è¡Œç±»å°è£…ï¼Œç»™å¤§å®¶æŠ›ç –å¼•ç‰ã€‚</p><h3 id="åŸºæœ¬æ€è·¯"><a href="#åŸºæœ¬æ€è·¯" class="headerlink" title="åŸºæœ¬æ€è·¯"></a>åŸºæœ¬æ€è·¯</h3><p>æœ¬è´¨ä¸Šå…¶å®å°±æ˜¯æä¾›ä¸€ä¸ªç¬›å¡å°”åæ ‡ï¼Œå°†DOMå…ƒç´ æ¸²æŸ“åˆ°cesiumå®¹å™¨ä¸­è¿›è¡Œå‘ˆç°ã€‚å¹¶åˆ©ç”¨<code>postRender</code>å®æ—¶åœ°æ›´æ–°ä½ç½®ï¼Œä¿è¯å…¶ä¸ç¬›å¡å°”åæ ‡ä¸€è‡´ã€‚æ€è·¯å…¶å®å¾ˆç®€å•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿›è¡Œå®ç°ã€‚</p><h3 id="åŸºæœ¬å®ç°"><a href="#åŸºæœ¬å®ç°" class="headerlink" title="åŸºæœ¬å®ç°"></a>åŸºæœ¬å®ç°</h3><p>æ¥ä¸‹æ¥çš„ç¯‡å¹…ä¼šä¸€æ­¥ä¸€æ­¥å®Œå–„æ ‡è®°ç‚¹çš„æ–¹æ³•ï¼Œæƒ³ç›´æ¥çœ‹æˆå“çš„å°ä¼™ä¼´å¯ä»¥è·³åˆ°æ–¹æ³•å®ç°çš„æœ€åã€‚</p><h4 id="å‚æ•°è®¾å®š"><a href="#å‚æ•°è®¾å®š" class="headerlink" title="å‚æ•°è®¾å®š"></a>å‚æ•°è®¾å®š</h4><p>é¦–å…ˆæœ€åŸºæœ¬çš„å°±æ˜¯<code>position</code>åæ ‡ã€<code>title</code>æ ‡è®°å†…å®¹å’Œ<code>id</code>å”¯ä¸€æ ‡è¯†ï¼Œå…¶æ¬¡æˆ‘ä»¬å¯ä»¥å¢åŠ ä¸€äº›å‚æ•°æ¯”å¦‚è¯´<code>height</code>æ ‡è®°çš„é«˜åº¦ï¼Œä»¥åŠéšè—é«˜åº¦ç­‰ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ·»åŠ ã€‚</p><h4 id="æ–¹æ³•å®ç°"><a href="#æ–¹æ³•å®ç°" class="headerlink" title="æ–¹æ³•å®ç°"></a>æ–¹æ³•å®ç°</h4><p>åŒæ ·çš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªçƒä½“åšæˆ‘ä»¬æ ‡è®°çš„å®¹å™¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&quot;cesiumContainer&quot;</span>, &#123;&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥æ„å»ºåŸºç¡€çš„æ·»åŠ æ ‡è®°ç‚¹çš„æ–¹æ³•å¹¶è®¾å®šæˆ‘ä»¬æƒ³è¦é…ç½®çš„å‚æ•°ï¼Œè¿™é‡Œæˆ‘åªè®¾ç½®äº†åŸºæœ¬çš„å‚æ•°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">addDynamicLabel</span>(<span class="hljs-params">&#123; position, title = <span class="hljs-string">&quot;æ–‡æœ¬æ ‡è®°&quot;</span>, id = <span class="hljs-string">&quot;0&quot;</span> &#125;</span>) &#123;<br><span class="hljs-comment">// â€¦â€¦Do SomeThing</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦åŠ¨æ€åˆ›å»ºä¸€ä¸ªdivä½œä¸ºæ ‡è®°ç‚¹ï¼Œå¹¶å¯¹å…¶è®¾ç½®æ ·å¼å’Œå†…å®¹ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°çƒä½“æ‰€åœ¨çš„å®¹å™¨ä¸­</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">addDynamicLabel</span>(<span class="hljs-params">&#123; position, title = <span class="hljs-string">&quot;æ–‡æœ¬æ ‡è®°&quot;</span>, id = <span class="hljs-string">&quot;0&quot;</span> &#125;</span>) &#123;<br><span class="hljs-keyword">let</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>    div.<span class="hljs-property">id</span> = id;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&quot;absolute&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&quot;100px&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">&quot;30px&quot;</span>;<br>    <span class="hljs-keyword">let</span> divHTML = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;div style=&quot;width:100px;height:30px;background:rgba(255,122,0,0.4)&quot;&gt;<span class="hljs-subst">$&#123;title&#125;</span>&lt;/div&gt;</span><br><span class="hljs-string">    `</span>;<br>    div.<span class="hljs-property">innerHTML</span> = divHTML;<br>    viewer.<span class="hljs-property">cesiumWidget</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(div);<br>&#125;,<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠè¿™ä¸ªæ ‡è®°æ”¾åˆ°é¡µé¢ä¸­äº†ï¼Œè™½ç„¶æ˜¯ç»å¯¹å®šä½ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å¯¹åº”çš„<code>top</code>å’Œ<code>left</code>å€¼ï¼Œæ— æ³•æ˜¾ç¤ºåœ¨æˆ‘ä»¬æƒ³è®©å®ƒå‡ºç°åœ¨çš„ä½ç½®ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ ¹æ®ä¼ å…¥çš„åæ ‡è½¬æ¢æˆå±å¹•çš„<code>x,y</code>ä½œä¸ºæ ‡è®°çš„åç§»é‡ã€‚Cesiumæä¾›äº†ä¸€ä¸ª<code>Cesium.SceneTransforms.wgs84ToWindowCoordinates()</code>çš„æ–¹æ³•ä¾›æˆ‘ä»¬è¿›è¡Œè½¬æ¢ã€‚</p><blockquote><p> Cesium.SceneTransforms.wgs84ToWindowCoordinates(scene, position, result) â†’ Cartesian2</p></blockquote><blockquote><p>å°†WGS84åæ ‡ä¸­çš„ä½ç½®è½¬æ¢ä¸ºçª—å£åæ ‡ã€‚ è¿™é€šå¸¸ç”¨äºå°†HTMLå…ƒç´ ä¸åœºæ™¯ä¸­çš„å¯¹è±¡æ”¾ç½®åœ¨ç›¸åŒçš„å±å¹•ä½ç½®ã€‚</p></blockquote><blockquote><table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>scene</code></td><td align="left"><a href="http://support.supermap.com.cn:8090/webgl/docs/Documentation/Scene.html">Scene</a></td><td align="left">The scene.</td></tr><tr><td align="left"><code>position</code></td><td align="left"><a href="http://support.supermap.com.cn:8090/webgl/docs/Documentation/Cartesian3.html">Cartesian3</a></td><td align="left">WGS84ï¼ˆä¸–ç•Œï¼‰åæ ‡ä¸­çš„ä½ç½®ã€‚</td></tr><tr><td align="left"><code>result</code></td><td align="left"><a href="http://support.supermap.com.cn:8090/webgl/docs/Documentation/Cartesian2.html">Cartesian2</a></td><td align="left"><code>optional</code> è¿”å›è½¬æ¢ä¸ºçª—å£åæ ‡çš„è¾“å…¥ä½ç½®çš„å¯é€‰å¯¹è±¡ã€‚</td></tr></tbody></table></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">addDynamicLabel</span>(<span class="hljs-params">&#123; position, title = <span class="hljs-string">&quot;æ–‡æœ¬æ ‡è®°&quot;</span>, id = <span class="hljs-string">&quot;0&quot;</span> &#125;</span>) &#123;<br><span class="hljs-keyword">let</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>    div.<span class="hljs-property">id</span> = id;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&quot;absolute&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&quot;100px&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">&quot;30px&quot;</span>;<br>    <span class="hljs-keyword">let</span> divHTML = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;div style=&quot;width:100px;height:30px;background:rgba(255,122,0,0.4)&quot;&gt;<span class="hljs-subst">$&#123;title&#125;</span>&lt;/div&gt;</span><br><span class="hljs-string">    `</span>;<br>    div.<span class="hljs-property">innerHTML</span> = divHTML;<br>    viewer.<span class="hljs-property">cesiumWidget</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(div);<br>    <br>    <span class="hljs-keyword">let</span> vmPosition = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>        position[<span class="hljs-number">0</span>],<br>        position[<span class="hljs-number">1</span>],<br>        <span class="hljs-number">500</span><br>    );<br>    <span class="hljs-keyword">const</span> canvasHeight = viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>;<br>    <span class="hljs-keyword">const</span> windowPosition = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian2</span>();<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">SceneTransforms</span>.<span class="hljs-title function_">wgs84ToWindowCoordinates</span>(<br>        viewer.<span class="hljs-property">scene</span>,<br>        vmPosition,<br>        windowPosition<br>    );<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = canvasHeight - windowPosition.<span class="hljs-property">y</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>    <span class="hljs-keyword">const</span> elWidth = div.<span class="hljs-property">offsetWidth</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = windowPosition.<span class="hljs-property">x</span> - elWidth / <span class="hljs-number">2</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>&#125;,<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬çš„æ ‡è®°ç‚¹å·²ç»èƒ½å¤Ÿæ˜¾ç¤ºåœ¨æ­£ç¡®çš„ä½ç½®äº†ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ‹–æ‹½æˆ–æ”¾å¤§ç¼©å°çƒä½“ä¼šå‘ç°ï¼Œæ ‡è®°ç‚¹å®ƒæ²¡åŠ¨ï¼è¿™æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ï¼Œæ ‡è®°ç‚¹åº”è¯¥è·Ÿéšçƒä½“çš„ç§»åŠ¨æ”¾ç¼©è€Œä¿®æ”¹ä½ç½®ã€‚è¿™é‡Œç®€å•è¯´ä¸€ä¸‹Cesiumçš„æ¸²æŸ“æœºåˆ¶ï¼Œåœ¨Cesiumå†…éƒ¨æ„å»ºäº†ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç”¨æ¥ä¸æ–­çš„åˆ·æ–°å¹¶æ¸²æŸ“é¡µé¢ï¼Œå…·ä½“ä»£ç åœ¨<code>CesiumWidget.js</code>é‡Œï¼Œè¿™é‡Œä¸èµ˜è¿°äº†â€¦â€¦ï¼ˆå…¶å®æ˜¯å› ä¸ºæˆ‘æ²¡ä»”ç»†çš„çœ‹è¿‡æºç ï¼‰ã€‚çœ‹äº†Cesiumçš„æœºåˆ¶åæˆ‘ä»¬çŸ¥é“ï¼Œæƒ³è®©æ ‡è®°è·Ÿéšçƒä½“ç§»åŠ¨ï¼Œå°±éœ€è¦è®©æ ‡è®°ä¹Ÿä¸æ–­çš„åˆ·æ–°æ¸²æŸ“ã€‚Cesiumå¾ˆè´´å¿ƒçš„ä¸ºæˆ‘ä»¬å‡†å¤‡äº†<code>scene.postRender</code>ï¼Œè·å–å½“å‰åœºæ™¯æ¯å¸§æ¸²æŸ“ç»“æŸæ—¶çš„äº‹ä»¶ï¼Œç›‘å¬è¯¥äº‹ä»¶åœ¨æ¯å¸§æ¸²æŸ“ç»“æŸæ—¶è§¦å‘ã€‚æˆ‘ä»¬åªè¦å¯¹å®ƒè¿›è¡Œäº‹ä»¶ç›‘å¬å°±èƒ½å¤Ÿè·å–åˆ°æ¯å¸§çš„äº‹ä»¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">addDynamicLabel</span>(<span class="hljs-params">&#123; position, title = <span class="hljs-string">&quot;æ–‡æœ¬æ ‡è®°&quot;</span>, id = <span class="hljs-string">&quot;0&quot;</span> &#125;</span>) &#123;<br>    <span class="hljs-keyword">let</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);<br>    div.<span class="hljs-property">id</span> = id;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&quot;absolute&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&quot;100px&quot;</span>;<br>    div.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">&quot;30px&quot;</span>;<br>    <span class="hljs-keyword">let</span> divHTML = <span class="hljs-string">`</span><br><span class="hljs-string">&lt;div style=&quot;width:100px;height:30px;background:rgba(255,122,0,0.4)&quot;&gt;<span class="hljs-subst">$&#123;title&#125;</span>&lt;/div&gt;</span><br><span class="hljs-string">`</span>;<br>    div.<span class="hljs-property">innerHTML</span> = divHTML;<br>    viewer.<span class="hljs-property">cesiumWidget</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(div);<br>    <span class="hljs-keyword">let</span> vmPosition = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>        position[<span class="hljs-number">0</span>],<br>        position[<span class="hljs-number">1</span>],<br>        <span class="hljs-number">500</span><br>    );<br>    viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">postRender</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> canvasHeight = viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>;<br>        <span class="hljs-keyword">const</span> windowPosition = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian2</span>();<br>        <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">SceneTransforms</span>.<span class="hljs-title function_">wgs84ToWindowCoordinates</span>(<br>            viewer.<span class="hljs-property">scene</span>,<br>            vmPosition,<br>            windowPosition<br>        );<br>        div.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> = canvasHeight - windowPosition.<span class="hljs-property">y</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>        <span class="hljs-keyword">const</span> elWidth = div.<span class="hljs-property">offsetWidth</span>;<br>        div.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = windowPosition.<span class="hljs-property">x</span> - elWidth / <span class="hljs-number">2</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>    &#125;, <span class="hljs-variable language_">this</span>);<br>&#125;,<br></code></pre></td></tr></table></figure><p>æ–¹æ³•æ„å»ºå®Œæ¯•ï¼Œæˆ‘ä»¬åªéœ€è¦è°ƒç”¨ä¸€ä¸‹å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ ‡è®°ç‚¹å·²ç»å‡ºç°åœ¨çƒä½“ä¸Šäº†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> position = [<span class="hljs-number">121.54035</span>, <span class="hljs-number">38.92146</span>],<br>    title = <span class="hljs-string">&quot;moeçš„æ ‡è®°&quot;</span>,<br>    id = <span class="hljs-number">210204121</span>;<br><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addDynamicLabel</span>(&#123; position, title, id &#125;);<br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7ce4e5f7c40483bb1a51eb366e4dd81~tplv-k3u1fbpfcp-watermark.image" alt="åŠ¨ç”».gif"></p><p>åˆ°è¿™é‡Œå…¶å®åŸºæœ¬çš„åŠŸèƒ½æˆ‘ä»¬å·²ç»å®ç°äº†ï¼Œæ ‡è®°çš„æ ·å¼æˆ‘ä»¬å¯ä»¥è‡ªå·±å˜å¾—é…·ç‚«ï¼Œåƒæˆ‘å¼€å¤´çš„åŠ¨å›¾é‚£æ ·ã€‚</p><h4 id="å°è£…ç±»"><a href="#å°è£…ç±»" class="headerlink" title="å°è£…ç±»"></a>å°è£…ç±»</h4><p>åœ¨ä¸šåŠ¡ä¸­å¯èƒ½å¾ˆå¤šåœ°æ–¹éƒ½ç”¨åˆ°è¿™ä¸ªæ ‡è®°ï¼Œæœ€å¥½çš„åŠæ³•å°±æ˜¯å°†å®ƒå°è£…æˆä¸€ä¸ªæ’ä»¶æ–‡ä»¶å³æ’å³ç”¨ã€‚ä¸‹é¢æˆ‘ä»¬å°è¯•æŠŠè¿™ä¸ªåŠŸèƒ½å•ç‹¬æŠ½å‡ºæ¥å°è£…æˆç±»ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>es6</code>çš„<code>class</code>è¿›è¡Œå°è£…ã€‚å› ä¸ºæœ€å¼€å§‹æˆ‘è‡ªå·±æ‘¸ç´¢å°è£…çš„æ—¶å€™èµ°äº†å¾ˆå¤šå¼¯è·¯ï¼Œæ‰€ä»¥æˆ‘æƒ³å°è£…ç±»è¿™é‡Œä¹Ÿç®€å•è®²ä¸€ä¸‹ï¼Œä»¥åå¤§å®¶åšåˆ«çš„åŠŸèƒ½çš„æ—¶å€™ä¹Ÿå¯ä»¥ä¸¾ä¸€åä¸‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@descripion</span>:</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Viewer</span>&#125; <span class="hljs-variable">viewer</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Cartesian2</span>&#125; <span class="hljs-variable">position</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">String</span>&#125; <span class="hljs-variable">title</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">String</span>&#125; <span class="hljs-variable">id</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">boolean</span>&#125; isHighHidden æ˜¯å¦é«˜åº¦éšè—</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">*</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicLabel</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">&#123;viewer , position , height , title , id , isHighHidden = <span class="hljs-literal">true</span>&#125;</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span> = viewer;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isHighHidden</span> = isHighHidden;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">position</span> = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>          position[<span class="hljs-number">0</span>],<br>          position[<span class="hljs-number">1</span>],<br>          height<br>        );<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addLabel</span>();<br>    &#125;<br>    <span class="hljs-title function_">addLabel</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>    <span class="hljs-title function_">addPostRender</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>    <span class="hljs-title function_">postRender</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">// ...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ­£å¸¸æƒ…å†µä¸‹è¿™æ ·æˆ‘ä»¬å°±å¤§åŠŸå‘Šæˆäº†ï¼Œä½†æˆ‘ä»¬åŠ è½½DOMçš„æ–¹å¼æ˜¾å¾—å¤ªè¿‡ç²—é²ï¼Œè€Œä¸”ä¸å¥½ç»´æŠ¤ï¼Œä¸èƒ½æ¯æ¬¡æˆ‘ä»¬éƒ½é€šè¿‡<code>innerHTML</code>å¡«å……DOMå…ƒç´ æˆ–åœ¨å­—ç¬¦ä¸²å†…å»å¯¹å†…å®¹åŠæ ·å¼è¿›è¡Œä¿®æ”¹ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>Vue.extend</code> + <code>$mount</code>æ„é€ å™¨æ¥åˆ›å»ºä¸€ä¸ªâ€å­ç±»â€äº†ã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯æˆ‘çœ‹è¿‡åˆ«äººçš„å¼€æºä»£ç åè±ç„¶å¼€æœ—çš„ï¼Œæ²¡æƒ³åˆ°è¿˜èƒ½è¿™ä¹ˆç”¨ï¼é•¿çŸ¥è¯†äº†ã€‚</p><p>æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªvueæ–‡ä»¶<code>label.vue</code>ï¼Œå¹¶æŠŠæˆ‘ä»¬çš„æ ‡è®°æ ·å¼ä»€ä¹ˆçš„éƒ½å†™è¿›å»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div :id=&quot;id&quot; class=&quot;divlabel-container&quot; v-if=&quot;show&quot; &gt;<br>    &lt;div class=&quot;animate-maker-border&quot;&gt;<br>      &lt;span class=&quot;animate-marker__text&quot;&gt;&#123;&#123; title &#125;&#125;&lt;/span&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>export default &#123;<br>  name: &quot;DynamicLabel&quot;,<br>  data() &#123;<br>    return &#123;<br>      show: true,<br>    &#125;;<br>  &#125;,<br>  props: &#123;<br>    title: &#123;<br>      type: String,<br>      default: &quot;æ ‡é¢˜&quot;,<br>    &#125;,<br>    id:&#123;<br>        type:String,<br>        default:&#x27;001&#x27;<br>    &#125;<br>  &#125;,<br>&#125;;<br>&lt;/script&gt;<br><br><br>&lt;style lang=&quot;scss&quot;&gt;<br>.divlabel-container &#123;<br>  position: absolute;<br>  left: 0;<br>  bottom: 0;<br>  pointer-events: none;<br>  cursor: pointer;<br>&#125;<br>.animate-maker-border &#123;<br>  width: 150px;<br>  height: 30px;<br>  margin: 0;<br>  color: #f7ea00;<br>  box-shadow: inset 0 0 0 1px rgba(247, 234, 0, 0.56);<br>&#125;<br>.animate-marker__text &#123;<br>  color: #fff;<br>  font-size: 14px;<br>  display: flex;<br>  width: 100%;<br>  height: 100%;<br>  align-items: center;<br>  justify-content: center;<br>  font-weight: bolder;<br>  user-select: none;<br>  cursor: pointer;<br>  background: rgba(0, 173, 181, 0.32);<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ”¹é€ æˆ‘ä»¬å°è£…çš„<code>DynamicLabel</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@descripion</span>:</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Viewer</span>&#125; <span class="hljs-variable">viewer</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">Cartesian2</span>&#125; <span class="hljs-variable">position</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">String</span>&#125; <span class="hljs-variable">title</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">String</span>&#125; <span class="hljs-variable">id</span></span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">boolean</span>&#125; isHighHidden æ˜¯å¦é«˜åº¦éšè—</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">*</span>&#125;</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Label</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./label.vue&quot;</span>;<br><span class="hljs-keyword">let</span> <span class="hljs-title class_">WindowVm</span> = <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">extend</span>(<span class="hljs-title class_">Label</span>);<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicLabel</span> &#123;<br>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">&#123;viewer , position , height , title , id , isHighHidden = <span class="hljs-literal">true</span>&#125;</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span> = viewer;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isHighHidden</span> = isHighHidden;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">position</span> = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>          position[<span class="hljs-number">0</span>],<br>          position[<span class="hljs-number">1</span>],<br>          height<br>        );<br>        <br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WindowVm</span>(&#123;<br>          <span class="hljs-attr">propsData</span>: &#123;<br>            title,<br>            id<br>          &#125;<br>        &#125;).$mount(); <span class="hljs-comment">//æ ¹æ®æ¨¡æ¿åˆ›å»ºä¸€ä¸ªé¢æ¿</span><br>        viewer.<span class="hljs-property">cesiumWidget</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>); <span class="hljs-comment">//å°†å­—ç¬¦ä¸²æ¨¡æ¿ç”Ÿæˆçš„å†…å®¹æ·»åŠ åˆ°DOMä¸Š</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addPostRender</span>();<br>    &#125;<br>    <br>  <span class="hljs-comment">//æ·»åŠ åœºæ™¯äº‹ä»¶</span><br>  <span class="hljs-title function_">addPostRender</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">scene</span>.<span class="hljs-property">postRender</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">postRender</span>, <span class="hljs-variable language_">this</span>);<br>  &#125;<br><br>  <span class="hljs-comment">//åœºæ™¯æ¸²æŸ“äº‹ä»¶ å®æ—¶æ›´æ–°çª—å£çš„ä½ç½® ä½¿å…¶ä¸ç¬›å¡å°”åæ ‡ä¸€è‡´</span><br>  <span class="hljs-title function_">postRender</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">style</span>) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">const</span> canvasHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>.<span class="hljs-property">height</span>;<br>    <span class="hljs-keyword">const</span> windowPosition = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian2</span>();<br>    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">SceneTransforms</span>.<span class="hljs-title function_">wgs84ToWindowCoordinates</span>(<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">scene</span>,<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">position</span>,<br>      windowPosition<br>    );<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">style</span>.<span class="hljs-property">bottom</span> =<br>      canvasHeight - windowPosition.<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>    <span class="hljs-keyword">const</span> elWidth = <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">offsetWidth</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = windowPosition.<span class="hljs-property">x</span> - elWidth / <span class="hljs-number">2</span> + <span class="hljs-string">&quot;px&quot;</span>;<br>    <span class="hljs-keyword">if</span> (<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewer</span>.<span class="hljs-property">camera</span>.<span class="hljs-property">positionCartographic</span>.<span class="hljs-property">height</span> &gt; <span class="hljs-number">4000</span> &amp;&amp;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isHighHidden</span><br>    ) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">vmInstance</span>.<span class="hljs-property">$el</span>.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;block&quot;</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤§åŠŸå‘Šæˆï¼Œç°åœ¨çœ‹è¿™ä¸ªç±»æ˜¯ä¸æ˜¯ååˆ†çš„æ¸…çˆ½ï¼Œå…³äº<code>Vue.extend</code>çš„ç›¸å…³åŸç†åŠæ“ä½œæˆ‘è¿™é‡Œä¸å¤šè¯´æ˜ï¼Œå¤§å®¶å¯ä»¥ç™¾åº¦ã€‚æˆ‘åœ¨åœºæ™¯æ¸²æŸ“æ–¹æ³•ä¸­é€šè¿‡<code>this.viewer.camera.positionCartographic.height</code>æ·»åŠ äº†ä¸€ä¸ªåˆ¤æ–­å½“å‰ç›¸æœºé«˜åº¦æ¥å†³å®šæ ‡ç­¾æ˜¯å¦æ˜¾ç¤ºï¼Œè®©è¿™ä¸ªæ’ä»¶æ›´çµæ´»ã€‚</p><p>æœ€åæˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„é¡µé¢æ–‡ä»¶ä¸­å¼•å…¥å¹¶è°ƒç”¨ï¼Œå°±å¯ä»¥å‡ºç°å’Œä¹‹å‰æ–¹æ³•å®ç°ä¸­ä¸€æ ·çš„æ•ˆæœå•¦~</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">DynamicLabel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./plugins/DynamicLabel&#x27;</span><br><br><span class="hljs-title function_">addDynamicLabel</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> label = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DynamicLabel</span>(&#123;<br>        viewer, <br>        <span class="hljs-attr">position</span>:[<span class="hljs-number">121.54035</span>, <span class="hljs-number">38.92146</span>] ,<br>        <span class="hljs-attr">height</span>:<span class="hljs-number">500</span>,<br>        <span class="hljs-attr">title</span>:<span class="hljs-string">&#x27;moeçš„æ ‡ç­¾&#x27;</span>,<br>        <span class="hljs-attr">id</span>:<span class="hljs-string">&#x27;210201025&#x27;</span> <br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ–‡æœ¬æ ‡è®°æä¾›äº†ä¸€ä¸ªåœ¨Cesiumåœºæ™¯ä¸­å¯¹æŒ‡å®šåŠŸèƒ½è¿›è¡Œå®ç°ä»¥åŠå°è£…æˆç±»çš„æ€è·¯ï¼Œå…¶å®å¾ˆå¤šçš„åŠŸèƒ½éƒ½å¯ä»¥åƒè¿™æ ·è¿›è¡Œå°è£…ï¼Œæ¯”å¦‚è‡ªå®šä¹‰å¼¹çª—ã€é›·è¾¾æ‰«ææ•ˆæœã€å‰ä¸€ç¯‡æ–‡ç« ä¸­çš„ç½‘æ ¼æ¸²æŸ“ï¼Œæ²¿çº¿é£è¡Œç­‰ã€‚åªè¦æˆ‘ä»¬å°†åŸºæœ¬çš„æ€è·¯ç†æ¸…ï¼Œå…¶å®éƒ½ä¸éš¾ã€‚æˆ–è€…å¯ä»¥åƒæˆ‘ä¸€æ ·ï¼Œå…ˆç”¨æ–¹æ³•å®ç°å‡ºåŠŸèƒ½ï¼Œå†ä¸€æ­¥ä¸€æ­¥å¾—å¯¹å…¶è¿›è¡Œå°è£…å’Œæš´éœ²ã€‚è§‰å¾—æœ‰å¸®åŠ©çš„å…„å¼Ÿå¯ä»¥ç‚¹ä¸ªğŸ‘å…³æ³¨ä¸€ä¸‹ä¸“æ ï¼ŒCesiumå’ŒGISç›¸å…³çš„æ–‡ç« æˆ‘éƒ½ä¼šæ”¶å½•è¿›å»ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>GIS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆå››ï¼‰</title>
    <link href="/2021/05/23/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
    <url>/2021/05/23/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‰ä¸‰ç¯‡ä¸­æˆ‘ä»¬å·²ç»èƒ½å¤Ÿå®ç°åŠ è½½åœ°çƒã€åŠ è½½åœ°å›¾ã€åŠ è½½ç‚¹çº¿é¢çš„æ•ˆæœã€‚åŸºæœ¬çŸ¥è¯†ä¹Ÿç›¸åº”ä»‹ç»è¿‡ï¼Œæ¥ä¸‹æ¥çš„æ–‡ç« ä¸»è¦åé‡çš„å¯èƒ½æ˜¯æŸä¸ªåŠŸèƒ½çš„å…·ä½“å®ç°æˆ–æŸç§æ ·å¼çš„å…·ä½“å®ç°ã€‚æ¬¢è¿å¤§å®¶è¯„è®ºåŒºè¿›è¡Œè®¨è®ºã€‚</p></blockquote><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>  å›½å®¶ç°åœ¨å¤§åŠ›æ¨è¡Œç½‘æ ¼åŒ–ç®¡ç†ï¼Œå„åœ°ä¹ŸåŸºäºç½‘æ ¼åŒ–ç®¡ç†è¯ç”Ÿäº†å¾ˆå¤šç³»ç»Ÿï¼Œç°å¦‚ä»Šæ™ºæ…§åŸå¸‚æˆ–æ•°å­—åŸå¸‚ä¸­ï¼Œå¿…ä¸å¯å°‘çš„åŠŸèƒ½å°±æ˜¯ç½‘æ ¼å±•ç¤ºåŠç›¸å…³åŠŸèƒ½ã€‚ä»Šå¤©æˆ‘ä»¬å°±ç½‘æ ¼ç›¸å…³çš„æ ·å¼å’Œæ“ä½œæ¥å¤ä¹ ä¸€ä¸‹å…³äºé¢<code>polygon</code>çš„ç‚¹å‡»æ“ä½œã€‚åŒæ ·çš„ï¼Œè¡Œæ”¿åŒºåˆ’ä¹Ÿå¯ä»¥åˆ©ç”¨è¿™æ ·çš„æ•ˆæœå’Œæ“ä½œè¿›è¡Œä¸‹æ²‰ã€‚</p><p>  æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼Œå®ç°äº†é¢çš„æ¸å˜å¡«å……æ ·å¼ï¼Œé¼ æ ‡æ‚¬æµ®æ•ˆæœã€ç‚¹å‡»æ•ˆæœã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aade526c35914ce4b319be056980283b~tplv-k3u1fbpfcp-watermark.image" alt="grid.gif"></p><h3 id="æ€è·¯åŠå®ç°"><a href="#æ€è·¯åŠå®ç°" class="headerlink" title="æ€è·¯åŠå®ç°"></a>æ€è·¯åŠå®ç°</h3><p>æˆ‘ä»¬æƒ³è¦å®ç°é¢çš„ç‚¹å‡»ã€æ‚¬æµ®æ•ˆæœä»¥åŠæ ·å¼çš„ä¿®æ”¹ã€‚éœ€è¦ç”¨åˆ°çš„åŸºæœ¬ä¸Šå°±æ˜¯Cesiumçš„<code>ScreenSpaceEventHandler</code>æ¥ç›‘å¬é¼ æ ‡çš„æ“ä½œï¼Œè€Œæ ·å¼ä¿®æ”¹å¯èƒ½ä¼šå¯¹å¡«å……å›¾ç‰‡æˆ–è€…<code>material</code>è¿›è¡Œå¤„ç†ã€‚å¥½äº†ï¼Œæ—¢ç„¶æƒ³åˆ°äº†å¦‚ä½•å®ç°æˆ‘ä»¬å°±å¼€å§‹åŠ¨æ‰‹å§ï¼</p><h4 id="è·å–æ•°æ®"><a href="#è·å–æ•°æ®" class="headerlink" title="è·å–æ•°æ®"></a>è·å–æ•°æ®</h4><p>ç½‘æ ¼å®è´¨ä¸Šä¹Ÿæ˜¯é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é¦–å…ˆæœ‰ç½‘æ ¼çš„é¢æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å» <a href="http://datav.aliyun.com/tools/atlas/#&lat=30.332329214580188&lng=106.72278672066881&zoom=3.5">DataV.Geoatlas</a>åœ°å›¾ä¸­è·å–é¢çš„geojsonæ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬é‡‡ç”¨åŒ—äº¬å¸‚çš„è¡Œæ”¿åŒºåˆ’æ•°æ®,åœ°å€æˆ‘è¿™é‡Œè´´å‡ºæ¥ï¼Œæƒ³å¯»æ‰¾å…¶ä»–æ•°æ®çš„å°ä¼™ä¼´å¯ä»¥è‡ªè¡Œå¯»æ‰¾ã€‚</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">https://geo.datav.aliyun.com/areas_v2/bound/110000_full.json<br></code></pre></td></tr></table></figure><h4 id="åŠ è½½geoJSONæ ¼å¼æ•°æ®"><a href="#åŠ è½½geoJSONæ ¼å¼æ•°æ®" class="headerlink" title="åŠ è½½geoJSONæ ¼å¼æ•°æ®"></a>åŠ è½½geoJSONæ ¼å¼æ•°æ®</h4><p>åˆ©ç”¨Cesiumçš„<code>GeoJsonDataSource</code>æ¥åŠ è½½geoJSONæ•°æ®ï¼Œæ³¨æ„ï¼šå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ï¼Œæ‰€ä»¥æ¥æ”¶æ—¶éœ€è¦ä½¿ç”¨<code>.then(cb)</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> promise=<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">GeoJsonDataSource</span>.<span class="hljs-title function_">load</span>(<span class="hljs-string">&#x27;https://geo.datav.aliyun.com/areas_v2/bound/110000_full.json&#x27;</span>)<br>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">datasource</span>) =&gt;</span> &#123;<br>    viewer.<span class="hljs-property">dataSources</span>.<span class="hljs-title function_">add</span>(datasource);<br>    <span class="hljs-keyword">var</span> entities = datasource.<span class="hljs-property">entities</span>.<span class="hljs-property">values</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; entities.<span class="hljs-property">length</span>; i++)&#123;<br>      <span class="hljs-keyword">var</span> entity = entities[i];<br>      entity.<span class="hljs-property">polygon</span>.<span class="hljs-property">material</span> = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">RED</span>;<br>      entity.<span class="hljs-property">polygon</span>.<span class="hljs-property">extrudedHeight</span> = <span class="hljs-number">100</span><br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°datasourceå°±æ˜¯æˆ‘ä»¬é€šè¿‡urlè·å–åˆ°çš„æ•°æ®é›†ï¼ŒåŠ è½½å®Œæ¯•åæˆ‘ä»¬éœ€è¦é€šè¿‡å¾ªç¯æ•°æ®é›†ä¸­çš„å®ä½“é›†æ¥å¯¹æ¯ä¸€ä¸ªå®ä½“è¿›è¡Œæ ·å¼çš„ä¿®æ”¹ï¼Œè¿™é‡Œæˆ‘ä»¬æš‚æ—¶è®¾ç½®äº†å®ƒçš„é¢œè‰²ä¸ºçº¢è‰²ï¼Œæ‹‰ä¼¸é«˜åº¦ä¸º100ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4e9e1de45ba445880effd74e7769dab~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„å¸¦æœ‰é«˜åº¦çš„é¢å·²ç»æ¸²æŸ“å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹å¦‚ä½•å˜æˆæˆ‘ä»¬æœ€å¼€å§‹çš„æ•ˆæœå›¾é‚£æ ·åŠé€æ˜æ¸å˜çš„å‘¢ï¼Ÿ</p><h4 id="polygonæ ·å¼ä¿®æ”¹"><a href="#polygonæ ·å¼ä¿®æ”¹" class="headerlink" title="polygonæ ·å¼ä¿®æ”¹"></a><code>polygon</code>æ ·å¼ä¿®æ”¹</h4><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>entity</code>æ˜¯é€šè¿‡<code>matrial</code>æè´¨è¿›è¡Œæ ·å¼çš„ä¿®æ”¹ã€‚é€æ˜åº¦æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Cesium.Color</code>è‡ªå¸¦çš„<code>withAlpha</code>è¿›è¡Œä¿®æ”¹ï¼Œä½†æˆ‘ä»¬æƒ³å‘ˆç°å‡ºçš„æ•ˆæœæ˜¯åŒºåŸŸæ¸å˜åŠ é€æ˜ï¼Œæˆ‘å½“æ—¶çš„ç¬¬ä¸€æƒ³æ³•æ˜¯æ—¢ç„¶<code>material</code>å¯ä»¥åŠ è½½å›¾ç‰‡ï¼Œé‚£æˆ‘ä»¬èƒ½ä¸èƒ½ç”¨ä¸€å¼ åŒºåŸŸæ¸å˜çš„å›¾ç‰‡å¯¹å®ƒè¿›è¡Œå¡«å……å‘¢ï¼Ÿç»“è®ºæ˜¯å¯ä»¥çš„ã€‚æˆ‘ä»¬åªéœ€è¦<code>           entity.polygon.material = require(&#39;./images/color.jpg&#39;);</code>å°±å¯ä»¥åˆ©ç”¨å›¾ç‰‡å¡«å……ã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c1500f8080d4aa3b4f7458f7a931c3c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>è¿™æ—¶å€™ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™å°±å¥½åŠäº†ï¼ŒæŠŠå›¾ç‰‡å˜æˆåŠé€æ˜çš„ä¸å°±å®ç°äº†å—ã€‚è¿™æœ‰ä»€ä¹ˆéš¾çš„ã€‚å¯¹ï¼Œä½†æ˜¯æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœè¿™æ—¶å€™å®¢æˆ·è¯´ï¼šä¸è¡Œï¼Œè¿™ä¸ªé¢œè‰²ä¸å¥½çœ‹ï¼Œç»™æˆ‘å¤šæ¢å‡ ä¸ªæˆ‘çœ‹çœ‹æ•ˆæœï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿåšå¥½å‡ å¼ å›¾ç‰‡æŒ¨ä¸ªæ›¿æ¢å—ï¼Œè¿™æœªå…ä¹Ÿå¤ªéº»çƒ¦äº†å§ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å¤ŸæŒ‡å®šé¢œè‰²å¹¶å¿«é€Ÿç”Ÿæˆå›¾ç‰‡çš„æ–¹å¼ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚<code>canvas</code>è¿™æ—¶å€™ç«™å‡ºæ¥äº†ï¼Œåˆ©ç”¨<code>canvas</code>ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»£ç æ¥å¿«ç”ŸæˆæŒ‡å®šæ ·å¼çš„å›¾ç‰‡ï¼Œè¿™ä¸æ¯”åˆ¶å›¾å¿«å¤šäº†ã€‚</p><p><code>canvas</code>å…³äºæ¸å˜ã€è§’åº¦çš„çŸ¥è¯†åœ¨è¿™å°±ä¸ä»‹ç»äº†ï¼Œç½‘ä¸Šæ¯”æ¯”çš†æ˜¯ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡ä»£ç è®²è§£ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">getColorRamp</span>(<span class="hljs-params">rampColor,centerColor</span>) &#123;<br>    <span class="hljs-keyword">var</span> ramp = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;canvas&quot;</span>);<br>    ramp.<span class="hljs-property">width</span> = <span class="hljs-number">50</span>;<br>    ramp.<span class="hljs-property">height</span> = <span class="hljs-number">50</span>;<br>    <span class="hljs-keyword">var</span> ctx = ramp.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br><br>    <span class="hljs-keyword">var</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<span class="hljs-number">25</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">25</span>, <span class="hljs-number">50</span>);<br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, centerColor); <span class="hljs-comment">// &quot;rgba(255,255,255,0)&quot;</span><br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, rampColor);<br><br>    ctx.<span class="hljs-property">fillStyle</span> = grd;<br>    ctx.<span class="hljs-title function_">fillRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">50</span>);<br><br>    <span class="hljs-comment">// return ramp;</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ImageMaterialProperty</span>(&#123;<br>      <span class="hljs-attr">image</span>: ramp,<br>      <span class="hljs-attr">transparent</span>: <span class="hljs-literal">true</span><br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å°è£…äº†ä¸€ä¸ªå‡½æ•°ï¼Œå…¥å‚æ˜¯æ¸å˜ä¸¤ç«¯çš„é¢œè‰²ï¼ˆå½“ç„¶å¦‚æœä½ çš„éœ€æ±‚ä¸­éœ€è¦æ”¹å˜è§’åº¦ã€æ–¹å‘ç­‰å¯ä»¥è‡ªå®šä¹‰å‚æ•°ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ª<code>50*50</code>çš„canvasç”»å¸ƒï¼Œ<code>createRadialGradient</code>åˆ›å»ºä¸€ä¸ªæ¸å˜å¯¹è±¡ï¼Œè§„å®šæ¸å˜é¢œè‰²å’Œä½ç½®ï¼Œç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šï¼Œæœ€åè¿”å›ä¸€ä¸ªCesiumçš„<code>ImageMaterialProperty</code>å›¾ç‰‡æè´¨ç±»ï¼Œè®°å¾—é…ç½®<code>transparent</code>ä¸º<code>true</code>ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰é¢œè‰²æ¥ç”ŸæˆåŠé€æ˜æ¸å˜æ•ˆæœçš„æè´¨äº†ï¼Œçœ‹æ•ˆæœï¼</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/75a5a24c5f554b798c3fb2c8f8eb2320~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>è¾¹ç¼˜çš„é»„çº¿æ˜¯é¢çš„<code>outline</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è®¾ç½®ä¸º<code>null</code>ä»¥å±•ç¤ºæ›´å¥½æ•ˆæœã€‚</p><h4 id="é¼ æ ‡æ‚¬æµ®åŠç‚¹å‡»äº‹ä»¶"><a href="#é¼ æ ‡æ‚¬æµ®åŠç‚¹å‡»äº‹ä»¶" class="headerlink" title="é¼ æ ‡æ‚¬æµ®åŠç‚¹å‡»äº‹ä»¶"></a>é¼ æ ‡æ‚¬æµ®åŠç‚¹å‡»äº‹ä»¶</h4><p>æˆ‘ä»¬æƒ³å®ç°çš„æ•ˆæœä¸ºç‚¹å‡»é«˜äº®å’Œé¼ æ ‡ç§»å…¥æ—¶é¢å¤–å›´æœ‰åŠ¨æ•ˆçº¿çš„æ•ˆæœï¼Œå…¶å®å¾ˆç®€å•ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç‚¹å‡»è¿™ä¸ªé¢çš„æ—¶å€™è·å–åˆ°è¿™ä¸ªé¢ï¼Œæ”¹å˜è¿™ä¸ªé¢çš„æè´¨ï¼Œåˆ©ç”¨è¿™ä¸ªé¢çš„å¤–å›´åæ ‡é›†ç”Ÿæˆä¸€ä¸ª<code>polyline</code>ï¼Œæ·»åŠ åŠ¨æ€çº¿çš„æè´¨ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç å§ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs js">handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">var</span> pick = viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(e.<span class="hljs-property">position</span>);<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Cesium</span>.<span class="hljs-title function_">defined</span>(pick) &amp;&amp; pick.<span class="hljs-property">id</span>) &#123;<br>    <span class="hljs-keyword">var</span> feature = pick.<span class="hljs-property">id</span>;<br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">removeById</span>(<span class="hljs-string">&quot;select_grid&quot;</span>);<br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">removeById</span>(<span class="hljs-string">`line_<span class="hljs-subst">$&#123;feature.id&#125;</span>`</span>);<br>    <span class="hljs-keyword">let</span> positions = feature.<span class="hljs-property">polygon</span>.<span class="hljs-property">hierarchy</span>.<span class="hljs-title function_">getValue</span>(<br>        <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">now</span>()<br>    ).<span class="hljs-property">positions</span>;<br>    viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;select_grid&quot;</span>,<br>    <span class="hljs-attr">polygon</span>: &#123;<br>      <span class="hljs-attr">hierarchy</span>: positions,<br>      <span class="hljs-attr">material</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getColorRamp</span>(<br>        <span class="hljs-string">&quot;rgba(0, 255, 255,1)&quot;</span>,<br>        <span class="hljs-string">&quot;rgba(255,0,0,0.3)&quot;</span><br>      ),<br>      <span class="hljs-attr">height</span>: <span class="hljs-number">499</span>,<br>    &#125;,<br>    &#125;);<br>  &#125;<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br><br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-function">(<span class="hljs-params">movement</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">var</span> pickFeature =<br>      viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(movement.<span class="hljs-property">endPosition</span>) &amp;&amp;<br>      viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(movement.<span class="hljs-property">endPosition</span>).<span class="hljs-property">id</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Cesium</span>.<span class="hljs-title function_">defined</span>(pickFeature) &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">preLineId</span> !== pickFeature.<span class="hljs-property">id</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">preLineId</span> &amp;&amp;viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">removeById</span>(<span class="hljs-string">`line_<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.preLineId&#125;</span>`</span>);<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">preLineId</span> = pickFeature.<span class="hljs-property">id</span>;<br>      viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;line_&quot;</span> + pickFeature.<span class="hljs-property">id</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;line_&quot;</span> + pickFeature.<span class="hljs-property">name</span>,<br>        <span class="hljs-attr">polyline</span>: &#123;<br>          <span class="hljs-attr">positions</span>: pickFeature.<span class="hljs-property">polygon</span>.<span class="hljs-property">hierarchy</span>.<span class="hljs-title function_">getValue</span>(<br>            <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">JulianDate</span>.<span class="hljs-title function_">now</span>()<br>          ).<span class="hljs-property">positions</span>,<br>          <span class="hljs-attr">width</span>: <span class="hljs-number">8</span>,<br>          <span class="hljs-attr">material</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PolylineTrailMaterialProperty</span>(&#123;<br>            <span class="hljs-comment">// å°¾è¿¹çº¿æè´¨</span><br>            <span class="hljs-attr">color</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">AQUA</span>,<br>            <span class="hljs-attr">trailLength</span>: <span class="hljs-number">0.9</span>,<br>            <span class="hljs-attr">period</span>: <span class="hljs-number">1</span>,<br>          &#125;),<br>        &#125;,<br>      &#125;);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">preLineId</span> &amp;&amp; viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">removeById</span>(<span class="hljs-string">`line_<span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.preLineId&#125;</span>`</span>);<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">preLineId</span> = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">MOUSE_MOVE</span>);<br></code></pre></td></tr></table></figure><p>æ•ˆæœï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c23f4fb6f1704739b9a1ddf1a1cb8eaf~tplv-k3u1fbpfcp-watermark.image" alt="6.gif"></p><p>å…¶å®æ€»ç»“ä¸€ä¸‹å°±æ˜¯è·å–åˆ°å½“å‰é¼ æ ‡ä½ç½®ä¸‹çš„<code>entity</code>ï¼Œæ ¹æ®é¢çš„å¤–å›´åæ ‡é›†ç”Ÿæˆä¸€ä¸ªæ–°çš„é¢å’Œæ–°çš„çº¿ï¼Œæ·»åŠ åˆ°çƒä½“ä¸Šã€‚å°±æ˜¯å…ˆæˆ‘ä»¬çš„æ•ˆæœäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆä¸‰ï¼‰</title>
    <link href="/2021/05/05/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2021/05/05/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<pre><code class="hljs">                                    FBI  WARNINGï¼                                    äº”ä¸€å‡æœŸå·²ç»“æŸ               ä¸çŸ¥é“xdméƒ½å»å“ªé‡Œç©äº†ï¼Ÿç»™ç‚¹æ¸¸ç©çš„å»ºè®®ï¼Œæˆ‘åä¸€å‡æœŸå‚è€ƒä¸€ä¸‹å•Šå“ˆå“ˆâ€¦â€¦</code></pre><blockquote><p>å¤ä¹ ä¸€ä¸‹ï¼Œä¸Šä¸€ç¯‡æˆ‘ä»¬é¦–å…ˆè®²äº†åœ°å›¾ä¸Šçš„å‡ å¤§è¦ç´ ï¼ŒåŒ…æ‹¬ç‚¹çº¿é¢ï¼Œç„¶åäº†è§£äº†äºŒç»´åœ°å›¾ã€ä¸‰ç»´åœ°å›¾ä¸­æ‰€ä½¿ç”¨çš„å‡ å¤§åæ ‡ç³»åŠå…¶è½¬æ¢æ–¹å¼ï¼Œæœ€åå¤§è‡´è®²äº†Cesiumä¸­çš„Viewerå®ä½“å’ŒCameraå®ä½“ï¼Œå¯¹åº”ç€çª—å£å’Œæ‘„åƒæœºã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿›è¡Œå®æ“ï¼Œäº†è§£å¦‚ä½•å°†ç‚¹çº¿é¢è¦ç´ æ·»åŠ åˆ°æˆ‘ä»¬çš„åœ°çƒä¸Šã€‚å¦‚æœæ–‡ç« ä¸­æœ‰é”™è¯¯çš„è¯æ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºï¼Œå®šå½“è™šå¿ƒè¯·æ•™å¹¶åŠæ—¶ä¿®æ”¹ï¼</p></blockquote><h3 id="Entityå®ä½“"><a href="#Entityå®ä½“" class="headerlink" title="Entityå®ä½“"></a>Entityå®ä½“</h3><hr><p>åœ¨Cesiumä¸­ï¼Œæœ‰å‡ ç§æ·»åŠ å®ä½“çš„æ–¹å¼ï¼Œä¾‹å¦‚åˆ©ç”¨Entityæ·»åŠ ï¼Œä»¥åŠPrimitiveæ·»åŠ ã€‚åè€…æ›´æ¥è¿‘æ¸²æŸ“å¼•æ“åº•å±‚æ‰€ä»¥ä»Šå¤©å…ˆä¸ä»‹ç»ã€‚Cesiumä¸­åˆ©ç”¨Entityå¯ä»¥æ·»åŠ è®¸å¤šå½¢çŠ¶ï¼šç‚¹ã€çº¿ã€é¢ã€ç®¡é“ã€åœ†æŸ±ä½“ç­‰ç­‰ï¼Œåœ¨Cesiumå®˜ç½‘çš„<a href="https://sandcastle.cesium.com/index.html?src=Box.html&label=Geometries">Sandcastle</a>ä¸­éƒ½æœ‰å¯¹åº”çš„ä¾‹å­ï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ã€‚</p><h4 id="ç‚¹Billboard"><a href="#ç‚¹Billboard" class="headerlink" title="ç‚¹Billboard"></a>ç‚¹<code>Billboard</code></h4><p>åœ¨Cesiumä¸­ï¼Œç‚¹çš„æ˜¯é€šè¿‡<code>Billboard</code>çš„æ–¹å¼å‘ˆç°çš„ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¹¿å‘Šç‰Œã€‚<code>Billboard</code>ä¼šåœ¨æŒ‡å®šåæ ‡ä½ç½®ç”Ÿæˆä¸€ä¸ªé¢æœå±å¹•çš„æŒ‡å®šå›¾ç‰‡ã€‚è¯ä¸å¤šè¯´ï¼Œæˆ‘ä»¬é€šè¿‡ä»£ç æ¥äº†è§£ä¸€ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-attr">position</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<span class="hljs-number">121.54035</span>, <span class="hljs-number">38.92146</span>,<span class="hljs-number">100</span>),<br>    <span class="hljs-attr">billboard</span>: &#123;<br>      <span class="hljs-attr">image</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@/views/images/blueCamera.png&quot;</span>), <span class="hljs-comment">// default: undefined</span><br>      <span class="hljs-attr">show</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// default</span><br>      <span class="hljs-attr">pixelOffset</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian2</span>(<span class="hljs-number">0</span>, -<span class="hljs-number">50</span>), <span class="hljs-comment">// default: (0, 0)</span><br>      <span class="hljs-attr">eyeOffset</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartesian3</span>(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>), <span class="hljs-comment">// default</span><br>      <span class="hljs-attr">horizontalOrigin</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">HorizontalOrigin</span>.<span class="hljs-property">CENTER</span>, <span class="hljs-comment">// default</span><br>      <span class="hljs-attr">verticalOrigin</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">VerticalOrigin</span>.<span class="hljs-property">BOTTOM</span>, <span class="hljs-comment">// default: CENTER</span><br>      <span class="hljs-attr">scale</span>: <span class="hljs-number">2.0</span>, <span class="hljs-comment">// default: 1.0</span><br>      <span class="hljs-attr">color</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">LIME</span>, <span class="hljs-comment">// default: WHITE</span><br>      <span class="hljs-attr">rotation</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-property">PI_OVER_FOUR</span>, <span class="hljs-comment">// default: 0.0</span><br>      <span class="hljs-attr">alignedAxis</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-property">ZERO</span>, <span class="hljs-comment">// default</span><br>      <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// default: undefined</span><br>      <span class="hljs-attr">height</span>: <span class="hljs-number">25</span>, <span class="hljs-comment">// default: undefined</span><br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨äº†<code>Viewer</code>ä¸‹<code>entities</code>ä¸‹çš„ä¸€ä¸ªæ–¹æ³•<code>add</code>ï¼Œentityé€šè¿‡è¿™ä¸ªæ–¹æ³•æ·»åŠ åˆ°<code>viewer</code>å†…ã€‚</p><p>æˆ‘åœ¨åæ ‡è½¬æ¢çš„æ—¶å€™ç»™äº†å®ƒä¸€ç‚¹é«˜ç¨‹å€¼ï¼Œä»¥ä¾¿æ˜¾ç¤ºçš„æ›´å®Œæ•´ã€‚æ•ˆæœå¦‚ä¸‹</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/773e0178f68546a8b6b41bba82392299~tplv-k3u1fbpfcp-watermark.image" alt="1.gif"></p><h4 id="çº¿Polyline"><a href="#çº¿Polyline" class="headerlink" title="çº¿Polyline"></a>çº¿<code>Polyline</code></h4><p>åŒ<code>Billboard</code>ä¸€æ ·ï¼Œçº¿ä¹Ÿæ˜¯é€šè¿‡<code>viewer.add()</code>æ–¹æ³•è¿›è¡Œæ·»åŠ çš„ã€‚æ¥ä¸‹æ¥å…ˆæ”¾ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>        <span class="hljs-comment">// name:entity.name,</span><br>    <span class="hljs-attr">polyline</span>: &#123;<br>      <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([<span class="hljs-number">121.534575</span>,<span class="hljs-number">38.926131</span>, <span class="hljs-number">121.537579</span>,<span class="hljs-number">38.92543</span>,<span class="hljs-number">121.541784</span>,<span class="hljs-number">38.924578</span>,<span class="hljs-number">121.543973</span>,<span class="hljs-number">38.924144</span>,<span class="hljs-number">121.545947</span>,<span class="hljs-number">38.923944</span>]),<br>      <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>,<br>      <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">DARKORANGE</span>.<span class="hljs-title function_">withAlpha</span>(<span class="hljs-number">0.7</span>),<br>      <span class="hljs-comment">// clampToGround: true,</span><br>      <span class="hljs-comment">// show: true,</span><br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p><code>positions</code>éœ€è¦ä¸€ä¸ªç¬›å¡å°”åšè¡¨é›†ç”¨æ¥ç»˜åˆ¶çº¿ï¼Œ<code>width</code>æ˜¯çº¿å®½ï¼Œ<code>material</code>æ˜¯çº¿çš„æè´¨ï¼ˆå®ƒå°±æ˜¯æˆ‘ä»¬ç”ŸæˆåŠ¨æ•ˆçº¿çš„å…³é”®ï¼‰ï¼Œ<code>clamToGround</code>æ˜¯é€‰æ‹©çº¿æ˜¯å¦è´´åœ°æ¸²æŸ“ï¼Œåœ¨æœ‰åœ°å½¢çš„åº•å›¾ä¸Šè´´åœ°æ¨¡å¼ä¼šè´´ç€åœ°å½¢èµ·ä¼è¿›è¡Œç»˜åˆ¶ï¼Œè€Œç»å¯¹é«˜åº¦åˆ™ä¼šç©¿è¿‡åœ°å½¢ï¼Œæœ€åçš„<code>show</code>å°±æ˜¯æ˜¯å¦æ˜¾ç¤ºäº†ã€‚</p><p>åŸºæœ¬æ•ˆæœï¼ˆä¸ºäº†æ˜¾ç¤ºæ•ˆæœå¥½ï¼Œæ¢äº†ä¸€ä¸ªæ·±è‰²åº•å›¾ï¼‰</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/467e77a280b34a81a5fb67d62c2373b7~tplv-k3u1fbpfcp-watermark.image" alt="2.gif"></p><p>è¿™æ—¶å€™ä½ å¯èƒ½å°±è¯´äº†ï¼Œè¿™ä¸ªçº¿ä¹Ÿå¤ªä¸‘äº†å§ï¼Œæˆ‘çœ‹äººå®¶çš„çº¿éƒ½æ˜¯é‚£ç§å‘å…‰çš„ï¼ˆä½ è¯´çš„æ˜¯å¥¥ç‰¹æ›¼å—ï¼Ÿè¿™ä¸ªä¸–ç•Œä¸ŠçœŸçš„æœ‰å¥¥ç‰¹æ›¼å—ï¼Ÿï¼‰ã€‚åˆ«æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘æä¾›ä¸€ç§å®ç°å‘å…‰çš„æ€è·¯ï¼Œå½“ç„¶æ€è·¯ä¸ä»…äºæ­¤ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å¤šä¸Šç½‘æœæœã€‚ä¸Šä»£ç ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// åœ¨ä¸Šè¾¹æ·»åŠ è¿‡çš„çº¿åŸºç¡€ä¸Šæˆ‘ä»¬å†æ·»åŠ ä¸€æ¡åŠ¨æ•ˆçº¿</span><br>viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>        <span class="hljs-comment">// name:entity.name,</span><br>    <span class="hljs-attr">polyline</span>: &#123;<br>      <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([<br>        <span class="hljs-number">121.534575</span>,<br>        <span class="hljs-number">38.926131</span>,<br>        <span class="hljs-number">121.537579</span>,<br>        <span class="hljs-number">38.92543</span>,<br>        <span class="hljs-number">121.541784</span>,<br>        <span class="hljs-number">38.924578</span>,<br>        <span class="hljs-number">121.543973</span>,<br>        <span class="hljs-number">38.924144</span>,<br>        <span class="hljs-number">121.545947</span>,<br>        <span class="hljs-number">38.923944</span>,<br>      ]),<br>      <span class="hljs-attr">width</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// çº¿çš„å®½åº¦ï¼Œåƒç´ ä¸ºå•ä½</span><br>      <span class="hljs-attr">material</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PolylineTrailMaterialProperty</span>(&#123;<br>        <span class="hljs-comment">// å°¾è¿¹çº¿æè´¨</span><br>        <span class="hljs-attr">color</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">GOLD</span>,<br>        <span class="hljs-attr">trailLength</span>: <span class="hljs-number">0.4</span>,<br>        <span class="hljs-attr">period</span>: <span class="hljs-number">3.0</span>,<br>      &#125;),<br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26b83bdb5dc742c0ae0dc4f028bd11a2~tplv-k3u1fbpfcp-watermark.image" alt="3.gif"></p><p>ä¸€æ¡çº¿çœ‹ç€æ•ˆæœæ„Ÿè§‰è¿˜å¥½ï¼Œä½†æ˜¯å¦‚æœæ˜¯ä¸‹è¾¹è¿™ç§è·¯ç½‘æ•ˆæœå…¶å®æ˜¯ä¸é”™çš„ã€‚</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4a7041548c9144548916d2bd990ff272~tplv-k3u1fbpfcp-watermark.image" alt="4.gif"></p><p>ç›¸ä¿¡èªæ˜çš„å°ä¼™ä¼´å·²ç»å‘ç°äº†ï¼Œè¯¶ä½ æ·»åŠ ç‚¹ï¼Œçº¿ç”¨çš„éƒ½æ˜¯addæ–¹æ³•è€Œä¸”ä¼ é€’çš„å‚æ•°ç»“æ„åŸºæœ¬ä¸Šéƒ½æ˜¯ä¸€ä¸ª<code>position</code>å’Œä¸€ä¸ªå¯¹åº”çš„å®ä½“é…å‚ã€‚ä¸é”™ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥åŸºäºè¿™æ ·çš„ç»“æ„è‡ªå·±å°è£…ä¸€ä¸ª<code>Entity</code>å¯¹è±¡ï¼Œåç»­äºŒæ¬¡è¿›è¡Œå®ä½“çš„ç»˜åˆ¶ç±»å’Œç¼–è¾‘ç±»ï¼Œè¿™é‡Œå°±ä¸è¿›è¡Œè¯´æ˜äº†ã€‚</p><h4 id="é¢Polygon"><a href="#é¢Polygon" class="headerlink" title="é¢Polygon"></a>é¢<code>Polygon</code></h4><p>ä¸Šè¾¹é‚£ä¸ªå›¾å…¶å®å·²ç»å‘æˆ‘ä»¬å±•ç¤ºäº†é¢å…ƒç´ ï¼Œä½ è‚¯å®šä¼šè®¤ä¸ºæˆ‘è¯´çš„æ˜¯é‚£ä¸ªç»¿è‰²çš„åŒºåŸŸï¼Œæ ¼å±€å°äº†ï¼å…¶å®é‚£äº›æ¥¼æˆ¿æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªä¸ªé¢ï¼Œåªä¸è¿‡æˆ‘ä»¬é€šè¿‡æ‹‰ä¼¸å°†ä»–æ‹‰ä¼¸å‡ºäº†ä¸€å®šé«˜åº¦å½¢æˆäº†æ‰€è°“çš„é¢ã€‚å®ƒçš„æ·»åŠ æ–¹å¼å’Œç‚¹ã€çº¿ä¸€æ ·ï¼Œæˆ‘å°±ä¸å¤šèµ˜è¿°äº†ï¼Œç›´æ¥ä¸Šä»£ç ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;<br>    <span class="hljs-attr">polygon</span>: &#123;<br>      <span class="hljs-attr">hierarchy</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([<br>        <span class="hljs-number">121.539208</span>,<br>        <span class="hljs-number">38.924962</span>,<br>        <span class="hljs-number">121.539176</span>,<br>        <span class="hljs-number">38.924737</span>,<br>        <span class="hljs-number">121.540195</span>,<br>        <span class="hljs-number">38.924486</span>,<br>        <span class="hljs-number">121.540281</span>,<br>        <span class="hljs-number">38.924737</span>,<br>      ]),<br>      <span class="hljs-attr">extrudedHeight</span>: <span class="hljs-number">50</span>,<br>      <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">WHITE</span>,<br>      <span class="hljs-comment">// closeTop: false,</span><br>      <span class="hljs-comment">// closeBottom: false,</span><br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>çœ‹æ•ˆæœï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2cc8cf3450d84f5386fce77650bc375a~tplv-k3u1fbpfcp-watermark.image" alt="5.gif"></p><p>è¿™åªæ˜¯ç”Ÿæˆå»ºç­‘çš„ä¸€ç§æ–¹å¼ï¼ŒåŒæ ·ï¼Œè¿™ä¹Ÿæ˜¯é¢ä¼—å¤šç”¨é€”ä¸­çš„ä¸€ç§ï¼Œæˆ‘åªè´Ÿè´£æŠ›ç –ï¼Œå¤§å®¶æ‰æ˜¯ç‰ã€‚</p><h3 id="ç‚¹å‡»è·å–é¢ã€å¹¿å‘Šç‰Œ"><a href="#ç‚¹å‡»è·å–é¢ã€å¹¿å‘Šç‰Œ" class="headerlink" title="ç‚¹å‡»è·å–é¢ã€å¹¿å‘Šç‰Œ"></a>ç‚¹å‡»è·å–é¢ã€å¹¿å‘Šç‰Œ</h3><p>åœ¨é¡¹ç›®ä¸­æˆ‘ä»¬ä¸å¯èƒ½åªæ˜¯å°†è¿™äº›ç‚¹çº¿é¢å‘ˆç°åœ¨çœ¼å‰ï¼Œæˆ‘ä»¬çš„è¦ç´ ä¸Šä¸€å®šæ‰¿è½½ç€å¯¹åº”çš„æ•°æ®æˆ–å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ç‚¹å‡»å¯¹åº”è¦ç´ è·å–åˆ°æ•°æ®ã€å±æ€§æˆ–è‡ªå®šä¹‰çš„æ“ä½œã€‚</p><p>æˆ‘ä»¬å…ˆé€šè¿‡<code>ScreenSpaceEventHandler</code>æ³¨å†Œä¸€ä¸ªå…¨å±€<code>handler</code>ï¼Œç„¶ååˆ©ç”¨<code>setInputAction</code>æ³¨å†Œ<code>LEFT_CLICK</code>é¼ æ ‡å·¦é”®ç‚¹å‡»äº‹ä»¶ï¼Œåœ¨å®ƒçš„å›è°ƒä¸­æˆ‘ä»¬å¯ä»¥è·å–åˆ°é¼ æ ‡çš„ç‚¹å‡»å¯¹è±¡ã€‚ç„¶åé€šè¿‡<code>viewer.scene.pick</code>æ–¹æ³•ï¼ˆ<code>åœºæ™¯æ‹¾å–ï¼Œè¿”å›åœ¨åœºæ™¯ä¸­è¯¥çª—å£ä½ç½®å¯¹åº”çš„ç¬¬ä¸€ä¸ªå›¾å…ƒå¯¹è±¡ï¼Œå¦‚æœè¯¥ä½ç½®æ²¡æœ‰ä»»ä½•ç‰©ä½“åˆ™è¿”å›undefined</code>ï¼‰ï¼Œä¼ å…¥åæ ‡ï¼Œè·å–åˆ°ç‚¹å‡»ä½ç½®çš„å®ä½“ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><br>handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">var</span> pick = viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(e.<span class="hljs-property">position</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e , pick);<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br><br></code></pre></td></tr></table></figure><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/951f125ebf7740dfbe6e8eaf60f273ff~tplv-k3u1fbpfcp-watermark.image" alt="6.gif"></p><p>æˆ‘ä»¬æ¥çœ‹çœ‹æ‰“å°å‡ºäº†ä»€ä¹ˆ</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e419d7fa2d634df3ba07e647c7b72f05~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p><code>e</code>ä¸ºæˆ‘ä»¬é¼ æ ‡åœ¨å±å¹•ä¸Šçš„å±å¹•äºŒç»´åæ ‡ç»„ï¼Œ<code>pick</code>åˆ™æ˜¯è¿”å›çš„å›¾å…ƒå¯¹è±¡ï¼Œå…¶ä¸­çš„<code>id</code>åˆ™æ˜¯æˆ‘ä»¬æ‹¾å–åˆ°çš„å®ä½“ã€‚</p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cesiumContainer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> viewer, camera, handler;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">return</span> &#123;&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&quot;cesiumContainer&quot;</span>, &#123;&#125;);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">var</span> layer = viewer.<span class="hljs-property">imageryLayers</span>.<span class="hljs-title function_">addImageryProvider</span>(</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">UrlTemplateImageryProvider</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">url</span>:</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-string">&quot;https://map.geoq.cn/arcgis/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/&#123;z&#125;/&#123;y&#125;/&#123;x&#125;&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">      );</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-comment">//   åˆå§‹åŒ–åœºæ™¯ä½ç½®</span></span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">flyTo</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// åˆå§‹åŒ–ç›¸æœºç»çº¬åº¦</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">destination</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">121.54035</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">38.92146</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">2000</span></span></span><br><span class="language-javascript"><span class="language-xml">        ),</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">orientation</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">heading</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(<span class="hljs-number">0.0</span>),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">pitch</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(-<span class="hljs-number">25.0</span>), <span class="hljs-comment">//ä»ä¸Šå¾€ä¸‹çœ‹ä¸º-90</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">roll</span>: <span class="hljs-number">0</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">      handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);</span></span><br><span class="language-javascript"><span class="language-xml">      handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">var</span> pick = viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pick</span>(e.<span class="hljs-property">position</span>);</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e, pick);</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addBillboard</span>();</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addPolyline</span>();</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addPolygon</span>();</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">addBillboard</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">position</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<span class="hljs-number">121.54035</span>, <span class="hljs-number">38.92146</span>, <span class="hljs-number">50</span>),</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">billboard</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">image</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./images/blueCamera.png&quot;</span>), <span class="hljs-comment">// default: undefined</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// show: true, // default</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// pixelOffset: new Cesium.Cartesian2(0, -50), // default: (0, 0)</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// eyeOffset: new Cesium.Cartesian3(0.0, 0.0, 0.0), // default</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// horizontalOrigin: Cesium.HorizontalOrigin.CENTER, // default</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// verticalOrigin: Cesium.VerticalOrigin.BOTTOM, // default: CENTER</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// scale: 2.0, // default: 1.0</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// color: Cesium.Color.LIME, // default: WHITE</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// rotation: Cesium.Math.PI_OVER_FOUR, // default: 0.0</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// alignedAxis: Cesium.Cartesian3.ZERO, // default</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// width: 100, // default: undefined</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// height: 25, // default: undefined</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">addPolyline</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">polyline</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.534575</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.926131</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.537579</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.92543</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.541784</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924578</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.543973</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924144</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.545947</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.923944</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          ]),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">width</span>: <span class="hljs-number">4</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">DARKORANGE</span>.<span class="hljs-title function_">withAlpha</span>(<span class="hljs-number">0.3</span>),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// clampToGround: true,</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// show: true,</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// name:entity.name,</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">polyline</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">positions</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.534575</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.926131</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.537579</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.92543</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.541784</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924578</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.543973</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924144</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.545947</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.923944</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          ]),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">width</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// çº¿çš„å®½åº¦ï¼Œåƒç´ ä¸ºå•ä½</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">material</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">PolylineTrailMaterialProperty</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// å°¾è¿¹çº¿æè´¨</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">color</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">GOLD</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">trailLength</span>: <span class="hljs-number">0.4</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">period</span>: <span class="hljs-number">3.0</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          &#125;),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// clampToGround: true,</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// show: true,</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">addPolygon</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">entities</span>.<span class="hljs-title function_">add</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">polygon</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">hierarchy</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>([</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.539208</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924962</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.539176</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924737</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.540195</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924486</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">121.540281</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-number">38.924737</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          ]),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">extrudedHeight</span>: <span class="hljs-number">50</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">material</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Color</span>.<span class="hljs-property">WHITESMOKE</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// closeTop: false,</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-comment">// closeBottom: false,</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><p>æœ€åŸºæœ¬çš„Cesiumç›¸å…³æ“ä½œé€šè¿‡è¿™å‡ ç¯‡æ–‡ç« å°±å¤§æ¦‚ä»‹ç»å®Œäº†ï¼Œæˆ‘çš„ç –ä¹ŸæŠ›å‡ºæ¥äº†ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å¤§å®¶è‡ªå·±è¿›è¡Œç‰çš„é›•ç¢äº†ã€‚åç»­æˆ‘è¿˜ä¼šæ•´ç†å…³äºç‚¹ã€é¢çš„ç‚¹å‡»ä»¥åŠç®€æ˜“çš„å°è£…å‡ ä¸ªå¸¸ç”¨åŠŸèƒ½çš„ç±»ã€‚å¤§å®¶å¯ä»¥å¤šå¤šäº¤æµå…±åŒè¿›æ­¥ï¼Œæ¯•ç«Ÿæˆ‘ä¹Ÿæ˜¯ä¸€ä¸ªCesiumçš„åˆå­¦è€…^-^ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆäºŒï¼‰</title>
    <link href="/2021/04/25/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2021/04/25/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å®ç°äº†æœ€åŸºæœ¬çš„é¡¹ç›®æ­å»ºå¹¶ç”Ÿæˆäº†ä¸€ä¸ªä¸‰ç»´åœ°çƒï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¸»è¦ä»‹ç»ä¸€ä¸‹åœ°å›¾ä¸­åŸºæœ¬çš„å‡ å¤§è¦ç´ ã€åœ°å›¾ç›¸å¯¹åº”åæ ‡ç³»çŸ¥è¯†çš„ä»‹ç»åŠå¦‚ä½•å°†è¿™å‡ å¤§å…ƒç´ å‘ˆç°åœ¨æˆ‘ä»¬çš„åœ°çƒä¸Šã€‚åŒæ ·çš„ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰é”™è¯¯çš„è¯æ¬¢è¿è¯„è®ºåŒºæŒ‡å‡ºï¼Œå®šå½“è™šå¿ƒè¯·æ•™å¹¶åŠæ—¶ä¿®æ”¹ï¼</p></blockquote><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>æ¥ä¸‹æ¥ä¼šæœ‰éƒ¨åˆ†ç¯‡å¹…ç”¨æ¥ä»‹ç»åœ°å›¾å…ƒç´ ä»¥åŠåæ ‡ç³»åŠå…¶è½¬æ¢ç›¸å…³çŸ¥è¯†ï¼Œä»…ä½œäº†è§£ã€‚ä¸æƒ³çœ‹çš„å°±ç›´æ¥è·³åˆ°Viewerç›¸å…³é…ç½®ï¼Œç›´æ¥è¿›è¡Œå®é™…æ“ä½œã€‚</p><h3 id="åœ°å›¾å…ƒç´ "><a href="#åœ°å›¾å…ƒç´ " class="headerlink" title="åœ°å›¾å…ƒç´ "></a>åœ°å›¾å…ƒç´ </h3><hr><h4 id="è¦ç´ "><a href="#è¦ç´ " class="headerlink" title="è¦ç´ "></a>è¦ç´ </h4><p>æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ç™¾åº¦åœ°å›¾ä¸Šå¤§æ¦‚éƒ½æœ‰å“ªäº›å…ƒç´ ï¼ˆè¿™é‡Œæˆ‘ä»¥è·¯çº¿æŸ¥è¯¢ä½œä¸ºä¾‹å­ï¼‰</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba13746420fa42f7bfff16a7528c1d24~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><p>é¦–å…ˆ,åœ°å›¾ä¸­æœ€é‡è¦çš„ï¼Œä¹Ÿæ˜¯æœ€åŸºæœ¬çš„å°±æ˜¯åº•å›¾ï¼Œåº•å›¾è´Ÿè´£å°†åœ°ç†çš„åŸºæœ¬ä¿¡æ¯å±•ç°åœ¨è§†åŒºä¸­ï¼Œæ²¡æœ‰åº•å›¾ï¼Œå †å¤šå°‘è¦ç´ éƒ½æ˜¯æ— ç”¨çš„ã€‚æ¥ä¸‹æ¥æ˜¯è·¯çº¿çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œå¯¹åº”åœ°å›¾ä¸­çš„<strong>ç‚¹è¦ç´ Point</strong>ï¼Œä¸¤ç‚¹ä¹‹é—´çš„è·¯çº¿å¯¹åº”åœ°å›¾ä¸­çš„<strong>çº¿è¦ç´ LineString</strong>ã€‚æœ€åå°±æ˜¯å³ä¸‹è§’çš„é¢æ•°æ®äº†ï¼ˆæ˜¯ä¸æ˜¯æ ¼æ ¼ä¸å…¥ï¼Œå› ä¸ºæ˜¯æˆ‘è‡ªå·±ç”»çš„å“ˆå“ˆå“ˆï¼‰ï¼Œå¯¹åº”åœ°å›¾ä¸­çš„<strong>é¢è¦ç´ Polygon</strong>ã€‚è€Œæˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼ŒåŸºæœ¬ä¸Šçš„ä¿¡æ¯å±•ç¤ºå°±æ˜¯ç”±ç‚¹çº¿é¢ä¸‰ç±»è¦ç´ æ„æˆã€‚</p><h3 id="åæ ‡ç³»"><a href="#åæ ‡ç³»" class="headerlink" title="åæ ‡ç³»"></a>åæ ‡ç³»</h3><hr><p>åªè¦æ¶‰åŠåˆ°åœ°å›¾å¼€å‘ï¼Œæ— è®ºå¦‚ä½•å…³äºåæ ‡ç³»çš„æ¦‚å¿µæ˜¯é€ƒä¸æ‰çš„ï¼Œè°è®©åœ°çƒå®ƒæ˜¯ä¸ªçƒå‘¢ğŸŒï¼ˆå¦‚æœå‘æ¬§æ–‡è¯´çš„åœ°çƒæ˜¯æ–¹çš„é‚£å°±å¥½äº†ï¼‰ã€‚</p><blockquote><p>æƒ³è±¡ä¸­çš„åœ°çƒvså®é™…çš„åœ°çƒ<br><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a49e3ec28ff04edd8a80c842fd58178e~tplv-k3u1fbpfcp-watermark.image" alt="æƒ³è±¡ä¸­çš„åœ°çƒvså®é™…çš„åœ°çƒ"></p></blockquote><h4 id="å¸¸ç”¨åæ ‡ç³»"><a href="#å¸¸ç”¨åæ ‡ç³»" class="headerlink" title="å¸¸ç”¨åæ ‡ç³»"></a>å¸¸ç”¨åæ ‡ç³»</h4><p>è¿™é‡Œå°±ä¸åˆ—ä¸¾å›½å†…å¸¸ç”¨çš„åæ ‡ç³»åŠè½¬æ¢æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚å…³äºæŠ•å½±åæ ‡ç³»ç»Ÿå’Œåœ°ç†åæ ‡ç³»ç»Ÿï¼Œå¯ä»¥é˜…è¯»è¿™ä¸¤ç¯‡æ–‡ç« åŠ ä»¥äº†è§£ã€‚æˆ‘ä»¬ä¸»è¦ä»‹ç»Cesiumä¸­çš„å¸¸ç”¨åæ ‡ç³»ä»¥åŠå¯¹åº”çš„è½¬æ¢æ–¹å¼ã€‚</p><p><a href="https://juejin.cn/post/6930539078488326152#heading-17">åœ°ç†åæ ‡ç³»ç»Ÿ</a></p><p><a href="https://juejin.cn/post/6940684126282317861">æŠ•å½±åæ ‡ç³»ç»Ÿ</a></p><h4 id="Cesiumä¸­çš„åæ ‡ç³»"><a href="#Cesiumä¸­çš„åæ ‡ç³»" class="headerlink" title="Cesiumä¸­çš„åæ ‡ç³»"></a>Cesiumä¸­çš„åæ ‡ç³»</h4><p>Cesiumä¸­å¸¸ç”¨çš„åæ ‡æœ‰ä¸¤ç§ï¼šWGS84åæ ‡å’Œç¬›å¡å°”ç©ºé—´åæ ‡ï¼Œæˆ‘ä»¬å¹³æ—¶ä»¥ç»çº¬åº¦æ¥æŒ‡å‘ä¸€ä¸ªåœ°ç‚¹ç”¨çš„å°±æ˜¯WGS84åæ ‡ï¼Œç¬›å¡å°”ç©ºé—´åæ ‡åˆ™å¸¸ç”¨æ¥åšä¸€äº›ç©ºé—´ä½ç½®çš„å˜æ¢ï¼Œå¦‚å¹³ç§»ã€ç¼©æ”¾ç­‰ã€‚äºŒè€…å…³ç³»å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b626f08dc4824c58b1b7e1735f5f6e82~tplv-k3u1fbpfcp-watermark.image" alt="124613_sr4k_1585572.png"></p><p>WGS84åæ ‡ç³»ä¸­åŒ…æ‹¬WGS84ç»çº¬åº¦åæ ‡ç³»å’ŒWGS84å¼§åº¦åæ ‡ç³»ï¼ˆ<code>Cartographic</code>ï¼‰ã€‚</p><p>ç¬›å¡å°”ç©ºé—´åæ ‡ç³»åŒ…æ‹¬ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆ<code>Cartesian3</code>ï¼‰ã€å¹³é¢åæ ‡ç³»ï¼ˆ<code>Cartesian2</code>ï¼‰å’Œ4Dç¬›å¡å°”åæ ‡ç³»ï¼ˆ<code>Cartesian4</code>ï¼‰ã€‚</p><h5 id="WGS84åæ ‡ç³»"><a href="#WGS84åæ ‡ç³»" class="headerlink" title="WGS84åæ ‡ç³»"></a>WGS84åæ ‡ç³»</h5><p>World Geodetic System 1984ï¼Œæ˜¯ä¸ºGPSå…¨çƒå®šä½ç³»ç»Ÿä½¿ç”¨è€Œå»ºç«‹çš„åæ ‡ç³»ç»Ÿï¼Œåæ ‡åŸç‚¹ä¸ºåœ°çƒè´¨å¿ƒï¼Œå…¶åœ°å¿ƒç©ºé—´ç›´è§’åæ ‡ç³»çš„Zè½´æŒ‡å‘BIH ï¼ˆå›½é™…æ—¶é—´æœåŠ¡æœºæ„ï¼‰1984.Oå®šä¹‰çš„åè®®åœ°çƒæï¼ˆCTP)æ–¹å‘ï¼ŒXè½´æŒ‡å‘BIH 1984.0çš„é›¶å­åˆé¢å’ŒCTPèµ¤é“çš„äº¤ç‚¹ï¼ŒYè½´ä¸Zè½´ã€Xè½´å‚ç›´æ„æˆå³æ‰‹åæ ‡ç³»ã€‚æˆ‘ä»¬å¹³å¸¸æ‰‹æœºä¸Šçš„æŒ‡å—é’ˆæ˜¾ç¤ºçš„ç»çº¬åº¦å°±æ˜¯è¿™ä¸ªåæ ‡ç³»ä¸‹å½“å‰çš„åæ ‡ï¼Œè¿›åº¦èŒƒå›´[-180ï¼Œ180],çº¬åº¦èŒƒå›´[-90ï¼Œ90]ã€‚</p><p>Cesiumç›®å‰æ”¯æŒä¸¤ç§åæ ‡ç³»WGS84å’ŒWebMercatorï¼Œä½†æ˜¯åœ¨Cesiumä¸­æ²¡æœ‰å®é™…çš„å¯¹è±¡æ¥æè¿°WGS84åæ ‡ï¼Œéƒ½æ˜¯ä»¥å¼§åº¦çš„æ–¹å¼æ¥è¿›è¡Œè¿ç”¨çš„ä¹Ÿå°±æ˜¯Cartographicç±»ï¼š</p><p>new Cesium.Cartographic(longitude, latitude, height)ï¼Œè¿™é‡Œçš„å‚æ•°ä¹Ÿå«longitudeã€latitudeï¼Œå°±æ˜¯ç»åº¦å’Œçº¬åº¦ï¼Œè®¡ç®—æ–¹æ³•ï¼šå¼§åº¦= Ï€/180Ã—ç»çº¬åº¦è§’åº¦ã€‚</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a38ef2fd24245698bdf3ff1dd0a2f6e~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h5 id="ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰"><a href="#ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰" class="headerlink" title="ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰"></a>ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆ<code>Cartesian3</code>ï¼‰</h5><p>ç¬›å¡å°”ç©ºé—´åæ ‡çš„åŸç‚¹å°±æ˜¯æ¤­çƒçš„ä¸­å¿ƒï¼Œæˆ‘ä»¬åœ¨è®¡ç®—æœºä¸Šè¿›è¡Œç»˜å›¾æ—¶ï¼Œä¸æ–¹ä¾¿ä½¿ç”¨ç»çº¬åº¦ç›´æ¥è¿›è¡Œç»˜å›¾ï¼Œä¸€èˆ¬ä¼šå°†åæ ‡ç³»è½¬æ¢ä¸ºç¬›å¡å°”åæ ‡ç³»ï¼Œä½¿ç”¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­çš„çŸ¥è¯†è¿›è¡Œç»˜å›¾ã€‚è¿™é‡Œçš„Cartesian3ï¼Œæœ‰ç‚¹ç±»ä¼¼äºä¸‰ç»´ç³»ç»Ÿä¸­çš„Point3Då¯¹è±¡ï¼Œnew Cesium.Cartesian3(x, y, z)ï¼Œé‡Œé¢ä¸‰ä¸ªåˆ†é‡xã€yã€zã€‚</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f9e213692d04770929c86349456dda9~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h5 id="å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰"><a href="#å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰" class="headerlink" title="å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰"></a>å¹³é¢åæ ‡ç³»ï¼ˆ<code>Cartesian2</code>ï¼‰</h5><p>å¹³é¢åæ ‡ç³»ä¹Ÿå°±æ˜¯å¹³é¢ç›´è§’åæ ‡ç³»ï¼Œæ˜¯ä¸€ä¸ªäºŒç»´ç¬›å¡å°”åæ ‡ç³»ï¼Œä¸Cartesian3ç›¸æ¯”å°‘äº†ä¸€ä¸ªzçš„åˆ†é‡ï¼Œnew Cesium.Cartesian2(x, y)ã€‚Cartesian2ç»å¸¸ç”¨æ¥æè¿°å±å¹•åæ ‡ç³»ï¼Œæ¯”å¦‚é¼ æ ‡åœ¨ç”µè„‘å±å¹•ä¸Šçš„ç‚¹å‡»ä½ç½®ï¼Œè¿”å›çš„å°±æ˜¯Cartesian2ï¼Œè¿”å›äº†é¼ æ ‡ç‚¹å‡»ä½ç½®çš„xyåƒç´ ç‚¹åˆ†é‡ã€‚</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/18ddfe6f0c8048ffa51fa2a02538da09~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p><h4 id="åæ ‡ç³»è½¬æ¢"><a href="#åæ ‡ç³»è½¬æ¢" class="headerlink" title="åæ ‡ç³»è½¬æ¢"></a>åæ ‡ç³»è½¬æ¢</h4><h5 id="ç»çº¬åº¦å’Œå¼§åº¦çš„è½¬æ¢"><a href="#ç»çº¬åº¦å’Œå¼§åº¦çš„è½¬æ¢" class="headerlink" title="ç»çº¬åº¦å’Œå¼§åº¦çš„è½¬æ¢"></a>ç»çº¬åº¦å’Œå¼§åº¦çš„è½¬æ¢</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> radians=<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-property">toRadians</span>ï¼ˆdegreesï¼‰;<span class="hljs-comment">//ç»çº¬åº¦è½¬å¼§åº¦</span><br><span class="hljs-keyword">var</span> degrees=<span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-property">toDegrees</span>ï¼ˆradiansï¼‰;<span class="hljs-comment">//å¼§åº¦è½¬ç»çº¬åº¦</span><br></code></pre></td></tr></table></figure><h5 id="WGS84ç»çº¬åº¦åæ ‡å’ŒWGS84å¼§åº¦åæ ‡ç³»ï¼ˆCartographicï¼‰çš„è½¬æ¢"><a href="#WGS84ç»çº¬åº¦åæ ‡å’ŒWGS84å¼§åº¦åæ ‡ç³»ï¼ˆCartographicï¼‰çš„è½¬æ¢" class="headerlink" title="WGS84ç»çº¬åº¦åæ ‡å’ŒWGS84å¼§åº¦åæ ‡ç³»ï¼ˆCartographicï¼‰çš„è½¬æ¢"></a>WGS84ç»çº¬åº¦åæ ‡å’ŒWGS84å¼§åº¦åæ ‡ç³»ï¼ˆ<code>Cartographic</code>ï¼‰çš„è½¬æ¢</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ–¹æ³•ä¸€ï¼š</span><br><span class="hljs-keyword">var</span> longitude = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(longitude1); <span class="hljs-comment">//å…¶ä¸­ longitude1ä¸ºè§’åº¦</span><br><span class="hljs-keyword">var</span> latitude= <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(latitude1); <span class="hljs-comment">//å…¶ä¸­ latitude1ä¸ºè§’åº¦</span><br><span class="hljs-keyword">var</span> cartographic = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Cartographic</span>(longitude, latitude, height)ï¼›<br><br><span class="hljs-comment">//æ–¹æ³•äºŒï¼š</span><br><span class="hljs-keyword">var</span> cartographic= <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartographic</span>.<span class="hljs-title function_">fromDegrees</span>(longitude, latitude, height);<span class="hljs-comment">//å…¶ä¸­ï¼Œlongitudeå’Œlatitudeä¸ºè§’åº¦</span><br><br><span class="hljs-comment">//æ–¹æ³•ä¸‰ï¼š</span><br><span class="hljs-keyword">var</span> cartographic= <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartographic</span>.<span class="hljs-title function_">fromRadians</span>(longitude, latitude, height);<span class="hljs-comment">//å…¶ä¸­ï¼Œlongitudeå’Œlatitudeä¸ºå¼§åº¦</span><br></code></pre></td></tr></table></figure><h5 id="WGS84åæ ‡ç³»å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢"><a href="#WGS84åæ ‡ç³»å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢" class="headerlink" title="WGS84åæ ‡ç³»å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢"></a>WGS84åæ ‡ç³»å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆ<code>Cartesian3</code>ï¼‰çš„è½¬æ¢</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> position = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(longitude, latitude, height)ï¼›<span class="hljs-comment">//å…¶ä¸­ï¼Œé«˜åº¦é»˜è®¤å€¼ä¸º0ï¼Œå¯ä»¥ä¸ç”¨å¡«å†™ï¼›longitudeå’Œlatitudeä¸ºè§’åº¦</span><br><br><span class="hljs-keyword">var</span> positions = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArray</span>(coordinates);<span class="hljs-comment">//å…¶ä¸­ï¼Œcoordinatesæ ¼å¼ä¸ºä¸å¸¦é«˜åº¦çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼š[-115.0, 37.0, -107.0, 33.0]</span><br><br><span class="hljs-keyword">var</span> positions = <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegreesArrayHeights</span>(coordinates);<span class="hljs-comment">//coordinatesæ ¼å¼ä¸ºå¸¦æœ‰é«˜åº¦çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼š[-115.0, 37.0, 100000.0, -107.0, 33.0, 150000.0]</span><br><br><span class="hljs-comment">//åŒç†ï¼Œé€šè¿‡å¼§åº¦è½¬æ¢ï¼Œç”¨æ³•ç›¸åŒï¼Œå…·ä½“æœ‰Cesium.Cartesian3.fromRadiansï¼ŒCesium.Cartesian3.fromRadiansArrayï¼ŒCesium.Cartesian3.fromRadiansArrayHeightsç­‰æ–¹æ³•</span><br></code></pre></td></tr></table></figure><h5 id="ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»è½¬æ¢WGS84"><a href="#ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»è½¬æ¢WGS84" class="headerlink" title="ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»è½¬æ¢WGS84"></a>ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»è½¬æ¢WGS84</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> cartographic= <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartographic</span>.<span class="hljs-title function_">fromCartesian</span>(cartesian3)ï¼›<br></code></pre></td></tr></table></figure><h5 id="å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢"><a href="#å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢" class="headerlink" title="å¹³é¢åæ ‡ç³»ï¼ˆCartesian2ï¼‰å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆCartesian3ï¼‰çš„è½¬æ¢"></a>å¹³é¢åæ ‡ç³»ï¼ˆ<code>Cartesian2</code>ï¼‰å’Œç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»ï¼ˆ<code>Cartesian3</code>ï¼‰çš„è½¬æ¢</h5><p>å¹³é¢åæ ‡ç³»è½¬ç¬›å¡å°”ç©ºé—´ç›´è§’åæ ‡ç³»</p><p>è¿™é‡Œæ³¨æ„çš„æ˜¯å½“å‰çš„ç‚¹(Cartesian2)å¿…é¡»åœ¨ä¸‰ç»´çƒä¸Šï¼Œå¦åˆ™è¿”å›çš„æ˜¯undefinedï¼›é€šè¿‡ScreenSpaceEventHandlerå›è°ƒä¼šå–åˆ°çš„åæ ‡éƒ½æ˜¯Cartesian2ã€‚</p><p>å±å¹•åæ ‡è½¬åœºæ™¯åæ ‡-è·å–å€¾æ–œæ‘„å½±æˆ–æ¨¡å‹ç‚¹å‡»å¤„çš„åæ ‡<br>è¿™é‡Œçš„åœºæ™¯åæ ‡æ˜¯åŒ…å«äº†åœ°å½¢ã€å€¾æ–œæ‘„å½±è¡¨é¢ã€æ¨¡å‹çš„åæ ‡ã€‚</p><p>é€šè¿‡viewer.scene.pickPosition(movement.position)è·å–ï¼Œæ ¹æ®çª—å£åæ ‡ï¼Œä»åœºæ™¯çš„æ·±åº¦ç¼“å†²åŒºä¸­æ‹¾å–ç›¸åº”çš„ä½ç½®ï¼Œè¿”å›ç¬›å¡å°”åæ ‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">movement</span>) &#123;<br>     <span class="hljs-keyword">var</span> position = viewer.<span class="hljs-property">scene</span>.<span class="hljs-title function_">pickPosition</span>(movement.<span class="hljs-property">position</span>);<br>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(position);<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šè‹¥å±å¹•åæ ‡å¤„æ²¡æœ‰å€¾æ–œæ‘„å½±è¡¨é¢ã€æ¨¡å‹æ—¶ï¼Œè·å–çš„ç¬›å¡å°”åæ ‡ä¸å‡†ï¼Œæ­¤æ—¶è¦å¼€å¯åœ°å½¢æ·±åº¦æ£€æµ‹ï¼ˆ<code>viewer.scene.globe.depthTestAgainstTerrain = true</code>; //é»˜è®¤ä¸ºfalseï¼‰ã€‚</p><p>å±å¹•åæ ‡è½¬åœ°è¡¨åæ ‡-è·å–åŠ è½½åœ°å½¢åå¯¹åº”çš„ç»çº¬åº¦å’Œé«˜ç¨‹<br>è¿™é‡Œæ˜¯åœ°çƒè¡¨é¢çš„ä¸–ç•Œåæ ‡ï¼ŒåŒ…å«åœ°å½¢ï¼Œä¸åŒ…æ‹¬æ¨¡å‹ã€å€¾æ–œæ‘„å½±è¡¨é¢ã€‚</p><p>é€šè¿‡<code>viewer.scene.globe.pick(ray, scene)</code>è·å–ï¼Œå…¶ä¸­<code>ray=viewer.camera.getPickRay(movement.position)</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">movement</span>) &#123;<br>     <span class="hljs-keyword">var</span> ray = viewer.<span class="hljs-property">camera</span>.<span class="hljs-title function_">getPickRay</span>(movement.<span class="hljs-property">position</span>);<br>     <span class="hljs-keyword">var</span> position = viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">globe</span>.<span class="hljs-title function_">pick</span>(ray, viewer.<span class="hljs-property">scene</span>);<br>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(position);<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šé€šè¿‡æµ‹è¯•ï¼Œæ­¤å¤„å¾—åˆ°çš„åæ ‡é€šè¿‡è½¬æ¢æˆwgs84åï¼Œheightçš„ä¸ºè¯¥ç‚¹çš„åœ°å½¢é«˜ç¨‹å€¼ã€‚</p><p>å±å¹•åæ ‡è½¬æ¤­çƒé¢åæ ‡-è·å–é¼ æ ‡ç‚¹çš„å¯¹åº”æ¤­çƒé¢ä½ç½®<br>è¿™é‡Œçš„æ¤­çƒé¢åæ ‡æ˜¯å‚è€ƒæ¤­çƒçš„WGS84åæ ‡(Ellipsoid.WGS84)ï¼Œä¸åŒ…å«åœ°å½¢ã€æ¨¡å‹ã€å€¾æ–œæ‘„å½±è¡¨é¢ã€‚</p><p>é€šè¿‡ <code>viewer.scene.camera.pickEllipsoid(movement.position, ellipsoid)</code>è·å–ï¼Œå¯ä»¥è·å–å½“å‰ç‚¹å‡»è§†çº¿ä¸æ¤­çƒé¢ç›¸äº¤å¤„çš„åæ ‡ï¼Œå…¶ä¸­ellipsoidæ˜¯å½“å‰åœ°çƒä½¿ç”¨çš„æ¤­çƒå¯¹è±¡ï¼š<code>viewer.scene.globe.ellipsoid</code>ï¼Œé»˜è®¤ä¸ºEllipsoid.WGS84ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ScreenSpaceEventHandler</span>(viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">canvas</span>);<br>handler.<span class="hljs-title function_">setInputAction</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">movement</span>) &#123;<br>     <span class="hljs-keyword">var</span> position = viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">pickEllipsoid</span>(movement.<span class="hljs-property">position</span>, viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">globe</span>.<span class="hljs-property">ellipsoid</span>);<br>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(position);<br>&#125;, <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">ScreenSpaceEventType</span>.<span class="hljs-property">LEFT_CLICK</span>);<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šé€šè¿‡æµ‹è¯•ï¼Œæ­¤å¤„å¾—åˆ°çš„åæ ‡é€šè¿‡è½¬æ¢æˆwgs84åï¼Œheightçš„ä¸º0(æ­¤å€¼åº”è¯¥ä¸ºåœ°è¡¨åæ ‡å‡å»åœ°å½¢çš„é«˜ç¨‹)ã€‚</p><h3 id="Viewerç›¸å…³é…ç½®é¡¹"><a href="#Viewerç›¸å…³é…ç½®é¡¹" class="headerlink" title="Viewerç›¸å…³é…ç½®é¡¹"></a>Viewerç›¸å…³é…ç½®é¡¹</h3><hr><p>æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­æˆåŠŸç”Ÿæˆäº†ä¸‰ç»´çƒä½“ï¼Œä½†æ˜¯ç»†å¿ƒçš„æœ‹å‹ä¼šå‘ç°æˆ‘ä»¬<code>Viewer</code>çš„é…ç½®é¡¹æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ¥ä¸‹æ¥æˆ‘å°±å°†åŸºæœ¬é…ç½®ç½—åˆ—å‡ºæ¥ï¼Œæœ‹å‹ä»¬å¯æ ¹æ®éœ€è¦è‡ªè¡Œæ·»åŠ åˆ°è‡ªå·±çš„<code>Viewer</code>é…ç½®ä¸­</p><blockquote><p>è¿™é‡Œçš„é…ç½®å¯¹åº”çš„æ˜¯è¶…å›¾äºŒæ¬¡å°è£…è¿‡çš„Viewer,æ‰€ä»¥æœ‰äº›é»˜è®¤é…ç½®å¯èƒ½ä¸åŸå§‹Ceiusmé»˜è®¤é…ç½®ä¸åŒï¼ŒåŸå§‹çš„é…ç½®é¡¹å¯å‚ç…§<a href="https://blog.csdn.net/shenwuyuexy/article/details/108262789">è¿™ç¯‡åšå®¢</a></p></blockquote><table><thead><tr><th>åç§°</th><th>ç±»å‹</th><th>é»˜è®¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>clock</td><td><code>Clock</code></td><td><code>new Clock()</code></td><td>æ§åˆ¶å½“å‰æ—¶é—´çš„æ—¶é’Ÿ</td></tr><tr><td>selectedImageryProviderViewModel</td><td><code>ProviderViewModel</code></td><td></td><td>å½“å‰åŸºç¡€å›¾åƒå›¾å±‚çš„è§†å›¾æ¨¡å‹ï¼Œå¦‚è‹¥æœªæä¾›ï¼Œåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨åŸºç¡€å›¾å±‚ã€‚æ­¤å€¼ä»…åœ¨ options.baseLayerPicker è®¾ç½®ä¸ºtrueæ—¶æœ‰æ•ˆã€‚</td></tr><tr><td>imageryProviderViewModels</td><td>Array.<code>&lt;ProviderViewModel&gt;</code></td><td><code>createDefaultImageryProviderViewModels()</code></td><td>ProviderViewModelsæ•°ç»„å¯ä»BaseLayerPickerä¸­é€‰æ‹©ã€‚æ­¤å€¼ä»…åœ¨ options.baseLayerPicker è®¾ç½®ä¸ºtrueæ—¶æœ‰æ•ˆã€‚</td></tr><tr><td>selectedTerrainProviderViewModel</td><td><code>ProviderViewModel</code></td><td></td><td>å½“å‰åŸºç¡€åœ°å½¢å›¾å±‚çš„è§†å›¾æ¨¡å‹ï¼Œå¦‚è‹¥æœªæä¾›ï¼Œåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨åŸºç¡€å›¾å±‚ã€‚æ­¤å€¼ä»…åœ¨ options.baseLayerPicker è®¾ç½®ä¸ºtrueæ—¶æœ‰æ•ˆã€‚</td></tr><tr><td>terrainProviderViewModels</td><td>Array.<code>&lt;ProviderViewModel&gt;</code></td><td><code>createDefaultTerrainProviderViewModels()</code></td><td>ProviderViewModelsæ•°ç»„å¯ä»BaseLayerPickerä¸­é€‰æ‹©ã€‚æ­¤å€¼ä»…åœ¨ options.baseLayerPicker è®¾ç½®ä¸ºtrueæ—¶æœ‰æ•ˆã€‚</td></tr><tr><td>imageryProvider</td><td><code>ImageryProvider</code></td><td><code>new BingMapsImageryProvider()</code></td><td>ä½¿ç”¨çš„å½±åƒæä¾›è€…ã€‚æ­¤å€¼ä»…åœ¨ options.baseLayerPicker è®¾ç½®ä¸º false æ—¶æœ‰æ•ˆã€‚</td></tr><tr><td>terrainProvider</td><td><code>TerrainProvider</code></td><td><code>new EllipsoidTerrainProvider()</code></td><td>ä½¿ç”¨çš„åœ°å½¢æä¾›è€…ã€‚</td></tr><tr><td>skyBox</td><td><code>SkyBox</code></td><td></td><td>ç”¨äºæ¸²æŸ“æ˜Ÿè¾°çš„å¤©ç©ºç›’ï¼Œæœªå®šä¹‰æ—¶ï¼Œä½¿ç”¨é»˜è®¤æ˜Ÿè¾°æ•ˆæœã€‚</td></tr><tr><td>skyAtmosphere</td><td><code>SkyAtmosphere</code></td><td></td><td>ç¯ç»•åœ°çƒè¾¹ç¼˜çš„è“å¤©å’Œå…‰æ™•æ•ˆæœï¼Œè®¾ç½®ä¸ºfalseå¯å°†å…¶å…³é—­ã€‚</td></tr><tr><td>useDefaultRenderLoop</td><td><code>Boolean</code></td><td><code>true</code></td><td>å¦‚æœæ­¤éƒ¨ä»¶èƒ½å¤Ÿæ§åˆ¶æ¸²æŸ“å¾ªç¯ï¼Œè®¾ç½®ä¸ºtrueï¼Œåä¹‹è®¾ç½®ä¸ºfalseã€‚</td></tr><tr><td>targetFrameRate</td><td><code>Number</code></td><td></td><td>ä½¿ç”¨é»˜è®¤æ¸²æŸ“å¾ªç¯æ—¶çš„ç›®æ ‡å¸§é€Ÿç‡ã€‚</td></tr><tr><td>showRenderLoopErrors</td><td><code>Boolean</code></td><td><code>true</code></td><td>å¦‚æœè®¾ç½®ä¸ºtrueï¼Œå‘ç”Ÿæ¸²æŸ“å¾ªç¯é”™è¯¯æ—¶ï¼Œå°†è‡ªåŠ¨ç»™ç”¨æˆ·æ˜¾ç¤ºä¸€ä¸ªåŒ…å«é”™è¯¯ä¿¡æ¯çš„HTMLé¢æ¿ã€‚</td></tr><tr><td>automaticallyTrackDataSourceClocks</td><td><code>Boolean</code></td><td><code>true</code></td><td>å¦‚æœè®¾ç½®ä¸ºtrueï¼Œå°†è‡ªåŠ¨è·Ÿè¸ªæ–°æ·»åŠ æ•°æ®æºçš„æ—¶é’Ÿè®¾ç½®ï¼Œå¦‚æœæ•°æ®æºçš„æ—¶é’Ÿå˜æ›´ï¼Œåˆ™æ›´æ–°ã€‚å¦‚éœ€å•ç‹¬è®¾ç½®æ—¶é’Ÿï¼Œè¯·å°†æ­¤é¡¹è®¾ç½®ä¸ºfalseã€‚</td></tr><tr><td>contextOptions</td><td><code>Object</code></td><td></td><td>Context and WebGL åˆ›å»ºå±æ€§ä¸ä¼ é€’ç»™SceneåŒ¹é…çš„é€‰é¡¹ã€‚å¢åŠ ç¡¬ä»¶åèµ°æ ·åŠŸèƒ½ï¼Œåèµ°æ ·ç³»æ•°msaalevelä½¿ç”¨1åˆ°8çš„æ•´æ•°å€¼ï¼Œé»˜è®¤æ˜¯1ï¼Œå€¼è¶Šå¤§åèµ°æ ·æ•ˆæœè¶Šå¥½ï¼ˆå› ä¸ºç”¨åˆ°äº†WebGL2.0çš„ç‰¹æ€§ï¼Œæ‰€ä»¥requestWebgl2å‚æ•°è®¾ç½®ä¸ºtrueã€‚å› ä¸ºWebGL2.0è¿˜å­˜åœ¨ä¸€ä¸‹ç¼ºé™·ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŠŠOIT,FXAA,HDRå…³æ‰ï¼‰</td></tr><tr><td>mapProjection</td><td><code>MapProjection</code></td><td><code>new GeographicProjection()    </code></td><td>åœ¨äºŒç»´å’ŒColumbusè§†å›¾æ¨¡å¼ä¸‹æ‰€ä½¿ç”¨çš„åœ°å›¾æŠ•å½±ã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>globe</td><td><code>Globe</code></td><td><code>new Globe(mapProjection.ellipsoid)    </code></td><td>åœºæ™¯ä¸­çš„åœ°çƒï¼Œå¦‚æœæ­¤é¡¹è®¾ç½®ä¸ºfalseï¼Œå°†ä¸æ·»åŠ çƒä½“å¯¹è±¡ã€‚</td></tr><tr><td>orderIndependentTranslucency</td><td><code>Boolean</code></td><td><code>true</code></td><td>å¦‚æœæ­¤é¡¹è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”ä½¿ç”¨è®¾å¤‡æ”¯æŒï¼Œå°†ä½¿ç”¨ä¸é¡ºåºæ— å…³çš„åŠé€æ˜ã€‚</td></tr><tr><td>creditContainer</td><td><code>Element</code> \ <code>String</code></td><td></td><td>æŒ‡å®šåŒ…å«CreditDisplayä¿¡æ¯çš„DOMå…ƒç´ æˆ–IDã€‚å¦‚è‹¥æœªæŒ‡å®šï¼Œcreditä¿¡æ¯å°†æ·»åŠ åˆ°éƒ¨ä»¶åº•éƒ¨ã€‚</td></tr><tr><td>dataSources</td><td><code>DataSourceCollection</code></td><td><code>new DataSourceCollection()</code></td><td>æŒ‡å®šç”±vieweréƒ¨ä»¶å¯è§†åŒ–çš„æ•°æ®æºé›†åˆã€‚å¦‚æœæä¾›æ­¤å‚æ•°ï¼Œå®ä¾‹ç”±è°ƒç”¨è€…æ‹¥æœ‰ï¼Œå¹¶ä¸”viewerè¢«é”€æ¯æ—¶æ­¤å®ä¾‹ä¸è¢«é”€æ¯ã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>terrainExaggeration</td><td><code>Number</code></td><td><code>1.0</code></td><td>ç”¨äºå¤¸å¤§åœ°å½¢çš„æ ‡é‡ã€‚è¯·æ³¨æ„ï¼Œè®¾ç½®åœ°å½¢å¤¸å¼ ä¸ä¼šä¿®æ”¹å…¶å®ƒä»»ä½•æ•°æ®ã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>shadows</td><td><code>Boolean</code></td><td><code>false</code></td><td>ç¡®å®šé˜´å½±æ˜¯å¦ç”±å¤ªé˜³æŠ•å°„å½¢æˆã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>terrainShadows</td><td><code>ShadowMode</code></td><td><code>ShadowMode.RECEIVE_ONLY</code></td><td>ç¡®å®šåœ°å½¢æ˜¯å¦æŠ•å°„æˆ–æ¥å—æ¥è‡ªå¤ªé˜³çš„é˜´å½±ã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>mapMode2D</td><td><code>MapMode2D</code></td><td><code>MapMode2D.INFINITE_SCROLL</code></td><td>ç¡®å®šäºŒç»´åœ°å›¾æ˜¯å¯æ—‹è½¬çš„æˆ–æ˜¯å¯ä»¥åœ¨åœ¨æ°´å¹³æ–¹å‘ä¸Šæ— é™æ»šåŠ¨ã€‚</td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td>navigation</td><td><code>Boolean</code></td><td><code>false</code></td><td>æ˜¯å¦æ˜¾ç¤ºå¯¼èˆªç½—ç›˜æ§ä»¶ã€‚å¦‚éœ€æ˜¾ç¤ºï¼Œéœ€åœ¨åˆå§‹åŒ–vieweræ—¶æ­¤é¡¹è®¾ç½®ä¸ºtrueã€‚</td></tr></tbody></table><h3 id="æ·»åŠ å›¾å±‚ï¼ˆAdding-Imageryï¼‰"><a href="#æ·»åŠ å›¾å±‚ï¼ˆAdding-Imageryï¼‰" class="headerlink" title="æ·»åŠ å›¾å±‚ï¼ˆAdding Imageryï¼‰"></a>æ·»åŠ å›¾å±‚ï¼ˆ<code>Adding Imagery</code>ï¼‰</h3><hr><p><code>Imagery</code>ä¸ç”¨è¯´ï¼Œåœ¨Cesiumé¡¹ç›®ä¸­ä¸€å®šæ˜¯å…³é”®å…ƒç´ ï¼Œç“¦ç‰‡å›¾é›†åˆæ ¹æ®ä¸åŒæŠ•å½±æ–¹å¼æ˜ å°„åˆ°ä¸‰ç»´åœ°çƒè¡¨é¢ï¼Œé€šè¿‡ç›¸æœºæŒ‡å‘åœ°è¡¨çš„æ–¹å‘è·ç¦»ï¼ŒCesiumä¼šè‡ªåŠ¨è¯·æ±‚ä¸åŒå±‚çº§çš„å›¾å±‚ä¿¡æ¯è¿›è¡Œæ¸²æŸ“ã€‚</p><p>Cesiumæ”¯æŒå¤šç§å›¾å±‚æ ¼å¼ï¼š</p><ul><li>wms</li><li>TMS</li><li>WMTS</li><li>ArcGIS</li><li>BingMaps</li><li>GoogleEarth</li><li>Mapbox</li><li>OpenStreetMap</li></ul><blockquote><p>é»˜è®¤åœ°ï¼ŒCesiumä½¿ç”¨Bing Mapsä½œä¸ºé»˜è®¤çš„å›¾å±‚ã€‚è¿™ä¸ªå›¾å±‚è¢«æ‰“åŒ…è¿›Viewerä¸­ç”¨äºæ¼”ç¤ºã€‚</p></blockquote><p>Cesiumä¸­åŸºæœ¬çš„æ·»åŠ åº•å›¾çš„æ–¹æ³•ä¸º<code>viewer.imageryLayers.addImageryProvider()</code></p><p>æˆ‘ä»¬åœ¨<code>init()</code>æ–¹æ³•ä¸­æ·»åŠ ä¸‹æ–¹ä»£ç ï¼Œå°è¯•ä¸€ä¸‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> layer = viewer.<span class="hljs-property">imageryLayers</span>.<span class="hljs-title function_">addImageryProvider</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ArcGisMapServerImageryProvider</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer&#x27;</span><br>&#125;));<br></code></pre></td></tr></table></figure><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/86c80980222c4490b0ba10c92bb2961e~tplv-k3u1fbpfcp-watermark.image" alt="1.gif"></p><p>å¯¹äºå¤©åœ°å›¾WebGLæä¾›äº†ä¸€ä¸ªå¤©åœ°å›¾å½±åƒæœåŠ¡æä¾›è€…ç±»<code>TiandituImageryProvider</code>ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•å¯ä»¥<a href="http://support.supermap.com.cn:8090/webgl/examples/webgl/editor.html#tianditu">å‚ç…§ç¤ºä¾‹</a>å’Œ<a href="http://support.supermap.com.cn/DataWarehouse/WebDocHelp/iPortal/webgl/docs/Documentation/TiandituImageryProvider.html">apiæ–‡æ¡£</a></p><h3 id="Cameraå®ä½“"><a href="#Cameraå®ä½“" class="headerlink" title="Cameraå®ä½“"></a>Cameraå®ä½“</h3><hr><p>æˆ‘ä»¬å·²ç»æŠŠè‡ªå·±æƒ³è¦çš„åº•å›¾æ·»åŠ åˆ°åœ°çƒä¸Šäº†ï¼Œä½†æ˜¯å®é™…é¡¹ç›®ä¸­è‚¯å®šä¸å¯èƒ½ä¸€è¿›é¡¹ç›®å°±ç»™äººå±•ç¤ºæ•´ä¸ªåœ°çƒï¼ˆå¦‚æœéœ€æ±‚æ˜¯è¿™æ ·çš„ï¼Œé‚£æˆ‘é“æ­‰ï¼ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨åœ°çƒç”Ÿæˆåå®šä½åˆ°æˆ‘ä»¬éœ€è¦çš„ä½ç½®ï¼Œè¿™å°±ä¸å¾—ä¸è¯´ä¸€ä¸‹<code>Camera</code>äº†ã€‚</p><p>Cesiumä¸­æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥æ“ä½œCameraï¼Œå¦‚æ—‹è½¬(rotate)ã€ç¼©æ”¾(zoom)ã€å¹³ç§»(pan)å’Œé£åˆ°ç›®çš„åœ°(flyTo)ã€‚CesiumJSæœ‰é¼ æ ‡å’Œè§¦æ‘¸äº‹ä»¶ç”¨æ¥å¤„ç†ä¸Camreaçš„äº¤äº’ï¼Œè¿˜æœ‰APIæ¥ä»¥ç¼–ç¨‹æ–¹å¼æ“ä½œæ‘„åƒæœºã€‚</p><p>ä½¿ç”¨<code>setView</code>å‡½æ•°å¯è®¾ç½®Cameraçš„ä½ç½®å’Œæ–¹å‘ã€‚<code>destination</code>å¯ä»¥æ˜¯<code>Cartesian3</code>æˆ–è€…<code>Rectangle</code>ï¼Œ<code>orientation</code>å¯ä»¥æ˜¯<code>heading | pitch | roll | direction | up</code>ã€‚èˆªå‘è§’ã€ä¿¯ä»°è§’å’Œæ¨ªæ»šè§’ä»¥å¼§åº¦å®šä¹‰ã€‚èˆªå‘è§’æ˜¯ä»æ­£è§’åº¦å‘ä¸œå¢åŠ çš„å±€éƒ¨åŒ—å‘æ—‹è½¬ã€‚ä¿¯ä»°è§’æ˜¯æŒ‡ä»å±€éƒ¨çš„ä¸œåŒ—å¹³é¢å¼€å§‹æ—‹è½¬ã€‚æ­£ä¿¯ä»°è§’åœ¨å¹³é¢ä¸Šæ–¹ã€‚è´Ÿä¿¯ä»°è§’åœ¨å¹³é¢ä»¥ä¸‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><br> <span class="hljs-comment">//   åˆå§‹åŒ–åœºæ™¯ä½ç½®</span><br>viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">setView</span>(&#123;<br>    <span class="hljs-comment">// åˆå§‹åŒ–ç›¸æœºç»çº¬åº¦ï¼ˆè¿™é‡Œä½¿ç”¨äº†ç»çº¬åº¦è½¬æ¢ä¸–ç•Œåæ ‡çš„æ–¹æ³•ï¼‰</span><br>    <span class="hljs-attr">destination</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(<br>      <span class="hljs-number">121.54035</span>,<br>      <span class="hljs-number">38.92146</span>,<br>      <span class="hljs-number">2000</span><br>    ),<br>    <span class="hljs-attr">orientation</span>: &#123;<br>      <span class="hljs-attr">heading</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(<span class="hljs-number">0.0</span>),<br>      <span class="hljs-attr">pitch</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(-<span class="hljs-number">25.0</span>), <span class="hljs-comment">//ä»ä¸Šå¾€ä¸‹çœ‹ä¸º-90</span><br>      <span class="hljs-attr">roll</span>: <span class="hljs-number">0</span>,<br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p><code>flyTo</code>æ–¹æ³•çš„å‚æ•°å’Œ<code>setView</code>æ˜¯åŸºæœ¬ä¸€æ ·çš„ã€‚åªæ˜¯<code>setView</code>æ˜¯ç›´æ¥å°†è§†è§’æ ¹æ®å‚æ•°å®šä½ï¼Œè€Œ<code>flyTo</code>å¦‚å­—é¢æ„æ€ï¼Œä¼šæœ‰ä¸€ä¸ªé£å‘å®šä½ç‚¹çš„åŠ¨ç”»æ•ˆæœã€‚</p><p>ä¸¤è€…æ•ˆæœå›¾ï¼š</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b4dd71de89504a73a1846edf0bcc9e5f~tplv-k3u1fbpfcp-watermark.image" alt="2.gif"></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6a6f904d242e440c86d15c2c874d4cf8~tplv-k3u1fbpfcp-watermark.image" alt="3.gif"></p><h4 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;template&gt;<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cesiumContainer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>&lt;/template&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">var</span> viewer, camera;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-keyword">return</span> &#123;&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">      viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&quot;cesiumContainer&quot;</span>, &#123;&#125;);</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-keyword">var</span> layer = viewer.<span class="hljs-property">imageryLayers</span>.<span class="hljs-title function_">addImageryProvider</span>(</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">ArcGisMapServerImageryProvider</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">url</span>:</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-string">&quot;http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer&quot;</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;)</span></span><br><span class="language-javascript"><span class="language-xml">      );</span></span><br><span class="language-javascript"><span class="language-xml">      <span class="hljs-comment">//   åˆå§‹åŒ–åœºæ™¯ä½ç½®</span></span></span><br><span class="language-javascript"><span class="language-xml">      viewer.<span class="hljs-property">scene</span>.<span class="hljs-property">camera</span>.<span class="hljs-title function_">flyTo</span>(&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">// åˆå§‹åŒ–ç›¸æœºç»çº¬åº¦</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">destination</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Cartesian3</span>.<span class="hljs-title function_">fromDegrees</span>(</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">121.54035</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">38.92146</span>,</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-number">2000</span></span></span><br><span class="language-javascript"><span class="language-xml">        ),</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-attr">orientation</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">heading</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(<span class="hljs-number">0.0</span>),</span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">pitch</span>: <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Math</span>.<span class="hljs-title function_">toRadians</span>(-<span class="hljs-number">25.0</span>), <span class="hljs-comment">//ä»ä¸Šå¾€ä¸‹çœ‹ä¸º-90</span></span></span><br><span class="language-javascript"><span class="language-xml">          <span class="hljs-attr">roll</span>: <span class="hljs-number">0</span>,</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">      &#125;);</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">  &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><hr><p>æœ¬æ¥æƒ³åœ¨è¿™ç¯‡æ–‡ç« ä¸­æŠŠç‚¹çº¿é¢çš„æ·»åŠ å†™è¿›æ¥çš„ï¼Œè®¡åˆ’ä¸å¦‚å˜åŒ–å¿«ï¼Œæ‰€ä»¥è¿™ç¯‡æš‚æ—¶å°±åªè®²ä¸€ä¸‹åæ ‡ç³»å’ŒViewerã€Cameraç›¸å…³çš„ä¸œè¥¿å§ã€‚ä¸‹ä¸€ç¯‡å†å®ç°æ·»åŠ ç‚¹çº¿é¢è¦ç´ å§ã€‚å¤´ç–¼å“ˆå“ˆå“ˆã€‚æœ€åè°¢è°¢çœ‹è¿‡èµè¿‡è¯„è®ºè¿‡æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« çš„å…„å¼Ÿä»¬ï¼Œå†™äº†æ–‡ç« æœ‰äº†åé¦ˆç¡®å®æ˜¯æ›´æœ‰åŠ¨åŠ›åˆ›ä½œä¸‹å»ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€ä¸‰ç»´GISå¯è§†åŒ–ã€‘åŸºäºVue+Cesium+Supermapå®ç°æ™ºæ…§åŸå¸‚ï¼ˆä¸€ï¼‰</title>
    <link href="/2021/04/22/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2021/04/22/%E3%80%90%E4%B8%89%E7%BB%B4GIS%E5%8F%AF%E8%A7%86%E5%8C%96%E3%80%91%E5%9F%BA%E4%BA%8EVue+Cesium+Supermap%E5%AE%9E%E7%8E%B0%E6%99%BA%E6%85%A7%E5%9F%8E%E5%B8%82%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><hr><p>ä¸ä¹…å‰å—å‘½ç ”ç©¶å¼€å‘3Då¯è§†åŒ–åŠæ™ºæ…§åŸå¸‚çš„æŠ€æœ¯è·¯çº¿ï¼Œç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯<a href="https://cesium.com/">Cesium</a>è¿™ä¸ªä¸–ç•Œçº§å¼€æºåº“ã€‚ä½†æ˜¯æˆ‘çš„ä¸šåŠ¡ä¸Šå¯èƒ½ä¼šæœ‰å¾ˆå¤šå…³äºç©ºé—´åŠåœ°ç†åˆ†æç›¸å…³çš„åŠŸèƒ½å®ç°ï¼Œæ‰€ä»¥æˆ‘æ‰¾åˆ°äº†è¶…å›¾ã€‚è¶…å›¾æ‹¥æœ‰åŸºäºCesiumåŒ…è£…å’ŒäºŒæ¬¡å°è£…çš„ä¸‰ç»´äº§å“3D-WebGLåŒ…ï¼ˆæ–‡æœ«é™„äº§å“ä¸‹è½½åœ°å€ï¼‰ã€‚ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œæ¥ä¸‹æ¥ç®€å•äº†è§£ä¸€ä¸‹Cesiumæ˜¯ä»€ä¹ˆç¥å¥‡çš„ä¸œä¸œå§ã€‚</p><h3 id="Cesium"><a href="#Cesium" class="headerlink" title="Cesium"></a>Cesium</h3><hr><h4 id="Cesiumæ˜¯ä»€ä¹ˆ"><a href="#Cesiumæ˜¯ä»€ä¹ˆ" class="headerlink" title="Cesiumæ˜¯ä»€ä¹ˆ"></a>Cesiumæ˜¯ä»€ä¹ˆ</h4><p>Cesiumæ˜¯ä¸€ä¸ªè·¨å¹³å°ï¼Œè·¨æµè§ˆå™¨çš„å±•ç¤ºä¸‰ç»´åœ°çƒå’Œåœ°å›¾çš„JavaScriptåº“ã€‚Cesiumä½¿ç”¨WebGLæ¥è¿›è¡Œç¡¬ä»¶åŠ é€Ÿå›¾å½¢ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦ä»»ä½•æ’ä»¶çš„æ”¯æŒï¼Œä½†éœ€è¦æµè§ˆå™¨æ”¯æŒWebGLã€‚å®ƒæä¾›äº†ä¾æ®Javascriptçš„å¼€å‘åŒ…ï¼Œæ–¹ä¾¿æˆ‘ä»¬é«˜æ•ˆå¿«é€Ÿçš„æ­å»ºä¸€ä¸ª3Dé¡¹ç›®ã€‚</p><h4 id="Cesiumèƒ½å¹²ä»€ä¹ˆ"><a href="#Cesiumèƒ½å¹²ä»€ä¹ˆ" class="headerlink" title="Cesiumèƒ½å¹²ä»€ä¹ˆ"></a>Cesiumèƒ½å¹²ä»€ä¹ˆ</h4><ul><li>æ”¯æŒ2Dï¼Œ2.5D,3Då½¢å¼çš„åœ°å›¾å±•ç¤º</li><li>å¯ä»¥ç»˜åˆ¶å„ç§å‡ ä½•å›¾å½¢ã€é«˜äº®åŒºåŸŸï¼Œæ”¯æŒå¯¼å…¥å›¾ç‰‡ï¼Œç”šè‡³3Dæ¨¡å‹ç­‰å¤šç§æ•°æ®å¯è§†åŒ–å±•ç¤ºã€‚</li><li>å¯ç”¨äºåŠ¨æ€æ•°æ®å¯è§†åŒ–å¹¶æä¾›è‰¯å¥½çš„è§¦æ‘¸æ”¯æŒï¼Œæ”¯æŒç»å¤§å¤šæ•°æµè§ˆå™¨å’Œmobileã€‚</li><li>Cesiumè¿˜æ”¯æŒåŸºäºæ—¶é—´è½´çš„åŠ¨æ€æ•°æ®å±•ç¤ºã€‚<h4 id="Cesiumæ€ä¹ˆç”¨"><a href="#Cesiumæ€ä¹ˆç”¨" class="headerlink" title="Cesiumæ€ä¹ˆç”¨"></a>Cesiumæ€ä¹ˆç”¨</h4><blockquote><p>æ¥ä¸‹æ¥çš„ä»£ç ä¸­æˆ‘ä½¿ç”¨çš„æ˜¯è¶…å›¾åŸºäºCesiumäºŒæ¬¡å°è£…è¿‡çš„äº§å“åŒ…ï¼Œæ‰€ä»¥åœ¨è¿™ç®€å•è¯´ä¸€ä¸‹æœ€åŸºæœ¬çš„Cesiumå¦‚ä½•ä½¿ç”¨ã€‚</p></blockquote></li></ul><p>å°†Cesiumæºç ä¸­çš„Buildæ–‡ä»¶å¤¹ï¼Œæ‹·å…¥åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚ç„¶ååœ¨é¡¹ç›®ä¸­é™æ€å¼•å…¥ç›¸å…³æ–‡ä»¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;./Build/Cesium/Widgets/widgets.css&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./Build/Cesium/Cesium.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å‘å¸ƒåè¿è¡Œï¼Œç†Ÿæ‚‰çš„helloworldå’Œåœ°çƒå°±å‡ºç°äº†ã€‚</p><h4 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- Use correct character set. --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- Tell IE to use the latest, best version. --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- Make the application on mobile take up the full browser screen and disable user scaling. --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Hello World!<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../Build/Cesium/Cesium.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">      <span class="hljs-keyword">@import</span> url(../Build/Cesium/Widgets/widgets.css);</span><br><span class="language-css">      <span class="hljs-selector-tag">html</span>, <span class="hljs-selector-tag">body</span>, <span class="hljs-selector-id">#cesiumContainer</span> &#123;</span><br><span class="language-css">          <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>; <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">overflow</span>: hidden;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cesiumContainer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Cesium</span>.<span class="hljs-property">Ion</span>.<span class="hljs-property">defaultAccessToken</span>=<span class="hljs-string">&#x27;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3ZjA2ZDQ2ZS02NTA4LTQ2NTItODE1My1kZjE3MjBkMjFkNzAiLCJpZCI6NDM5NCwic2NvcGVzIjpbImFzciIsImdjIl0sImlhdCI6MTU0MDcyNzI4Nn0.L7P8pJponZfYjdsGnEw2hIHd2AN0h-SuYl6XvzOwLeA&#x27;</span>;</span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&#x27;cesiumContainer&#x27;</span>);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h3><hr><p>æˆ‘ä»¬é€‰æ‹©Vueä½œä¸ºå¼€å‘æ¡†æ¶ï¼Œæ‰€ä»¥æ­å»ºVueé¡¹ç›®è¿™ä¸ªæˆ‘å°±ä¸å¤šåšä»‹ç»äº†ï¼Œå¤§å®¶èƒ½åœ¨æ˜é‡‘ç›¸é‡é‚£è¯æ˜å¤§å®¶éƒ½æ˜¯ä¼˜ç§€çš„å‰ç«¯ï¼ˆ<del>æ‘¸é±¼æ‘¸æ‘¸</del>ï¼‰ï¼Œä¸ä¼šçš„xdmå°±ç™¾åº¦ä¸€ä¸‹å§ã€‚</p><h4 id="å¼•å…¥WebGLåŒ…"><a href="#å¼•å…¥WebGLåŒ…" class="headerlink" title="å¼•å…¥WebGLåŒ…"></a>å¼•å…¥WebGLåŒ…</h4><p>å› ä¸ºè¿™ä¸ªåŒ…æ˜¯åŸºäºCesiumäºŒæ¬¡å¼€å‘çš„ï¼Œæ‰€ä»¥å¼•å…¥æ–¹å¼å¯ä»¥å’ŒCesiumä¸€æ ·ï¼Œåªéœ€è¦å°†åŒ…å†…çš„<code>Build/Cesium</code>æ–‡ä»¶å¤¹æ”¾åˆ°æˆ‘ä»¬çš„<code>public/static</code>ä¸‹ï¼Œåœ¨<code>index.html</code>å†…é™æ€å¼•å…¥å³å¯ã€‚</p><blockquote><p>widgets.cssåŒ…å«äº†Ceisumçš„å¯è§†åŒ–æ§ä»¶</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;static/Cesium/Widgets/widgets.css&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>Cesium.jså®šä¹‰äº†Cesiumå¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;static/Cesium/Cesium.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="ç»å…¸HelloWorld"><a href="#ç»å…¸HelloWorld" class="headerlink" title="ç»å…¸HelloWorld"></a>ç»å…¸HelloWorld</h4><p>åƒå¾ˆå¤šçš„åœ°å›¾apiä¸€æ ·ï¼ŒCesiumä¹Ÿéœ€è¦ä¸€ä¸ªdivä½œä¸ºä¸‰ç»´åœºæ™¯çš„å”¯ä¸€å®¹å™¨ï¼Œå¹¶åœ¨é¡µé¢åˆå§‹åŒ–æ—¶ç”Ÿæˆå¯¹åº”çš„Viewerå®ä¾‹ã€‚</p><h4 id="å¼ºè°ƒï¼å¼ºè°ƒï¼å¼ºè°ƒï¼"><a href="#å¼ºè°ƒï¼å¼ºè°ƒï¼å¼ºè°ƒï¼" class="headerlink" title="å¼ºè°ƒï¼å¼ºè°ƒï¼å¼ºè°ƒï¼"></a>å¼ºè°ƒï¼å¼ºè°ƒï¼å¼ºè°ƒï¼</h4><p>é‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚æ‰€æœ‰å…³äºCesiumçš„å˜é‡è¯·ï¼ä¸€å®šï¼<strong>ä¸è¦æ”¾åœ¨dataä¸­ç»´æŠ¤</strong>ï¼å› ä¸ºVueä¼šå¯¹dataä¸­çš„çŠ¶æ€è¿›è¡Œæ•°æ®åŠ«æŒï¼Œè€Œå¯¹è±¡åˆ™ä¼šé€’å½’çš„è¿›è¡Œæ•°æ®åŠ«æŒï¼Œä»¥æ­¤æ–¹å¼ç›‘å¬çŠ¶æ€å˜åŒ–ã€‚è€ŒCesiumå®ä¾‹çš„å±æ€§æå¤šï¼Œå±‚çº§ææ·±ï¼Œå¦‚æœå°†å…¶æŒ‚è½½åˆ°dataä¸Šã€‚ä¸å‡ºæ„å¤–ï¼Œä½ çš„æµè§ˆå™¨ä¼šå´©æºƒã€‚</p><p>å¦‚æœéœ€è¦é€šä¿¡çš„è¯ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æŒ‚è½½åˆ°windowå¯¹è±¡ä¸Šã€‚</p><h4 id="å®Œæ•´ä»£ç -1"><a href="#å®Œæ•´ä»£ç -1" class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cesiumContainer&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">var</span> viewer, camera;</span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-keyword">return</span> &#123;&#125;;</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">  <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">  <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">      viewer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cesium</span>.<span class="hljs-title class_">Viewer</span>(<span class="hljs-string">&quot;cesiumContainer&quot;</span>, &#123;&#125;);</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span> <span class="hljs-attr">scoped</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°ä¸‹å›¾çš„æ•ˆæœäº†ã€‚<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70b22bd76fd649038222986ee0ec685b~tplv-k3u1fbpfcp-watermark.image" alt="helloworld.gif"></p><h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h3><hr><p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬åªæ˜¯å®ç°äº†æœ€åŸºæœ¬çš„å°†ä¸‰ç»´åœºæ™¯æ”¾åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬å°†ä¼šç®€å•ä»‹ç»åœ°å›¾ä¸Šçš„åŸºæœ¬æ¦‚å¿µå¹¶å°è¯•å°†ç‚¹çº¿é¢ç­‰è¦ç´ ç»˜åˆ¶åˆ°æˆ‘ä»¬è¿™ä¸ªåœ°çƒä¸Šã€‚ç„¶åé€æ­¥å‘å…¶ä¸­ä¸°å¯Œæˆ‘ä»¬çš„åŠŸèƒ½ã€‚</p><h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><hr><h4 id="Cesiumç›¸å…³ç½‘å€"><a href="#Cesiumç›¸å…³ç½‘å€" class="headerlink" title="Cesiumç›¸å…³ç½‘å€"></a>Cesiumç›¸å…³ç½‘å€</h4><ul><li><p><a href="https://cesium.com/docs/">https://cesium.com/docs/</a>   Cesiumæ–‡æ¡£</p></li><li><p><a href="https://cesium.com/docs/cesiumjs-ref-doc/">https://cesium.com/docs/cesiumjs-ref-doc/</a> Cesium API</p></li><li><p><a href="https://sandcastle.cesium.com/">https://sandcastle.cesium.com/</a> Cesiumæ²™ç›’ç¤ºä¾‹ï¼ˆå¥½å¤šæ•ˆæœéƒ½å¯ä»¥åœ¨è¿™æ‰¾åˆ°ï¼‰</p><h4 id="è¶…å›¾ç›¸å…³ç½‘å€"><a href="#è¶…å›¾ç›¸å…³ç½‘å€" class="headerlink" title="è¶…å›¾ç›¸å…³ç½‘å€"></a>è¶…å›¾ç›¸å…³ç½‘å€</h4></li><li><p><a href="http://support.supermap.com.cn:8090/webgl/web/downloads/download1.html">http://support.supermap.com.cn:8090/webgl/web/downloads/download1.html</a> è¶…å›¾WebGLäº§å“åŒ…ä¸‹è½½</p></li><li><p><a href="http://support.supermap.com.cn:8090/webgl/examples/webgl/examples.html#layer">http://support.supermap.com.cn:8090/webgl/examples/webgl/examples.html#layer</a> è¶…å›¾3ç»´ç¤ºä¾‹</p></li><li><p><a href="http://support.supermap.com.cn:8090/webgl/web/apis/3dwebgl.html">http://support.supermap.com.cn:8090/webgl/web/apis/3dwebgl.html</a> è¶…å›¾åŠCesiumç›¸å…³APIå±æ€§æ–‡æ¡£ï¼ˆä¸ªäººè§‰å¾—æ¯”è¾ƒæ–¹ä¾¿ï¼‰</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>Cesium</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>Cesium</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è‡ªå®šä¹‰ä¸€ä¸ªwindowsç»ˆç«¯å§</title>
    <link href="/2020/07/10/2020-07-10-%E8%87%AA%E5%AE%9A%E4%B9%89windows%E7%BB%88%E7%AB%AF/"/>
    <url>/2020/07/10/2020-07-10-%E8%87%AA%E5%AE%9A%E4%B9%89windows%E7%BB%88%E7%AB%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://i.loli.net/2020/07/10/hrEw9cJN6TxBjKM.png" alt="Snipaste_2020-07-10_15-06-43.png"></p><p>æ€ä¹ˆæ ·ï¼Œè¿™ä¸æ¯”é»˜è®¤çš„â€å‚»é»‘ç²—â€œæ¥çš„èµå¿ƒæ‚¦ç›®</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>åºŸè¯ä¸å¤šè¯´ï¼Œå¼€å§‹æˆ‘ä»¬çš„è‡ªå®šä¹‰powerShellä¹‹æ—…</p><hr><p>windowé»˜è®¤çš„powershellç”±â€å‚»é»‘ç²—â€è¿›åŒ–ä¸ºâ€å‚»å¤§è“â€ï¼Œä¸‘ä¹Ÿæ˜¯çœŸçš„ä¸‘ï¼Œæ‰€ä»¥æˆ‘ä¸€ç›´ç”¨çš„éƒ½æ˜¯<code>cmder</code>å»å¤„ç†å‘½ä»¤è¡Œï¼ŒçŸ¥é“ä»Šå¤©æˆ‘åœ¨æ‘¸é±¼çš„æ—¶å€™å‘ç°äº†</p><p> æŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€è·å–äº†å®ƒï¼Œå’³å’³ï¼Œç»“æœè¿˜æ˜¯è›®å¤±æœ›çš„ï¼Œä¸€å¦‚æ—¢å¾€çš„å¾®è½¯é£æ ¼ï¼Œä½†æ˜¯è¿™æ˜¯å¼€æºçš„ï¼Œä¹Ÿå°±æ„å‘³ç€å¯ä»¥ä¿®æ”¹å®ƒçš„é…ç½®ï¼Œ</p><p>è€Œå®ƒçš„é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨</p><blockquote><p>~\AppData\Local\Packages\Microsoft.WindowsTerminal_8wekyb3d8bbwe\LocalState\setting.json</p></blockquote><p>è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œç¨åæˆ‘ä¼šç®€å•ä»‹ç»ä¸€ä¸‹é‡Œé¢çš„å¸¸ç”¨é…ç½®ã€‚</p><h2 id="æ”¹é€ PowerShell"><a href="#æ”¹é€ PowerShell" class="headerlink" title="æ”¹é€ PowerShell"></a>æ”¹é€ PowerShell</h2><hr><p>æ•ˆæœå›¾ä¸­çš„è·¯å¾„æ•ˆæœæ˜¯éœ€è¦é¢å¤–çš„åŒ…å»ç¾åŒ–çš„ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å…ˆå®‰è£…oh-my-poshï¼Œåœ¨PowerShellä¸­è¾“å…¥</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Install-Module</span> posh<span class="hljs-literal">-git</span> <span class="hljs-literal">-Scope</span> CurrentUser<br><span class="hljs-built_in">Install-Module</span> <span class="hljs-built_in">oh</span><span class="hljs-literal">-my-posh</span> <span class="hljs-literal">-Scope</span> CurrentUser<br></code></pre></td></tr></table></figure><p>é‡åˆ°è®©ä½ å…è®¸ä¸å¯ä¿¡æ¥æºçš„æ—¶å€™ç›´æ¥æ•²<code>A</code>å…¨éƒ¨ä¿¡ä»»ã€‚</p><p>å®‰è£…å®Œæˆåè¾“å…¥</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Import-Module</span> posh<span class="hljs-literal">-git</span><br><span class="hljs-built_in">Import-Module</span> <span class="hljs-built_in">oh</span><span class="hljs-literal">-my-posh</span><br><span class="hljs-built_in">Set-Theme</span> PowerLine<br></code></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°PowerShellå˜äº†æ ·å­ï¼Œä½†æ˜¯é‡å¯åå°±æ¶ˆå¤±äº†ï¼Œå› ä¸ºè¿™äº›æŒ‡ä»¤ä»…é™äºæ­¤æ¬¡ä¼šè¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†è¿™å‡ å¥å‘½ä»¤æ·»åŠ åˆ°å¯åŠ¨è„šæœ¬ä¸­ã€‚</p><p>æ‰“å¼€<code>~\Documents\WindowsPowerShell</code>ï¼Œæ–°å»ºæ–‡æœ¬æ–‡æ¡£ï¼Œå«åš<code>Microsoft.PowerShell_profile.ps1</code>ï¼ˆè®°å¾—å¼€æ‹“å±•åæ˜¾ç¤ºï¼‰ï¼Œè¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œä¿å­˜ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Import-Module</span> posh<span class="hljs-literal">-git</span><br><span class="hljs-built_in">Import-Module</span> <span class="hljs-built_in">oh</span><span class="hljs-literal">-my-posh</span><br><span class="hljs-built_in">Set-Theme</span> PowerLine<br></code></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œåœ¨æ¯æ¬¡PoweShellæ‰“å¼€çš„æ—¶å€™éƒ½èƒ½å¯ç”¨PowerLineä¸»é¢˜ã€‚</p><p>å¯æ˜¯è¿™æ ·ï¼ŒPowerShellæ‰“å¼€çš„æ—¶å€™ä»æœ‰ä¹±ç ï¼ˆæˆ–è€…è¯´ï¼Œæœ‰è¿å’Œæ„Ÿï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰ç»™ä½ ä½¿ç”¨çš„å­—ä½“é“¾æ¥è¡¨æƒ…ï¼Œä¹±ç çš„åœ°æ–¹å…¶å®å°±æ˜¯è¡¨æƒ…ç¬¦å·ã€‚</p><h2 id="å­—ä½“é€‰æ‹©"><a href="#å­—ä½“é€‰æ‹©" class="headerlink" title="å­—ä½“é€‰æ‹©"></a>å­—ä½“é€‰æ‹©</h2><hr><p>ç°åœ¨Powershellä¸­ä¼šæœ‰ä¹±ç ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬çš„å­—ä½“æ— æ³•æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…æŒ‡å®šå­—ä½“ï¼Œæˆ‘è¿™é‡Œé€‰ç”¨çš„æ˜¯<code>Sarasa Term SC</code>ï¼ˆ</p><p>ï¼‰ï¼Œ</p><p>è¿™ä¸ªå­—ä½“æ˜¯ç­‰å®½å­—ä½“ï¼Œä¸ä¼šåœ¨ç»ˆç«¯ä¸­å‡ºç°æ’ç‰ˆé”™è¯¯ï¼Œä¸‹è½½å®‰è£…åæˆ‘ä»¬åœ¨æ³¨å†Œè¡¨ä¸­é…ç½®ï¼Œæˆ‘è¿™é‡Œç›´æ¥æä¾›ä¸€ä¸ªregè„šæœ¬ï¼ŒæŠŠä¸‹é¢çš„ç‰‡æ®µå¤åˆ¶åˆ°ä¸€ä¸ªregæ–‡ä»¶ä¸­ï¼ŒåŒå‡»è‡ªåŠ¨å¯¼å…¥ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs text">Windows Registry Editor Version 5.00<br><br>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontLink\SystemLink]<br>&quot;Sarasa Term SC&quot;=hex(7):4d,00,49,00,43,00,52,00,4f,00,53,00,53,00,2e,00,54,00,\<br>  54,00,46,00,2c,00,4d,00,69,00,63,00,72,00,6f,00,73,00,6f,00,66,00,74,00,20,\<br>  00,53,00,61,00,6e,00,73,00,20,00,53,00,65,00,72,00,69,00,66,00,2c,00,31,00,\<br>  30,00,38,00,2c,00,31,00,32,00,32,00,00,00,4d,00,49,00,43,00,52,00,4f,00,53,\<br>  00,53,00,2e,00,54,00,54,00,46,00,2c,00,4d,00,69,00,63,00,72,00,6f,00,73,00,\<br>  6f,00,66,00,74,00,20,00,53,00,61,00,6e,00,73,00,20,00,53,00,65,00,72,00,69,\<br>  00,66,00,00,00,4d,00,49,00,4e,00,47,00,4c,00,49,00,55,00,2e,00,54,00,54,00,\<br>  43,00,2c,00,50,00,4d,00,69,00,6e,00,67,00,4c,00,69,00,55,00,00,00,4d,00,53,\<br>  00,4d,00,49,00,4e,00,43,00,48,00,4f,00,2e,00,54,00,54,00,43,00,2c,00,4d,00,\<br>  53,00,20,00,50,00,4d,00,69,00,6e,00,63,00,68,00,6f,00,00,00,42,00,41,00,54,\<br>  00,41,00,4e,00,47,00,2e,00,54,00,54,00,43,00,2c,00,42,00,61,00,74,00,61,00,\<br>  6e,00,67,00,00,00,4d,00,53,00,59,00,48,00,2e,00,54,00,54,00,43,00,2c,00,4d,\<br>  00,69,00,63,00,72,00,6f,00,73,00,6f,00,66,00,74,00,20,00,59,00,61,00,48,00,\<br>  65,00,69,00,20,00,55,00,49,00,00,00,4d,00,53,00,4a,00,48,00,2e,00,54,00,54,\<br>  00,43,00,2c,00,4d,00,69,00,63,00,72,00,6f,00,73,00,6f,00,66,00,74,00,20,00,\<br>  4a,00,68,00,65,00,6e,00,67,00,48,00,65,00,69,00,20,00,55,00,49,00,00,00,59,\<br>  00,55,00,47,00,4f,00,54,00,48,00,4d,00,2e,00,54,00,54,00,43,00,2c,00,59,00,\<br>  75,00,20,00,47,00,6f,00,74,00,68,00,69,00,63,00,20,00,55,00,49,00,00,00,4d,\<br>  00,41,00,4c,00,47,00,55,00,4e,00,2e,00,54,00,54,00,46,00,2c,00,4d,00,61,00,\<br>  6c,00,67,00,75,00,6e,00,20,00,47,00,6f,00,74,00,68,00,69,00,63,00,00,00,53,\<br>  00,45,00,47,00,55,00,49,00,53,00,59,00,4d,00,2e,00,54,00,54,00,46,00,2c,00,\<br>  53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,20,00,53,00,79,00,6d,00,62,\<br>  00,6f,00,6c,00,00,00,00,00<br></code></pre></td></tr></table></figure><h2 id="settings"><a href="#settings" class="headerlink" title="settings"></a>settings</h2><hr><p>å‡†å¤‡å·¥ä½œåšå®Œäº†ï¼Œç°åœ¨ä»‹ç»ä¸€ä¸‹PowerShellçš„é…ç½®æ–‡ä»¶ï¼Œ</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;profiles&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;defaults&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-comment">// Put settings here that you want to apply to all profiles.</span><br>            <span class="hljs-attr">&quot;backgroundImage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C:\\Users\\MileWang\\Pictures\\æ¡Œé¢\\wallhaven-j5lx3y.jpg&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-comment">// # èƒŒæ™¯å›¾é€æ˜åº¦</span><br>            <span class="hljs-attr">&quot;backgroundImageOpacity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.6</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-comment">// # èƒŒæ™¯å›¾æ‰©å±•æ¨¡å¼</span><br>            <span class="hljs-attr">&quot;backgroundImageStretchMode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;fill&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-comment">// # é¢œè‰²ä¸»é¢˜ï¼Œä¸»é¢˜åœ¨ä¸‹æ–¹shcemeä¸­æ·»åŠ </span><br>            <span class="hljs-attr">&quot;colorScheme&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3024 Day&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-comment">// # å…‰æ ‡æ ·å¼ã€é¢œè‰²</span><br>            <span class="hljs-attr">&quot;cursorShape&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vintage&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-attr">&quot;cursorColor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;#000&quot;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-comment">// # å­—ä½“</span><br>            <span class="hljs-attr">&quot;fontFace&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Sarasa Term SC&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;list&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-comment">// Make changes here to the powershell.exe profile.</span><br>                <span class="hljs-attr">&quot;guid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&#123;61c54bbd-c2c6-5271-96e7-009a87ff44bf&#125;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;PowerShell&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;commandline&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;powershell.exe&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;hidden&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-comment">// Make changes here to the cmd.exe profile.</span><br>                <span class="hljs-attr">&quot;guid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&#123;0caa0dad-35be-5f56-a8ff-afceeeaa6101&#125;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;å‘½ä»¤æç¤ºç¬¦&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;commandline&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cmd.exe&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;hidden&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>            <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>            <span class="hljs-punctuation">&#123;</span><br>                <span class="hljs-attr">&quot;guid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&#123;b453ae62-4e3d-5e58-b989-0a998ec441b8&#125;&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;hidden&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Azure Cloud Shell&quot;</span><span class="hljs-punctuation">,</span><br>                <span class="hljs-attr">&quot;source&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Windows.Terminal.Azure&quot;</span><br>            <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br></code></pre></td></tr></table></figure><p>ä¸€äº›ç®€å•çš„é…ç½®å·²ç»æ³¨é‡Šåœ¨ä»£ç ä¸­ï¼Œå…¶ä¸­ä¸»é¢˜Schemeå¯ä»¥åœ¨</p><p>ä¸­é€‰æ‹©ä½ æƒ³è¦çš„é…è‰²ã€‚é€‰æ‹©åæ·»åŠ åˆ°jsonæ–‡ä»¶çš„schemeæ•°ç»„ä¸­ï¼Œç„¶ååœ¨ä¸Šæ–¹<code>profiles</code>é€‰æ‹©æƒ³è¦ä½¿ç”¨çš„ç»ˆç«¯ï¼Œæ·»åŠ ã€‚æˆ‘è¿™é‡Œå› ä¸ºwindowsä¸»è¦ä½¿ç”¨PowerShellï¼Œæ‰€ä»¥ç›´æ¥å°†è®¾ç½®éƒ½åŠ åœ¨<code>default</code>é»˜è®¤ä¸­äº†ï¼Œå®å¯ä»¥åœ¨<code>List</code>ä¸­é€‰æ‹©æƒ³è¦é…ç½®çš„ç»ˆç«¯ã€‚</p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><hr><p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œwindowsç»ˆäºç»“æŸäº†éš¾çœ‹çš„ç»ˆç«¯ç•Œé¢ï¼Œè€Œä¸”è¿™ä¸ªç»ˆç«¯è¿˜æ˜¯å¼€æºçš„ã€‚æ‰€ä»¥æœ‰å¾ˆå¤§çš„å¯ç©æ€§ï¼Œå¸Œæœ›å„ä½å¤§ä½¬èƒ½å¤Ÿç©å‡ºèŠ±æ¥ã€‚</p><p>å¥½äº†æˆ‘ç»§ç»­å»ç”¨cmderäº†â€¦â€¦</p>]]></content>
    
    
    <categories>
      
      <category>others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>powerShell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpackæ€»ç»“</title>
    <link href="/2020/02/24/2020-02-24-webpack%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/"/>
    <url>/2020/02/24/2020-02-24-webpack%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><hr><ul><li>ä»£ç è½¬æ¢ï¼š<code>typeScript</code>ç¼–è¯‘æˆ<code>JavaScript</code>ã€<code>scssï¼Œless</code>ç¼–è¯‘æˆ<code>css</code></li><li>æ–‡ä»¶ä¼˜åŒ–ï¼šå‹ç¼©<code>JavaScript</code>ã€<code>html</code>ã€<code>css</code>æ–‡ä»¶ï¼Œå‹ç¼©åˆå¹¶å›¾ç‰‡ç­‰</li><li>ä»£ç åˆ†å‰²ï¼šæä¾›å¤šä¸ªé¡µé¢çš„å…¬å…±ä»£ç ï¼ŒæŠ½ç¦»é¦–å±ä¸éœ€è¦çš„ä»£ç ä½¿å…¶å¼‚æ­¥åŠ è½½</li><li>æ¨¡å—åˆå¹¶ï¼šæ¨¡å—åŒ–çš„é¡¹ç›®é‡Œä¼šæœ‰å¾ˆå¤šæ¨¡å—å’Œæ–‡ä»¶ï¼Œæ„å»ºç‹—èƒ½æŠŠæ¨¡å—åˆ†ç±»åˆå¹¶</li><li>è‡ªåŠ¨åˆ·æ–°ï¼šç›‘å¬æœ¬åœ°æºä»£ç ï¼Œè‡ªåŠ¨é‡æ„åˆ·æ–°æµè§ˆå™¨</li><li>æ‰©å±•æ€§å¥½ï¼Œæ’ä»¶æœºåˆ¶å®Œå–„</li></ul><h2 id="æ‰“åŒ…è¿‡ç¨‹"><a href="#æ‰“åŒ…è¿‡ç¨‹" class="headerlink" title="æ‰“åŒ…è¿‡ç¨‹"></a>æ‰“åŒ…è¿‡ç¨‹</h2><hr><ol><li>åˆ©ç”¨babelå®Œæˆä»£ç è½¬æ¢ï¼Œç”Ÿæˆå•ä¸ªæ–‡ä»¶ä¾èµ–</li><li>ä»å…¥å£å¼€å§‹åˆ†æï¼Œç”Ÿæˆä¾èµ–å›¾è°±</li><li>å°†å¼•ç”¨æ¨¡å—æ‰“åŒ…ä¸ºç«‹å³æ‰§è¡Œå‡½æ•°</li><li>æŠŠæœ€ç»ˆçš„bundleæ–‡ä»¶å†™å…¥bundle.jsé‡Œ</li></ol><h2 id="å››å¤§æ ¸å¿ƒ"><a href="#å››å¤§æ ¸å¿ƒ" class="headerlink" title="å››å¤§æ ¸å¿ƒ"></a>å››å¤§æ ¸å¿ƒ</h2><hr><ul><li>entryï¼šå…¥å£ï¼Œå³jså…¥å£æºæ–‡ä»¶</li><li>outputï¼šç”Ÿæˆæ–‡ä»¶</li><li>loaderï¼šæ–‡ä»¶å¤„ç†</li><li>pluginsï¼šæ’ä»¶</li></ul><h2 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h2><p>webpackåº”è¯¥ç”¨å“ªä¸ªæ¨¡å—ä½œä¸ºå…¥å£æ–‡ä»¶ï¼Œä½œä¸ºæ„å»ºå†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹ï¼Œè¿›å…¥å…¥å£åï¼Œwebpackä¼šæ‰¾åˆ°å“ªäº›åº“å’Œæ¨¡å—æ˜¯å…¥å£ä¾èµ–çš„ï¼Œå¹¶éšå³è¢«å¤„ç†ï¼Œæœ€åè¾“å‡ºåˆ°bundle.jsçš„æ–‡ä»¶ä¸­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//å•å…¥å£ï¼šentryæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>&#125;<br><span class="hljs-comment">//å¤šå…¥å£ï¼šentryæ˜¯ä¸€ä¸ªå¯¹è±¡</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><hr><p>å‘Šè¯‰webpackåœ¨å“ªè¾“å‡ºbundlesï¼Œä»¥åŠæ€ä¹ˆå‘½åä»–ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­å‡å¯æå®š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//å•å…¥å£é…ç½®é¡¹</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>    <span class="hljs-attr">output</span>: &#123;<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.jsâ€™,</span><br><span class="hljs-string">        path: __dirname + &#x27;</span>/dist<span class="hljs-string">&#x27;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">&#125;;</span><br><span class="hljs-string">//å¤šå…¥å£é…ç½®é¡¹</span><br><span class="hljs-string">module.exports = &#123;</span><br><span class="hljs-string">  entry: &#123;</span><br><span class="hljs-string">    app: &#x27;</span>./src/app.<span class="hljs-property">js</span><span class="hljs-string">&#x27;,</span><br><span class="hljs-string">    search: &#x27;</span>./src/search.<span class="hljs-property">js</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">  &#125;,</span><br><span class="hljs-string">  output: &#123;</span><br><span class="hljs-string">    filename: &#x27;</span>[name].<span class="hljs-property">js</span><span class="hljs-string">&#x27;,//[name]å ä½ç¬¦ç¡®ä¿æ–‡ä»¶åå”¯ä¸€</span><br><span class="hljs-string">    path: __dirname + &#x27;</span>/dist<span class="hljs-string">&#x27;</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><h2 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h2><hr><p><code>loader</code>è®©webpackèƒ½å¤Ÿå¤„ç†é<code>javaScript</code>æ–‡ä»¶ï¼Œå› ä¸ºwebpackè‡ªå·±åªèƒ½çœ‹æ‡‚<code>javaScript</code>ã€‚<code>loader</code>èƒ½å¤ŸæŠŠæ‰€æœ‰ç±»å‹çš„æ–‡ä»¶è½¬æ¢æˆwebpackèƒ½å¤Ÿå¤„ç†çš„æ¨¡å—ï¼Œç„¶ååˆ©ç”¨æ‰“åŒ…èƒ½åŠ›å¯¹ä»–è¿›è¡Œå¤„ç†</p><h3 id="Loaderçš„ç‰¹ç‚¹"><a href="#Loaderçš„ç‰¹ç‚¹" class="headerlink" title="Loaderçš„ç‰¹ç‚¹"></a>Loaderçš„ç‰¹ç‚¹</h3><ul><li>æ¯ä¸€ä¸ªloaderçš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œåªèƒ½å®Œæˆä¸€ç§è½¬æ¢</li><li>loaderæœ¬è´¨ä¸Šæ˜¯node.jsæ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—éœ€è¦å¯¼å‡ºä¸€ä¸ªå‡½æ•°</li><li>loaderæ€»æ˜¯ä»å³åˆ°å·¦è¢«è°ƒç”¨</li></ul><h3 id="å¸¸ç”¨Loader"><a href="#å¸¸ç”¨Loader" class="headerlink" title="å¸¸ç”¨Loader"></a>å¸¸ç”¨Loader</h3><h4 id="å¤„ç†æ ·å¼"><a href="#å¤„ç†æ ·å¼" class="headerlink" title="å¤„ç†æ ·å¼"></a>å¤„ç†æ ·å¼</h4><ul><li><code>css-loader</code>åŠ è½½cssæ–‡ä»¶</li><li><code>style-loader</code>ä½¿ç”¨styleæ ‡ç­¾æŠŠ<code>css-loader</code>å†…éƒ¨æ ·å¼æ³¨å…¥åˆ°htmlä¸­</li><li><code>less-loader,sass-loader</code>è§£æcssé¢„å¤„ç†å™¨</li></ul><h4 id="å¤„ç†js"><a href="#å¤„ç†js" class="headerlink" title="å¤„ç†js"></a>å¤„ç†js</h4><p>è®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨æœ€æ–°çš„jsä»£ç ï¼ˆES6ï¼ŒES7ç­‰ï¼‰åŠè®©æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨åŸºäºjsè¿›è¡Œäº†æ‹“å±•çš„è¯­è¨€ï¼Œæ¯”å¦‚JSXç­‰</p><h4 id="å¤„ç†æ–‡ä»¶"><a href="#å¤„ç†æ–‡ä»¶" class="headerlink" title="å¤„ç†æ–‡ä»¶"></a>å¤„ç†æ–‡ä»¶</h4><p>é€šå¸¸ä½¿ç”¨çš„ä¸¤ç§loaderæ˜¯<code>file-loader</code>å’Œ<code>url-loader</code>ï¼Œä¸¤è€…ä¸»è¦çš„åŒºåˆ«æ˜¯<code>url-loader</code>èƒ½å¤Ÿè®¾ç½®å›¾ç‰‡çš„å¤§å°é™åˆ¶ï¼Œå¦‚æœå¤§å°è¶…è¿‡é™åˆ¶ï¼Œåˆ™è¡Œä¸ºç­‰åŒäº<code>file-loader</code>ï¼Œå¦‚æœå›¾ç‰‡å¤§å°ä¸è¶…è¿‡é™åˆ¶ï¼Œé‚£ä¹ˆå›¾ç‰‡ä¼šä»¥base64çš„å½¢å¼æ‰“åŒ…</p><h4 id="å¤„ç†vueå•æ–‡ä»¶"><a href="#å¤„ç†vueå•æ–‡ä»¶" class="headerlink" title="å¤„ç†vueå•æ–‡ä»¶"></a>å¤„ç†vueå•æ–‡ä»¶</h4><p><code>vue-loader</code>æ˜¯webpackçš„åŠ è½½å™¨é­”é“ ï¼Œå®ƒè®©æˆ‘ä»¬çš„éšå¿ƒæ‰€æ¬²çš„ç¼–å†™<code>.vue</code>æ ¼å¼çš„å•æ–‡ä»¶ç»„ä»¶ã€‚<code>vue-loader</code> æ¨¡å—å…è®¸ <code>webpack</code> ä½¿ç”¨å•ç‹¬çš„åŠ è½½å™¨æ¨¡å—ï¼ˆä¾‹å¦‚ <code>sass æˆ– scss åŠ è½½å™¨</code>ï¼‰æå–å’Œå¤„ç†æ¯ä¸ªéƒ¨åˆ†ã€‚è¯¥è®¾ç½®ä½¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>.vue</code> æ–‡ä»¶æ— ç¼ç¼–å†™ç¨‹åºã€‚</p><p><strong>åœ¨æ–‡ç« æœ€åï¼Œæˆ‘ä»¬ä¼šå°è¯•å¼€å‘ä¸€ä¸ªç®€æ˜“çš„loaderæ¥åŠ æ·±æˆ‘ä»¬çš„ç†è§£</strong></p><h3 id="Plugin"><a href="#Plugin" class="headerlink" title="Plugin"></a>Plugin</h3><hr><p>ä¸“æ³¨äºå¤„ç†webpackåœ¨ç¼–è¯‘è¿‡ç¨‹é‡ŒæŸä¸ªç‰¹å®šä»»åŠ¡çš„åŠŸèƒ½æ¨¡å—</p><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul><li><p>æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—</p></li><li><p>æ¨¡å—å¯¹å¤–æš´éœ²ä¸€ä¸ªjså‡½æ•°</p></li><li><p>å‡½æ•°çš„åŸå‹ <code>(prototype)</code> ä¸Šå®šä¹‰äº†ä¸€ä¸ªæ³¨å…¥ <code>compiler</code> å¯¹è±¡çš„ <code>apply</code>æ–¹æ³• <code>apply</code> å‡½æ•°ä¸­éœ€è¦æœ‰é€šè¿‡ <code>compiler</code> å¯¹è±¡æŒ‚è½½çš„ <code>webpack</code> äº‹ä»¶é’©å­ï¼Œé’©å­çš„å›è°ƒä¸­èƒ½æ‹¿åˆ°å½“å‰ç¼–è¯‘çš„ <code>compilation</code> å¯¹è±¡ï¼Œå¦‚æœæ˜¯å¼‚æ­¥ç¼–è¯‘æ’ä»¶çš„è¯å¯ä»¥æ‹¿åˆ°å›è°ƒ <code>callback</code></p></li><li><p>å®Œæˆè‡ªå®šä¹‰è‡ªç¼–ç¨‹æµç¨‹å¹¶å¤„ç†<code>complition</code>å¯¹è±¡çš„å†…éƒ¨æ•°æ®</p></li><li><p>å¦‚æœå¼‚æ­¥ç¼–è¯‘æ’ä»¶çš„è¯ï¼Œæ•°æ®å¤„ç†å®Œæˆåæ‰§è¡Œ<code>callback</code>å›è°ƒ</p></li></ul><h3 id="å¸¸ç”¨Plugin"><a href="#å¸¸ç”¨Plugin" class="headerlink" title="å¸¸ç”¨Plugin"></a>å¸¸ç”¨Plugin</h3><ul><li><code>HotModuleReplacementPlugin</code> ä»£ç çƒ­æ›¿æ¢ã€‚å› ä¸º <code>Hot-Module-Replacement</code> çš„çƒ­æ›´æ–°æ˜¯ä¾èµ–äº <code>webpack-dev-server</code>ï¼Œåè€…æ˜¯åœ¨æ‰“åŒ…æ–‡ä»¶æ”¹å˜æ—¶æ›´æ–°æ‰“åŒ…æ–‡ä»¶æˆ–è€… reload åˆ·æ–°æ•´ä¸ªé¡µé¢ï¼Œ<code>HRM</code> æ˜¯åªæ›´æ–°ä¿®æ”¹çš„éƒ¨åˆ†ã€‚</li><li><code>HtmlWebpackPlugin</code>, ç”Ÿæˆ html æ–‡ä»¶ã€‚å°† webpack ä¸­<code>entry</code>é…ç½®çš„ç›¸å…³å…¥å£ chunk å’Œ <code>extract-text-webpack-plugin</code>æŠ½å–çš„ css æ ·å¼ æ’å…¥åˆ°è¯¥æ’ä»¶æä¾›çš„<code>template</code>æˆ–è€…<code>templateContent</code>é…ç½®é¡¹æŒ‡å®šçš„å†…å®¹åŸºç¡€ä¸Šç”Ÿæˆä¸€ä¸ª html æ–‡ä»¶ï¼Œå…·ä½“æ’å…¥æ–¹å¼æ˜¯å°†æ ·å¼<code>link</code>æ’å…¥åˆ°<code>head</code>å…ƒç´ ä¸­ï¼Œ<code>script</code>æ’å…¥åˆ°<code>head</code>æˆ–è€…<code>body</code>ä¸­ã€‚</li><li><code>ExtractTextPlugin</code>, å°† css æˆç”Ÿæ–‡ä»¶ï¼Œè€Œéå†…è” ã€‚è¯¥æ’ä»¶çš„ä¸»è¦æ˜¯ä¸ºäº†æŠ½ç¦» css æ ·å¼,é˜²æ­¢å°†æ ·å¼æ‰“åŒ…åœ¨ js ä¸­å¼•èµ·é¡µé¢æ ·å¼åŠ è½½é”™ä¹±çš„ç°è±¡ã€‚</li><li><code>NoErrorsPlugin</code>æŠ¥é”™ä½†ä¸é€€å‡º webpack è¿›ç¨‹</li><li><code>UglifyJsPlugin</code>ï¼Œä»£ç ä¸‘åŒ–ï¼Œå¼€å‘è¿‡ç¨‹ä¸­ä¸å»ºè®®æ‰“å¼€ã€‚ <code>uglifyJsPlugin</code> ç”¨æ¥å¯¹ js æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œä»è€Œå‡å° js æ–‡ä»¶çš„å¤§å°ï¼ŒåŠ é€Ÿ load é€Ÿåº¦ã€‚<code>uglifyJsPlugin</code> ä¼šæ‹–æ…¢ webpack çš„ç¼–è¯‘é€Ÿåº¦ï¼Œæ‰€æœ‰å»ºè®®åœ¨å¼€å‘ç®€å•å°†å…¶å…³é—­ï¼Œéƒ¨ç½²çš„æ—¶å€™å†å°†å…¶æ‰“å¼€ã€‚å¤šä¸ª html å…±ç”¨ä¸€ä¸ª js æ–‡ä»¶(chunk)ï¼Œå¯ç”¨ <code>CommonsChunkPlugin</code></li><li><code>purifycss-webpack</code> ã€‚æ‰“åŒ…ç¼–è¯‘æ—¶ï¼Œå¯å‰”é™¤é¡µé¢å’Œ js ä¸­æœªè¢«ä½¿ç”¨çš„ cssï¼Œè¿™æ ·ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ç±»åº“æ—¶ï¼ŒåªåŠ è½½è¢«ä½¿ç”¨çš„ç±»ï¼Œå¤§å¤§å‡å° css ä½“ç§¯</li><li><code>optimize-css-assets-webpack-plugin</code>  å‹ç¼© cssï¼Œä¼˜åŒ– css ç»“æ„ï¼Œåˆ©äºç½‘é¡µåŠ è½½å’Œæ¸²æŸ“</li><li><code>webpack-parallel-uglify-plugin</code>  å¯ä»¥å¹¶è¡Œè¿è¡Œ UglifyJS æ’ä»¶ï¼Œè¿™å¯ä»¥æœ‰æ•ˆå‡å°‘æ„å»ºæ—¶é—´</li></ul><p><strong>åŒæ ·çš„ï¼Œæ–‡ç« æœ€åæˆ‘ä»¬ä¹Ÿä¼šå°è¯•å¼€å‘ä¸€ä¸ªPlugin</strong></p><h2 id="webpacké…ç½®"><a href="#webpacké…ç½®" class="headerlink" title="webpacké…ç½®"></a>webpacké…ç½®</h2><hr><h3 id="1ã€Webpack-é¡¹ç›®åˆå§‹åŒ–"><a href="#1ã€Webpack-é¡¹ç›®åˆå§‹åŒ–" class="headerlink" title="1ã€Webpack é¡¹ç›®åˆå§‹åŒ–"></a>1ã€Webpack é¡¹ç›®åˆå§‹åŒ–</h3><p><strong>1ã€æ–°å»º Web é¡¹ç›®</strong></p><p>æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå†è¿›å…¥é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ npm init æ¥åˆå§‹åŒ–æœ€ç®€å•çš„é‡‡ç”¨äº†æ¨¡å—åŒ–å¼€å‘çš„é¡¹ç›®ï¼›æœ€ç»ˆç”Ÿæˆ package.json æ–‡ä»¶ï¼›</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$ <span class="hljs-built_in">npm</span> init<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p><strong>2ã€å®‰è£… Webpack åˆ°æœ¬é¡¹ç›®</strong></p><p>ï¼ˆ1ï¼‰æŸ¥çœ‹ Webpack ç‰ˆæœ¬</p><p>è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Webpack çš„ç‰ˆæœ¬å·</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$ <span class="hljs-built_in">npm</span> view webpack versions<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å®‰è£… Webpack</p><p>å¯ä»¥é€‰æ‹©ï¼ˆ1ï¼‰æ­¥éª¤ç½—åˆ—å¾—åˆ°çš„ Webpack ç‰ˆæœ¬å·ï¼Œä¹Ÿå¯ä»¥å®‰è£…æœ€æ–°ç¨³å®šç‰ˆã€æœ€æ–°ä½“éªŒç‰ˆæœ¬ï¼Œç›¸å…³å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘é€‰æ‹©å®‰è£… 4.28.2 ç‰ˆæœ¬ï¼ˆæ²¡æœ‰ä¸ºä»€ä¹ˆï¼Œå°±æƒ³è£…ä¸ª 4.x çš„ç‰ˆæœ¬ï¼‰ï¼›</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> å®‰è£…æŒ‡å®šç‰ˆæœ¬<br>npm i -D webpack@<span class="hljs-number">4.28</span>.<span class="hljs-number">2</span><br><br><span class="hljs-regexp">//</span> å®‰è£…æœ€æ–°ç¨³å®šç‰ˆ<br>npm i -D webpack<br><br><span class="hljs-regexp">//</span> å®‰è£…æœ€æ–°ä½“éªŒç‰ˆæœ¬<br>npm i -D webpack@beta<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰å®‰è£… Webpack è„šæ‰‹æ¶</p><p>éœ€è¦å®‰è£… Webpack è„šæ‰‹æ¶ï¼Œæ‰èƒ½åœ¨å‘½ä»¤çª—å£æ‰§è¡Œ Webpack å‘½ä»¤ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… Webpack è„šæ‰‹æ¶ï¼›</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">$ npm i -D webpack-<span class="hljs-keyword">cli</span><br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p><strong>3ã€ä½¿ç”¨ Webpack</strong></p><p>ä½¿ç”¨ Webpack æ„å»ºä¸€ä¸ªé‡‡ç”¨ CommonJS æ¨¡å—åŒ–ç¼–å†™çš„é¡¹ç›®ï¼›</p><p>ï¼ˆ1ï¼‰æ–°å»ºé¡µé¢å…¥å£æ–‡ä»¶ index.html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Webpack<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-comment">&lt;!--å¯¼å…¥ Webpack è¾“å‡ºçš„ JavaScript æ–‡ä»¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./dist/bundle.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰æ–°å»ºéœ€è¦ç”¨åˆ°çš„ JS æ–‡ä»¶</p><p>show.js æ–‡ä»¶</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// æ“ä½œ DOM å…ƒç´ ï¼ŒæŠŠ content æ˜¾ç¤ºåˆ°ç½‘é¡µä¸Š</span><br>function <span class="hljs-keyword">show</span>(content) &#123;<br>  <span class="hljs-built_in">window</span>.<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;app&#x27;</span>).innerText = <span class="hljs-string">&#x27;Hello,&#x27;</span> + content;<br>&#125;<br><br><span class="hljs-comment">// é€šè¿‡ CommonJS è§„èŒƒå¯¼å‡º show å‡½æ•°</span><br>module.exports = <span class="hljs-keyword">show</span>;<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>main.js æ–‡ä»¶</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-comment">// é€šè¿‡ CommonJS è§„èŒƒå¯¼å…¥ show å‡½æ•°</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">show</span> = require(<span class="hljs-string">&#x27;./show.js&#x27;</span>);<br><span class="hljs-comment">// æ‰§è¡Œ show å‡½æ•°</span><br><span class="hljs-keyword">show</span>(<span class="hljs-string">&#x27;Webpack&#x27;</span>);<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ–°å»º Webpack é…ç½®æ–‡ä»¶ webpack.config.js</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk">const path = require(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br>module.exports = &#123;<br>  <span class="hljs-regexp">//</span> JavaScript æ‰§è¡Œå…¥å£æ–‡ä»¶<br>  entry: <span class="hljs-string">&#x27;./main.js&#x27;</span>,<br>  output: &#123;<br>    <span class="hljs-regexp">//</span> æŠŠæ‰€æœ‰ä¾èµ–çš„æ¨¡å—åˆå¹¶è¾“å‡ºåˆ°ä¸€ä¸ª bundle.js æ–‡ä»¶<br>    filename: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-regexp">//</span> è¾“å‡ºæ–‡ä»¶éƒ½æ”¾åˆ° dist ç›®å½•ä¸‹<br>    path: path.resolve(__dirname, <span class="hljs-string">&#x27;./dist&#x27;</span>),<br>  &#125;<br>&#125;;<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰æ‰§è¡Œ webpack å‘½ä»¤è¿›è¡Œæ„å»º</p><p>åœ¨ package.json æ–‡ä»¶ä¸­é…ç½®ç¼–è¯‘å‘½ä»¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --config webpack.config.js&quot;</span>,<br>  &#125;,<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œé¡¹ç›®çš„ Webpack ç¼–è¯‘ï¼ŒæˆåŠŸåä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆç¼–è¯‘ç›®å½• dist ï¼›</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">$ npm <span class="hljs-built_in">run</span> build<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ5ï¼‰è¿è¡Œ index.html</p><p>ç¼–è¯‘æˆåŠŸåï¼Œæˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€ index.html æ–‡ä»¶ï¼Œèƒ½çœ‹åˆ°é¡µé¢æˆåŠŸæ˜¾ç¤º â€œHello Webpackâ€ï¼›</p><h3 id="2ã€Loader-é…ç½®"><a href="#2ã€Loader-é…ç½®" class="headerlink" title="2ã€Loader é…ç½®"></a>2ã€Loader é…ç½®</h3><p>æœ¬èŠ‚é€šè¿‡ä¸ºä¹‹å‰çš„ä¾‹å­æ·»åŠ æ ·å¼ï¼Œæ¥å°è¯•ä½¿ç”¨ Loaderï¼›</p><p>ï¼ˆ1ï¼‰æ–°å»ºæ ·å¼æ–‡ä»¶ main.css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-id">#app</span>&#123;<br>  <span class="hljs-attribute">text-align</span>: center;<br>  <span class="hljs-attribute">color</span>:<span class="hljs-string">&#x27;#999&#x27;</span>;<br>&#125;<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰å°† main.css æ–‡ä»¶å¼•å…¥å…¥å£æ–‡ä»¶ main.js ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span> é€šè¿‡ CommonJS è§„èŒƒå¯¼å…¥ CSS æ¨¡å—<br>require(<span class="hljs-string">&#x27;./main.css&#x27;</span>);<br><br><span class="hljs-regexp">//</span> é€šè¿‡ CommonJS è§„èŒƒå¯¼å…¥ show å‡½æ•°<br>const show = require(<span class="hljs-string">&#x27;./show.js&#x27;</span>);<br><span class="hljs-regexp">//</span> æ‰§è¡Œ show å‡½æ•°<br>show(<span class="hljs-string">&#x27;Webpack&#x27;</span>);<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰Loader é…ç½®</p><p>ä»¥ä¸Šä¿®æ”¹åå»æ‰§è¡Œ Webpack æ„å»ºæ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› ä¸º Webpack ä¸åŸç”Ÿæ”¯æŒè§£æ CSS æ–‡ä»¶ã€‚è¦æ”¯æŒé JavaScript ç±»å‹çš„æ–‡ä»¶ï¼Œéœ€è¦ä½¿ç”¨ Webpack çš„ Loader æœºåˆ¶ï¼›</p><p>ï¼ˆ3.1ï¼‰è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… style-loader å’Œ css-loaderï¼Œå…¶ä¸­ï¼š</p><ul><li>css-loader ç”¨äºè¯»å– CSS æ–‡ä»¶ï¼›</li><li>style-loader æŠŠ CSS å†…å®¹æ³¨å…¥åˆ° JavaScript ä¸­ï¼›</li></ul><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$ <span class="hljs-built_in">npm</span> i -D style-loader css-loader<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3.2ï¼‰è¿›è¡Œä»¥ä¸‹é…ç½®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">module:&#123;<br>rules:[<br>  &#123;<br><span class="hljs-regexp">//</span> ç”¨æ­£åˆ™å»åŒ¹é…è¦ç”¨è¯¥ loader è½¬æ¢çš„ CSS æ–‡ä»¶<br>test:<span class="hljs-regexp">/\.css$/</span>,<br>use:[<span class="hljs-string">&#x27;style-loader&#x27;</span>,<span class="hljs-string">&#x27;css-loader&#x27;</span>]<br>  &#125;<br> ]<br>&#125;<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ4ï¼‰æŸ¥çœ‹ç»“æœ</p><p>ç¼–è¯‘åï¼Œåˆ·æ–° index.html ï¼ŒæŸ¥çœ‹åˆšåˆšçš„æ ·å¼ loader å·²ç»èµ·ä½œç”¨ï¼›</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/10/16f8ccdeb77f673c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="1"></p><h3 id="3ã€Plugin-é…ç½®"><a href="#3ã€Plugin-é…ç½®" class="headerlink" title="3ã€Plugin é…ç½®"></a>3ã€Plugin é…ç½®</h3><p>ï¼ˆ1ï¼‰å®‰è£…æ ·å¼æå–æ’ä»¶  extract-text-webpack-plugin</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$ <span class="hljs-built_in">npm</span> i -D extract-text-webpack-plugin@next<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰plugin æ–‡ä»¶é…ç½®å¦‚ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs css">  module:&#123;<br>    rules:[<br>      &#123;<br>        // ç”¨æ­£åˆ™å»åŒ¹é…è¦ç”¨è¯¥ loader è½¬æ¢çš„ CSS æ–‡ä»¶<br>        test:/\.css$/,<br>        use:ExtractTextPlugin.<span class="hljs-built_in">extract</span>(&#123;<br>          use:[<span class="hljs-string">&#x27;css-loader&#x27;</span>]<br>        &#125;),<br>      &#125;<br>    ]<br>  &#125;,<br>  plugins:[<br>    new <span class="hljs-built_in">ExtractTextPlugin</span>(&#123;<br>       // ä» <span class="hljs-selector-class">.js</span> æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ <span class="hljs-selector-class">.css</span> æ–‡ä»¶çš„åç§°<br>       filename:`[name]_[hash:<span class="hljs-number">8</span>].css`<br>    &#125;),<br>  ]<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æŸ¥çœ‹ç»“æœ</p><p>é€šè¿‡ä»¥ä¸Šé…ç½®åï¼Œæ‰§è¡Œ Webapack çš„æ‰§è¡Œå‘½ä»¤ï¼Œå‘ç°åœ¨ dist ç›®å½•ä¸‹ï¼Œç”Ÿæˆå¯¹åº”çš„ css æ–‡ä»¶ï¼›å­˜åœ¨çš„å‘ç‚¹ï¼š</p><ul><li>æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†ç”Ÿæˆçš„ css æ–‡ä»¶å¼•å…¥åˆ° index.html ä¸­ï¼›</li><li>ä¿®æ”¹ css æ–‡ä»¶åï¼Œä¼šç”Ÿæˆæ–°çš„ css æ–‡ä»¶ï¼ŒåŸå…ˆçš„ä¸ä¼šåˆ é™¤ï¼›</li></ul><h3 id="4ã€ä½¿ç”¨-DevServer"><a href="#4ã€ä½¿ç”¨-DevServer" class="headerlink" title="4ã€ä½¿ç”¨ DevServer"></a>4ã€ä½¿ç”¨ DevServer</h3><p>ï¼ˆ1ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… webpack-dev-server</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs axapta">$ npm i -D  webpack-dev-<span class="hljs-keyword">server</span><br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>åœ¨ package.json ä¸­é…ç½®å¯åŠ¨å‘½ä»¤</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c">  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --config webpack.config.js&quot;</span>,<br>    <span class="hljs-string">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack-dev-server&quot;</span>,<br>  &#125;,<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>è¿è¡Œå‘½ä»¤åï¼Œå°±å¯ä»¥å¯åŠ¨ HTTP æœåŠ¡</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">$ npm <span class="hljs-built_in">run</span> dev<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>å¯åŠ¨ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <a href="http://localhost:8080/">http://localhost:8080/</a>  è®¿é—®æˆ‘ä»¬çš„ index.html çš„demo</p><p><img src="https://user-gold-cdn.xitu.io/2020/1/10/16f8ccdec2f9318d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="1"></p><p>ï¼ˆ2ï¼‰å®æ—¶é¢„è§ˆ</p><p>æˆ‘ä»¬åœ¨è¿è¡Œå‘½ä»¤åé¢æ·»åŠ å‚æ•° â€“watch å®ç°å®æ—¶é¢„è§ˆï¼Œé…ç½®å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack-dev-server --watch&quot;</span><br>  &#125;,<br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬ä¿®æ”¹ main.js çš„ä¼ å…¥å‚æ•°ï¼Œå‘ç°å¹¶ä¸èƒ½å®æ—¶é¢„è§ˆï¼Œä¹Ÿæ²¡æœ‰æŠ¥é”™ï¼ï¼ï¼ why?</p><p>è¸©å‘ï¼š</p><p>åœ¨ index.html ä¸­éœ€è¦å°† js çš„è·¯å¾„ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;bundle.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>  <br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>è€Œä¸èƒ½æ˜¯ä¹‹å‰çš„ï¼ˆå› ä¸ºè¿™ä¸ªæ˜¯ç¼–è¯‘ç”Ÿæˆçš„ï¼Œå¹¶ä¸æ˜¯é€šè¿‡ devServer ç”Ÿæˆæ”¾åœ¨å†…å­˜çš„ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./dist/bundle.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> <br>å¤åˆ¶ä»£ç <br></code></pre></td></tr></table></figure><p>ï¼ˆ3ï¼‰æ¨¡å—çƒ­æ›¿æ¢</p><p>å¯ä»¥é€šè¿‡é…ç½®  â€“ hot  è¿›è¡Œæ¨¡å—çƒ­æ›¿æ¢ï¼›</p><h2 id="ç•ªå¤–"><a href="#ç•ªå¤–" class="headerlink" title="ç•ªå¤–"></a>ç•ªå¤–</h2><hr><p>æ²¡é”™ï¼Œæ–‡ç« æœ€åäº†ï¼Œç°åœ¨æˆ‘ä»¬å¼€å§‹å¼€å‘ä¸€ä¸ª<code>loader</code>å’Œ<code>plugin</code></p><h3 id="å¼€å‘ä¸€ä¸ªloader"><a href="#å¼€å‘ä¸€ä¸ªloader" class="headerlink" title="å¼€å‘ä¸€ä¸ªloader"></a>å¼€å‘ä¸€ä¸ª<code>loader</code></h3><p>éœ€æ±‚ï¼šå¼€å‘ä¸€ä¸ª<code>loader</code>ï¼Œå°†KobeBryant<code>è½¬æ¢ä¸º</code>mamba forever`ã€‚</p><h4 id="1-ç¼–å†™loader"><a href="#1-ç¼–å†™loader" class="headerlink" title="1.ç¼–å†™loader"></a>1.ç¼–å†™loader</h4><p>æ–°å»ºç›®å½•<code>my-loader</code>ä½œä¸ºåå­—ï¼Œæ‰§è¡Œ<code>npm init -y</code>å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ¨¡å—åŒ–é¡¹ç›®ï¼Œç„¶åæ–°å»º<code>index.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">content</span>) &#123;<br><span class="hljs-keyword">return</span> content &amp;&amp; content.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/KobeBryant/gi</span> , <span class="hljs-string">&#x27;mamba forever&#x27;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-æ³¨å†Œæ¨¡å—"><a href="#2-æ³¨å†Œæ¨¡å—" class="headerlink" title="2.æ³¨å†Œæ¨¡å—"></a>2.æ³¨å†Œæ¨¡å—</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦çš„loaderéƒ½æ˜¯åˆ©ç”¨npmå®‰è£…ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>npm link</code>å‘½ä»¤ï¼Œä»¥æ±‚åœ¨ä¸å‘å¸ƒæ¨¡å—çš„æƒ…å†µä¸‹ï¼Œå°†æœ¬åœ°çš„æºç é“¾æ¥åˆ°é¡¹ç›®çš„<code>node_modules</code>ä¸‹ã€‚åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">Î» npm link my<span class="hljs-literal">-loader</span><br></code></pre></td></tr></table></figure><h4 id="3-åœ¨webpackä¸­é…ç½®loader"><a href="#3-åœ¨webpackä¸­é…ç½®loader" class="headerlink" title="3.åœ¨webpackä¸­é…ç½®loader"></a>3.åœ¨webpackä¸­é…ç½®loader</h4><p>åœ¨<code>webpack.base.config.js</code>ä¸­åŠ ä¸Šä»¥ä¸‹é…ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br><span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.js/</span>,<br><span class="hljs-attr">loader</span>:<span class="hljs-string">&#x27;my-loader&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬jsé‡Œæ‰€æœ‰çš„å­—ç¬¦ä¸²<code>KobeBryant</code>å°±ä¼šæ›¿æ¢ä¸º<code>mamba forever</code>äº†</p><h4 id="4-é…ç½®å‚æ•°"><a href="#4-é…ç½®å‚æ•°" class="headerlink" title="4.é…ç½®å‚æ•°"></a>4.é…ç½®å‚æ•°</h4><p>å‰é¢æˆ‘ä»¬æ˜¯å†™æ­»çš„æ›¿æ¢ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦é€šè¿‡é…ç½®é¡¹æ¥è¿›è¡Œæ”¹å˜æ€ä¹ˆåŠ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// index.js</span><br><span class="hljs-keyword">var</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;loader-utils&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">content</span>) &#123;<br>    <span class="hljs-keyword">const</span> options = utils.<span class="hljs-title function_">getOptions</span>(<span class="hljs-variable language_">this</span>)<br>    <span class="hljs-keyword">return</span> content &amp;&amp; content.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/KobeBryant/gi</span> , options.<span class="hljs-property">name</span>)<br>&#125;<br><br><span class="hljs-comment">// webpack.base.conf.js</span><br>&#123;<br>  <span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.js/</span>,<br>  <span class="hljs-attr">use</span>: &#123;<br>    <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;my-loader&#x27;</span>,<br>    <span class="hljs-attr">options</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;KobeBryant&#x27;</span>,<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¼€å‘ä¸€ä¸ªPlugin"><a href="#å¼€å‘ä¸€ä¸ªPlugin" class="headerlink" title="å¼€å‘ä¸€ä¸ªPlugin"></a>å¼€å‘ä¸€ä¸ªPlugin</h3><ul><li>webpackåœ¨ç¼–è¯‘ä¸­ï¼Œä¼šå¹¿æ’­å¾ˆå¤šäº‹ä»¶</li><li>webpackåº”ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæ’ä»¶å¯ä»¥ç›‘å¬webpackäº‹ä»¶æ¥è§¦å‘å¯¹åº”çš„å¤„ç†é€»è¾‘</li><li>æ’ä»¶ä¸­å¯ä»¥ä½¿ç”¨webpackçš„api</li></ul><h4 id="1-ç¼–å†™æ’ä»¶"><a href="#1-ç¼–å†™æ’ä»¶" class="headerlink" title="1.ç¼–å†™æ’ä»¶"></a>1.ç¼–å†™æ’ä»¶</h4><p>åˆ›å»ºç›®å½•<code>my-plugin</code>ä½œä¸ºç¼–å†™çš„æ’ä»¶ï¼Œæ‰§è¡Œ<code>npm init -y</code>å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ¨¡å—åŒ–é¡¹ç›®ï¼Œç„¶åæ–°å»º<code>index.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPlugin</span> &#123;<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params">doneCakkback , failCallback</span>) &#123;<br><span class="hljs-comment">//ä¿å­˜åœ¨åˆ›å»ºå®ä¾‹æ—¶å€™ä¼ å…¥çš„å›è°ƒå‡½æ•°</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">doneCallback</span> = doneCallback<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">failCallback</span> = failCallback<br>&#125;<br>    <br>    <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) &#123;<br>        <span class="hljs-comment">//æˆåŠŸå®Œæˆä¸€æ¬¡å®Œæ•´çš„ç¼–è¯‘å’Œè¾“å‡ºæ—¶ï¼Œä¼šè§¦å‘done</span><br>        compile.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">&#x27;done&#x27;</span> , <span class="hljs-function"><span class="hljs-params">stats</span> =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">doneCallback</span>(stats)<br>        &#125;)<br>        <br>        <span class="hljs-comment">//å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œè§¦å‘fail</span><br>        compiler.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">&#x27;fail&#x27;</span> , <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">failCallback</span>(err)<br>        &#125;)<br>    &#125;<br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">MyPlugin</span><br></code></pre></td></tr></table></figure><h4 id="2-æ³¨å†Œæ¨¡å—-1"><a href="#2-æ³¨å†Œæ¨¡å—-1" class="headerlink" title="2.æ³¨å†Œæ¨¡å—"></a>2.æ³¨å†Œæ¨¡å—</h4><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬linkä¸€ä¸‹ï¼Œä»¥ä¾¿äºæˆ‘ä»¬èƒ½ç›´æ¥ä½¿ç”¨æœ¬åœ°çš„æ¨¡å—</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">Î» npm link my<span class="hljs-literal">-plugin</span><br></code></pre></td></tr></table></figure><h4 id="3-é…ç½®æ’ä»¶"><a href="#3-é…ç½®æ’ä»¶" class="headerlink" title="3.é…ç½®æ’ä»¶"></a>3.é…ç½®æ’ä»¶</h4><p>åœ¨<code>webpack.base.conf.js</code>åŠ ä¸Šä»¥ä¸‹é…ç½®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">plugins</span>: [<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">MyPlugin</span>(<br>    <span class="hljs-function"><span class="hljs-params">stats</span> =&gt;</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ç¼–è¯‘æˆåŠŸ&#x27;</span>)<br>        &#125;ï¼Œ<br>        err =&gt; &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;ç¼–è¯‘å¤±è´¥&#x27;</span>)<br>        &#125;<br>    )<br>]<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fetchä¹Ÿæœ‰å‘ï¼</title>
    <link href="/2020/02/20/2020-02-20-%E5%85%B3%E4%BA%8EFetch/"/>
    <url>/2020/02/20/2020-02-20-%E5%85%B3%E4%BA%8EFetch/</url>
    
    <content type="html"><![CDATA[<h3 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h3><p>æœ€è¿‘æ£é¼“RNï¼Œåšäº†ä¸ªé¡¹ç›®ï¼Œä½†æ˜¯åˆ°è°ƒè¯•æ¥å£çš„æ—¶å€™å‡ºäº†ä¸€ä¸ªå°é—®é¢˜ï¼Œå› ä¸ºä»¥å‰ç”¨çš„éƒ½æ˜¯ajaxå’Œaxiosï¼Œè¿™å›rnè‡ªå·±æä¾›äº†ä¸€ä¸ªfetchçš„apiï¼Œæ‰€ä»¥å°±ç´¢æ€§ç”¨æä¾›çš„äº†ï¼Œç„¶åå°±æ‰è¿›å‘é‡Œäº†â€¦â€¦ä»–ï¼æŠ¥é”™äº†</p><p><img src="https://i.loli.net/2020/02/20/v2CiEucYsNQHyPf.png" alt="TIMæˆªå›¾20200220202756.png"></p><p><code>Unexpected token in JSON at position 0</code> çœ¼ç†Ÿçš„é”™è¯¯ï¼Œå¯èƒ½ä»¥å‰å½“ä½ å‘é€ä¸€ä¸ªHTTPè¯·æ±‚çš„æ—¶å€™ï¼Œéƒ½æ›¾å‡ºç°è¿‡è¿™ä¸ªé”™è¯¯æç¤ºæˆ–è€…ç›¸ä¼¼çš„é”™è¯¯ï¼Œé‚£è¿™ä¸ªé”™è¯¯æ˜¯ç”±ä»€ä¹ˆå¼•èµ·çš„å‘¢</p><h3 id="æŠ¥é”™åŸå› "><a href="#æŠ¥é”™åŸå› " class="headerlink" title="æŠ¥é”™åŸå› "></a>æŠ¥é”™åŸå› </h3><p>è¿™äº›é”™è¯¯å‘ç”Ÿåœ¨ä½ å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œè¿”å›å€¼ä¸æ˜¯JSONè€Œä½ å´ç”¨JSONçš„æ–¹æ³•è§£æçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µ</p><p><code>fetch(â€™/apiâ€™).then(res =&gt; res.json())</code></p><p>è¿™å¥ä»£ç æœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä»–ä¼šå¾—åˆ°ä¸€ä¸ªè¿”å›å€¼ï¼Œé—®é¢˜å‡ºåœ¨<code>res.json()</code>ä¸Šé¢</p><p><code>Unexpected token in JSON at position 0</code> ä»–æ‰€æç¤ºçš„ç¬¦å·å’Œä½ç½®å¯èƒ½ä¸åŒï¼Œä½†æ˜¯å¼•èµ·ä»–çš„åŸå› æ˜¯ä¸€æ ·çš„ï¼Œä»£ç è§£æçš„JSONä¸æ˜¯æœ‰æ•ˆçš„JSON</p><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><p>æ—¢ç„¶ç”¨JSONæ–¹æ³•æ²¡æ³•å°†ç»“æœæ‰“å°å‡ºæ¥ï¼Œé‚£å¯ä»¥æ¢ä¸€ä¸ªæ€è·¯ï¼Œå…ˆç”¨<code>res.text()</code>å°†ç»“æœæ‰“å°å‡ºæ¥ï¼ŒæŸ¥çœ‹å“ªé‡Œå‡ºé—®é¢˜äº†</p><p><img src="https://i.loli.net/2020/02/20/5K6LmGiwNhHpsyf.png" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œfetchè¿”å›å€¼æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æ‰“å°ä¸€å®šè¦åœ¨<code>.then()&#123;&#125;</code>é‡Œè¿›è¡Œï¼Œå› ä¸ºæ˜¯å¼‚æ­¥çš„ï¼Œè¿™é‡Œä¸»è¦çœ‹<code>[[PromiseValue]]</code>é‡Œçš„å€¼ï¼Œä¼šå‘ç°ä»–å¹¶ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„å¯¹è±¡ï¼Œä»–å‰è¾¹è¿˜æœ‰å­—ç¬¦ä¸²ï¼Œå¯ä»¥çŒœæµ‹è¿™ä¸ªæ¥å£ä½¿ç”¨JSPå»è§£å†³è·¨åŸŸçš„ï¼ˆ<del>å¤ªlowäº†ä¹Ÿ</del>ï¼‰ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°±æ‡‚äº†ï¼Œæ˜¯å› ä¸ºè¿”å›å€¼ä¸æ˜¯JSONï¼Œé‚£å°±å¥½åŠäº†ï¼Œä¸‹é¢æˆ‘å°±ä¸è¿‡å¤šé˜è¿°äº†ï¼Œåº”è¯¥éƒ½ä¼šäº†</p><h3 id="ç•ªå¤–-ï¼š-æ˜¯æœåŠ¡å™¨çš„é”…ï¼Ÿ"><a href="#ç•ªå¤–-ï¼š-æ˜¯æœåŠ¡å™¨çš„é”…ï¼Ÿ" class="headerlink" title="ç•ªå¤– ï¼š æ˜¯æœåŠ¡å™¨çš„é”…ï¼Ÿ"></a>ç•ªå¤– ï¼š æ˜¯æœåŠ¡å™¨çš„é”…ï¼Ÿ</h3><p>è¿™é‡Œé¡ºä¾¿å†è®°å½•å‡ ä¸ªä½ çš„æ¥å£å¯èƒ½è¿”å›htmlè€Œä¸æ˜¯JSONçš„é—®é¢˜</p><ul><li><p><strong>è¯·æ±‚çš„urlä¸å­˜åœ¨ ï¼Œ æœåŠ¡å™¨ä»¥HTMLçš„æ–¹å¼è¿”å›404é¡µé¢</strong></p></li><li><p><strong>æ·»åŠ äº†æ–°çš„è·¯ç”±ï¼ŒæœåŠ¡å™¨éœ€è¦é‡å¯</strong></p></li><li><p><strong>å®¢æˆ·ç«¯æ²¡æœ‰è®¾ç½®ä»£ç†</strong></p><p>å¦‚æœåœ¨ä½¿ç”¨ CRAçš„webpack dev serveræ—¶ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ªæŒ‡å‘åç«¯çš„ä»£ç†</p></li><li><p><strong>apiçš„æ ¹urlæ˜¯<code>/</code></strong></p><p>å¦‚æœä½ åœ¨é€šè¿‡webpackæˆ–è€…CRAä½¿ç”¨ä»£ç†ï¼Œç¡®è®¤ä½ çš„apiä¸åœ¨æ ¹å±‚çº§ï¼Œè¿™æ ·ä¼šè®©ä»£ç†æœåŠ¡å™¨æ··æ·†ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªHTMLï¼Œä½ å¯ä»¥åœ¨ä½ çš„apiå‰é¢å¢åŠ ä¸€ä¸ªå‘½åç©ºé—´ <code>/api/</code></p></li></ul><hr><p><img src="https://i.loli.net/2020/02/20/nFpzWqlmBtMoIZv.png" alt="ç‚¹ç‚¹çœ‹å§ï¼Œ.png"></p>]]></content>
    
    
    <categories>
      
      <category>others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>â—Yarnçš„cache å‘ï¼</title>
    <link href="/2020/02/16/2020-02-16-yarn%E4%BB%A5%E5%8F%8Anpm%E6%B8%85%E7%90%86/"/>
    <url>/2020/02/16/2020-02-16-yarn%E4%BB%A5%E5%8F%8Anpm%E6%B8%85%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>è¿‡å®Œå¹´åœ¨å®¶æ£é¼“ç”µè„‘ï¼Œå‘ç°Cç›˜å¿«æ»¡äº†ï¼Œåˆå¼€å§‹äº†å„ç§ä¼˜åŒ–Cç›˜çš„æ–¹æ³•ï¼Œé¦–å…ˆå½“ç„¶æ˜¯ç”¨spaceSnifferå»æŸ¥çœ‹ä¸€ä¸‹å ç”¨æƒ…å†µï¼Œä¸çœ‹ä¸çŸ¥é“ä¸€çœ‹å“ä¸€è·³ï¼ŒYarnç«Ÿç„¶åœ¨Cç›˜ä¸ªäººç›®å½•æœ‰é¢æœ‰7ä¸ªGå¤šçš„å¤§å°ï¼Œä¸‹é¢å°±ç®€å•åˆ—ä¸¾å‡ ä¸ªYarnæä¾›çš„å…³äºç¼“å­˜çš„å‘½ä»¤ã€‚</p><h3 id="ä¸€ã€yarn-cache-dir"><a href="#ä¸€ã€yarn-cache-dir" class="headerlink" title="ä¸€ã€yarn cache dir"></a>ä¸€ã€<code>yarn cache dir</code></h3><p>è¿è¡Œå‘½ä»¤ä¼šæ˜¾ç¤ºå½“å‰ç¼“å­˜ç›®å½•ï¼Œé»˜è®¤æ˜¯Cç›˜</p><h3 id="äºŒã€yarn-cache-clean-lt-module-name-gt"><a href="#äºŒã€yarn-cache-clean-lt-module-name-gt" class="headerlink" title="äºŒã€yarn cache clean [&lt;module_name...&gt;]"></a>äºŒã€<code>yarn cache clean [&lt;module_name...&gt;]</code></h3><p>è¿è¡Œå‘½ä»¤ä¼šæ¸…ç†ç¼“å­˜åŒ…ï¼Œè‹¥æœªæŒ‡å®šåŒ…ååˆ™ä¼šå…¨éƒ¨æ¸…ç†ï¼ŒæŒ‡å®šåˆ™æ¸…ç†æŒ‡å®šåŒ…ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šè¦å…ˆæ¸…ç†åŒ…åœ¨é‡æ–°é…ç½®ç›®å½•ï¼Œå¦åˆ™ä¼šä½¿ä¹‹å‰çš„ç¼“å­˜æ— æ³•æ¸…é™¤</p><h3 id="ä¸‰ã€yarn-config-set-cache-folder"><a href="#ä¸‰ã€yarn-config-set-cache-folder" class="headerlink" title="ä¸‰ã€yarn config set cache-folder"></a>ä¸‰ã€<code>yarn config set cache-folder</code></h3><p>è®¾ç½®å½“å‰ç¼“å­˜ç›®å½•</p><hr><p>åŒæ ·çš„ï¼Œnpmä¹Ÿæœ‰ä¸€ä¸ªå­˜å‚¨ç¼“å­˜åŒ…çš„ä½ç½®ï¼Œè¿™é‡Œä¹ŸæŠŠç›¸åº”çš„å‘½ä»¤æä¾›å‡ºæ¥</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">npm config get cache<br>npm cache clean <span class="hljs-literal">--force</span><br>npm config <span class="hljs-built_in">set</span> cache <span class="hljs-string">&quot;F:\ProgramFile\nodejs\node_module\node_cache&quot;</span><br>npm cache verify<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><blockquote><p><a href="https://yarn.bootcss.com/docs/cli/cache/">https://yarn.bootcss.com/docs/cli/cache/</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>others</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Yarn</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°MyReduxï¼ˆä¸‰ï¼‰</title>
    <link href="/2019/12/16/2019-12-16-Redux%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2019/12/16/2019-12-16-Redux%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h3 id="æä¸€æ‰‹reducer"><a href="#æä¸€æ‰‹reducer" class="headerlink" title="æä¸€æ‰‹reducer"></a>æä¸€æ‰‹<code>reducer</code></h3><p>æœ‰äº†å‰é¢ä¸¤ç¯‡ï¼Œç°åœ¨æœ‰äº†ä¸€ä¸ªé€šç”¨çš„<code>createStore</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (state, stateChanger) &#123;<br>  <span class="hljs-keyword">const</span> listeners = []<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">subscribe</span> = (<span class="hljs-params">listener</span>) =&gt; listeners.<span class="hljs-title function_">push</span>(listener)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; &#123;<br>    state = <span class="hljs-title function_">stateChanger</span>(state, action) <span class="hljs-comment">// è¦†ç›–åŸå¯¹è±¡</span><br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch, subscribe &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é‚£ä»–æ€ä¹ˆç”¨å‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> appState = &#123;<br>  <span class="hljs-attr">title</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js å°ä¹¦&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span>,<br>  &#125;,<br>  <span class="hljs-attr">content</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js å°ä¹¦å†…å®¹&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">stateChanger</span> (state, action) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">text</span>: action.<span class="hljs-property">text</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">color</span>: action.<span class="hljs-property">color</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(appState, stateChanger)<br>...<br></code></pre></td></tr></table></figure><p>å…¶å®å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ï¼Œ<code>appStore</code>å’Œ<code>stateChange</code>å¯ä»¥åˆå¹¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">stateChanger</span> (state, action) &#123;<br>  <span class="hljs-keyword">if</span> (!state) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">title</span>: &#123;<br>        <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js å°ä¹¦&#x27;</span>,<br>        <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">content</span>: &#123;<br>        <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js å°ä¹¦å†…å®¹&#x27;</span>,<br>        <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">text</span>: action.<span class="hljs-property">text</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123;<br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">color</span>: action.<span class="hljs-property">color</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>stateChange</code>ç°åœ¨æ—¢å……å½“äº†è·å–åˆå§‹åŒ–æ•°æ®çš„åŠŸèƒ½ï¼Œä¹Ÿå……å½“äº†ç”Ÿæˆæ›´æ–°æ•°æ®çš„åŠŸèƒ½ï¼Œå¦‚æœä¼ å…¥äº†<code>state</code>å°±æ›´æ–°æ•°æ®ï¼Œå¦åˆ™ä¸ºåˆå§‹åŒ–æ•°æ®ï¼Œé‚£<code>createStore</code>å¯ä»¥ä¼˜åŒ–æˆä¸€ä¸ªå‚æ•°ï¼Œå› ä¸º<code>state</code>å’Œ<code>stateChange</code>å¯ä»¥åˆå¹¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (stateChanger) &#123;<br>  <span class="hljs-keyword">let</span> state = <span class="hljs-literal">null</span><br>  <span class="hljs-keyword">const</span> listeners = []<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">subscribe</span> = (<span class="hljs-params">listener</span>) =&gt; listeners.<span class="hljs-title function_">push</span>(listener)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; &#123;<br>    state = <span class="hljs-title function_">stateChanger</span>(state, action)<br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br>  <span class="hljs-title function_">dispatch</span>(&#123;&#125;) <span class="hljs-comment">// åˆå§‹åŒ– state</span><br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch, subscribe &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>createStore</code> å†…éƒ¨çš„ <code>state</code> ä¸å†é€šè¿‡å‚æ•°ä¼ å…¥ï¼Œè€Œæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ <code>let state = null</code>ã€‚<code>createStore</code> çš„æœ€åä¼šæ‰‹åŠ¨è°ƒç”¨ä¸€æ¬¡ <code>dispatch(&#123;&#125;)</code>ï¼Œ<code>dispatch</code> å†…éƒ¨ä¼šè°ƒç”¨ <code>stateChanger</code>ï¼Œè¿™æ—¶å€™çš„ <code>state</code> æ˜¯ <code>null</code>ï¼Œæ‰€ä»¥è¿™æ¬¡çš„ <code>dispatch</code> å…¶å®å°±æ˜¯åˆå§‹åŒ–æ•°æ®äº†ã€‚<code>createStore</code> å†…éƒ¨ç¬¬ä¸€æ¬¡çš„ <code>dispatch</code> å¯¼è‡´ <code>state</code> åˆå§‹åŒ–å®Œæˆï¼Œåç»­å¤–éƒ¨çš„ <code>dispatch</code> å°±æ˜¯ä¿®æ”¹æ•°æ®çš„è¡Œä¸ºäº†ã€‚</p><p><code>stateChange</code>å¯ä»¥æ¢ä¸€ä¸ªåå­—ï¼Œå°±å«ä»–<code>reducer</code>ï¼Œä¸è¦é—®ï¼Œé—®å°±æ˜¯<code>reducer</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (reducer) &#123;<br>  <span class="hljs-keyword">let</span> state = <span class="hljs-literal">null</span><br>  <span class="hljs-keyword">const</span> listeners = []<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">subscribe</span> = (<span class="hljs-params">listener</span>) =&gt; listeners.<span class="hljs-title function_">push</span>(listener)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; &#123;<br>    state = <span class="hljs-title function_">reducer</span>(state, action)<br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br>  <span class="hljs-title function_">dispatch</span>(&#123;&#125;) <span class="hljs-comment">// åˆå§‹åŒ– state</span><br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch, subscribe &#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="reducer"><a href="#reducer" class="headerlink" title="reducer"></a><code>reducer</code></h4><p><code>createStore</code>æ¥å—ä¸€ä¸ªå«<code>reducer</code>çš„å‡½æ•°ï¼Œ<strong>ä»–ä¸€å®šæ˜¯ä¸€ä¸ªçº¯å‡½æ•°</strong>ï¼Œä»–æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯<code>state</code>ï¼Œä¸€ä¸ªæ˜¯<code>action</code></p><p>ä»–ä¸èƒ½å¹²ä»»ä½•äº‹æƒ…ï¼Œåªèƒ½<strong>åˆå§‹åŒ–å’Œè®¡ç®—æ–°çš„<code>state</code></strong></p><hr><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>ä»ç¬¬ä¸€ç¯‡å¼€å§‹ï¼Œé¦–å…ˆå‘ç°å¦‚æœå…±äº«çš„çŠ¶æ€èƒ½è¢«éšæ„ä¿®æ”¹ï¼Œé‚£ç¨‹åºåœ°è¡Œä¸ºä¼šä¸å¯é¢„æ–™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ±‚åªèƒ½é€šè¿‡<code>dispatch</code>å»è¿›è¡Œæ•°æ®ä¿®æ”¹ï¼Œè€Œä¸”å¿…é¡»è¦åœ¨<code>action</code>ä¸­å£°æ˜ï¼Œç„¶åæˆ‘ä»¬æŠŠå®ƒæŠ½è±¡å‡ºæ¥æˆä¸ºä¸€ä¸ª<code>createStore</code>ï¼Œå®ƒèƒ½ç”Ÿäº§<code>store</code>ï¼Œé‡Œé¢æœ‰<code>getState</code>å’Œ<code>dispatch</code>è®©æˆ‘ä»¬ä½¿ç”¨</p><p>åæ¥å‘ç°æ¯æ¬¡ä¿®æ”¹æ•°æ®éƒ½è¦é‡æ–°æ¸²æŸ“ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè‡ªåŠ¨æ¸²æŸ“è§†å›¾ï¼Œæ‰€ä»¥ä½¿ç”¨äº†è®¢é˜…è€…æ¨¡å¼ï¼Œé€šè¿‡<code>store.subscribe</code>è®¢é˜…æ•°æ®ä¿®æ”¹äº‹ä»¶ï¼Œä¸ºäº†è®©å®ƒè‡ªåŠ¨æ¸²æŸ“è§†å›¾</p><p>åœ¨æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™å‘ç°æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“è§†å›¾ä¼šæœ‰å¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨å…±äº«ç»“æ„çš„å¯¹è±¡æ¥è§£å†³é—®é¢˜ï¼Œè€Œåè®©<code>stateChanger</code>æ›´åä¸º<code>reducer</code>ï¼Œå¹¶è®©ä»–æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œè´Ÿè´£åˆå§‹åŒ–<code>state</code>ï¼Œæ ¹æ®<code>state</code>å’Œ<code>action</code>è®¡ç®—å…·æœ‰å…±äº«ç»“æ„çš„æ–°<code>state</code></p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>immutable.js</title>
    <link href="/2019/12/16/2019-12-16-immutable.js/"/>
    <url>/2019/12/16/2019-12-16-immutable.js/</url>
    
    <content type="html"><![CDATA[<img src="https://upload-images.jianshu.io/upload_images/2165169-cebb05bca02f1772?imageMogr2/auto-orient/strip|imageView2/2/w/613/format/webp" style="zoom:80%;" /><h2 id="ä»€ä¹ˆæ˜¯Immutable-Dataï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯Immutable-Dataï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯Immutable Dataï¼Ÿ"></a>ä»€ä¹ˆæ˜¯Immutable Dataï¼Ÿ</h2><p>æ‰”ä¸€æ®µå®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä¹Ÿçœ‹ä¸æ˜ç™½ï¼ˆè¿‡äº†ä¸ªå‡å…­çº§ï¼‰</p><blockquote><p>Immutable data encourages pure functions (data-in, data-out) and lends itself to much simpler application development and enabling techniques from functional programming such as lazy evaluation.</p></blockquote><p>å®ç°åŸç†ï¼š<strong>Persistent Data Structure ï¼ˆæŒä¹…åŒ–æ•°æ®ç»“æ„ï¼‰</strong></p><p>ä¹Ÿå°±æ˜¯ç”¨æ—§æ•°æ®åˆ›å»ºæ–°æ•°æ®çš„æ—¶å€™è¦ä¿è¯æ—§æ•°æ®åŒæ—¶å¯ç”¨ä¸”ä¸å˜ï¼Œè€Œä¸”ä¸ºäº†é¿å…æ·±æ‹·è´æŠŠæ‰€æœ‰èŠ‚ç‚¹å¤åˆ¶ä¸€éå¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼ŒImmutableä½¿ç”¨äº†<code>Structural Sharing</code>ï¼ˆç»“æ„å…±äº«ï¼‰ï¼Œå°±æ˜¯è¯´å¦‚æœå¯¹è±¡æ•°ä¸­ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿå˜åŒ–ï¼Œåªä¿®æ”¹è¿™ä¸ªèŠ‚ç‚¹å’Œå—å®ƒå½±å“çš„çˆ¶èŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹å…±äº«ï¼Œå¦‚å›¾</p><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><h3 id="1-é™ä½Mutableå¸¦æ¥çš„å¤æ‚åº¦"><a href="#1-é™ä½Mutableå¸¦æ¥çš„å¤æ‚åº¦" class="headerlink" title="1.é™ä½Mutableå¸¦æ¥çš„å¤æ‚åº¦"></a>1.é™ä½Mutableå¸¦æ¥çš„å¤æ‚åº¦</h3><p>å¼•ç”¨èµ‹å€¼è™½ç„¶å¯ä»¥èŠ‚çœå†…å­˜ï¼Œä½†æ˜¯å½“å·¥ç¨‹å˜çš„åºå¤§ï¼Œå¯å˜çŠ¶æ€ä¼šæˆä¸ºå™©æ¢¦ï¼Œé€šå¸¸æ˜¯ç†ç”±æ·±æ‹·è´æ¥é¿å…ï¼Œä½†æ˜¯è¿‡åº¦æ¶ˆè€—å†…å­˜</p><h3 id="2-èŠ‚çœå†…å­˜ç©ºé—´"><a href="#2-èŠ‚çœå†…å­˜ç©ºé—´" class="headerlink" title="2.èŠ‚çœå†…å­˜ç©ºé—´"></a>2.èŠ‚çœå†…å­˜ç©ºé—´</h3><p>å› ä¸ºæ˜¯ç»“æ„å…±äº«ï¼Œæ‰€ä»¥Immutableä½¿ç”¨è¿™ç§æ–¹å¼ä¼šå°½é‡å¤ç”¨å†…å­˜</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">import</span> &#123; <span class="hljs-built_in">Map</span> &#125; from <span class="hljs-string">&#x27;immutable&#x27;</span>;<br>let a = <span class="hljs-built_in">Map</span>(&#123;<br>  select: <span class="hljs-string">&#x27;users&#x27;</span>,<br>  filter: <span class="hljs-built_in">Map</span>(&#123; name: <span class="hljs-string">&#x27;Cam&#x27;</span> &#125;)<br>&#125;)<br>let b = a.<span class="hljs-keyword">set</span>(<span class="hljs-string">&#x27;select&#x27;</span>, <span class="hljs-string">&#x27;people&#x27;</span>);<br><br>a === b; <span class="hljs-comment">// false</span><br>a.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;filter&#x27;</span>) === b.<span class="hljs-keyword">get</span>(<span class="hljs-string">&#x27;filter&#x27;</span>); <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œåªæœ‰<code>select</code>å˜åŒ–äº†ï¼Œæ‰€ä»¥<code>filter</code>èŠ‚ç‚¹æ˜¯å…±äº«çš„</p><h3 id="Undo-Redo-Copy-Paste"><a href="#Undo-Redo-Copy-Paste" class="headerlink" title="Undo/Redo , Copy/Paste"></a>Undo/Redo , Copy/Paste</h3><p>æ¯æ¬¡æ•°æ®éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥æŠŠæ•°æ®æ”¾åˆ°æ•°ç»„é‡Œå­˜å‚¨ï¼Œæƒ³æ‹¿å“ªæ¬¡å¾—åˆ°çš„æ•°æ®éƒ½å¯ä»¥ï¼ˆè¯è™½å¦‚æ­¤ï¼Œæˆ‘å´æ²¡ç”¨è¿‡ï¼‰</p><h3 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h3><hr><h2 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h2><p>ä¸è¯´äº†è‡ªå·±çœ‹å§</p><h2 id="Immutable-jsçš„æ•°æ®ç±»å‹"><a href="#Immutable-jsçš„æ•°æ®ç±»å‹" class="headerlink" title="Immutable.jsçš„æ•°æ®ç±»å‹"></a>Immutable.jsçš„æ•°æ®ç±»å‹</h2><blockquote><ul><li><p>Listï¼šæœ‰åºåºåˆ—é›†ï¼Œç±»ä¼¼Array</p></li><li><p>Mapï¼šæ— åºåºåˆ—é›†ï¼Œç±»ä¼¼Object</p></li><li><p>Seqï¼šè¿™è¡¨ç¤ºä¸€ç³»åˆ—å€¼ï¼Œä½†ä¸èƒ½ç”±å…·ä½“çš„æ•°æ®ç»“æ„æ”¯æŒã€‚</p></li></ul><ul><li>ç­‰â€¦â€¦ï¼ˆä»¥åå†æ·»åŠ ï¼‰</li></ul></blockquote><h2 id="Immutable-js-å¸¸ç”¨API"><a href="#Immutable-js-å¸¸ç”¨API" class="headerlink" title="Immutable.js å¸¸ç”¨API"></a>Immutable.js å¸¸ç”¨API</h2><ul><li><p><code>fromJS()</code></p><ul><li>ä½œç”¨ï¼šæŠŠä¸€ä¸ªJSæ•°æ®è½¬æ¢æˆImmutableç±»å‹æ•°æ®</li><li>ç”¨æ³•ï¼š<code>fromJS(value , converter)</code></li><li>å‚æ•°ï¼švalueæ˜¯è¦è½¬å˜çš„æ•°æ®ï¼Œconverter[å¯é€‰]æ˜¯è¦åšçš„æ“ä½œï¼Œé»˜è®¤ä¼šæŠŠæ•°ç»„è½¬æˆLIstï¼Œå¯¹è±¡è½¬æˆMap</li></ul></li><li><p><code>toJS()</code></p><ul><li>ä½œç”¨ï¼šæŠŠImmutableç±»å‹æ•°æ®è½¬æ¢æˆJSç±»å‹æ•°æ®</li><li>ç”¨æ³•ï¼š<code>value.toJS()</code></li></ul></li><li><p><code>is()</code></p><ul><li>ä½œç”¨ï¼šå¯¹ä¸¤ä¸ªå¯¹è±¡è¿›è¡Œæ¯”è¾ƒ</li><li>ç”¨æ³•ï¼š<code>is(map1 , map2)</code></li><li>ç®€ä»‹ï¼šå’ŒJSä¸­çš„å¯¹è±¡æ¯”è¾ƒä¸åŒï¼ŒJSä¸­æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯æ¯”è¾ƒåœ°å€ï¼Œè€ŒImmutableä¸­æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„hashCodeå’ŒvalueOfï¼Œåªè¦ä¸¤è€…hashCodeç›¸ç­‰ï¼Œå€¼å°±ç›¸åŒï¼Œé¿å…æ·±åº¦éå†ï¼Œæé«˜æ€§èƒ½</li></ul></li><li><p><code>List()</code>å’Œ<code>Map()</code></p><ul><li><p>ä½œç”¨ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„List/Mapå¯¹è±¡</p></li><li><p>ç”¨æ³•</p></li><li><p>```dart<br>//List<br>Immutable.List(); // ç©ºList<br>Immutable.List([1, 2]);</p><p>//Map<br>Immutable.Map(); // ç©ºMap<br>Immutable.Map({ a: â€˜1â€™, b: â€˜2â€™ });</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><br>- `get<span class="hljs-literal">()</span>`ã€`get<span class="hljs-constructor">In()</span>`<br><br>  - è·å–æ•°æ®ç»“æ„ä¸­çš„æ•°æ®<br><br>  - ```dart<br>    <span class="hljs-comment">//è·å–Listç´¢å¼•çš„å…ƒç´ </span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ImmutableData</span>.</span></span>get(<span class="hljs-number">0</span>);<br>    <br>    <span class="hljs-comment">// è·å–Mapå¯¹åº”keyçš„value</span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ImmutableData</span>.</span></span>get(<span class="hljs-character">&#x27;a&#x27;</span>);<br>    <br>    <span class="hljs-comment">// è·å–åµŒå¥—æ•°ç»„ä¸­çš„æ•°æ®</span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ImmutableData</span>.</span></span>get<span class="hljs-constructor">In([1, 2])</span>;<br>    <br>    <span class="hljs-comment">// è·å–åµŒå¥—mapçš„æ•°æ®</span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ImmutableData</span>.</span></span>get<span class="hljs-constructor">In([&#x27;<span class="hljs-params">a</span>&#x27;, &#x27;<span class="hljs-params">b</span>&#x27;])</span>;<br></code></pre></td></tr></table></figure></li></ul></li><li><p><code>has()</code>ã€<code>hasIn()</code></p><ul><li><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸ªkey</p></li><li><p>```dart<br>Immutable.fromJS([1,2,3,{a:4,b:5}]).has(â€˜0â€™); //true<br>Immutable.fromJS([1,2,3,{a:4,b:5}]).has(â€˜0â€™); //true<br>Immutable.fromJS([1,2,3,{a:4,b:5}]).hasIn([3,â€™bâ€™]) //true</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><br>- è®¾ç½®`<span class="hljs-keyword">set</span>()`ã€`setIn()`<br><br>  - <span class="hljs-keyword">set</span>  =&gt;  è®¾ç½®ç¬¬ä¸€å±‚key ï¼Œ indexçš„å€¼<br><br>  - setIn =&gt;  è®¾ç½®æ·±å±‚ç»“æ„ä¸­å±æ€§çš„å€¼<br><br>  - ```dart<br>    const originalList = List([ <span class="hljs-number">0</span> ]);<br>    <span class="hljs-comment">// List [ 0 ]</span><br>    originalList.<span class="hljs-keyword">set</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br>    <span class="hljs-comment">// List [ 0, 1 ]</span><br>    originalList.<span class="hljs-keyword">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&#x27;overwritten&#x27;</span>);<br>    <span class="hljs-comment">// List [ &quot;overwritten&quot; ]</span><br>    originalList.<span class="hljs-keyword">set</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>);<br>    <span class="hljs-comment">// List [ 0, undefined, 2 ]</span><br>    <br>    List().<span class="hljs-keyword">set</span>(<span class="hljs-number">50000</span>, <span class="hljs-string">&#x27;value&#x27;</span>).size;<br>    <span class="hljs-comment">// 50001</span><br>    <br>    const originalMap = Map()<br>    const <span class="hljs-keyword">new</span><span class="hljs-type">erMap</span> = originalMap.<span class="hljs-keyword">set</span>(<span class="hljs-string">&#x27;key&#x27;</span>, <span class="hljs-string">&#x27;value&#x27;</span>)<br>    const <span class="hljs-keyword">new</span><span class="hljs-type">estMap</span> = <span class="hljs-keyword">new</span><span class="hljs-type">erMap</span>.<span class="hljs-keyword">set</span>(<span class="hljs-string">&#x27;key&#x27;</span>, <span class="hljs-string">&#x27;newer value&#x27;</span>)<br>    <br>    originalMap<br>    <span class="hljs-comment">// Map &#123;&#125;</span><br>    <span class="hljs-keyword">new</span><span class="hljs-type">erMap</span><br>    <span class="hljs-comment">// Map &#123; &quot;key&quot;: &quot;value&quot; &#125;</span><br>    <span class="hljs-keyword">new</span><span class="hljs-type">estMap</span><br>    <span class="hljs-comment">// Map &#123; &quot;key&quot;: &quot;newer value&quot; &#125;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>è·Ÿjsä¸­ä¸åŒï¼ŒListä¸­ä¸å­˜åœ¨ç©ºä½ï¼Œ[,,,],Listä¸­è‹¥æ²¡æœ‰å€¼ï¼Œåˆ™ä¸ºundefinedã€‚</strong></p></li><li><p><code>setIn()</code></p></li><li><p>```dart<br>const originalMap = Map({<br>  subObject: Map({</p><pre><code class="hljs">subKey: &#39;subvalue&#39;,subSubObject: Map(&#123;  subSubKey: &#39;subSubValue&#39;&#125;)</code></pre><p>  })<br>})</p><p>const newMap = originalMap.setIn([â€˜subObjectâ€™, â€˜subKeyâ€™], â€˜ha ha!â€™)<br>// Map {<br>//   â€œsubObjectâ€: Map {<br>//     â€œsubKeyâ€: â€œha ha!â€,<br>//     â€œsubSubObjectâ€: Map { â€œsubSubKeyâ€: â€œsubSubValueâ€ }<br>//   }<br>// }</p><p>const newerMap = originalMap.setIn(<br>  [â€˜subObjectâ€™, â€˜subSubObjectâ€™, â€˜subSubKeyâ€™],<br>  â€˜ha ha ha!â€™<br>)<br>// Map {<br>//   â€œsubObjectâ€: Map {<br>//     â€œsubKeyâ€: â€œsubvalueâ€,<br>//     â€œsubSubObjectâ€: Map { â€œsubSubKeyâ€: â€œha ha ha!â€ }<br>//   }<br>// }</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">  <br>- `<span class="language-javascript"><span class="hljs-title function_">update</span>()</span>`<br><br>  - æ›´æ–°æ•°æ®<br><br>  - ```<span class="language-javascript">dart</span><br><span class="language-javascript">    <span class="hljs-comment">////List</span></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> list = <span class="hljs-title class_">List</span>([ <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span> ])</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> result = list.<span class="hljs-title function_">update</span>(<span class="hljs-number">2</span>, <span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> val.<span class="hljs-title function_">toUpperCase</span>())</span><br><span class="language-javascript">    </span><br><span class="language-javascript">    <span class="hljs-comment">///Map</span></span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> aMap = <span class="hljs-title class_">Map</span>(&#123; <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;value&#x27;</span> &#125;)</span><br><span class="language-javascript">    <span class="hljs-keyword">const</span> newMap = aMap.<span class="hljs-title function_">update</span>(<span class="hljs-string">&#x27;key&#x27;</span>, <span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> value + value)</span><br><span class="language-javascript">        </span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="å…³äºmerge"><a href="#å…³äºmerge" class="headerlink" title="å…³äºmerge"></a>å…³äºmerge</h2><p>â€‹    merge</p><p>ä½œç”¨ï¼šæµ…åˆå¹¶ï¼Œæ–°æ•°æ®ä¸æ—§æ•°æ®å¯¹æ¯”ï¼Œæ—§æ•°æ®ä¸­ä¸å­˜åœ¨çš„å±æ€§ç›´æ¥æ·»åŠ ï¼Œå°±æ•°æ®ä¸­å·²å­˜åœ¨çš„å±æ€§ç”¨æ–°æ•°æ®ä¸­çš„è¦†ç›–</p><h6 id="mergrWith"><a href="#mergrWith" class="headerlink" title="mergrWith"></a>mergrWith</h6><p>ä½œç”¨ï¼šè‡ªå®šä¹‰æµ…åˆå¹¶ï¼Œå¯è‡ªè¡Œè®¾ç½®æŸäº›å±æ€§çš„å€¼</p><h6 id="mergeIn"><a href="#mergeIn" class="headerlink" title="mergeIn"></a>mergeIn</h6><p>ä½œç”¨ï¼šå¯¹æ·±å±‚æ•°æ®è¿›è¡Œæµ…åˆå¹¶</p><h6 id="mergeDeep"><a href="#mergeDeep" class="headerlink" title="mergeDeep"></a>mergeDeep</h6><p>ä½œç”¨ï¼šæ·±åˆå¹¶ï¼Œæ–°æ—§æ•°æ®ä¸­åŒæ—¶å­˜åœ¨çš„çš„å±æ€§ä¸ºæ–°æ—§æ•°æ®åˆå¹¶ä¹‹åçš„æ•°æ®</p><h6 id="mergeDeepIn"><a href="#mergeDeepIn" class="headerlink" title="mergeDeepIn"></a>mergeDeepIn</h6><p>ä½œç”¨ï¼šå¯¹æ·±å±‚æ•°æ®è¿›è¡Œæ·±åˆå¹¶</p><h6 id="mergrDeepWith"><a href="#mergrDeepWith" class="headerlink" title="mergrDeepWith"></a>mergrDeepWith</h6><p>ä½œç”¨ï¼šè‡ªå®šä¹‰æ·±åˆå¹¶ï¼Œå¯è‡ªè¡Œè®¾ç½®æŸäº›å±æ€§çš„å€¼</p><p>è¿™é‡Œç”¨ä¸€æ®µç¤ºä¾‹å½»åº•ææ‡‚mergeï¼Œæ­¤ç¤ºä¾‹ä¸ºMapç»“æ„ï¼ŒListä¸MapåŸç†ç›¸åŒ</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">const</span> Map1 = Immutable.fromJS(&#123;a:<span class="hljs-number">111</span>,b:<span class="hljs-number">222</span>,c:&#123;d:<span class="hljs-number">333</span>,e:<span class="hljs-number">444</span>&#125;&#125;);<br><span class="hljs-keyword">const</span> Map2 = Immutable.fromJS(&#123;a:<span class="hljs-number">111</span>,b:<span class="hljs-number">222</span>,c:&#123;e:<span class="hljs-number">444</span>,f:<span class="hljs-number">555</span>&#125;&#125;);<br><br><span class="hljs-keyword">const</span> Map3 = Map1.merge(Map2);<br> <span class="hljs-comment">//Map &#123;a:111,b:222,c:&#123;e:444,f:555&#125;&#125;</span><br><span class="hljs-keyword">const</span> Map4 = Map1.mergeDeep(Map2);<br> <span class="hljs-comment">//Map &#123;a:111,b:222,c:&#123;d:333,e:444,f:555&#125;&#125;</span><br><span class="hljs-keyword">const</span> Map5 = Map1.mergeWith((oldData,newData,key)=&gt;&#123;<br>     <span class="hljs-keyword">if</span>(key === <span class="hljs-string">&#x27;a&#x27;</span>)&#123;<br>       <span class="hljs-keyword">return</span> <span class="hljs-number">666</span>;<br>     &#125;<span class="hljs-keyword">else</span>&#123;<br>       <span class="hljs-keyword">return</span> newData<br>     &#125;<br>   &#125;,Map2);<br> <span class="hljs-comment">//Map &#123;a:666,b:222,c:&#123;e:444,f:555&#125;&#125;</span><br></code></pre></td></tr></table></figure><hr><p>æ›´å¤šAPIè§</p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°MyReduxï¼ˆäºŒï¼‰</title>
    <link href="/2019/12/04/2019-12-04-Redux%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2019/12/04/2019-12-04-Redux%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h3 id="çº¯å‡½æ•°ï¼ˆPure-Functionï¼‰"><a href="#çº¯å‡½æ•°ï¼ˆPure-Functionï¼‰" class="headerlink" title="çº¯å‡½æ•°ï¼ˆPure Functionï¼‰"></a>çº¯å‡½æ•°ï¼ˆPure Functionï¼‰</h3><blockquote><p>ç®€å•è¯´ï¼Œ<strong>ä¸€ä¸ªå‡½æ•°çš„è¿”å›ç»“æœåªä¾èµ–äºä»–çš„å‚æ•°ï¼Œå¹¶ä¸”æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰å‰¯ä½œç”¨</strong>ï¼Œå°±æ˜¯çº¯å‡½æ•°</p></blockquote><p>ä»ä¸Šé¢çœ‹ï¼Œçº¯å‡½æ•°éœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>å‡½æ•°çš„è¿”å›ç»“æœåªä¾èµ–äºå®ƒçš„å‚æ•°</li><li>å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹æ²¡æœ‰å‰¯ä½œç”¨</li></ul><p>ç°åœ¨åˆ†åˆ«çœ‹ä¸€ä¸‹ä¸¤ä¸ªæ¡ä»¶</p><ol><li><p><strong>å‡½æ•°çš„è¿”å›ç»“æœåªä¾èµ–äºå®ƒçš„å‚æ•°</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">foo</span> = (<span class="hljs-params">b</span>) =&gt; a + b<br><span class="hljs-title function_">foo</span>(<span class="hljs-number">2</span>) <span class="hljs-comment">// =&gt; 3</span><br></code></pre></td></tr></table></figure><p><code>foo</code>å°±ä¸æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå› ä¸ºä»–çš„è¿”å›å€¼è¦ä¾èµ–å¤–éƒ¨å˜é‡<code>a</code>ï¼Œæˆ‘ä»¬ä¸çŸ¥é“<code>a</code>çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½ä¿è¯<code>foo(2)</code>çš„è¿”å›å€¼æ˜¯3ï¼Œå¦‚æœ<code>a</code>å˜åŒ–ï¼Œé‚£è¿”å›å€¼æ˜¯<strong>ä¸å¯é¢„æ–™</strong>çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">foo</span> = (<span class="hljs-params">x, b</span>) =&gt; x + b<br><span class="hljs-title function_">foo</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) <span class="hljs-comment">// =&gt; 3</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸€ä¸‹<code>foo</code>ï¼Œç°åœ¨å‡½æ•°çš„è¿”å›ç»“æœåªä¾èµ–äºä»–çš„å‚æ•°ï¼Œæ‰€ä»¥æ˜¯çº¯å‡½æ•°</p></li><li><p><strong>å‡½æ•°æ‰§è¡Œè¿‡ç¨‹æ²¡æœ‰å‰¯ä½œç”¨</strong></p></li></ol><p>å†ä¿®æ”¹ä¸€ä¸‹<code>foo</code></p>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">foo</span> = (<span class="hljs-params">obj, b</span>) =&gt; &#123;<br>  <span class="hljs-keyword">return</span> obj.<span class="hljs-property">x</span> + b<br>&#125;<br><span class="hljs-keyword">const</span> counter = &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">1</span> &#125;<br><span class="hljs-title function_">foo</span>(counter, <span class="hljs-number">2</span>) <span class="hljs-comment">// =&gt; 3</span><br>counter.<span class="hljs-property">x</span> <span class="hljs-comment">// =&gt; 1</span><br></code></pre></td></tr></table></figure><p>   æŠŠåŸæ¥çš„xå˜æˆäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å¾€é‡Œé¢ä¼ ä¸€ä¸ªå¯¹è±¡è¿›è¡Œè®¡ç®—ï¼Œè¿‡ç¨‹ä¸­ä¸ä¼šå¯¹ä¼ å…¥çš„å¯¹è±¡è¿›è¡Œæ›´æ”¹ï¼Œ<code>counter</code>ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥æ˜¯çº¯å‡½æ•°ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ç¨å¾®ä¿®æ”¹å®ƒä¸€ä¸‹ï¼š</p>   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">foo</span> = (<span class="hljs-params">obj, b</span>) =&gt; &#123;<br>  obj.<span class="hljs-property">x</span> = <span class="hljs-number">2</span><br>  <span class="hljs-keyword">return</span> obj.<span class="hljs-property">x</span> + b<br>&#125;<br><span class="hljs-keyword">const</span> counter = &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">1</span> &#125;<br><span class="hljs-title function_">foo</span>(counter, <span class="hljs-number">2</span>) <span class="hljs-comment">// =&gt; 4</span><br>counter.<span class="hljs-property">x</span> <span class="hljs-comment">// =&gt; 2</span><br></code></pre></td></tr></table></figure><p>   åœ¨<code>foo</code>å†…éƒ¨æ·»åŠ äº†ä¸€å¥<code>obj.x = 2</code>ï¼Œè®¡ç®—å‰<code>counter.x</code>æ˜¯1ï¼Œä½†æ˜¯è®¡ç®—ä»¥åçš„<code>counter.x</code>æ˜¯2ã€‚å‡½æ•°å†…çš„æ‰§è¡Œå¯¹å¤–éƒ¨äº§ç”Ÿäº†å½±å“ï¼Œä¹Ÿå«<strong>å‰¯ä½œç”¨</strong>ï¼Œæ‰€ä»¥ä¸æ˜¯çº¯å‡½æ•°</p><p>   åªè¦å‡½æ•°æ‰§è¡Œäº§ç”Ÿäº†<strong>å¤–éƒ¨å¯ä»¥è§‚å¯Ÿåˆ°çš„å˜åŒ–</strong>,å°±æ˜¯å‰¯ä½œç”¨ï¼Œåƒè°ƒç”¨DOM APIä¿®æ”¹é¡µé¢ï¼Œå‘é€AJAXè¯·æ±‚ï¼Œç”šè‡³<code>console.log</code>ä¹Ÿæ˜¯å‰¯ä½œç”¨</p><hr><h3 id="ä¼˜åŒ–å…±äº«ç»“æ„çš„å¯¹è±¡"><a href="#ä¼˜åŒ–å…±äº«ç»“æ„çš„å¯¹è±¡" class="headerlink" title="ä¼˜åŒ–å…±äº«ç»“æ„çš„å¯¹è±¡"></a>ä¼˜åŒ–å…±äº«ç»“æ„çš„å¯¹è±¡</h3><p>å…¶å®ä¹‹å‰çš„éƒ¨åˆ†å·²ç»å¯ä»¥ç®—æ˜¯ç®€å•å®ç°äº†ä¸€ä¸ªreduxï¼Œä½†æ˜¯å¦‚æœç»†å¿ƒå°±ä¼šå‘ç°ï¼Œä¹‹å‰çš„ç‰ˆæœ¬ä¸­æœ‰å¾ˆä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬è¯•ç€åœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°å¼€å¤´è¾“å‡ºä¸€äº›æ—¥å¿—çœ‹ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderApp</span> (appState) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render app...&#x27;</span>)<br>  <span class="hljs-title function_">renderTitle</span>(appState.<span class="hljs-property">title</span>)<br>  <span class="hljs-title function_">renderContent</span>(appState.<span class="hljs-property">content</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderTitle</span> (title) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render title...&#x27;</span>)<br>  <span class="hljs-keyword">const</span> titleDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;title&#x27;</span>)<br>  titleDOM.<span class="hljs-property">innerHTML</span> = title.<span class="hljs-property">text</span><br>  titleDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = title.<span class="hljs-property">color</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderContent</span> (content) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render content...&#x27;</span>)<br>  <span class="hljs-keyword">const</span> contentDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>)<br>  contentDOM.<span class="hljs-property">innerHTML</span> = content.<span class="hljs-property">text</span><br>  contentDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = content.<span class="hljs-property">color</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œä¸€æ¬¡åˆå§‹åŒ–æ¸²æŸ“å’Œä¸¤æ¬¡æ›´æ–°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(appState, stateChanger)<br>store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>())) <span class="hljs-comment">// ç›‘å¬æ•°æ®å˜åŒ–</span><br><br><span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>()) <span class="hljs-comment">// é¦–æ¬¡æ¸²æŸ“é¡µé¢</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜é¢œè‰²</span><br></code></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å¡”ç„ä¸€çœ¼å‘—ï¼š</p><p><img src="https://i.loli.net/2019/12/04/yVTaFHuE2KC4blI.png"></p><p>çœ‹å¾—å‡ºæ¥ä¸€ç»„ä¸‰ä¸ªrenderå‡½æ•°è¾“å‡ºäº†ä¸‰æ¬¡ï¼Œç¬¬ä¸€æ¬¡è‚¯å®šæ˜¯é¦–æ¬¡æ¸²æŸ“ï¼Œåè¾¹ä¸¤æ¬¡åˆ†åˆ«æ˜¯ä¸¤æ¬¡<code>store.dispatch</code>å¯¼è‡´çš„ã€‚å¯ä»¥çœ‹å‡ºæ¯æ¬¡æ›´æ–°æ•°æ®éƒ½è¦é‡æ–°æ¸²æŸ“æ•´ä¸ªAppï¼Œä½†æ˜¯æˆ‘ä»¬ä¸¤æ¬¡æ›´æ–°éƒ½åªæ˜¯æ›´æ–°äº†<code>title</code>å­—æ®µï¼Œå¹¶ä¸éœ€è¦é‡æ–°è°ƒç”¨<code>renderContent</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå†—ä½™çš„æ“ä½œï¼Œç°åœ¨éœ€è¦ä¼˜åŒ–å®ƒ</p><p>æå‡ºä¸€ç§è§£å†³æ–¹æ³•ï¼ˆä½†ä¸é™äºä¸€ç§ï¼‰ï¼Œåœ¨æ¯ä¸ªæ¸²æŸ“å‡½æ•°è°ƒç”¨ä¹‹å‰åˆ¤æ–­ä¸€ä¸‹ä¼ å…¥çš„æ•°æ®å’Œæ—§æ•°æ®æ˜¯å¦ç›¸åŒï¼Œç›¸åŒå°±ä¸è°ƒç”¨äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderApp</span> (newAppState, oldAppState = &#123;&#125;) &#123; <span class="hljs-comment">// é˜²æ­¢ oldAppState æ²¡æœ‰ä¼ å…¥ï¼Œæ‰€ä»¥åŠ äº†é»˜è®¤å‚æ•° oldAppState = &#123;&#125;</span><br>  <span class="hljs-keyword">if</span> (newAppState === oldAppState) <span class="hljs-keyword">return</span> <span class="hljs-comment">// æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render app...&#x27;</span>)<br>  <span class="hljs-title function_">renderTitle</span>(newAppState.<span class="hljs-property">title</span>, oldAppState.<span class="hljs-property">title</span>)<br>  <span class="hljs-title function_">renderContent</span>(newAppState.<span class="hljs-property">content</span>, oldAppState.<span class="hljs-property">content</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderTitle</span> (newTitle, oldTitle = &#123;&#125;) &#123;<br>  <span class="hljs-keyword">if</span> (newTitle === oldTitle) <span class="hljs-keyword">return</span> <span class="hljs-comment">// æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render title...&#x27;</span>)<br>  <span class="hljs-keyword">const</span> titleDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;title&#x27;</span>)<br>  titleDOM.<span class="hljs-property">innerHTML</span> = newTitle.<span class="hljs-property">text</span><br>  titleDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = newTitle.<span class="hljs-property">color</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderContent</span> (newContent, oldContent = &#123;&#125;) &#123;<br>  <span class="hljs-keyword">if</span> (newContent === oldContent) <span class="hljs-keyword">return</span> <span class="hljs-comment">// æ•°æ®æ²¡æœ‰å˜åŒ–å°±ä¸æ¸²æŸ“äº†</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;render content...&#x27;</span>)<br>  <span class="hljs-keyword">const</span> contentDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>)<br>  contentDOM.<span class="hljs-property">innerHTML</span> = newContent.<span class="hljs-property">text</span><br>  contentDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = newContent.<span class="hljs-property">color</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åç”¨ä¸€ä¸ª<code>oldState</code> æ¥ä¿å­˜æ—§çš„åº”ç”¨çŠ¶æ€ï¼Œåœ¨éœ€è¦é‡æ–°æ¸²æŸ“çš„åœ°æ–¹æŠŠæ–°æ—§æ•°æ®ä¼ è¿›å»ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(appState, stateChanger)<br><span class="hljs-keyword">let</span> oldState = store.<span class="hljs-title function_">getState</span>() <span class="hljs-comment">// ç¼“å­˜æ—§çš„ state</span><br>store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> newState = store.<span class="hljs-title function_">getState</span>() <span class="hljs-comment">// æ•°æ®å¯èƒ½å˜åŒ–ï¼Œè·å–æ–°çš„ state</span><br>  <span class="hljs-title function_">renderApp</span>(newState, oldState) <span class="hljs-comment">// æŠŠæ–°æ—§çš„ state ä¼ è¿›å»æ¸²æŸ“</span><br>  oldState = newState <span class="hljs-comment">// æ¸²æŸ“å®Œä»¥åï¼Œæ–°çš„ newState å˜æˆäº†æ—§çš„ oldStateï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æ•°æ®å˜åŒ–é‡æ–°æ¸²æŸ“</span><br>&#125;)<br>...<br></code></pre></td></tr></table></figure><p>å¯åˆ«ä»¥ä¸ºè¿™æ ·å°±å¥½äº†â€¦â€¦ï¼Œçœ‹çœ‹<code>stateChanger</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">stateChanger</span> (state, action) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      state.<span class="hljs-property">title</span>.<span class="hljs-property">text</span> = action.<span class="hljs-property">text</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      state.<span class="hljs-property">title</span>.<span class="hljs-property">color</span> = action.<span class="hljs-property">color</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">break</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å³ä½¿ä¿®æ”¹äº†<code>state.title.text</code>ï¼Œä½†æ˜¯<code>state</code>è¿˜æ˜¯åŸæ¥é‚£ä¸ª<code>state</code>ï¼Œä¸€åˆ‡éƒ½æ˜¯ä»¥å‰çš„ä¸€åˆ‡ï¼Œè¿™äº›å¼•ç”¨æŒ‡å‘çš„è¿˜æ˜¯äºè°¦çš„å¯¹è±¡ï¼Œåªæ˜¯å†…å®¹æ”¹å˜äº†è€Œå·²ï¼Œå°±åƒä¸‹è¾¹è¿™ä¸ªè¯­å¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> obj = &#123;<br><span class="hljs-attr">x</span>: <span class="hljs-number">0</span><br>&#125;<br><span class="hljs-keyword">let</span> obj2 = obj<br>obj2.<span class="hljs-property">x</span> = <span class="hljs-number">1</span><br>obj !== obj2 <span class="hljs-comment">// false ,ä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡,æ€ä¹ˆä¼šä¸ç›¸ç­‰ï¼Ÿ</span><br></code></pre></td></tr></table></figure><p>æƒ³è®©ä¸¤è€…æˆä¸ºä¸¤ä¸ªå®Œå…¨ä¸åŒçš„å¯¹è±¡ï¼Œå°±å¾—ä½¿ç”¨ES6çš„è¯­æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> obj = &#123;<span class="hljs-attr">a</span>:<span class="hljs-number">1</span>&#125;<br><span class="hljs-keyword">const</span> obj2 = &#123;...obj&#125;<br></code></pre></td></tr></table></figure><p>æ”¾åˆ°ä¾‹å­ä¸­å°±æ˜¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> newAppState = &#123; <span class="hljs-comment">// æ–°å»ºä¸€ä¸ª newAppState</span><br>  ...appState, <span class="hljs-comment">// å¤åˆ¶ appState é‡Œé¢çš„å†…å®¹</span><br>  <span class="hljs-attr">title</span>: &#123; <span class="hljs-comment">// ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–åŸæ¥çš„ title å±æ€§</span><br>    ...appState.<span class="hljs-property">title</span>, <span class="hljs-comment">// å¤åˆ¶åŸæ¥ title å¯¹è±¡é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;new text&#x27;</span> <span class="hljs-comment">// è¦†ç›– text å±æ€§</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”¨ä¸€ä¸ªå›¾æ¥è¡¨ç¤ºå¯¹è±¡ç»“æ„</p><p><img src="https://i.loli.net/2019/12/04/IEWhwaOTZlSpvN8.png"></p><p><code>appState</code>å’Œ<code>newAppState</code>æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œå› ä¸ºæµ…å¤åˆ¶æ‰€ä»¥ä¸¤ä¸ªå¯¹è±¡çš„<code>content</code>æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä½†æ˜¯<code>title</code>è¢«ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–ï¼Œæ‰€ä»¥æŒ‡å‘ä¸åŒï¼ŒåŒæ ·çš„å¯ä¿®æ”¹<code>appState.title.color</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> newAppState1 = &#123; <span class="hljs-comment">// æ–°å»ºä¸€ä¸ª newAppState1</span><br>  ...newAppState, <span class="hljs-comment">// å¤åˆ¶ newAppState1 é‡Œé¢çš„å†…å®¹</span><br>  <span class="hljs-attr">title</span>: &#123; <span class="hljs-comment">// ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡è¦†ç›–åŸæ¥çš„ title å±æ€§</span><br>    ...newAppState.<span class="hljs-property">title</span>, <span class="hljs-comment">// å¤åˆ¶åŸæ¥ title å¯¹è±¡é‡Œé¢çš„å†…å®¹</span><br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&quot;blue&quot;</span> <span class="hljs-comment">// è¦†ç›– color å±æ€§</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/12/04/e6KNOS8A5ipxVvk.png"></p><p>è¿™æ ·æ¯æ¬¡æˆ‘ä»¬ä¿®æ”¹æŸäº›æ•°æ®çš„æ—¶å€™ï¼Œéƒ½ä¸ä¼šç¢°åŸæ¥çš„æ•°æ®ï¼Œæ¯æ¬¡éƒ½æ˜¯copyçš„ä¸€ä¸ªæ–°å¯¹è±¡ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ä¿®æ”¹<code>stateChanger</code>ä¸­çš„ä»£ç ï¼Œè®©ä»–äº§ç”Ÿä¸Šè¿°å…±äº«ç»“æ„çš„å¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">stateChanger</span> (state, action) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123; <span class="hljs-comment">// æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›</span><br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">text</span>: action.<span class="hljs-property">text</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      <span class="hljs-keyword">return</span> &#123; <span class="hljs-comment">// æ„å»ºæ–°çš„å¯¹è±¡å¹¶ä¸”è¿”å›</span><br>        ...state,<br>        <span class="hljs-attr">title</span>: &#123;<br>          ...state.<span class="hljs-property">title</span>,<br>          <span class="hljs-attr">color</span>: action.<span class="hljs-property">color</span><br>        &#125;<br>      &#125;<br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">return</span> state <span class="hljs-comment">// æ²¡æœ‰ä¿®æ”¹ï¼Œè¿”å›åŸæ¥çš„å¯¹è±¡</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (state, stateChanger) &#123;<br>  <span class="hljs-keyword">const</span> listeners = []<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">subscribe</span> = (<span class="hljs-params">listener</span>) =&gt; listeners.<span class="hljs-title function_">push</span>(listener)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; &#123;<br>    state = <span class="hljs-title function_">stateChanger</span>(state, action) <span class="hljs-comment">// è¦†ç›–åŸå¯¹è±¡</span><br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch, subscribe &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨å†çœ‹ä¸€çœ¼æ§åˆ¶å°ï¼š</p><p><img src="https://i.loli.net/2019/12/04/CE9rWDcVh7fS1vA.png"></p><p>è¿™æ ·æˆ‘ä»¬å°±èƒ½é¿å…ä¸éœ€è¦çš„æ¸²æŸ“äº†ï¼è¿‡ä¸¤å¤©å†å¾€ä¸‹èµ°â€¦â€¦</p><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç°MyReduxï¼ˆä¸€ï¼‰</title>
    <link href="/2019/12/03/2019-12-03-Redux%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2019/12/03/2019-12-03-Redux%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h3 id="è¯´åœ¨å‰é¢"><a href="#è¯´åœ¨å‰é¢" class="headerlink" title="è¯´åœ¨å‰é¢"></a>è¯´åœ¨å‰é¢</h3><p>ä¸ºäº†å­¦ä¹ <code>redux</code>ï¼Œä»…ä»…å®ç°äº†<code>store</code>,<code>createStore</code>,<code>reducer</code>ç­‰éƒ¨åˆ†åŸºæœ¬åŠŸèƒ½</p><hr><h3 id="ç°åœ¨å¼€å§‹å¿˜æ‰ä¸€åˆ‡"><a href="#ç°åœ¨å¼€å§‹å¿˜æ‰ä¸€åˆ‡" class="headerlink" title="ç°åœ¨å¼€å§‹å¿˜æ‰ä¸€åˆ‡"></a>ç°åœ¨å¼€å§‹å¿˜æ‰ä¸€åˆ‡</h3><p>é¦–å…ˆç”¨create-react-appæ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä¿®æ”¹<code>public/index.html</code>ä¸‹çš„é¡µé¢ç»“æ„</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;title&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;content&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¸…ç©º<code>src</code>æ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ª<code>index.js</code>ï¼Œæ·»åŠ ä»£ç ä»£è¡¨æˆ‘ä»¬è¦åº”ç”¨çš„çŠ¶æ€ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> appState = &#123;<br>  <span class="hljs-attr">title</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;Redux&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span>,<br>  &#125;,<br>  <span class="hljs-attr">content</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;å­¦ä¹ redux&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ·»åŠ æ¸²æŸ“å‡½æ•°ï¼Œä¼šæŠŠä¸Šé¢çš„çŠ¶æ€æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderApp</span> (appState) &#123;<br>  <span class="hljs-title function_">renderTitle</span>(appState.<span class="hljs-property">title</span>)<br>  <span class="hljs-title function_">renderContent</span>(appState.<span class="hljs-property">content</span>)<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderTitle</span> (title) &#123;<br>  <span class="hljs-keyword">const</span> titleDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;title&#x27;</span>)<br>  titleDOM.<span class="hljs-property">innerHTML</span> = title.<span class="hljs-property">text</span><br>  titleDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = title.<span class="hljs-property">color</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderContent</span> (content) &#123;<br>  <span class="hljs-keyword">const</span> contentDOM = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;content&#x27;</span>)<br>  contentDOM.<span class="hljs-property">innerHTML</span> = content.<span class="hljs-property">text</span><br>  contentDOM.<span class="hljs-property">style</span>.<span class="hljs-property">color</span> = content.<span class="hljs-property">color</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç®€å•çš„æ¸²æŸ“å®Œæˆäº†ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œæ¸²æŸ“æ•°æ®ä½¿ç”¨çš„æ˜¯å…±äº«çš„çŠ¶æ€<code>appState</code>,<strong>ä»»ä½•äººéƒ½èƒ½ä¿®æ”¹</strong>ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ¸²æŸ“ä¹‹å‰åšäº†å…¶ä»–å‡½æ•°æ“ä½œï¼Œå°±æ— æ³•æ™ºå¤§ä¸œä¼šå¯¹<code>appState</code>åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¦é¿å…å…¨å±€å˜é‡</p><p>å½“æˆ‘ä»¬çš„ä¸åŒç»„ä»¶ä¹‹é—´éœ€è¦å…±äº«æ•°æ®ï¼Œå°±ä¼šäº§ç”ŸçŸ›ç›¾ï¼š</p><blockquote><p>ç»„ä»¶ä¹‹é—´å…±äº«æ•°æ® â—â— æ•°æ®å¯èƒ½åœ¨ç»„ä»¶å†…è¢«ä»»æ„ä¿®æ”¹</p></blockquote><p>å¦‚æœæˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹Reactå›¢é˜Ÿçš„åšæ³•ï¼ŒæŠŠæ“ä½œå˜å¤æ‚</p><blockquote><p>â€‹    ç»„ä»¶ä¹‹é—´å¯ä»¥å…±äº«ã€æ”¹åŠ¨æ•°æ®ä½†æ˜¯ä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œå¿…é¡»æ‰§è¡Œæˆ‘å®šä¹‰çš„æŸäº›å‡½æ•°</p></blockquote><p>å®šä¹‰ä¸€ä¸ª<code>dispatch</code>å‡½æ•° ï¼Œ è´Ÿè´£æ•°æ®ä¿®æ”¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatch</span> (action) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      appState.<span class="hljs-property">title</span>.<span class="hljs-property">text</span> = action.<span class="hljs-property">text</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      appState.<span class="hljs-property">title</span>.<span class="hljs-property">color</span> = action.<span class="hljs-property">color</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">break</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å¯¹æ•°æ®çš„æ“ä½œå¿…é¡» é€šè¿‡<code>dispatch</code>å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªå‚æ•°<code>action</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ª<code>type</code>å­—æ®µæ¥ç”Ÿå‘½ä½ æƒ³å¹²ä»€ä¹ˆï¼Œ<code>dispatch</code>å†…çš„<code>switch</code>ä¼šè¯†åˆ«è¿™ä¸ªå­—æ®µï¼Œè¯†åˆ«æˆåŠŸçš„ä¼šå¯¹<code>appState</code>è¿›è¡Œä¿®æ”¹</p><p>ä¸Šé¢çš„ <code>dispatch</code> å®ƒåªèƒ½è¯†åˆ«ä¸¤ç§æ“ä½œï¼Œä¸€ç§æ˜¯ <code>UPDATE_TITLE_TEXT</code> å®ƒä¼šç”¨ <code>action</code> çš„ <code>text</code> å­—æ®µå»æ›´æ–° <code>appState.title.text</code>ï¼›ä¸€ç§æ˜¯ <code>UPDATE_TITLE_COLOR</code>ï¼Œå®ƒä¼šç”¨ <code>action</code> çš„ <code>color</code> å­—æ®µå»æ›´æ–° <code>appState.title.color</code>ã€‚<code>action</code> é‡Œé¢é™¤äº† <code>type</code> å­—æ®µæ˜¯å¿…é¡»çš„ä»¥å¤–ï¼Œå…¶ä»–å­—æ®µéƒ½æ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚</p><p>å¦‚æœæƒ³è¦ä¿®æ”¹<code>appState.title.text</code>ï¼Œå¿…é¡»è°ƒç”¨<code>dispatch</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬</span><br><span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜é¢œè‰²</span><br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¸ç”¨çš„æ‹…å¿ƒåˆ«çš„å‡½æ•°ä¼šä¿®æ”¹appStateï¼Œè‡³å°‘æ˜¯ç›´æ¥ä¿®æ”¹</p><p>åŸæ¥ï¼š</p><p><img src="https://i.loli.net/2019/12/03/fCxTNHJ1Sea9jZ2.png"></p><p>ç°åœ¨æ‰€æœ‰çš„æ•°æ®æƒ³ä¿®æ”¹å¿…é¡»ç»è¿‡<code>dispatch</code>ï¼š</p><p><img src="https://i.loli.net/2019/12/03/HgCwc7sunDxYeKr.png"></p><hr><h3 id="æŠ½ç¦»å‡ºstore"><a href="#æŠ½ç¦»å‡ºstore" class="headerlink" title="æŠ½ç¦»å‡ºstore"></a>æŠ½ç¦»å‡º<code>store</code></h3><p>ç°åœ¨æœ‰äº†<code>appState</code>å’Œ<code>dispatch</code>,å¯ä»¥æŠŠä»–ä»¬é›†ä¸­åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œèµ·åå«åš<code>store</code>,ç„¶åæ„å»ºä¸€ä¸ª<code>createStore()</code>å‡½æ•°ï¼Œç”¨æ¥ç”Ÿäº§è¿™ç§<code>state</code>å’Œ<code>dispatch</code>çš„é›†åˆ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (state, stateChanger) &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; <span class="hljs-title function_">stateChanger</span>(state, action)<br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>createStore</code>æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¡¨ç¤ºçŠ¶æ€çš„<code>state</code>ï¼Œå¦ä¸€ä¸ªæ˜¯<code>stateChanger</code>ï¼Œå®ƒç”¨æ¥æè¿°åº”ç”¨ç¨‹åºçŠ¶æ€ä¼šæ ¹æ®<code>action</code>å‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Œç›¸å½“äº<code>dispatch</code></p><p><code>createStore</code>è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼Œ<code>getState</code>ç”¨äºè·å–<code>state</code>çš„æ•°æ®ï¼Œ<code>dispatch</code>ç”¨äºä¿®æ”¹æ•°æ®ï¼Œå’Œä»¥å‰ä¸€æ ·</p><p>ç°åœ¨æˆ‘çš„ä»£ç å¯ä»¥ä¼˜åŒ–æˆï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript">et appState = &#123;<br>  <span class="hljs-attr">title</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span>,<br>  &#125;,<br>  <span class="hljs-attr">content</span>: &#123;<br>    <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js å†…å®¹&#x27;</span>,<br>    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">stateChanger</span> (state, action) &#123;<br>  <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>:<br>      state.<span class="hljs-property">title</span>.<span class="hljs-property">text</span> = action.<span class="hljs-property">text</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>:<br>      state.<span class="hljs-property">title</span>.<span class="hljs-property">color</span> = action.<span class="hljs-property">color</span><br>      <span class="hljs-keyword">break</span><br>    <span class="hljs-attr">default</span>:<br>      <span class="hljs-keyword">break</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(appState, stateChanger)<br><br><span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>()) <span class="hljs-comment">// é¦–æ¬¡æ¸²æŸ“é¡µé¢</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜é¢œè‰²</span><br><span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>()) <span class="hljs-comment">// æŠŠæ–°çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Š</span><br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±æœ‰ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œæ€ä¹ˆç›‘æ§æ•°æ®çš„å˜åŒ–ï¼Œä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸è°ƒç”¨<code>renderApp</code>ï¼Œé‚£é¡µé¢çš„å†…å®¹æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œå¦‚æœå¾€<code>dispatch</code>ä¸­åŠ å…¥<code>renderApp</code>ï¼Œé‚£æˆ‘ä»¬æƒ³é€šç”¨<code>createStore</code>å°±ä¸è¡Œäº†ï¼Œæƒ³ç”¨ä¸€ç§é€šç”¨çš„æ–¹å¼ç›‘å¬æ•°æ®ï¼Œéœ€è¦ç”¨åˆ°è§‚å¯Ÿè€…æ¨¡å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span> (state, stateChanger) &#123;<br>  <span class="hljs-keyword">const</span> listeners = []<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">subscribe</span> = (<span class="hljs-params">listener</span>) =&gt; listeners.<span class="hljs-title function_">push</span>(listener)<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">getState</span> = (<span class="hljs-params"></span>) =&gt; state<br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">dispatch</span> = (<span class="hljs-params">action</span>) =&gt; &#123;<br>    <span class="hljs-title function_">stateChanger</span>(state, action)<br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br>  <span class="hljs-keyword">return</span> &#123; getState, dispatch, subscribe &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨æ–¹æ³•ä¸­å®šä¹‰äº†ä¸€ä¸ªæ•°ç»„ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>subscribe</code>æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•ä¼ å…¥ä¸€ä¸ªç›‘å¬å‡½æ•°ï¼Œå¹¶<code>push</code>åˆ°æ•°ç»„ä¸­ï¼Œä¿®æ”¹äº†<code>dispatch</code>æ–¹æ³•ï¼Œå½“å®ƒè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šéå†æ•°ç»„ä¸­çš„å‡½æ•°ï¼Œä¸€ä¸ªä¸ªçš„è°ƒç”¨ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>subscribe</code>ä¼ å…¥æ•°æ®å˜åŒ–çš„ç›‘å¬å‡½æ•°ï¼Œæ¯æ¬¡<code>dispatch</code>çš„æ—¶å€™ï¼Œç›‘å¬å‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(appState, stateChanger)<br>store.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>()))<br><br><span class="hljs-title function_">renderApp</span>(store.<span class="hljs-title function_">getState</span>()) <span class="hljs-comment">// é¦–æ¬¡æ¸²æŸ“é¡µé¢</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_TEXT&#x27;</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;React.js&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜æ–‡æœ¬</span><br>store.<span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;UPDATE_TITLE_COLOR&#x27;</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;blue&#x27;</span> &#125;) <span class="hljs-comment">// ä¿®æ”¹æ ‡é¢˜é¢œè‰²</span><br><span class="hljs-comment">// ...åé¢ä¸ç®¡å¦‚ä½• store.dispatchï¼Œéƒ½ä¸éœ€è¦é‡æ–°è°ƒç”¨ renderApp</span><br></code></pre></td></tr></table></figure><p>åªéœ€è¦<code>subscribe</code>ä¸€æ¬¡ï¼Œåé¢ä¸ç®¡æ€ä¹ˆ<code>dispatch</code>ï¼Œ<code>renderApp</code>éƒ½ä¼šè¢«é‡æ–°è°ƒç”¨ï¼Œé‡æ–°æ¸²æŸ“é¡µé¢ï¼Œè€Œä¸”è§‚å¯Ÿè€…æ¨¡å¼ä¸‹åŒä¸€å—æ•°æ®ä¹Ÿå¯ä»¥æ¸²æŸ“å…¶ä»–é¡µé¢ã€‚</p><p><strong>é˜¶æ®µæ€»ç»“</strong></p><p>ç°åœ¨æœ‰äº†é€šç”¨çš„<code>createStore</code>ï¼Œå¯ä»¥äº§ç”Ÿä¸€ç§æ–°å®šä¹‰çš„æ•°æ®ç±»å‹<code>store</code>ï¼Œé€šè¿‡<code>getState</code>è·å–çŠ¶æ€ï¼Œ<code>dispatch</code>ä¿®æ”¹çŠ¶æ€ï¼Œ<code>subscribe</code>ç›‘å¬æ•°æ®â€¦â€¦</p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Reactè¸©å‘äº†</title>
    <link href="/2019/11/27/2019-11-27-React%E8%B8%A9%E5%9D%91%EF%BC%81/"/>
    <url>/2019/11/27/2019-11-27-React%E8%B8%A9%E5%9D%91%EF%BC%81/</url>
    
    <content type="html"><![CDATA[<h4 id="èµ·æ­¥å°±è¸©å‘"><a href="#èµ·æ­¥å°±è¸©å‘" class="headerlink" title="èµ·æ­¥å°±è¸©å‘"></a>èµ·æ­¥å°±è¸©å‘</h4><p>å¯ç»™æˆ‘ç‰›é€¼åäº†</p><p>ä¸Šæ¥åœ¨å…¥å£æ–‡ä»¶index.jsé‡Œå†™äº†ä¸€æ®µrender()ä»£ç ï¼Œç„¶åçœ‹åˆ°äº†ç¾ä¸½çš„çº¢è‰²:ï¼‰</p><p><img src="https://i.loli.net/2019/11/27/6GPcURBpEs1Foxj.png">{:width=â€600pxâ€ height=â€380pxâ€}</p><p>ç–¯ç‹‚ç™¾åº¦ï¼Œæœ€åè‡ªå·±å‘ç°äº†â€¦â€¦å¾—æŠŠè¯­è¨€çš„ç±»å‹æ”¹ä¸€ä¸‹</p><p><img src="https://i.loli.net/2019/11/27/dwBa3SN7crLPWZ5.png">{:width=â€600pxâ€ height=â€380pxâ€}</p><p>å¥½äº†â€¦â€¦</p><hr><h4 id="å…³äºthis"><a href="#å…³äºthis" class="headerlink" title="å…³äºthis"></a>å…³äºthis</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs react">class Title extends Component &#123;<br>  handleClickOnTitle (e) &#123;<br>    console.log(e.target.innerHTML)<br>  &#125;<br><br>  render () &#123;<br>    return (<br>      &lt;h1 onClick=&#123;this.handleClickOnTitle&#125;&gt;React å°ä¹¦&lt;/h1&gt;<br>    )<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬åœ¨ç±»çš„å®ä¾‹æ–¹æ³•é‡Œçš„<code>this</code>æŒ‡çš„æ˜¯å®ä¾‹æœ¬èº«ï¼Œä½†æ˜¯ä½ åœ¨ä¸Šé¢çš„<code>handleClickOnTitle</code>ä¸­æŠŠ<code>this</code>æ‰“å°å‡ºæ¥ï¼Œä¼šå‘ç°<code>this</code>æ˜¯<code>null</code>æˆ–è€…<code>undefined</code></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs react">â€¦â€¦<br>  handleClickOnTitle(e) &#123;<br>    console.log(this) // --&gt; null or undefined<br>  &#125;<br>â€¦â€¦<br></code></pre></td></tr></table></figure><p>reactä¸­è°ƒç”¨ä½ ä¼ ç»™ä»–çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¸æ˜¯é€šè¿‡<strong>å¯¹è±¡æ–¹æ³•</strong>çš„æ–¹å¼è°ƒç”¨<code>(this.handleClickOnTitle)</code>,è€Œæ˜¯é€šè¿‡å‡½æ•°è°ƒç”¨ï¼Œæ‰€ä»¥äº‹ä»¶ç›‘å¬å‡½æ•°å†…å¹¶ä¸èƒ½é€šè¿‡<code>this</code>è·å–åˆ°å®ä¾‹</p><p>å¦‚æœè¦åœ¨äº‹ä»¶å‡½æ•°ä¸­ä½¿ç”¨å½“å‰å®ä¾‹ï¼Œå¯ä»¥ç”¨<code>Bind</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs react">class Title extends Component &#123;<br>  handleClickOnTitle (e) &#123;<br>    console.log(this)<br>  &#125;<br><br>  render () &#123;<br>    return (<br>      &lt;h1 onClick=&#123;this.handleClickOnTitle.bind(this)&#125;&gt;React å°ä¹¦&lt;/h1&gt;<br>    )<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h4 id="å…³äºprops-children"><a href="#å…³äºprops-children" class="headerlink" title="å…³äºprops.children"></a>å…³äº<code>props.children</code></h4><p>reactä¸­å®¹å™¨ç±»ç»„ä»¶å’Œ<code>props.children</code>å¾ˆå¤šæ—¶å€™èƒ½è§£å†³å¾ˆå¤šé—®é¢˜</p><p>æœ‰éœ€æ±‚ç±»ä¼¼<img src="https://i.loli.net/2019/12/02/SOmZUCvir8b4gNq.png"></p><p>æ­£å¸¸å†™æ˜¯å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs react">class Card extends Component &#123;<br>  render () &#123;<br>    return (<br>      &lt;div className=&#x27;card&#x27;&gt;<br>        &lt;div className=&#x27;card-content&#x27;&gt;<br>          &#123;this.props.content&#125;<br>        &lt;/div&gt;<br>      &lt;/div&gt;<br>    )<br>  &#125;<br>&#125;<br><br>ReactDOM.render(<br>  &lt;Card content=&#123;<br>    &lt;div&gt;<br>      &lt;h2&gt;React.js å°ä¹¦&lt;/h2&gt;<br>       &lt;div&gt;å¼€æºã€å…è´¹ã€ä¸“ä¸šã€ç®€å•&lt;/div&gt;<br>      è®¢é˜…ï¼š&lt;input /&gt;<br>    &lt;/div&gt;<br>  &#125; /&gt;,<br>  document.getElementById(&#x27;root&#x27;)<br>)<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·å¾ˆä¹±è€Œä¸”ä¸å¥½ç»´æŠ¤ï¼Œå¦‚æœcardèƒ½å˜æˆä¸‹é¢è¿™æ ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs react">ReactDOM.render(<br>  &lt;Card&gt;<br>    &lt;h2&gt;React.js å°ä¹¦&lt;/h2&gt;<br>    &lt;div&gt;å¼€æºã€å…è´¹ã€ä¸“ä¸šã€ç®€å•&lt;/div&gt;<br>    è®¢é˜…ï¼š&lt;input /&gt;<br>  &lt;/Card&gt;,<br>  document.getElementById(&#x27;root&#x27;)<br>)<br></code></pre></td></tr></table></figure><p>å¦‚æœç»„ä»¶æ ‡ç­¾èƒ½åƒhtmlä¸€æ ·å†™å†…åµŒçš„ç»“æ„â€¦â€¦ï¼Ÿæ˜¯å§</p><p>reactæä¾›äº†<code>props.children</code>æ¥å®ç°è¿™ç§æƒ³æ³•ï¼Œæˆ‘ä»¬æ‰“å°ä¸€ä¸‹<code>props.children</code>ä¼šå‘ç°ä»–å…¶å®æ˜¯ä¸€ä¸ªæ•°ç»„</p><p><img src="https://i.loli.net/2019/12/02/69IsZhDwC5ktiQl.png"></p><p>reactå°±æ˜¯æŠŠæˆ‘ä»¬åµŒå¥—çš„JSXå…ƒç´ ä¸€ä¸ªä¸ªæ”¾åˆ°æ•°ç»„ä¸­ï¼Œç„¶åé€šè¿‡è¿™ä¸ªæ–¹æ³•ä¼ ç»™<code>Card</code></p><p>ç”±äº JSX ä¼šæŠŠæ’å…¥è¡¨è¾¾å¼é‡Œé¢æ•°ç»„ä¸­çš„ JSX ä¸€ä¸ªä¸ªç½—åˆ—ä¸‹æ¥æ˜¾ç¤ºã€‚æ‰€ä»¥å…¶å®å°±ç›¸å½“äºåœ¨ <code>Card</code> ä¸­åµŒå¥—äº†ä»€ä¹ˆ JSX ç»“æ„ï¼Œéƒ½ä¼šæ˜¾ç¤ºåœ¨ <code>Card</code> çš„ç±»åä¸º <code>card-content</code> çš„ <code>div</code> å…ƒç´ å½“ä¸­ã€‚</p><p>è¿™ç§åµŒå¥—çš„å†…å®¹æˆä¸ºäº† <code>props.children</code> æ•°ç»„çš„æœºåˆ¶ä½¿å¾—æˆ‘ä»¬ç¼–å†™ç»„ä»¶å˜å¾—éå¸¸çš„çµæ´»ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥åœ¨ç»„ä»¶å†…éƒ¨æŠŠæ•°ç»„ä¸­çš„ JSX å…ƒç´ å®‰ç½®åœ¨ä¸åŒçš„åœ°æ–¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs react">class Layout extends Component &#123;<br>  render () &#123;<br>    return (<br>      &lt;div className=&#x27;two-cols-layout&#x27;&gt;<br>        &lt;div className=&#x27;sidebar&#x27;&gt;<br>          &#123;this.props.children[0]&#125; &lt;!--&gt;h2&lt;--&gt;<br>        &lt;/div&gt;<br>        &lt;div className=&#x27;main&#x27;&gt;<br>          &#123;this.props.children[1]&#125; &lt;!--&gt;div&lt;--&gt;<br>        &lt;/div&gt;<br>      &lt;/div&gt;<br>    )<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vueéƒ¨åˆ†æ•´ç†</title>
    <link href="/2019/11/20/2019-11-20-Vue%E9%83%A8%E5%88%86%E6%95%B4%E7%90%86/"/>
    <url>/2019/11/20/2019-11-20-Vue%E9%83%A8%E5%88%86%E6%95%B4%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="Vueç”Ÿå‘½å‘¨æœŸ"><a href="#Vueç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Vueç”Ÿå‘½å‘¨æœŸ"></a>Vueç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://i.loli.net/2019/11/20/4mQWXF6GJA8Uv1k.png">{:width=â€624.5pxâ€ height=â€699.5pxâ€}</p><h3 id="çˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ"><a href="#çˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ" class="headerlink" title="çˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ"></a>çˆ¶ç»„ä»¶ç›‘å¬å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Ÿ</h3><p>ä¸¤ç§æ–¹æ³•ï¼Œæœ€ç®€å•åŸºæœ¬çš„æ˜¯å­ç»„ä»¶åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­é€šè¿‡<code>this.$emit(&#39;foo&#39;)</code>æ¥æ¿€æ´»çˆ¶ç»„ä»¶çš„å‡½æ•°æ–¹æ³•<code>@foo=&#39;doSomeThing&#39;</code>ï¼Œå¦ä¸€ç§æ–¹æ³•ï¼Œåˆ©ç”¨<code>@hook:name</code>æ¥ç›‘å¬ç¬¬ä¸‰æ–¹ç»„ä»¶çš„çŠ¶æ€</p><h3 id="ç»„ä»¶ä¸­çš„çš„dataä¸ºä»€ä¹ˆæ˜¯å‡½æ•°"><a href="#ç»„ä»¶ä¸­çš„çš„dataä¸ºä»€ä¹ˆæ˜¯å‡½æ•°" class="headerlink" title="ç»„ä»¶ä¸­çš„çš„dataä¸ºä»€ä¹ˆæ˜¯å‡½æ•°"></a>ç»„ä»¶ä¸­çš„çš„dataä¸ºä»€ä¹ˆæ˜¯å‡½æ•°</h3><blockquote><p>ä¸ºä»€ä¹ˆç»„ä»¶ä¸­çš„ data å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç„¶å return ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ new Vue å®ä¾‹é‡Œï¼Œdata å¯ä»¥ç›´æ¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Ÿ </p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// data</span><br><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> &#123;<br><span class="hljs-attr">message</span>: <span class="hljs-string">&quot;å­ç»„ä»¶&quot;</span>,<br><span class="hljs-attr">childName</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span><br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// new Vue</span><br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>  <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#app&#x27;</span>,<br>  router,<br>  <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;&lt;App/&gt;&#x27;</span>,<br>  <span class="hljs-attr">components</span>: &#123;<span class="hljs-title class_">App</span>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>ç»„ä»¶æ˜¯ç”¨æ¥<strong>å¤ç”¨</strong>çš„ï¼Œå¹¶ä¸”JSé‡Œçš„å¯¹è±¡æ˜¯å¼•ç”¨å…³ç³»ï¼Œå¦‚æœç»„ä»¶ä¸­çš„dataæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä½œç”¨åŸŸæ²¡æœ‰éš”ç¦»ï¼Œå­ç»„ä»¶ä¸­çš„dataå±æ€§ä¼šäº’ç›¸å½±å“ï¼Œè€Œä½¿ç”¨å‡½æ•°åˆ™æ¯ä¸ªå®ä¾‹éƒ½å¯ä»¥ç»´æŠ¤ä¸€ä»½è¢«è¿”å›å¯¹è±¡çš„ç‹¬ç«‹æ‹·è´ï¼Œç»„ä»¶ä¹‹é—´çš„dataå±æ€§ä¸ä¼šç›¸äº’å½±å“ï¼Œè€Œ<code>new Vue</code>çš„å®ä¾‹æ˜¯<strong>ä¸ä¼šè¢«å¤ç”¨çš„</strong>ï¼Œä¸å­˜åœ¨å¼•ç”¨é—®é¢˜ã€‚</p><h3 id="Vueç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼"><a href="#Vueç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼" class="headerlink" title="Vueç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼"></a>Vueç»„ä»¶ä¹‹é—´çš„é€šä¿¡æ–¹å¼</h3><h4 id="props-emit"><a href="#props-emit" class="headerlink" title="props / $emit"></a><code>props / $emit</code></h4><blockquote><p>é€‚ç”¨äºçˆ¶å­ç»„ä»¶é€šä¿¡</p></blockquote><h4 id="refä¸-parent-children"><a href="#refä¸-parent-children" class="headerlink" title="refä¸$parent / $children"></a><code>ref</code>ä¸<code>$parent</code> / <code>$children</code></h4><blockquote><p>é€‚ç”¨çˆ¶å­ç»„ä»¶é€šä¿¡</p></blockquote><p>â€‹    <code>ref</code>åœ¨DOMä¸Šä½¿ç”¨ï¼ŒæŒ‡å‘DOMå…ƒç´ ï¼Œåœ¨å­ç»„ä»¶ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘ç»„ä»¶å®ä¾‹</p><p>â€‹    <code>$parent / $chidlren</code>è®¿é—®çˆ¶ / å­å®ä¾‹</p><h4 id="Busæ€»çº¿-emit-on"><a href="#Busæ€»çº¿-emit-on" class="headerlink" title="Busæ€»çº¿ $emit / $on"></a>Busæ€»çº¿ <code>$emit</code> / <code>$on</code></h4><blockquote><p>é€‚ç”¨äºçˆ¶å­ã€éš”ä»£ã€å…„å¼Ÿç»„ä»¶é€šä¿¡</p></blockquote><p>â€‹    å»ºç«‹ä¸€ä¸ªç©ºçš„Vueå®ä¾‹ä½œä¸ºäº‹ä»¶æ€»çº¿ï¼Œåˆ©ç”¨å®ƒæ¥è§¦å‘äº‹ä»¶ï¼Œç›‘å¬äº‹ä»¶ï¼Œä»è€Œå®ç°é€šä¿¡</p><h4 id="provide-inject"><a href="#provide-inject" class="headerlink" title="provide / inject"></a><code>provide / inject</code></h4><blockquote><p>é€‚ç”¨éš”ä»£ç»„å»ºé€šä¿¡</p></blockquote><p>â€‹    ç¥–å…ˆç»„ä»¶é€šè¿‡provideæä¾›å˜é‡ï¼Œå­å­™ç»„ä»¶ä¸­é€šè¿‡injectæ³¨å…¥å˜é‡</p><h4 id="Vuex"><a href="#Vuex" class="headerlink" title="Vuex"></a>Vuex</h4><blockquote><p>é€‚ç”¨äºçˆ¶å­ã€éš”ä»£ã€å…„å¼Ÿç»„ä»¶é€šä¿¡</p></blockquote><h3 id="Vueå¦‚ä½•å®ç°åŒå‘ç»‘å®š"><a href="#Vueå¦‚ä½•å®ç°åŒå‘ç»‘å®š" class="headerlink" title="Vueå¦‚ä½•å®ç°åŒå‘ç»‘å®š"></a>Vueå¦‚ä½•å®ç°åŒå‘ç»‘å®š</h3><p>å››éƒ¨åˆ†å…±åŒå®ç°</p><p>ç›‘å¬å™¨<code>Observer</code>ï¼Œå¯¹æ•°æ®å¯¹è±¡è¿›è¡Œéå†ï¼ŒåŒ…æ‹¬å­å±æ€§å¯¹è±¡çš„å±æ€§ï¼Œåˆ©ç”¨<code>Object.defineProperty()</code>å¯¹å±æ€§åŠ ä¸Š<code>getter</code>å’Œ <code>setter</code>ï¼Œç”¨ä»¥ç›‘å¬æ•°æ®å˜åŒ–</p><p>è§£æå™¨<code>Compile</code>ï¼Œè§£æVueæ¨¡ç‰ˆæŒ‡ä»¤ï¼ŒæŠŠæ¨¡ç‰ˆä¸­çš„å˜é‡æ›¿æ¢æˆæ•°æ®ï¼Œåˆå§‹åŒ–æ¸²æŸ“é¡µé¢è§†å›¾ï¼Œæ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„èŠ‚ç‚¹ç»‘å®šæ›´æ–°å‡½æ•°ï¼Œæ·»åŠ ç›‘å¬æ•°æ®çš„è®¢é˜…è€…</p><p>è®¢é˜…è€…<code>Watcher</code>ï¼ŒW æ˜¯ O å’Œ Cä¹‹é—´é€šä¿¡çš„æ¡¥æ¢ï¼Œä»»åŠ¡æ˜¯è®¢é˜…Oä¸­çš„å±æ€§å€¼å˜åŒ–ï¼Œæ”¶åˆ°å˜åŒ–æ¶ˆæ¯æ—¶ï¼Œè§¦å‘Cä¸­çš„æ›´æ–°å‡½æ•°</p><p>è®¢é˜…å™¨<code>Dep</code>ï¼Œé‡‡ç”¨å‘å¸ƒ-è®¢é˜… è®¾è®¡æ¨¡å¼ï¼Œæ”¶é›†è®¢é˜…è€…Wï¼Œå¯¹ç›‘å¬å™¨ O å’Œè®¢é˜…è€… W è¿›è¡Œç®¡ç†</p><p><img src="https://i.loli.net/2019/11/20/kpmvl2MwFdEfy5G.png"></p><h3 id="è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹"><a href="#è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹"></a>è™šæ‹ŸDOMçš„ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li><p><strong>ä¿è¯æ€§èƒ½ä¸‹é™</strong>ï¼šæ¡†æ¶çš„è™šæ‹ŸDOMéœ€è¦é€‚é…ä»»ä½•ä¸Šå±‚APIå¯èƒ½äº§ç”Ÿçš„æ“ä½œï¼Œå®ƒçš„DOMæ“ä½œå¿…é¡»æ˜¯æ™®é€‚çš„ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½ä¸æ˜¯æœ€ä¼˜çš„ï¼Œä½†æ¯”èµ·ç›´æ¥çš„DOMæ“ä½œè¦å¥½å¾ˆå¤šï¼Œå³å¯ä¿è¯åœ¨ä½ ä¸éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶å¯ä»¥æä¾›ä¸é”™çš„æ€§èƒ½</p></li><li><p><strong>æ— éœ€æ‰‹åŠ¨æ“ä½œDOM</strong>ï¼šä¸éœ€è¦æ‰‹åŠ¨æ“ä½œDOMï¼Œåªéœ€è¦å†™å¥½View-Modelçš„ä»£ç é€»è¾‘ï¼Œæ¡†æ¶ä¼šæ ¹æ®è™šæ‹ŸDOMå’Œæ•°æ®è¿›è¡ŒåŒå‘ç»‘å®š</p></li><li><p><strong>è·¨å¹³å°</strong>ï¼šæœ¬è´¨ä¸Šæ˜¯JSå¯¹è±¡ï¼Œè€ŒDOMå’Œå¹³å°å¼ºç›¸å…³ï¼Œç›¸æ¯”ä¹‹ä¸‹è™šæ‹ŸDOMå¯ä»¥è¿›è¡Œæ›´æ–¹ä¾¿çš„è·¨å¹³å°æ“ä½œï¼ŒåƒæœåŠ¡å™¨æ¸²æŸ“ã€weexç­‰</p></li></ul><p><strong>ç¼ºç‚¹:</strong></p><ul><li>â€‹    <strong>æ— æ³•è¿›è¡Œæè‡´ä¼˜åŒ–</strong></li></ul><h3 id="è™šæ‹ŸDOMçš„å®ç°åŸç†"><a href="#è™šæ‹ŸDOMçš„å®ç°åŸç†" class="headerlink" title="è™šæ‹ŸDOMçš„å®ç°åŸç†"></a>è™šæ‹ŸDOMçš„å®ç°åŸç†</h3><p>ä¸»è¦åŒ…æ‹¬ä¸‰éƒ¨åˆ†</p><ul><li><p>ç”¨JSå¯¹è±¡æ¨¡æ‹ŸçœŸå®çš„DOMæ ‘ï¼Œå¯¹çœŸå®DOMè¿›è¡ŒæŠ½è±¡</p></li><li><p>diffç®—æ³• -&gt; æ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚</p></li><li><p>pachç®—æ³• -&gt; æŠŠä¸¤ä¸ªè™šæ‹ŸDOMå¯¹è±¡çš„å·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMä¸Š</p></li></ul><h3 id=""><a href="#" class="headerlink" title=""></a></h3>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Vue.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§†é¢‘ä¸€é¢æ€»ç»“</title>
    <link href="/2019/10/30/2019-10-30-%E6%97%A5%E5%B8%B8%E7%BB%93/"/>
    <url>/2019/10/30/2019-10-30-%E6%97%A5%E5%B8%B8%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<ol><li><h4 id="åç«¯è¿”å›ä¸€ä¸ªé•¿æ•´å½¢ï¼Œå‰ç«¯å¦‚ä½•å¤„ç†æ‰èƒ½è®©ç²¾åº¦ä¸ä¸¢å¤±"><a href="#åç«¯è¿”å›ä¸€ä¸ªé•¿æ•´å½¢ï¼Œå‰ç«¯å¦‚ä½•å¤„ç†æ‰èƒ½è®©ç²¾åº¦ä¸ä¸¢å¤±" class="headerlink" title="åç«¯è¿”å›ä¸€ä¸ªé•¿æ•´å½¢ï¼Œå‰ç«¯å¦‚ä½•å¤„ç†æ‰èƒ½è®©ç²¾åº¦ä¸ä¸¢å¤±"></a>åç«¯è¿”å›ä¸€ä¸ªé•¿æ•´å½¢ï¼Œå‰ç«¯å¦‚ä½•å¤„ç†æ‰èƒ½è®©ç²¾åº¦ä¸ä¸¢å¤±</h4><h5 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h5><blockquote><p>å¦‚æœæœåŠ¡å™¨ä¼ æ¥çš„jsonä¸­åŒ…å«ä¸€ä¸ªå¾ˆå¤§çš„æ•´æ•°ï¼Œå¦‚ { â€œidâ€: 296675198462066688 } ï¼Œé‚£ä¹ˆæ¥å—åä¼šå‘ç°å˜æˆäº† { id: 296675198462066700 } ã€‚ </p></blockquote><h5 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h5><p>â€‹    jsæ˜¯å¼±ç±»å‹è¯­è¨€ï¼Œæ‰€æœ‰çš„æ•°å­—ç±»å‹ç»Ÿç§°ä¸ºNumberç±»å‹ï¼Œä¸åŒºåˆ†intã€longã€doubleç­‰ã€‚è€ŒNumberæ˜¯æ ¹æ®IEEE 754æ ‡å‡†ä¸­çš„doubleæ¥å®ç°çš„ï¼Œå³æ‰€æœ‰çš„Numberç±»å‹éƒ½æ˜¯64ä½åŒç²¾åº¦å®å‹ã€‚jså†…ç½®æœ‰32ä½æ•´æ•°ï¼Œè€Œnumberç±»å‹çš„å®‰å…¨æ•´æ•°æ˜¯53ä½ã€‚å¦‚æœè¶…è¿‡53ä½çš„ï¼Œä½ ä¸èƒ½ç”¨jsonä¼ é€’ï¼Œéœ€è¦ç”¨å…¶ä»–æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ï¼Œæˆ–æ‹†åˆ†æˆä¸¤ä¸ªæ•°æ®å­—æ®µã€‚</p><h5 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h5><p>è½¬æˆå­—ç¬¦ä¸²ï¼Œå¦‚æœéœ€è¦è¿ç®—ï¼Œéœ€è¦åç«¯å¤„ç†</p></li><li><h4 id="æ•°ç»„å»é‡-1-2-â€˜1â€™-â€˜2â€™-3-â€˜4â€™-4-2"><a href="#æ•°ç»„å»é‡-1-2-â€˜1â€™-â€˜2â€™-3-â€˜4â€™-4-2" class="headerlink" title="æ•°ç»„å»é‡([1, 2, â€˜1â€™, â€˜2â€™, 3, â€˜4â€™, 4, 2]"></a>æ•°ç»„å»é‡([1, 2, â€˜1â€™, â€˜2â€™, 3, â€˜4â€™, 4, 2]</h4></li></ol><p>   é™¤äº†é“¾æ¥å†…çš„æ–¹æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>[...new Set(a)]</code>æ–¹æ³•</p><h5 id="å¼•ç”³é—®é¢˜"><a href="#å¼•ç”³é—®é¢˜" class="headerlink" title="å¼•ç”³é—®é¢˜"></a><strong>å¼•ç”³é—®é¢˜</strong></h5><ul><li><h6 id="Set-gt-Setæ˜¯ä»€ä¹ˆ-gt-Set-æ€ä¹ˆå®ç°-gt-Set-å¯ä»¥å»é‡æ··åˆæ•°ç»„å—"><a href="#Set-gt-Setæ˜¯ä»€ä¹ˆ-gt-Set-æ€ä¹ˆå®ç°-gt-Set-å¯ä»¥å»é‡æ··åˆæ•°ç»„å—" class="headerlink" title="Set -&gt; Setæ˜¯ä»€ä¹ˆ? -&gt; Set æ€ä¹ˆå®ç°?  -&gt; Set å¯ä»¥å»é‡æ··åˆæ•°ç»„å—?"></a>Set -&gt; Setæ˜¯ä»€ä¹ˆ? -&gt; Set æ€ä¹ˆå®ç°?  -&gt; Set å¯ä»¥å»é‡æ··åˆæ•°ç»„å—?</h6><ol><li><p>Setæ˜¯ä»€ä¹ˆ</p><p>ES6æ–°çš„æ•°æ®ç»“æ„ï¼Œç±»ä¼¼æ•°ç»„ï¼Œä½†<strong>æˆå‘˜çš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼</strong></p></li><li><p>Setæ€ä¹ˆå®ç°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>()<br>s.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>)<br>s.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>)<br>s.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>)<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> s)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(i) <span class="hljs-comment">// =&gt; 1 , 2 , 3</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>Setèƒ½å»é‡æ··åˆæ•°ç»„å—</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">[...<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(array)]<br><span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(array))<br></code></pre></td></tr></table></figure><p><strong>setä¸­ä¸¤ä¸ªNaNç›¸ç­‰ï¼Œä¼šå»é™¤é‡å¤çš„NaNï¼Œä½†æ˜¯<code>===</code>ä¸‹æ˜¯ä¸ç›¸ç­‰çš„</strong></p></li></ol></li><li><p>Map -&gt; Map çš„é”®æ˜¯å¦‚ä½•å­˜å‚¨çš„? -&gt; å“ˆå¸Œæ˜¯ä»€ä¹ˆ? </p></li></ul><ol start="3"><li><h4 id="new-åšäº†ä»€ä¹ˆäº‹æƒ…-å®ç°-new"><a href="#new-åšäº†ä»€ä¹ˆäº‹æƒ…-å®ç°-new" class="headerlink" title="new åšäº†ä»€ä¹ˆäº‹æƒ…, å®ç° new ?"></a>new åšäº†ä»€ä¹ˆäº‹æƒ…, å®ç° new ?</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/*new å…·ä½“å¹²äº†å•¥*/</span><br><span class="hljs-keyword">var</span> obj = &#123;&#125;<span class="hljs-comment">//åˆ›å»ºç©ºå¯¹è±¡</span><br>obj.<span class="hljs-property">__proto__</span> = <span class="hljs-title class_">Base</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span><span class="hljs-comment">//æŠŠç©ºå¯¹è±¡çš„__proto__æŒ‡å‘äº†Baseçš„prototype</span><br><span class="hljs-title class_">Base</span>.<span class="hljs-title function_">call</span>(obj)<span class="hljs-comment">//å°†Baseçš„thisæ›¿æ¢æˆobjï¼Œå¹¶è°ƒç”¨Base</span><br></code></pre></td></tr></table></figure><p>[]: <a href="https://my.oschina.net/u/3607067/blog/2209082">https://my.oschina.net/u/3607067/blog/2209082</a>    â€œå®ç°newâ€</p></li><li><h4 id="æ„é€ å‡½æ•°æœ‰-return-ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ"><a href="#æ„é€ å‡½æ•°æœ‰-return-ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ" class="headerlink" title="æ„é€ å‡½æ•°æœ‰ return, ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ ?"></a>æ„é€ å‡½æ•°æœ‰ return, ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µ ?</h4></li><li><h4 id="HTTP-é™æ€èµ„æºçš„ä¼˜åŒ–æ–¹å¼"><a href="#HTTP-é™æ€èµ„æºçš„ä¼˜åŒ–æ–¹å¼" class="headerlink" title="HTTP é™æ€èµ„æºçš„ä¼˜åŒ–æ–¹å¼ ?"></a>HTTP é™æ€èµ„æºçš„ä¼˜åŒ–æ–¹å¼ ?</h4></li><li><h4 id="æµè§ˆå™¨ç¼“å­˜æœºåˆ¶"><a href="#æµè§ˆå™¨ç¼“å­˜æœºåˆ¶" class="headerlink" title="æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ ?"></a>æµè§ˆå™¨ç¼“å­˜æœºåˆ¶ ?</h4></li></ol>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>CSS</tag>
      
      <tag>HTTP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°ç»„è½¬æ¢æ ‘ç»“æ„</title>
    <link href="/2019/10/08/2019-10-18-%E7%94%9F%E6%88%90%E6%A0%91/"/>
    <url>/2019/10/08/2019-10-18-%E7%94%9F%E6%88%90%E6%A0%91/</url>
    
    <content type="html"><![CDATA[<h4 id="nestï¼šæ ¹æ®parent-idç”Ÿæˆæ ‘ç»“æ„ï¼ˆé˜¿é‡Œä¸€é¢çœŸé¢˜ï¼‰"><a href="#nestï¼šæ ¹æ®parent-idç”Ÿæˆæ ‘ç»“æ„ï¼ˆé˜¿é‡Œä¸€é¢çœŸé¢˜ï¼‰" class="headerlink" title="nestï¼šæ ¹æ®parent_idç”Ÿæˆæ ‘ç»“æ„ï¼ˆé˜¿é‡Œä¸€é¢çœŸé¢˜ï¼‰"></a>nestï¼šæ ¹æ®parent_idç”Ÿæˆæ ‘ç»“æ„ï¼ˆé˜¿é‡Œä¸€é¢çœŸé¢˜ï¼‰</h4><p>é¢˜ç›®è¦æ±‚ï¼š</p><p>æ ¹æ®æ¯é¡¹çš„parent_id,ç”Ÿæˆå…·ä½“çš„æ ‘å½¢ç»“æ„å¯¹è±¡</p><p><img src="https://i.loli.net/2019/10/28/ElNsiRj1DgVkFS4.png">å®ç°</p><p><strong>ï¼ˆä¸ºæ–¹ä¾¿ï¼Œæ‰€æœ‰å‡½æ•°å‡ç”¨ç®­å¤´å‡½æ•°ï¼‰</strong></p><p>é¦–å…ˆè‚¯å®šè¦æ ¹æ®æä¾›çš„parent_idæ¥è¿›è¡Œæ•°ç»„çš„ç­›é€‰ï¼Œå¯ä»¥é€‰æ‹©<code>for()&#123;&#125;</code>ï¼Œ<code>foreachï¼ˆï¼‰</code>ï¼Œä½†æ˜¯è¿™é‡Œå¯ä»¥ä½¿ç”¨æ•°ç»„çš„æ–°æ–¹æ³•<code>filterï¼ˆï¼‰</code>ï¼Œæ›´ä¸ºæ–¹ä¾¿~</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">items.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item[link] === id) <span class="hljs-comment">// æ³¨æ„===è¦æ±‚ç±»å‹å¿…é¡»ç›¸ç­‰</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°†ç­›é€‰å‡ºæ¥çš„æ•°ç»„æ”¾åˆ°ä¸€èµ·ï¼Œå†å°†parent_idæŒ‡å‘å®ƒä»¬çš„æ•°ç»„è¿›è¡Œåˆå¹¶å¹¶æ”¾åˆ°ä¸€èµ·ï¼Œè¿™é‡Œä¸€æ ·å¯ä»¥ç”¨<code>for()&#123;&#125;</code> , <code>foreach()</code>ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨æ–°æ–¹æ³•<code>map()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">items.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> (&#123;<br>...item,<br>children : <span class="hljs-comment">//=&gt;è¿™ä¸ªåœ°æ–¹å¯ä»¥è¿›è¡Œé€’å½’è°ƒç”¨å°è£…çš„å‡½æ•°</span><br>&#125;))<br></code></pre></td></tr></table></figure><p>å®ç°æ–¹å¼æƒ³åˆ°äº†å°±å¯ä»¥å°è£…å‡½æ•°äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">nest</span> = (<span class="hljs-params">items , id=<span class="hljs-literal">null</span> , link=<span class="hljs-string">&#x27;parent_id&#x27;</span></span>) =&gt; <br>items<br>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item[link] === id)<br>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> (&#123;<br>...item,<br>children : <span class="hljs-title function_">nest</span>(items , item.<span class="hljs-property">id</span>)<br>&#125;))<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">/*æµ‹è¯•ç”¨ä¾‹*/</span><br><span class="hljs-keyword">const</span> comments = [<br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">parent_id</span>: <span class="hljs-literal">null</span> &#125;,<br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">parent_id</span>: <span class="hljs-number">1</span> &#125;,<br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">parent_id</span>: <span class="hljs-number">1</span> &#125;,<br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">parent_id</span>: <span class="hljs-number">2</span> &#125;,<br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">parent_id</span>: <span class="hljs-number">4</span> &#125;<br>];<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="https://i.loli.net/2019/10/28/AoVCfvFtb8DTkew.png"></p><hr><h4 id="å…³äºmap-å’Œfilter"><a href="#å…³äºmap-å’Œfilter" class="headerlink" title="å…³äºmap()å’Œfilter()"></a>å…³äº<code>map()</code>å’Œ<code>filter()</code></h4><p><code>filter()</code>å’Œ<code>map()</code>éƒ½ä¸ä¼šå¯¹ç©ºæ•°ç»„è¿›è¡Œæ£€æµ‹ä¸”ä¸ä¼šæ”¹å˜åŸæ•°ç»„</p><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è‡ªå®šä¹‰ä¸‰é˜¶è´å¡å°”æ›²çº¿</title>
    <link href="/2019/09/27/2019-09-27-%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF/"/>
    <url>/2019/09/27/2019-09-27-%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF/</url>
    
    <content type="html"><![CDATA[<p>æ²¡å¬è¯¾çš„æˆ‘è¦å†™è‡ªå®šä¹‰ä¸‰é˜¶è´å¡å°”æ›²çº¿â€¦â€¦çå†™äº†ä¸€ä¸ªç‚¹ï¼Œçªç„¶æœ‰äº†ç‚¹æ€è·¯ï¼Œç„¶åå†™äº†å¥½ä¸€é˜µï¼Œå†™å®Œäº†å†³å®šmdä¸€ä¸‹æ€è·¯ï¼Œå—¯ï¼Œä¹Ÿç”¨ä¸åˆ°ï¼Œè€å¸ˆè¯´æ”¾åˆ°githubä¸Šç‚¹ç‚¹starï¼Œæˆ‘æƒ³æƒ³è¿˜æ˜¯ç®—äº†ï¼Œå¤ªèœ</p><p><img src="https://i.loli.net/2019/12/02/gMIE9VXieWw3ASj.png"></p><h4 id="è¿›å…¥æ­£é¢˜"><a href="#è¿›å…¥æ­£é¢˜" class="headerlink" title="è¿›å…¥æ­£é¢˜"></a>è¿›å…¥æ­£é¢˜</h4><p>è‡ªå®šä¹‰ä¸‰é˜¶è´å¡å°”æ›²çº¿é¦–å…ˆæ˜¯ éœ€è¦ç”¨<code>canvas</code>å»ç”»çš„ï¼Œå¹¶ä¸”ä½ æ¯æ‹–åŠ¨ä¸€ä¸ªç‚¹ï¼Œéƒ½è¦é‡ç»˜ä¸€æ¬¡ã€‚æ‰€ä»¥ä¸€å¼€å§‹æˆ‘ç›´æ¥ç”¨<code>bezierCurveTo</code>ç”»äº†ä¸€ä¸ªä¸‰é˜¶æ›²çº¿ï¼Œå¦„æƒ³å»è®©ä»–å˜å¼¯â€¦â€¦äº‹å®è¯æ˜ä¸è¡Œã€‚</p><p>æ‰€ä»¥å‚è€ƒäº†ä¸€ä¸‹ä¸€ä¸ªè‡ªå®šä¹‰è´å¡å°”æ›²çº¿åŠ¨ç”»çš„ç½‘ç«™ï¼Œä»–ä¼šç»™é¡¶ç‚¹å’Œå…³é”®ç‚¹åšæˆä¸€ä¸ªå¯æ‹–æ‹½çš„åœ†ï¼Œç„¶åé€šè¿‡æ”¹å˜åœ†çš„ä½ç½®æ”¹å˜è´å¡å°”æ›²çº¿çš„å…³é”®ç‚¹ï¼Œæœå™¶ï¼</p><p>é¦–å…ˆè‚¯å®šè¦æœ‰ä¸ªcanvasï¼Œå¹¶ä¸”åœ¨jsä¸­è·å–å®ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;canvas id=<span class="hljs-string">&quot;canvas&quot;</span> width=<span class="hljs-string">&quot;800&quot;</span> height=<span class="hljs-string">&quot;500&quot;</span>&gt;&lt;/canvas&gt;<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;canvas&#x27;</span>);<br><span class="hljs-keyword">var</span> context = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&#x27;2d&#x27;</span>);<br></code></pre></td></tr></table></figure><p>å› ä¸ºè¦æ‹–åŠ¨å››ä¸ªç‚¹æ¥æ”¹å˜ä¸‰é˜¶è´å¡å°”æ›²çº¿çš„å€¼ï¼Œæ‰€ä»¥æˆ‘æŠŠæ‰€æœ‰çš„ç‚¹æ”¾åˆ°ä¸€ä¸ªpointå¯¹è±¡é‡Œ,ç„¶ååœ¨åˆå§‹åŒ–çš„å‡½æ•°<code>init()</code>ä¸­å®šä¹‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//åˆå§‹åŒ–ç‚¹</span><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params">quadratic</span>) &#123;<br>            <span class="hljs-comment">//ä¸¤ç«¯é¡¶ç‚¹</span><br>            point = &#123;<br>                <span class="hljs-attr">p1</span>: &#123;<br>                    <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,<br>                    <span class="hljs-attr">y</span>: <span class="hljs-number">250</span><br>                &#125;,<br>                <span class="hljs-attr">p2</span>: &#123;<br>                    <span class="hljs-attr">x</span>: <span class="hljs-number">400</span>,<br>                    <span class="hljs-attr">y</span>: <span class="hljs-number">250</span><br>                &#125;<br>            &#125;<br>            point.<span class="hljs-property">cp1</span> = &#123;<br>                    <span class="hljs-attr">x</span>: <span class="hljs-number">150</span>,<br>                    <span class="hljs-attr">y</span>: <span class="hljs-number">100</span><br>                &#125;,<br>                point.<span class="hljs-property">cp2</span> = &#123;<br>                    <span class="hljs-attr">x</span>: <span class="hljs-number">350</span>,<br>                    <span class="hljs-attr">y</span>: <span class="hljs-number">100</span><br>                &#125;,<br><br><br>                <span class="hljs-comment">//é»˜è®¤æ ·å¼</span><br><br>                style = &#123;<br>                <span class="hljs-attr">line</span>: &#123;<br>                    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span>,<br>                    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;red&#x27;</span><br>                &#125;,<br><br>                <span class="hljs-attr">cpline</span>: &#123;<br>                    <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>,<br>                    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;#777&#x27;</span><br>                &#125;,<br>                <span class="hljs-attr">point</span>: &#123;<br>                    <span class="hljs-attr">radius</span>: <span class="hljs-number">10</span>,<br>                    <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>,<br>                    <span class="hljs-attr">color</span>: <span class="hljs-string">&#x27;rgb(55, 255, 55)&#x27;</span>,<br>                    <span class="hljs-attr">fill</span>: <span class="hljs-string">&#x27;rgba(102, 217, 255 , 0.7)&#x27;</span>,<br>                    <span class="hljs-attr">arc1</span>: <span class="hljs-number">0</span>,<br>                    <span class="hljs-attr">arc2</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> * <span class="hljs-number">2</span><br>                &#125;<br>            &#125;<br><br>            canvas.<span class="hljs-property">onmousedown</span> = dragStart;<br>            canvas.<span class="hljs-property">onmousemove</span> = dragging;<br>            canvas.<span class="hljs-property">onmouseup</span> = dragEnd;<br>            <span class="hljs-title class_">DrawCanvas</span>();<br>        &#125;<br></code></pre></td></tr></table></figure><p>ç„¶åè¦ç”»å‡ºæ›²çº¿ã€å·¦è¾¹ç‚¹ä»¥åŠå³è¾¹ç‚¹çš„è¿çº¿ï¼ˆä¸ºäº†å¥½çœ‹ï¼‰ï¼Œè¦æ³¨æ„å› ä¸ºæ¯æ¬¡éƒ½æ˜¯é‡ç»˜æ‰€ä»¥è¦æŠŠç”»å¸ƒæ¸…ç©º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">DrawCanvas</span>(<span class="hljs-params"></span>) &#123;<br>            context.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);<br><br>            context.<span class="hljs-property">lineWidth</span> = style.<span class="hljs-property">cpline</span>.<span class="hljs-property">width</span>;<br>            context.<span class="hljs-property">strokeStyle</span> = style.<span class="hljs-property">cpline</span>.<span class="hljs-property">color</span>;<br>            context.<span class="hljs-title function_">beginPath</span>();<br>            context.<span class="hljs-title function_">moveTo</span>(point.<span class="hljs-property">p1</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">p1</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">lineTo</span>(point.<span class="hljs-property">cp1</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">cp1</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">moveTo</span>(point.<span class="hljs-property">p2</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">p2</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">lineTo</span>(point.<span class="hljs-property">cp2</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">cp2</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">stroke</span>();<br><br>            context.<span class="hljs-property">lineWidth</span> = style.<span class="hljs-property">line</span>.<span class="hljs-property">width</span>;<br>            context.<span class="hljs-property">strokeStyle</span> = style.<span class="hljs-property">line</span>.<span class="hljs-property">color</span>;<br>            context.<span class="hljs-title function_">beginPath</span>();<br>            context.<span class="hljs-title function_">moveTo</span>(point.<span class="hljs-property">p1</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">p1</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">bezierCurveTo</span>(point.<span class="hljs-property">cp1</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">cp1</span>.<span class="hljs-property">y</span>, point.<span class="hljs-property">cp2</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">cp2</span>.<span class="hljs-property">y</span>, point.<span class="hljs-property">p2</span>.<span class="hljs-property">x</span>, point.<span class="hljs-property">p2</span>.<span class="hljs-property">y</span>);<br>            context.<span class="hljs-title function_">stroke</span>();<br><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> p <span class="hljs-keyword">in</span> point) &#123;<br>                context.<span class="hljs-property">lineWidth</span> = style.<span class="hljs-property">point</span>.<span class="hljs-property">width</span>;<br>                context.<span class="hljs-property">strokeStyle</span> = style.<span class="hljs-property">point</span>.<span class="hljs-property">color</span>;<br>                context.<span class="hljs-property">fillStyle</span> = style.<span class="hljs-property">point</span>.<span class="hljs-property">fill</span>;<br>                context.<span class="hljs-title function_">beginPath</span>();<br><br>                context.<span class="hljs-title function_">arc</span>(point[p].<span class="hljs-property">x</span>, point[p].<span class="hljs-property">y</span>, style.<span class="hljs-property">point</span>.<span class="hljs-property">radius</span>, style.<span class="hljs-property">point</span>.<span class="hljs-property">arc1</span>, style.<span class="hljs-property">point</span>.<span class="hljs-property">arc2</span>)<br>                context.<span class="hljs-title function_">fill</span>();<br>                context.<span class="hljs-title function_">stroke</span>();<br><br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>ç”»ä¹Ÿç”»å®Œäº†ï¼Œæˆ‘æ„æ€çš„æ—¶å€™å¡ä½çš„é—¨æ§›å°±æ¥äº†â€¦â€¦æ€ä¹ˆåˆ¤æ–­é¼ æ ‡æ˜¯ä¸æ˜¯ç‚¹åœ¨äº†é‚£å››ä¸ªåœ†é‡Œå‘¢ï¼Œæƒ³å•¥å‘¢ç™¾åº¦å°±å®Œäº‹äº†ï¼Œç„¶åå‘ç°äº†ä¸€ä¸ªä»€ä¹ˆåˆ¤æ–­æ˜¯ä¸æ˜¯åœ¨å½“å‰è·¯å¾„çš„ä¸œè¥¿ï¼Œå—¯ï¼Ÿï¼Ÿï¼Ÿä»€ä¹ˆç©æ„ä¸ä¼šç”¨ï¼Œæ‰€ä»¥å°±å¦è¾Ÿè¹Šå¾„ï¼Œåˆ¤æ–­é¼ æ ‡ç‚¹å‡»ä½ç½®åœ¨ä¸åœ¨åœ†é‡Œï¼Œé«˜ä¸­æ•°å­¦ï¼Ÿåˆä¸­æ•°å­¦ï¼Ÿç‚¹åˆ°åœ†å¿ƒçš„è·ç¦»å°äºåŠå¾„ï¼Œå—¯æˆ‘çœŸèªæ˜</p><p>æƒ³å¥½äº†å°±å¼€å§‹å†™å§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">dragStart</span>(<span class="hljs-params">e</span>) &#123;<br>            e = <span class="hljs-title class_">MousePos</span>(e);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>            <span class="hljs-keyword">var</span> dx,<br>                dy;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> p <span class="hljs-keyword">in</span> point) &#123;<br>                dx = point[p].<span class="hljs-property">x</span> - e.<span class="hljs-property">x</span>;<br>                dy = point[p].<span class="hljs-property">y</span> - e.<span class="hljs-property">y</span>;<br>                <span class="hljs-keyword">if</span> ((dx * dx) + (dy * dy) &lt; style.<span class="hljs-property">point</span>.<span class="hljs-property">radius</span> * style.<span class="hljs-property">point</span>.<span class="hljs-property">radius</span>) &#123;<br>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">1</span>);<br>                    drag = p;<br>                    dPoint = e;<br>                    <span class="hljs-keyword">return</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">//æ‹–æ‹½</span><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">dragging</span>(<span class="hljs-params">e</span>) &#123;<br>            <span class="hljs-keyword">if</span> (drag) &#123;<br>                e = <span class="hljs-title class_">MousePos</span>(e);<br>                point[drag].<span class="hljs-property">x</span> += e.<span class="hljs-property">x</span> - dPoint.<span class="hljs-property">x</span>;<br>                point[drag].<span class="hljs-property">y</span> += e.<span class="hljs-property">y</span> - dPoint.<span class="hljs-property">y</span>;<br>                dPoint = e;<br>                <span class="hljs-title class_">DrawCanvas</span>();<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">//ç»“æŸ</span><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">dragEnd</span>(<span class="hljs-params">e</span>) &#123;<br>            drag = <span class="hljs-literal">null</span>;<br>            <span class="hljs-title class_">DrawCanvas</span>();<br>        &#125;<br></code></pre></td></tr></table></figure><p>ps:æŠŠé¼ æ ‡ç›¸å¯¹äºç”»å¸ƒçš„ä½ç½®å°è£…äº†ä¸€ä¸‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//è·å–å½“å‰é¼ æ ‡ç›¸å¯¹äºç”»å¸ƒçš„åæ ‡</span><br>        <span class="hljs-keyword">function</span> <span class="hljs-title function_">MousePos</span>(<span class="hljs-params">e</span>) &#123;<br>            e = e ? e : <span class="hljs-variable language_">window</span>.<span class="hljs-property">event</span>;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">x</span>: e.<span class="hljs-property">pageX</span> - canvas.<span class="hljs-property">offsetLeft</span>,<br>                <span class="hljs-attr">y</span>: e.<span class="hljs-property">pageY</span> - canvas.<span class="hljs-property">offsetTop</span><br><br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>ç„¶åä¸€ä¸ªè‡ªå®šä¹‰è´å¡å°”æ›²çº¿å°±å®Œæˆäº†ï¼Œå…¶å®è¿˜å¥½ï¼Œå°±æ˜¯æœ‰ç‚¹â€¦â€¦æ²¡å¬è¯¾ï¼</p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>canvas</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HTML5</title>
    <link href="/2019/09/23/2019-09-23-HTML5/"/>
    <url>/2019/09/23/2019-09-23-HTML5/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€HTML5"><a href="#ä¸€ã€HTML5" class="headerlink" title="ä¸€ã€HTML5"></a>ä¸€ã€HTML5</h1><h4 id="1-1ä»€ä¹ˆæ˜¯-HTML5ï¼Ÿ"><a href="#1-1ä»€ä¹ˆæ˜¯-HTML5ï¼Ÿ" class="headerlink" title="1.1ä»€ä¹ˆæ˜¯ HTML5ï¼Ÿ"></a>1.1ä»€ä¹ˆæ˜¯ HTML5ï¼Ÿ</h4><p>HTML5 å°†æˆä¸º HTMLã€XHTML ä»¥åŠ HTML DOM çš„æ–°æ ‡å‡†ã€‚<br>HTML çš„ä¸Šä¸€ä¸ªç‰ˆæœ¬è¯ç”Ÿäº 1999 å¹´ã€‚è‡ªä»é‚£ä»¥åï¼ŒWeb ä¸–ç•Œå·²ç»ç»å†äº†å·¨å˜ã€‚<br>HTML5 ä»å¤„äºå®Œå–„ä¹‹ä¸­ã€‚ç„¶è€Œï¼Œå¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨å·²ç»å…·å¤‡äº†æŸäº› HTML5 æ”¯æŒã€‚</p><h4 id="1-2-HTML5æ˜¯å¦‚ä½•èµ·æ­¥çš„ï¼Ÿ"><a href="#1-2-HTML5æ˜¯å¦‚ä½•èµ·æ­¥çš„ï¼Ÿ" class="headerlink" title="1.2 HTML5æ˜¯å¦‚ä½•èµ·æ­¥çš„ï¼Ÿ"></a>1.2 HTML5æ˜¯å¦‚ä½•èµ·æ­¥çš„ï¼Ÿ</h4><p>HTML5 æ˜¯ W3C ä¸ WHATWGï¼ˆ[Web Hypertext Application Technology Working Group]ç½‘é¡µè¶…æ–‡æœ¬åº”ç”¨æŠ€æœ¯å·¥ä½œå°ç»„ï¼‰ åˆä½œçš„ç»“æœã€‚</p><p>WHATWG è‡´åŠ›äº web è¡¨å•å’Œåº”ç”¨ç¨‹åºï¼Œè€Œ W3C ä¸“æ³¨äº XHTML 2.0ã€‚åœ¨ 2006 å¹´ï¼ŒåŒæ–¹å†³å®šè¿›è¡Œåˆä½œï¼Œæ¥åˆ›å»ºä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ HTMLã€‚</p><p>ä¸º HTML5 å»ºç«‹çš„ä¸€äº›è§„åˆ™ï¼š</p><ul><li>æ–°ç‰¹æ€§åº”è¯¥åŸºäº HTMLã€CSSã€DOM ä»¥åŠ JavaScriptã€‚</li><li>å‡å°‘å¯¹å¤–éƒ¨æ’ä»¶çš„éœ€æ±‚ï¼ˆæ¯”å¦‚ Flashï¼‰</li><li>æ›´ä¼˜ç§€çš„é”™è¯¯å¤„ç†</li><li>æ›´å¤šå–ä»£è„šæœ¬çš„æ ‡è®°</li><li>HTML5 åº”è¯¥ç‹¬ç«‹äºè®¾å¤‡</li><li>å¼€å‘è¿›ç¨‹åº”å¯¹å…¬ä¼—é€æ˜</li></ul><h4 id="1-3-æ–°ç‰¹æ€§"><a href="#1-3-æ–°ç‰¹æ€§" class="headerlink" title="1.3 æ–°ç‰¹æ€§"></a>1.3 æ–°ç‰¹æ€§</h4><p>HTML5 ä¸­çš„ä¸€äº›æœ‰è¶£çš„æ–°ç‰¹æ€§ï¼š</p><ul><li>ç”¨äºç»˜ç”»çš„ canvas å…ƒç´ </li><li>ç”¨äºåª’ä»‹å›æ”¾çš„ video å’Œ audio å…ƒç´ </li><li>å¯¹æœ¬åœ°ç¦»çº¿å­˜å‚¨çš„æ›´å¥½çš„æ”¯æŒ</li><li>æ–°çš„ç‰¹æ®Šå†…å®¹å…ƒç´ ï¼Œæ¯”å¦‚ articleã€footerã€headerã€navã€section</li><li>æ–°çš„è¡¨å•æ§ä»¶ï¼Œæ¯”å¦‚ calendarã€dateã€timeã€emailã€urlã€search</li></ul><h4 id="1-4-HTML5æ–°å¢è¯­ä¹‰åŒ–æ ‡ç­¾"><a href="#1-4-HTML5æ–°å¢è¯­ä¹‰åŒ–æ ‡ç­¾" class="headerlink" title="1.4 HTML5æ–°å¢è¯­ä¹‰åŒ–æ ‡ç­¾"></a>1.4 HTML5æ–°å¢è¯­ä¹‰åŒ–æ ‡ç­¾</h4><table><thead><tr><th align="left"><strong>æ ‡ç­¾</strong></th><th align="left"><strong>æè¿°</strong></th></tr></thead><tbody><tr><td align="left"><code>&lt;article&gt;</code></td><td align="left">å®šä¹‰article</td></tr><tr><td align="left"><code>&lt;aside&gt;</code></td><td align="left">å®šä¹‰é¡µé¢å†…å®¹ä¹‹å¤–çš„å†…å®¹ã€‚</td></tr><tr><td align="left"><code>&lt;audio&gt;</code></td><td align="left">å®šä¹‰å£°éŸ³å†…å®¹ã€‚</td></tr><tr><td align="left"><code>&lt;bdi&gt;</code></td><td align="left">å®šä¹‰æ–‡æœ¬çš„æ–‡æœ¬æ–¹å‘ï¼Œä½¿å…¶è„±ç¦»å…¶å‘¨å›´æ–‡æœ¬çš„æ–¹å‘è®¾ç½®ã€‚(æµè§ˆå™¨æ”¯æŒä¸å¥½)</td></tr><tr><td align="left"><code>&lt;canvas&gt;</code></td><td align="left">å®šä¹‰ç”»å¸ƒ</td></tr><tr><td align="left"><code>&lt;command&gt;</code></td><td align="left">å®šä¹‰å‘½ä»¤æŒ‰é’®ã€‚(ç›®å‰ï¼Œä¸»æµæµè§ˆå™¨éƒ½ä¸æ”¯æŒ <command> æ ‡ç­¾ã€‚)</td></tr><tr><td align="left"><code>&lt;datalist&gt;</code></td><td align="left">å®šä¹‰ä¸‹æ‹‰åˆ—è¡¨ã€‚</td></tr><tr><td align="left"><code>&lt;details&gt;</code></td><td align="left">å®šä¹‰å…ƒç´ çš„ç»†èŠ‚ã€‚</td></tr><tr><td align="left"><code>&lt;embed&gt;</code></td><td align="left">å®šä¹‰å¤–éƒ¨äº¤äº’å†…å®¹æˆ–æ’ä»¶ã€‚</td></tr><tr><td align="left"><code>&lt;figcaption&gt;</code></td><td align="left">å®šä¹‰figure å…ƒç´ çš„æ ‡é¢˜ã€‚</td></tr><tr><td align="left"><code>&lt;figure&gt;</code></td><td align="left">å®šä¹‰åª’ä»‹å†…å®¹çš„åˆ†ç»„ï¼Œä»¥åŠå®ƒä»¬çš„æ ‡é¢˜ã€‚</td></tr><tr><td align="left"><code>&lt;footer&gt;</code></td><td align="left">å®šä¹‰   section æˆ– page çš„é¡µè„šã€‚</td></tr><tr><td align="left"><code>&lt;header&gt;</code></td><td align="left">å®šä¹‰   section æˆ– page çš„é¡µçœ‰ã€‚</td></tr><tr><td align="left"><code>&lt;hgroup&gt;</code></td><td align="left">å®šä¹‰æœ‰å…³æ–‡æ¡£ä¸­çš„   section çš„ä¿¡æ¯ã€‚</td></tr><tr><td align="left"><code>&lt;keygen&gt;</code></td><td align="left">å®šä¹‰ç”Ÿæˆå¯†é’¥ã€‚</td></tr><tr><td align="left"><code>&lt;main&gt;</code></td><td align="left">å®šä¹‰æ–‡æ¡£çš„ä¸»è¦å†…å®¹ã€‚</td></tr><tr><td align="left"><code>&lt;mark&gt;</code></td><td align="left">å®šä¹‰æœ‰è®°å·çš„æ–‡æœ¬ã€‚</td></tr><tr><td align="left"><code>&lt;meter&gt;</code></td><td align="left">å®šä¹‰é¢„å®šä¹‰èŒƒå›´å†…çš„åº¦é‡ã€‚</td></tr><tr><td align="left"><code>&lt;nav&gt;</code></td><td align="left">å®šä¹‰å¯¼èˆªé“¾æ¥ã€‚</td></tr><tr><td align="left"><code>&lt;output&gt;</code></td><td align="left">å®šä¹‰è¾“å‡ºçš„ä¸€äº›ç±»å‹ã€‚</td></tr><tr><td align="left"><code>&lt;progress&gt;</code></td><td align="left">å®šä¹‰ä»»ä½•ç±»å‹çš„ä»»åŠ¡çš„è¿›åº¦ã€‚</td></tr><tr><td align="left"><code>&lt;rp&gt;</code></td><td align="left">å®šä¹‰è‹¥æµè§ˆå™¨ä¸æ”¯æŒ ruby å…ƒç´ æ˜¾ç¤ºçš„å†…å®¹ã€‚</td></tr><tr><td align="left"><code>&lt;rt&gt;</code></td><td align="left">å®šä¹‰ ruby æ³¨é‡Šçš„è§£é‡Šã€‚</td></tr><tr><td align="left"><code>&lt;ruby&gt;</code></td><td align="left">å®šä¹‰ ruby æ³¨é‡Šã€‚</td></tr><tr><td align="left"><code>&lt;section&gt;</code></td><td align="left">å®šä¹‰   sectionã€‚</td></tr><tr><td align="left"><code>&lt;source&gt;</code></td><td align="left">å®šä¹‰åª’ä»‹æºã€‚</td></tr><tr><td align="left"><code>&lt;summary&gt;</code></td><td align="left">å®šä¹‰   details å…ƒç´ çš„æ ‡é¢˜ã€‚</td></tr><tr><td align="left"><code>&lt;time&gt;</code></td><td align="left">å®šä¹‰æ—¥æœŸ/æ—¶é—´ã€‚</td></tr><tr><td align="left"><code>&lt;track&gt;</code></td><td align="left">å®šä¹‰ç”¨åœ¨åª’ä½“æ’­æ”¾å™¨ä¸­çš„æ–‡æœ¬è½¨é“ã€‚</td></tr><tr><td align="left"><code>&lt;video&gt;</code></td><td align="left">å®šä¹‰è§†é¢‘ã€‚</td></tr></tbody></table><h4 id="1-5-browser-sync"><a href="#1-5-browser-sync" class="headerlink" title="1.5 browser-sync"></a>1.5 browser-sync</h4><h4 id="1-6-HTML5è¡¨å•"><a href="#1-6-HTML5è¡¨å•" class="headerlink" title="1.6 HTML5è¡¨å•"></a>1.6 HTML5è¡¨å•</h4><h5 id="HTML5-æ–°çš„-Input-ç±»å‹"><a href="#HTML5-æ–°çš„-Input-ç±»å‹" class="headerlink" title="HTML5 æ–°çš„ Input ç±»å‹"></a>HTML5 æ–°çš„ Input ç±»å‹</h5><p>HTML5 æ‹¥æœ‰å¤šä¸ªæ–°çš„è¡¨å•è¾“å…¥ç±»å‹ã€‚è¿™äº›æ–°ç‰¹æ€§æä¾›äº†æ›´å¥½çš„è¾“å…¥æ§åˆ¶å’ŒéªŒè¯ï¼š</p><ul><li>email</li><li>url</li><li>number</li><li>range</li><li>Date pickers (date, month, week, time, datetime, datetime-local)</li><li>search</li><li>color</li></ul><h5 id="1-6-2-Input-ç±»å‹-email"><a href="#1-6-2-Input-ç±»å‹-email" class="headerlink" title="1.6.2 Input ç±»å‹ - email"></a>1.6.2 Input ç±»å‹ - email</h5><p>email ç±»å‹ç”¨äºåº”è¯¥åŒ…å« e-mail åœ°å€çš„è¾“å…¥åŸŸã€‚</p><p>åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ email åŸŸçš„å€¼ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">E-mail: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;email&quot; <span class="hljs-type">name</span>=&quot;user_email&quot; /&gt;<br></code></pre></td></tr></table></figure><p><strong>Input ç±»å‹ - url</strong></p><p>url ç±»å‹ç”¨äºåº”è¯¥åŒ…å« URL åœ°å€çš„è¾“å…¥åŸŸã€‚</p><p>åœ¨æäº¤è¡¨å•æ—¶ï¼Œä¼šè‡ªåŠ¨éªŒè¯ url åŸŸçš„å€¼ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Homepage: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;url&quot; <span class="hljs-type">name</span>=&quot;user_url&quot; /&gt;<br></code></pre></td></tr></table></figure><p><strong>Input ç±»å‹ - number</strong></p><p>number ç±»å‹ç”¨äºåº”è¯¥åŒ…å«æ•°å€¼çš„è¾“å…¥åŸŸã€‚</p><p>æ‚¨è¿˜èƒ½å¤Ÿè®¾å®šå¯¹æ‰€æ¥å—çš„æ•°å­—çš„é™å®šï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">Points: &lt;<span class="hljs-built_in">input</span> <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;number&quot;</span> name=<span class="hljs-string">&quot;points&quot;</span> <span class="hljs-built_in">min</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-built_in">max</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>è¯·ä½¿ç”¨ä¸‹é¢çš„å±æ€§æ¥è§„å®šå¯¹æ•°å­—ç±»å‹çš„é™å®šï¼š</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">max</td><td align="left"><em>number</em></td><td align="left">è§„å®šå…è®¸çš„æœ€å¤§å€¼</td></tr><tr><td align="left">min</td><td align="left"><em>number</em></td><td align="left">è§„å®šå…è®¸çš„æœ€å°å€¼</td></tr><tr><td align="left">step</td><td align="left"><em>number</em></td><td align="left">è§„å®šåˆæ³•çš„æ•°å­—é—´éš”ï¼ˆå¦‚æœ step=â€3â€ï¼Œåˆ™åˆæ³•çš„æ•°æ˜¯ -3,0,3,6 ç­‰ï¼‰</td></tr><tr><td align="left">value</td><td align="left"><em>number</em></td><td align="left">è§„å®šé»˜è®¤å€¼</td></tr></tbody></table><p><strong>Input ç±»å‹ - range</strong></p><p>range ç±»å‹ç”¨äºåº”è¯¥åŒ…å«ä¸€å®šèŒƒå›´å†…æ•°å­—å€¼çš„è¾“å…¥åŸŸã€‚</p><p>range ç±»å‹æ˜¾ç¤ºä¸ºæ»‘åŠ¨æ¡ã€‚</p><p>æ‚¨è¿˜èƒ½å¤Ÿè®¾å®šå¯¹æ‰€æ¥å—çš„æ•°å­—çš„é™å®šï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;range&quot;</span> name<span class="hljs-operator">=</span><span class="hljs-string">&quot;points&quot;</span> min<span class="hljs-operator">=</span><span class="hljs-string">&quot;1&quot;</span> max<span class="hljs-operator">=</span><span class="hljs-string">&quot;10&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>è¯·ä½¿ç”¨ä¸‹é¢çš„å±æ€§æ¥è§„å®šå¯¹æ•°å­—ç±»å‹çš„é™å®šï¼š</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">max</td><td align="left"><em>number</em></td><td align="left">è§„å®šå…è®¸çš„æœ€å¤§å€¼</td></tr><tr><td align="left">min</td><td align="left"><em>number</em></td><td align="left">è§„å®šå…è®¸çš„æœ€å°å€¼</td></tr><tr><td align="left">step</td><td align="left"><em>number</em></td><td align="left">è§„å®šåˆæ³•çš„æ•°å­—é—´éš”ï¼ˆå¦‚æœ step=â€3â€ï¼Œåˆ™åˆæ³•çš„æ•°æ˜¯ -3,0,3,6 ç­‰ï¼‰</td></tr><tr><td align="left">value</td><td align="left"><em>number</em></td><td align="left">è§„å®šé»˜è®¤å€¼</td></tr></tbody></table><p><strong>Input ç±»å‹ - Date Pickersï¼ˆæ—¥æœŸé€‰æ‹©å™¨ï¼‰</strong></p><p>HTML5 æ‹¥æœ‰å¤šä¸ªå¯ä¾›é€‰å–æ—¥æœŸå’Œæ—¶é—´çš„æ–°è¾“å…¥ç±»å‹ï¼š</p><ul><li>date - é€‰å–æ—¥ã€æœˆã€å¹´</li><li>month - é€‰å–æœˆã€å¹´</li><li>week - é€‰å–å‘¨å’Œå¹´</li><li>time - é€‰å–æ—¶é—´ï¼ˆå°æ—¶å’Œåˆ†é’Ÿï¼‰</li><li>datetime - é€‰å–æ—¶é—´ã€æ—¥ã€æœˆã€å¹´ï¼ˆUTC æ—¶é—´ï¼‰</li><li>datetime-local - é€‰å–æ—¶é—´ã€æ—¥ã€æœˆã€å¹´ï¼ˆæœ¬åœ°æ—¶é—´ï¼‰</li></ul><p>ä¸‹é¢çš„ä¾‹å­å…è®¸æ‚¨ä»æ—¥å†ä¸­é€‰å–ä¸€ä¸ªæ—¥æœŸï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-type">Date</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;date&quot; <span class="hljs-type">name</span>=&quot;user_date&quot; /&gt;<br></code></pre></td></tr></table></figure><p>color: é¢œè‰²é€‰æ‹©å™¨</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Color: &lt;input <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;color&quot;</span> <span class="hljs-attribute">onchange</span>=<span class="hljs-string">&quot;getColor()&quot;</span>  <span class="hljs-attribute">id</span>=<span class="hljs-string">&quot;colorSelector&quot;</span>&gt;  &lt;br&gt;<br></code></pre></td></tr></table></figure><p>Input ç±»å‹ - search**</p><p>search ç±»å‹ç”¨äºæœç´¢åŸŸï¼Œæ¯”å¦‚ç«™ç‚¹æœç´¢æˆ– Google æœç´¢ã€‚</p><p>search åŸŸæ˜¾ç¤ºä¸ºå¸¸è§„çš„æ–‡æœ¬åŸŸã€‚</p><h5 id="1-6-3-HTML5-æ–°çš„è¡¨å•å…ƒç´ "><a href="#1-6-3-HTML5-æ–°çš„è¡¨å•å…ƒç´ " class="headerlink" title="1.6.3 HTML5 æ–°çš„è¡¨å•å…ƒç´ "></a>1.6.3 HTML5 æ–°çš„è¡¨å•å…ƒç´ </h5><p>HTML5 æ‹¥æœ‰è‹¥å¹²æ¶‰åŠè¡¨å•çš„å…ƒç´ å’Œå±æ€§ã€‚</p><ul><li>datalist</li><li>keygen</li><li>output</li></ul><p><strong>datalist å…ƒç´ </strong></p><p>datalist å…ƒç´ è§„å®šè¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚</p><p>åˆ—è¡¨æ˜¯é€šè¿‡ datalist å†…çš„ option å…ƒç´ åˆ›å»ºçš„ã€‚</p><p>å¦‚éœ€æŠŠ datalist ç»‘å®šåˆ°è¾“å…¥åŸŸï¼Œè¯·ç”¨è¾“å…¥åŸŸçš„ list å±æ€§å¼•ç”¨ datalist çš„ idï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">Webpage: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;url_list&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;link&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;url_list&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;baidu&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.baidu.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;tencent&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.qq.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;alibaba&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.alibaba.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">datalist</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>output å…ƒç´ </strong></p><p>output å…ƒç´ ç”¨äºä¸åŒç±»å‹çš„è¾“å‡ºï¼Œæ¯”å¦‚è®¡ç®—æˆ–è„šæœ¬è¾“å‡ºï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;output <span class="hljs-attribute">id</span>=<span class="hljs-string">&quot;result&quot;</span> <span class="hljs-attribute">onforminput</span>=<span class="hljs-string">&quot;resCalc()&quot;</span>&gt;&lt;/output&gt;<br></code></pre></td></tr></table></figure><h5 id="1-6-4-HTML5-æ–°çš„è¡¨å•å±æ€§"><a href="#1-6-4-HTML5-æ–°çš„è¡¨å•å±æ€§" class="headerlink" title="1.6.4 HTML5 æ–°çš„è¡¨å•å±æ€§"></a>1.6.4 HTML5 æ–°çš„è¡¨å•å±æ€§</h5><p><strong>æ–°çš„ form å±æ€§ï¼š</strong></p><ul><li>autocomplete</li><li>novalidate</li></ul><p><strong>æ–°çš„ input å±æ€§ï¼š</strong></p><ul><li>autocomplete</li><li>autofocus</li><li>form</li><li>form overrides (formaction, formenctype, formmethod, formnovalidate, formtarget)</li><li>height å’Œ width</li><li>list</li><li>min, max å’Œ step</li><li>multiple</li><li>pattern (regexp)</li><li>placeholder</li><li>required</li></ul><p><strong>autocomplete å±æ€§</strong></p><p>autocomplete å±æ€§è§„å®š form æˆ– input åŸŸåº”è¯¥æ‹¥æœ‰è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>autocomplete é€‚ç”¨äº <code>&lt;form&gt; </code>æ ‡ç­¾ï¼Œä»¥åŠä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email, password, datepickers, range ä»¥åŠ colorã€‚</p><p>å½“ç”¨æˆ·åœ¨è‡ªåŠ¨å®ŒæˆåŸŸä¸­å¼€å§‹è¾“å…¥æ—¶ï¼Œæµè§ˆå™¨åº”è¯¥åœ¨è¯¥åŸŸä¸­æ˜¾ç¤ºå¡«å†™çš„é€‰é¡¹ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;form action=&quot;demo_form.php&quot; <span class="hljs-keyword">method</span>=&quot;get&quot; autocomplete=&quot;on&quot;&gt;<br>First <span class="hljs-type">name</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;fname&quot; /&gt;&lt;br /&gt;<br>Last <span class="hljs-type">name</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;lname&quot; /&gt;&lt;br /&gt;<br>E-mail: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;email&quot; <span class="hljs-type">name</span>=&quot;email&quot; autocomplete=&quot;off&quot; /&gt;&lt;br /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;submit&quot; /&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p><strong>æ³¨é‡Šï¼š</strong>åœ¨æŸäº›æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦å¯ç”¨è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œä»¥ä½¿è¯¥å±æ€§ç”Ÿæ•ˆã€‚(firefoxæ”¯æŒè¾ƒå¥½)</p><p><strong>autofocus å±æ€§</strong></p><p>autofocus å±æ€§è§„å®šåœ¨é¡µé¢åŠ è½½æ—¶ï¼ŒåŸŸè‡ªåŠ¨åœ°è·å¾—ç„¦ç‚¹ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>autofocus å±æ€§é€‚ç”¨äºæ‰€æœ‰ <code>&lt;input&gt;</code> æ ‡ç­¾çš„ç±»å‹ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">User</span> <span class="hljs-type">name</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;user_name&quot;  autofocus=&quot;autofocus&quot; /&gt;<br></code></pre></td></tr></table></figure><p><strong>form å±æ€§</strong></p><p>form å±æ€§è§„å®šè¾“å…¥åŸŸæ‰€å±çš„ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨å•ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>form å±æ€§é€‚ç”¨äºæ‰€æœ‰ <code>&lt;input&gt; </code>æ ‡ç­¾çš„ç±»å‹ã€‚</p><p>form å±æ€§å¿…é¡»å¼•ç”¨æ‰€å±è¡¨å•çš„ idï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;form action=&quot;demo_form.php&quot; <span class="hljs-keyword">method</span>=&quot;get&quot; id=&quot;user_form&quot;&gt;<br>First <span class="hljs-type">name</span>:&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;fname&quot; /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;submit&quot; /&gt;<br>&lt;/form&gt;<br>Last <span class="hljs-type">name</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;lname&quot; form=&quot;user_form&quot; /&gt;<br></code></pre></td></tr></table></figure><p><strong>æ³¨é‡Šï¼š</strong>å¦‚éœ€å¼•ç”¨ä¸€ä¸ªä»¥ä¸Šçš„è¡¨å•ï¼Œè¯·ä½¿ç”¨ç©ºæ ¼åˆ†éš”çš„åˆ—è¡¨ã€‚</p><p><strong>è¡¨å•é‡å†™å±æ€§</strong></p><p>è¡¨å•é‡å†™å±æ€§ï¼ˆform override attributesï¼‰å…è®¸æ‚¨é‡å†™ form å…ƒç´ çš„æŸäº›å±æ€§è®¾å®šã€‚</p><p>è¡¨å•é‡å†™å±æ€§æœ‰ï¼š</p><ul><li>formaction - é‡å†™è¡¨å•çš„ action å±æ€§</li><li>formenctype - é‡å†™è¡¨å•çš„ enctype å±æ€§</li><li>formmethod - é‡å†™è¡¨å•çš„ method å±æ€§</li><li>formnovalidate - é‡å†™è¡¨å•çš„ novalidate å±æ€§</li><li>formtarget - é‡å†™è¡¨å•çš„ target å±æ€§</li></ul><p><strong>æ³¨é‡Šï¼š</strong>è¡¨å•é‡å†™å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼šsubmit å’Œ imageã€‚</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs stata">&lt;<span class="hljs-keyword">form</span> action=<span class="hljs-string">&quot;demo_form.php&quot;</span> method=<span class="hljs-string">&quot;get&quot;</span> id=<span class="hljs-string">&quot;user_form&quot;</span>&gt;<br><span class="hljs-keyword">E</span>-mail: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;email&quot;</span> name=<span class="hljs-string">&quot;userid&quot;</span> /&gt;&lt;<span class="hljs-keyword">br</span> /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;Submit&quot;</span> /&gt;<br>&lt;<span class="hljs-keyword">br</span> /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;submit&quot;</span> formaction=<span class="hljs-string">&quot;demo_admin.php&quot;</span> value=<span class="hljs-string">&quot;Submit as admin&quot;</span> /&gt;<br>&lt;<span class="hljs-keyword">br</span> /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=<span class="hljs-string">&quot;submit&quot;</span> formnovalidate=<span class="hljs-string">&quot;true&quot;</span> value=<span class="hljs-string">&quot;Submit without validation&quot;</span> /&gt;<br>&lt;<span class="hljs-keyword">br</span> /&gt;<br>&lt;/<span class="hljs-keyword">form</span>&gt;<br></code></pre></td></tr></table></figure><p><strong>æ³¨é‡Šï¼š</strong>è¿™äº›å±æ€§å¯¹äºåˆ›å»ºä¸åŒçš„æäº¤æŒ‰é’®å¾ˆæœ‰å¸®åŠ©ã€‚</p><p><strong>height å’Œ width å±æ€§</strong></p><p>height å’Œ width å±æ€§è§„å®šç”¨äº image ç±»å‹çš„ input æ ‡ç­¾çš„å›¾åƒé«˜åº¦å’Œå®½åº¦ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>height å’Œ width å±æ€§åªé€‚ç”¨äº image ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;image&quot;</span> src<span class="hljs-operator">=</span><span class="hljs-string">&quot;img_submit.gif&quot;</span> width<span class="hljs-operator">=</span><span class="hljs-string">&quot;99&quot;</span> height<span class="hljs-operator">=</span><span class="hljs-string">&quot;99&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p><strong>list å±æ€§</strong></p><p>list å±æ€§è§„å®šè¾“å…¥åŸŸçš„ datalistã€‚datalist æ˜¯è¾“å…¥åŸŸçš„é€‰é¡¹åˆ—è¡¨ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>list å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email, date pickers, number, range ä»¥åŠ colorã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml">Webpage: <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">list</span>=<span class="hljs-string">&quot;url_list&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;link&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">datalist</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;url_list&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;baidu&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.baidu.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;tencent&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.qq.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;alibaba&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;http://www.alibaba.com&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">datalist</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>minã€max å’Œ step å±æ€§</strong></p><p>minã€max å’Œ step å±æ€§ç”¨äºä¸ºåŒ…å«æ•°å­—æˆ–æ—¥æœŸçš„ input ç±»å‹è§„å®šé™å®šï¼ˆçº¦æŸï¼‰ã€‚</p><p>max å±æ€§è§„å®šè¾“å…¥åŸŸæ‰€å…è®¸çš„æœ€å¤§å€¼ã€‚</p><p>min å±æ€§è§„å®šè¾“å…¥åŸŸæ‰€å…è®¸çš„æœ€å°å€¼ã€‚</p><p>step å±æ€§ä¸ºè¾“å…¥åŸŸè§„å®šåˆæ³•çš„æ•°å­—é—´éš”ï¼ˆå¦‚æœ step=â€3â€ï¼Œåˆ™åˆæ³•çš„æ•°æ˜¯ -3,0,3,6 ç­‰ï¼‰ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>minã€max å’Œ step å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„<code> &lt;input&gt;</code> æ ‡ç­¾ï¼šdate pickersã€number ä»¥åŠ rangeã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºä¸€ä¸ªæ•°å­—åŸŸï¼Œè¯¥åŸŸæ¥å—ä»‹äº 0 åˆ° 10 ä¹‹é—´çš„å€¼ï¼Œä¸”æ­¥è¿›ä¸º 3ï¼ˆå³åˆæ³•çš„å€¼ä¸º 0ã€3ã€6 å’Œ 9ï¼‰ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Points: &lt;input <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;number&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;points&quot;</span> <span class="hljs-attribute">min</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attribute">max</span>=<span class="hljs-string">&quot;10&quot;</span> <span class="hljs-attribute">step</span>=<span class="hljs-string">&quot;3&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p><strong>multiple å±æ€§</strong></p><p>multiple å±æ€§è§„å®šè¾“å…¥åŸŸä¸­å¯é€‰æ‹©å¤šä¸ªå€¼ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>multiple å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼šemail å’Œ fileã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Select</span> images: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;file&quot; <span class="hljs-type">name</span>=&quot;img&quot; multiple=&quot;multiple&quot; /&gt;<br></code></pre></td></tr></table></figure><p><strong>novalidate å±æ€§</strong></p><p>novalidate å±æ€§è§„å®šåœ¨æäº¤è¡¨å•æ—¶ä¸åº”è¯¥éªŒè¯ form æˆ– input åŸŸã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>novalidate å±æ€§é€‚ç”¨äº <code>&lt;form&gt;</code> ä»¥åŠä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email, password, date pickers, range ä»¥åŠ color.</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;form action=&quot;demo_form.php&quot; <span class="hljs-keyword">method</span>=&quot;get&quot; novalidate=&quot;true&quot;&gt;<br>E-mail: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;email&quot; <span class="hljs-type">name</span>=&quot;user_email&quot; /&gt;<br>&lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;submit&quot; /&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p><strong>pattern å±æ€§</strong></p><p>pattern å±æ€§è§„å®šç”¨äºéªŒè¯ input åŸŸçš„æ¨¡å¼ï¼ˆpatternï¼‰ã€‚</p><p>æ¨¡å¼ï¼ˆpatternï¼‰ æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>pattern å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email ä»¥åŠ passwordã€‚</p><p>ä¸‹é¢çš„ä¾‹å­æ˜¾ç¤ºäº†ä¸€ä¸ªåªèƒ½åŒ…å«ä¸‰ä¸ªå­—æ¯çš„æ–‡æœ¬åŸŸï¼ˆä¸å«æ•°å­—åŠç‰¹æ®Šå­—ç¬¦ï¼‰ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Country code: &lt;input <span class="hljs-attribute">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;country_code&quot;</span><br><span class="hljs-attribute">pattern</span>=<span class="hljs-string">&quot;[A-z]&#123;3&#125;&quot;</span> <span class="hljs-attribute">title</span>=<span class="hljs-string">&quot;Three letter country code&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p><strong>placeholder å±æ€§</strong></p><p>placeholder å±æ€§æä¾›ä¸€ç§æç¤ºï¼ˆhintï¼‰ï¼Œæè¿°è¾“å…¥åŸŸæ‰€æœŸå¾…çš„å€¼ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>placeholder å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„ <code>&lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email ä»¥åŠ passwordã€‚</p><p>æç¤ºï¼ˆhintï¼‰ä¼šåœ¨è¾“å…¥åŸŸä¸ºç©ºæ—¶æ˜¾ç¤ºå‡ºç°ï¼Œä¼šåœ¨è¾“å…¥åŸŸè·å¾—ç„¦ç‚¹æ—¶æ¶ˆå¤±ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;search&quot;</span> name<span class="hljs-operator">=</span><span class="hljs-string">&quot;user_search&quot;</span>  placeholder<span class="hljs-operator">=</span><span class="hljs-string">&quot;Search&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p><strong>required å±æ€§</strong></p><p>required å±æ€§è§„å®šå¿…é¡»åœ¨æäº¤ä¹‹å‰å¡«å†™è¾“å…¥åŸŸï¼ˆä¸èƒ½ä¸ºç©ºï¼‰ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>required å±æ€§é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„<code> &lt;input&gt;</code> æ ‡ç­¾ï¼štext, search, url, telephone, email, password, date pickers, number, checkbox, radio ä»¥åŠ fileã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-type">Name</span>: &lt;<span class="hljs-keyword">input</span> <span class="hljs-keyword">type</span>=&quot;text&quot; <span class="hljs-type">name</span>=&quot;usr_name&quot; required=&quot;required&quot; /&gt;<br></code></pre></td></tr></table></figure><h4 id="1-7-HTML5-å…¨å±€å±æ€§"><a href="#1-7-HTML5-å…¨å±€å±æ€§" class="headerlink" title="1.7 HTML5 å…¨å±€å±æ€§"></a>1.7 HTML5 å…¨å±€å±æ€§</h4><p>HTML5 ä¸­æ·»åŠ çš„å±æ€§ã€‚</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">contenteditable</td><td align="left">è§„å®šå…ƒç´ å†…å®¹æ˜¯å¦å¯ç¼–è¾‘ã€‚</td></tr><tr><td align="left">contextmenu</td><td align="left">è§„å®šå…ƒç´ çš„ä¸Šä¸‹æ–‡èœå•ã€‚ä¸Šä¸‹æ–‡èœå•åœ¨ç”¨æˆ·ç‚¹å‡»å…ƒç´ æ—¶æ˜¾ç¤ºã€‚(æµè§ˆå™¨ä¸æ”¯æŒ)</td></tr><tr><td align="left">data-*</td><td align="left">ç”¨äºå­˜å‚¨é¡µé¢æˆ–åº”ç”¨ç¨‹åºçš„ç§æœ‰å®šåˆ¶æ•°æ®ã€‚</td></tr><tr><td align="left">draggable</td><td align="left">è§„å®šå…ƒç´ æ˜¯å¦å¯æ‹–åŠ¨ã€‚</td></tr><tr><td align="left">dropzone</td><td align="left">è§„å®šåœ¨æ‹–åŠ¨è¢«æ‹–åŠ¨æ•°æ®æ—¶æ˜¯å¦è¿›è¡Œå¤åˆ¶ã€ç§»åŠ¨æˆ–é“¾æ¥ã€‚</td></tr><tr><td align="left">hidden</td><td align="left">éšè—å…ƒç´ </td></tr><tr><td align="left">spellcheck</td><td align="left">è§„å®šæ˜¯å¦å¯¹å…ƒç´ è¿›è¡Œæ‹¼å†™å’Œè¯­æ³•æ£€æŸ¥ã€‚</td></tr><tr><td align="left">translate</td><td align="left">è§„å®šæ˜¯å¦åº”è¯¥ç¿»è¯‘å…ƒç´ å†…å®¹ã€‚</td></tr></tbody></table><h4 id="1-8-HTML5äº‹ä»¶"><a href="#1-8-HTML5äº‹ä»¶" class="headerlink" title="1.8 HTML5äº‹ä»¶"></a>1.8 HTML5äº‹ä»¶</h4><h5 id="1-8-1-window-äº‹ä»¶å±æ€§"><a href="#1-8-1-window-äº‹ä»¶å±æ€§" class="headerlink" title="1.8.1 window äº‹ä»¶å±æ€§"></a>1.8.1 window äº‹ä»¶å±æ€§</h5><p>é’ˆå¯¹ window å¯¹è±¡è§¦å‘çš„äº‹ä»¶ï¼ˆåº”ç”¨åˆ° <body> æ ‡ç­¾ï¼‰ï¼š</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">onafterprint</td><td align="left">script</td><td align="left">æ–‡æ¡£æ‰“å°ä¹‹åè¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹)</td></tr><tr><td align="left">onbeforeprint</td><td align="left">script</td><td align="left">æ–‡æ¡£æ‰“å°ä¹‹å‰è¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹)</td></tr><tr><td align="left">onbeforeunload</td><td align="left">script</td><td align="left">æ–‡æ¡£å¸è½½ä¹‹å‰è¿è¡Œçš„è„šæœ¬ã€‚ (chrome)</td></tr><tr><td align="left">onerror</td><td align="left">script</td><td align="left">åœ¨é”™è¯¯å‘ç”Ÿæ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onhashchange</td><td align="left">script</td><td align="left">å½“æ–‡æ¡£å·²æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onmessage</td><td align="left">script</td><td align="left">åœ¨æ¶ˆæ¯è¢«è§¦å‘æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onoffline</td><td align="left">script</td><td align="left">å½“æ–‡æ¡£ç¦»çº¿æ—¶è¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹)</td></tr><tr><td align="left">ononline</td><td align="left">script</td><td align="left">å½“æ–‡æ¡£ä¸Šçº¿æ—¶è¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹)</td></tr><tr><td align="left">onpagehide</td><td align="left">script</td><td align="left">å½“çª—å£éšè—æ—¶è¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹/chrome)</td></tr><tr><td align="left">onpageshow</td><td align="left">script</td><td align="left">å½“çª—å£æˆä¸ºå¯è§æ—¶è¿è¡Œçš„è„šæœ¬ã€‚(ç«ç‹/chrome)</td></tr><tr><td align="left">onpopstate</td><td align="left">script</td><td align="left">å½“çª—å£å†å²è®°å½•æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onredo</td><td align="left">script</td><td align="left">å½“æ–‡æ¡£æ‰§è¡Œæ’¤é”€ï¼ˆredoï¼‰æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onstorage</td><td align="left">script</td><td align="left">åœ¨ Web Storage åŒºåŸŸæ›´æ–°åè¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onundo</td><td align="left">script</td><td align="left">åœ¨æ–‡æ¡£æ‰§è¡Œ undo æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr></tbody></table><h5 id="1-8-2-Form-äº‹ä»¶"><a href="#1-8-2-Form-äº‹ä»¶" class="headerlink" title="1.8.2 Form äº‹ä»¶"></a>1.8.2 Form äº‹ä»¶</h5><p>ç”± HTML è¡¨å•å†…çš„åŠ¨ä½œè§¦å‘çš„äº‹ä»¶ï¼ˆåº”ç”¨åˆ°å‡ ä¹æ‰€æœ‰ HTML å…ƒç´ ï¼Œä½†æœ€å¸¸ç”¨åœ¨ form å…ƒç´ ä¸­ï¼‰ï¼š</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">oncontextmenu</td><td align="left">script</td><td align="left">å½“ä¸Šä¸‹æ–‡èœå•è¢«è§¦å‘æ—¶è¿è¡Œçš„è„šæœ¬ã€‚(é¼ æ ‡å³é”®è§¦å‘)</td></tr><tr><td align="left">onformchange</td><td align="left">script</td><td align="left">åœ¨è¡¨å•æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onforminput</td><td align="left">script</td><td align="left">å½“è¡¨å•è·å¾—ç”¨æˆ·è¾“å…¥æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">oninvalid</td><td align="left">script</td><td align="left">å½“å…ƒç´ æ— æ•ˆæ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr></tbody></table><p>oncontextmenuäº‹ä»¶ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;ie=edge&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-tag">ul</span>, <span class="hljs-selector-tag">li</span> &#123;</span><br><span class="language-css">            <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-id">#myMenu</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">list-style</span>: none;</span><br><span class="language-css">            <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">            <span class="hljs-attribute">border-bottom</span>: none;</span><br><span class="language-css">            <span class="hljs-attribute">position</span>: absolute;</span><br><span class="language-css">            <span class="hljs-attribute">display</span>: none;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-id">#myMenu</span> <span class="hljs-selector-tag">li</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">5px</span> <span class="hljs-number">10px</span>;</span><br><span class="language-css">            <span class="hljs-attribute">cursor</span>: pointer;</span><br><span class="language-css">        &#125;</span><br><span class="language-css"></span><br><span class="language-css">        <span class="hljs-selector-id">#myMenu</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-pseudo">:hover</span>&#123;</span><br><span class="language-css">            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ccc</span>;</span><br><span class="language-css">        &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;myMenu&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å³é”®æƒ³å¹²ä»€ä¹ˆï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æƒ³çœ‹æºä»£ç ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>è¿˜æ˜¯æƒ³å®¡æŸ¥å…ƒç´ ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">var</span> myMenu = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;myMenu&quot;</span>);</span><br><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;contextmenu&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;</span><br><span class="language-javascript">    event.<span class="hljs-title function_">preventDefault</span>();</span><br><span class="language-javascript">    myMenu.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;block&quot;</span>;</span><br><span class="language-javascript">    <span class="hljs-comment">//è·å–é¼ æ ‡è§†å£ä½ç½®</span></span><br><span class="language-javascript">    myMenu.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = event.<span class="hljs-property">clientY</span> + <span class="hljs-string">&quot;px&quot;</span>;</span><br><span class="language-javascript">    myMenu.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = event.<span class="hljs-property">clientX</span> + <span class="hljs-string">&quot;px&quot;</span>;</span><br><span class="language-javascript">&#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)&#123;</span><br><span class="language-javascript">    myMenu.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&quot;none&quot;</span>;</span><br><span class="language-javascript">&#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h5 id="1-8-3-Mouse-äº‹ä»¶"><a href="#1-8-3-Mouse-äº‹ä»¶" class="headerlink" title="1.8.3 Mouse äº‹ä»¶"></a>1.8.3 Mouse äº‹ä»¶</h5><p>ç”±é¼ æ ‡æˆ–ç±»ä¼¼ç”¨æˆ·åŠ¨ä½œè§¦å‘çš„äº‹ä»¶ï¼š</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">ondrag</td><td align="left">script</td><td align="left">å…ƒç´ è¢«æ‹–åŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondragend</td><td align="left">script</td><td align="left">åœ¨æ‹–åŠ¨æ“ä½œæœ«ç«¯è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondragenter</td><td align="left">script</td><td align="left">å½“å…ƒç´ å…ƒç´ å·²è¢«æ‹–åŠ¨åˆ°æœ‰æ•ˆæ‹–æ”¾åŒºåŸŸæ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondragleave</td><td align="left">script</td><td align="left">å½“å…ƒç´ ç¦»å¼€æœ‰æ•ˆæ‹–æ”¾ç›®æ ‡æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondragover</td><td align="left">script</td><td align="left">å½“å…ƒç´ åœ¨æœ‰æ•ˆæ‹–æ”¾ç›®æ ‡ä¸Šæ­£åœ¨è¢«æ‹–åŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondragstart</td><td align="left">script</td><td align="left">åœ¨æ‹–åŠ¨æ“ä½œå¼€ç«¯è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondrop</td><td align="left">script</td><td align="left">å½“è¢«æ‹–å…ƒç´ æ­£åœ¨è¢«æ‹–æ”¾æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onmousewheel</td><td align="left">script</td><td align="left">å½“é¼ æ ‡æ»šè½®æ­£åœ¨è¢«æ»šåŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onscroll</td><td align="left">script</td><td align="left">å½“å…ƒç´ æ»šåŠ¨æ¡è¢«æ»šåŠ¨æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr></tbody></table><h5 id="1-8-4-Media-äº‹ä»¶"><a href="#1-8-4-Media-äº‹ä»¶" class="headerlink" title="1.8.4 Media äº‹ä»¶"></a>1.8.4 Media äº‹ä»¶</h5><p>ç”±åª’ä»‹ï¼ˆæ¯”å¦‚è§†é¢‘ã€å›¾åƒå’ŒéŸ³é¢‘ï¼‰è§¦å‘çš„äº‹ä»¶ï¼ˆé€‚ç”¨äºæ‰€æœ‰ HTML å…ƒç´ ï¼Œä½†å¸¸è§äºåª’ä»‹å…ƒç´ ä¸­ï¼Œæ¯”å¦‚ <code>&lt;audio&gt;ã€&lt;embed&gt;ã€&lt;img&gt;ã€&lt;object&gt; ä»¥åŠ &lt;video&gt;</code>ï¼‰:</p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">oncanplay</td><td align="left">script</td><td align="left">å½“æ–‡ä»¶å°±ç»ªå¯ä»¥å¼€å§‹æ’­æ”¾æ—¶è¿è¡Œçš„è„šæœ¬ï¼ˆç¼“å†²å·²è¶³å¤Ÿå¼€å§‹æ—¶ï¼‰ã€‚</td></tr><tr><td align="left">oncanplaythrough</td><td align="left">script</td><td align="left">å½“åª’ä»‹èƒ½å¤Ÿæ— éœ€å› ç¼“å†²è€Œåœæ­¢å³å¯æ’­æ”¾è‡³ç»“å°¾æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ondurationchange</td><td align="left">script</td><td align="left">å½“åª’ä»‹é•¿åº¦æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onemptied</td><td align="left">script</td><td align="left">å½“å‘ç”Ÿæ•…éšœå¹¶ä¸”æ–‡ä»¶çªç„¶ä¸å¯ç”¨æ—¶è¿è¡Œçš„è„šæœ¬ï¼ˆæ¯”å¦‚è¿æ¥æ„å¤–æ–­å¼€æ—¶ï¼‰ã€‚</td></tr><tr><td align="left">onended</td><td align="left">script</td><td align="left">å½“åª’ä»‹å·²åˆ°è¾¾ç»“å°¾æ—¶è¿è¡Œçš„è„šæœ¬ï¼ˆå¯å‘é€ç±»ä¼¼â€œæ„Ÿè°¢è§‚çœ‹â€ä¹‹ç±»çš„æ¶ˆæ¯ï¼‰ã€‚</td></tr><tr><td align="left">onerror</td><td align="left">script</td><td align="left">å½“åœ¨æ–‡ä»¶åŠ è½½æœŸé—´å‘ç”Ÿé”™è¯¯æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onloadeddata</td><td align="left">script</td><td align="left">å½“åª’ä»‹æ•°æ®å·²åŠ è½½æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onloadedmetadata</td><td align="left">script</td><td align="left">å½“å…ƒæ•°æ®ï¼ˆæ¯”å¦‚åˆ†è¾¨ç‡å’Œæ—¶é•¿ï¼‰è¢«åŠ è½½æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onloadstart</td><td align="left">script</td><td align="left">åœ¨æ–‡ä»¶å¼€å§‹åŠ è½½ä¸”æœªå®é™…åŠ è½½ä»»ä½•æ•°æ®å‰è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onpause</td><td align="left">script</td><td align="left">å½“åª’ä»‹è¢«ç”¨æˆ·æˆ–ç¨‹åºæš‚åœæ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onplay</td><td align="left">script</td><td align="left">å½“åª’ä»‹å·²å°±ç»ªå¯ä»¥å¼€å§‹æ’­æ”¾æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onplaying</td><td align="left">script</td><td align="left">å½“åª’ä»‹å·²å¼€å§‹æ’­æ”¾æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onprogress</td><td align="left">script</td><td align="left">å½“æµè§ˆå™¨æ­£åœ¨è·å–åª’ä»‹æ•°æ®æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onratechange</td><td align="left">script</td><td align="left">æ¯å½“å›æ”¾é€Ÿç‡æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ï¼ˆæ¯”å¦‚å½“ç”¨æˆ·åˆ‡æ¢åˆ°æ…¢åŠ¨ä½œæˆ–å¿«è¿›æ¨¡å¼ï¼‰ã€‚</td></tr><tr><td align="left">onreadystatechange</td><td align="left">script</td><td align="left">æ¯å½“å°±ç»ªçŠ¶æ€æ”¹å˜æ—¶è¿è¡Œçš„è„šæœ¬ï¼ˆå°±ç»ªçŠ¶æ€ç›‘æµ‹åª’ä»‹æ•°æ®çš„çŠ¶æ€ï¼‰ã€‚</td></tr><tr><td align="left">onseeked</td><td align="left">script</td><td align="left">å½“ seeking å±æ€§è®¾ç½®ä¸º falseï¼ˆæŒ‡ç¤ºå®šä½å·²ç»“æŸï¼‰æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onseeking</td><td align="left">script</td><td align="left">å½“ seeking å±æ€§è®¾ç½®ä¸º trueï¼ˆæŒ‡ç¤ºå®šä½æ˜¯æ´»åŠ¨çš„ï¼‰æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onstalled</td><td align="left">script</td><td align="left">åœ¨æµè§ˆå™¨ä¸è®ºä½•ç§åŸå› æœªèƒ½å–å›åª’ä»‹æ•°æ®æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onsuspend</td><td align="left">script</td><td align="left">åœ¨åª’ä»‹æ•°æ®å®Œå…¨åŠ è½½ä¹‹å‰ä¸è®ºä½•ç§åŸå› ç»ˆæ­¢å–å›åª’ä»‹æ•°æ®æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">ontimeupdate</td><td align="left">script</td><td align="left">å½“æ’­æ”¾ä½ç½®æ”¹å˜æ—¶ï¼ˆæ¯”å¦‚å½“ç”¨æˆ·å¿«è¿›åˆ°åª’ä»‹ä¸­ä¸€ä¸ªä¸åŒçš„ä½ç½®æ—¶ï¼‰è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onvolumechange</td><td align="left">script</td><td align="left">æ¯å½“éŸ³é‡æ”¹å˜æ—¶ï¼ˆåŒ…æ‹¬å°†éŸ³é‡è®¾ç½®ä¸ºé™éŸ³ï¼‰æ—¶è¿è¡Œçš„è„šæœ¬ã€‚</td></tr><tr><td align="left">onwaiting</td><td align="left">script</td><td align="left">å½“åª’ä»‹å·²åœæ­¢æ’­æ”¾ä½†æ‰“ç®—ç»§ç»­æ’­æ”¾æ—¶ï¼ˆæ¯”å¦‚å½“åª’ä»‹æš‚åœå·²ç¼“å†²æ›´å¤šæ•°æ®ï¼‰è¿è¡Œè„šæœ¬</td></tr></tbody></table><h4 id="1-9-video"><a href="#1-9-video" class="headerlink" title="1.9 video"></a>1.9 video</h4><p><strong>1ã€ å®šä¹‰å’Œç”¨æ³•</strong></p><p><code>&lt;video&gt;</code> æ ‡ç­¾å®šä¹‰è§†é¢‘ï¼Œæ¯”å¦‚ç”µå½±ç‰‡æ®µæˆ–å…¶ä»–è§†é¢‘æµã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;video width<span class="hljs-operator">=</span><span class="hljs-string">&quot;320&quot;</span> height<span class="hljs-operator">=</span><span class="hljs-string">&quot;240&quot;</span> controls&gt;<br>    &lt;source src<span class="hljs-operator">=</span><span class="hljs-string">&quot;movie.mp4&quot;</span> type<span class="hljs-operator">=</span><span class="hljs-string">&quot;video/mp4&quot;</span>&gt;<br>    &lt;source src<span class="hljs-operator">=</span><span class="hljs-string">&quot;movie.ogg&quot;</span> type<span class="hljs-operator">=</span><span class="hljs-string">&quot;video/ogg&quot;</span>&gt;<br>    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ video æ ‡ç­¾ã€‚<br>&lt;/video&gt;<br></code></pre></td></tr></table></figure><p><strong>2ã€æ ‡ç­¾å®šä¹‰åŠä½¿ç”¨è¯´æ˜</strong></p><p>ç›®å‰ï¼Œ<code>&lt;video&gt;</code> å…ƒç´ æ”¯æŒä¸‰ç§è§†é¢‘æ ¼å¼ï¼šMP4ã€WebMã€Oggã€‚</p><table><thead><tr><th align="left">æµè§ˆå™¨</th><th align="left">MP4</th><th align="left">WebM</th><th align="left">Ogg</th></tr></thead><tbody><tr><td align="left">Internet Explorer</td><td align="left">YES</td><td align="left">NO</td><td align="left">NO</td></tr><tr><td align="left">Chrome</td><td align="left">YES</td><td align="left">YES</td><td align="left">YES</td></tr><tr><td align="left">Firefox</td><td align="left">YES ä» Firefox 21 ç‰ˆæœ¬å¼€å§‹ Linux ç³»ç»Ÿä» Firefox 30 å¼€å§‹</td><td align="left">YES</td><td align="left">YES</td></tr><tr><td align="left">Safari</td><td align="left">YES</td><td align="left">NO</td><td align="left">NO</td></tr><tr><td align="left">Opera</td><td align="left">YES ä» Opera 25 ç‰ˆæœ¬å¼€å§‹</td><td align="left">YES</td><td align="left">YES</td></tr></tbody></table><ul><li>MP4 = MPEG 4æ–‡ä»¶ä½¿ç”¨ H264 è§†é¢‘ç¼–è§£ç å™¨å’ŒAACéŸ³é¢‘ç¼–è§£ç å™¨</li><li>WebM = WebM æ–‡ä»¶ä½¿ç”¨ VP8 è§†é¢‘ç¼–è§£ç å™¨å’Œ Vorbis éŸ³é¢‘ç¼–è§£ç å™¨</li><li>Ogg = Ogg æ–‡ä»¶ä½¿ç”¨ Theora è§†é¢‘ç¼–è§£ç å™¨å’Œ VorbiséŸ³é¢‘ç¼–è§£ç å™¨</li></ul><p><strong>3ã€å±æ€§</strong></p><table><thead><tr><th align="left">å±æ€§</th><th align="left">å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">autoplay</td><td align="left">autoplay</td><td align="left">å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨å°±ç»ªåé©¬ä¸Šæ’­æ”¾ã€‚</td></tr><tr><td align="left">controls</td><td align="left">controls</td><td align="left">å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™å‘ç”¨æˆ·æ˜¾ç¤ºæ§ä»¶ï¼Œæ¯”å¦‚æ’­æ”¾æŒ‰é’®ã€‚</td></tr><tr><td align="left">height</td><td align="left"><em>pixels</em></td><td align="left">è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„é«˜åº¦ã€‚</td></tr><tr><td align="left">loop</td><td align="left">loop</td><td align="left">å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™å½“åª’ä»‹æ–‡ä»¶å®Œæˆæ’­æ”¾åå†æ¬¡å¼€å§‹æ’­æ”¾ã€‚</td></tr><tr><td align="left">muted</td><td align="left">muted</td><td align="left">è§„å®šè§†é¢‘çš„éŸ³é¢‘è¾“å‡ºåº”è¯¥è¢«é™éŸ³ã€‚</td></tr><tr><td align="left">poster</td><td align="left"><em>URL</em></td><td align="left">è§„å®šè§†é¢‘ä¸‹è½½æ—¶æ˜¾ç¤ºçš„å›¾åƒï¼Œæˆ–è€…åœ¨ç”¨æˆ·ç‚¹å‡»æ’­æ”¾æŒ‰é’®å‰æ˜¾ç¤ºçš„å›¾åƒã€‚</td></tr><tr><td align="left">preload</td><td align="left">preload</td><td align="left">å¦‚æœå‡ºç°è¯¥å±æ€§ï¼Œåˆ™è§†é¢‘åœ¨é¡µé¢åŠ è½½æ—¶è¿›è¡ŒåŠ è½½ï¼Œå¹¶é¢„å¤‡æ’­æ”¾ã€‚å¦‚æœä½¿ç”¨ â€œautoplayâ€ï¼Œåˆ™å¿½ç•¥è¯¥å±æ€§ã€‚</td></tr><tr><td align="left">src</td><td align="left"><em>url</em></td><td align="left">è¦æ’­æ”¾çš„è§†é¢‘çš„ URLã€‚</td></tr><tr><td align="left">width</td><td align="left"><em>pixels</em></td><td align="left">è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„å®½åº¦ã€‚</td></tr></tbody></table><p><strong>4ã€ä½¿ç”¨DOMæ§åˆ¶</strong></p><p>HTML5 <code>&lt;video&gt;</code> å…ƒç´ åŒæ ·æ‹¥æœ‰æ–¹æ³•ã€å±æ€§å’Œäº‹ä»¶ã€‚</p><p>å…¶ä¸­çš„æ–¹æ³•ç”¨äºæ’­æ”¾ã€æš‚åœä»¥åŠåŠ è½½ç­‰ã€‚å…¶ä¸­çš„å±æ€§ï¼ˆæ¯”å¦‚æ—¶é•¿ã€éŸ³é‡ç­‰ï¼‰å¯ä»¥è¢«è¯»å–æˆ–è®¾ç½®ã€‚å…¶ä¸­çš„ DOM äº‹ä»¶èƒ½å¤Ÿé€šçŸ¥æ‚¨ï¼Œæ¯”æ–¹è¯´ï¼Œ<video> å…ƒç´ å¼€å§‹æ’­æ”¾ã€å·²æš‚åœï¼Œå·²åœæ­¢ï¼Œç­‰ç­‰ã€‚</p><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">å±æ€§</th><th align="left">äº‹ä»¶</th></tr></thead><tbody><tr><td align="left">play()</td><td align="left">currentSrc</td><td align="left">play</td></tr><tr><td align="left">pause()</td><td align="left">currentTime</td><td align="left">pause</td></tr><tr><td align="left">load()</td><td align="left">videoWidth</td><td align="left">progress</td></tr><tr><td align="left">canPlayType</td><td align="left">videoHeight</td><td align="left">error</td></tr><tr><td align="left"></td><td align="left">duration</td><td align="left">timeupdate</td></tr><tr><td align="left"></td><td align="left">ended</td><td align="left">ended</td></tr><tr><td align="left"></td><td align="left">error</td><td align="left">abort</td></tr><tr><td align="left"></td><td align="left">paused</td><td align="left">empty</td></tr><tr><td align="left"></td><td align="left">muted</td><td align="left">emptied</td></tr><tr><td align="left"></td><td align="left">seeking</td><td align="left">waiting</td></tr><tr><td align="left"></td><td align="left">volume</td><td align="left">loadedmetadata</td></tr><tr><td align="left"></td><td align="left">height</td><td align="left"></td></tr><tr><td align="left"></td><td align="left">width</td><td align="left"></td></tr></tbody></table><p><strong>æ³¨é‡Šï¼š</strong>åœ¨æ‰€æœ‰å±æ€§ä¸­ï¼Œåªæœ‰ videoWidth å’Œ videoHeight å±æ€§æ˜¯ç«‹å³å¯ç”¨çš„ã€‚åœ¨è§†é¢‘çš„å…ƒæ•°æ®å·²åŠ è½½åï¼Œå…¶ä»–å±æ€§æ‰å¯ç”¨ã€‚</p><h4 id="1-10-audio"><a href="#1-10-audio" class="headerlink" title="1.10 audio"></a>1.10 audio</h4><p><strong>1ã€ å®šä¹‰å’Œç”¨æ³•</strong></p><p><code>&lt;audio&gt;</code> æ ‡ç­¾å®šä¹‰å£°éŸ³ï¼Œæ¯”å¦‚éŸ³ä¹æˆ–å…¶ä»–éŸ³é¢‘æµã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&lt;<span class="hljs-selector-tag">audio</span> <span class="hljs-attribute">src</span>=<span class="hljs-string">&quot;someaudio.wav&quot;</span>&gt;<br>æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ <span class="hljs-selector-tag">audio</span> æ ‡ç­¾ã€‚<br>&lt;/audio&gt;<br></code></pre></td></tr></table></figure><p><strong>2ã€éŸ³é¢‘æ ¼å¼</strong></p><p>å½“å‰ï¼Œaudio å…ƒç´ æ”¯æŒä¸‰ç§éŸ³é¢‘æ ¼å¼ï¼š</p><table><thead><tr><th align="left"></th><th align="left">IE 9</th><th align="left">Firefox 3.5</th><th align="left">Opera 10.5</th><th align="left">Chrome 3.0</th><th align="left">Safari 3.0</th></tr></thead><tbody><tr><td align="left">Ogg Vorbis</td><td align="left"></td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left"></td></tr><tr><td align="left">MP3</td><td align="left">âˆš</td><td align="left"></td><td align="left"></td><td align="left">âˆš</td><td align="left">âˆš</td></tr><tr><td align="left">Wav</td><td align="left"></td><td align="left">âˆš</td><td align="left">âˆš</td><td align="left"></td><td align="left">âˆš</td></tr></tbody></table><p><strong>3ã€å±æ€§</strong></p><table><thead><tr><th align="left">å±æ€§</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">audioTracks</td><td align="left">è¿”å›è¡¨ç¤ºå¯ç”¨éŸ³é¢‘è½¨é“çš„ AudioTrackList å¯¹è±¡ã€‚</td></tr><tr><td align="left">autoplay</td><td align="left">è®¾ç½®æˆ–è¿”å›æ˜¯å¦åœ¨å°±ç»ªï¼ˆåŠ è½½å®Œæˆï¼‰åéšå³æ’­æ”¾éŸ³é¢‘ã€‚</td></tr><tr><td align="left">buffered</td><td align="left">è¿”å›è¡¨ç¤ºéŸ³é¢‘å·²ç¼“å†²éƒ¨åˆ†çš„ TimeRanges å¯¹è±¡ã€‚</td></tr><tr><td align="left">controller</td><td align="left">è¿”å›è¡¨ç¤ºéŸ³é¢‘å½“å‰åª’ä½“æ§åˆ¶å™¨çš„ MediaController å¯¹è±¡ã€‚</td></tr><tr><td align="left">controls</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘æ˜¯å¦åº”è¯¥æ˜¾ç¤ºæ§ä»¶ï¼ˆæ¯”å¦‚æ’­æ”¾/æš‚åœç­‰ï¼‰ã€‚</td></tr><tr><td align="left">crossOrigin</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘çš„ CORS è®¾ç½®ã€‚</td></tr><tr><td align="left">currentSrc</td><td align="left">è¿”å›å½“å‰éŸ³é¢‘çš„ URLã€‚</td></tr><tr><td align="left">currentTime</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘ä¸­çš„å½“å‰æ’­æ”¾ä½ç½®ï¼ˆä»¥ç§’è®¡ï¼‰ã€‚</td></tr><tr><td align="left">defaultMuted</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘é»˜è®¤æ˜¯å¦é™éŸ³ã€‚</td></tr><tr><td align="left">defaultPlaybackRate</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘çš„é»˜è®¤æ’­æ”¾é€Ÿåº¦ã€‚</td></tr><tr><td align="left">duration</td><td align="left">è¿”å›éŸ³é¢‘çš„é•¿åº¦ï¼ˆä»¥ç§’è®¡ï¼‰ã€‚</td></tr><tr><td align="left">ended</td><td align="left">è¿”å›éŸ³é¢‘çš„æ’­æ”¾æ˜¯å¦å·²ç»“æŸã€‚</td></tr><tr><td align="left">error</td><td align="left">è¿”å›è¡¨ç¤ºéŸ³é¢‘é”™è¯¯çŠ¶æ€çš„ MediaError å¯¹è±¡ã€‚</td></tr><tr><td align="left">loop</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘æ˜¯å¦åº”åœ¨ç»“æŸæ—¶å†æ¬¡æ’­æ”¾ã€‚</td></tr><tr><td align="left">mediaGroup</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘æ‰€å±åª’ä»‹ç»„åˆçš„åç§°ã€‚</td></tr><tr><td align="left">muted</td><td align="left">è®¾ç½®æˆ–è¿”å›æ˜¯å¦å…³é—­å£°éŸ³ã€‚</td></tr><tr><td align="left">networkState</td><td align="left">è¿”å›éŸ³é¢‘çš„å½“å‰ç½‘ç»œçŠ¶æ€ã€‚</td></tr><tr><td align="left">paused</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘æ˜¯å¦æš‚åœã€‚</td></tr><tr><td align="left">playbackRate</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘æ’­æ”¾çš„é€Ÿåº¦ã€‚</td></tr><tr><td align="left">played</td><td align="left">è¿”å›è¡¨ç¤ºéŸ³é¢‘å·²æ’­æ”¾éƒ¨åˆ†çš„ TimeRanges å¯¹è±¡ã€‚</td></tr><tr><td align="left">preload</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘çš„ preload å±æ€§çš„å€¼ã€‚</td></tr><tr><td align="left">readyState</td><td align="left">è¿”å›éŸ³é¢‘å½“å‰çš„å°±ç»ªçŠ¶æ€ã€‚</td></tr><tr><td align="left">seekable</td><td align="left">è¿”å›è¡¨ç¤ºéŸ³é¢‘å¯å¯»å€éƒ¨åˆ†çš„ TimeRanges å¯¹è±¡ã€‚</td></tr><tr><td align="left">seeking</td><td align="left">è¿”å›ç”¨æˆ·å½“å‰æ˜¯å¦æ­£åœ¨éŸ³é¢‘ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚</td></tr><tr><td align="left">src</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘çš„ src å±æ€§çš„å€¼ã€‚</td></tr><tr><td align="left">textTracks</td><td align="left">è¿”å›è¡¨ç¤ºå¯ç”¨æ–‡æœ¬è½¨é“çš„ TextTrackList å¯¹è±¡ã€‚</td></tr><tr><td align="left">volume</td><td align="left">è®¾ç½®æˆ–è¿”å›éŸ³é¢‘çš„éŸ³é‡ã€‚</td></tr></tbody></table><p><strong>4ã€æ–¹æ³•</strong></p><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">addTextTrack()</td><td align="left">å‘éŸ³é¢‘æ·»åŠ æ–°çš„æ–‡æœ¬è½¨é“ã€‚</td></tr><tr><td align="left">canPlayType()</td><td align="left">æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦èƒ½å¤Ÿæ’­æ”¾æŒ‡å®šçš„éŸ³é¢‘ç±»å‹ã€‚</td></tr><tr><td align="left">fastSeek()</td><td align="left">åœ¨éŸ³é¢‘æ’­æ”¾å™¨ä¸­æŒ‡å®šæ’­æ”¾æ—¶é—´ã€‚</td></tr><tr><td align="left">getStartDate()</td><td align="left">è¿”å›æ–°çš„ Date å¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰æ—¶é—´çº¿åç§»é‡ã€‚</td></tr><tr><td align="left">load()</td><td align="left">é‡æ–°åŠ è½½éŸ³é¢‘å…ƒç´ ã€‚</td></tr><tr><td align="left">play()</td><td align="left">å¼€å§‹æ’­æ”¾éŸ³é¢‘ã€‚</td></tr><tr><td align="left">pause()</td><td align="left">æš‚åœå½“å‰æ’­æ”¾çš„éŸ³é¢‘ã€‚</td></tr></tbody></table><p><strong>5ã€äº‹ä»¶</strong></p><p>play æ’­æ”¾äº‹ä»¶ å¯åˆ¤æ–­æ­Œæ›²æ˜¯å¦æ­£åœ¨æ’­æ”¾ä¸­<br>pause æš‚åœäº‹ä»¶ åˆ¤æ–­æ­Œæ›²æ˜¯å¦æš‚åœ<br>loadstartï¼Œdurationchangeï¼Œloadeddataï¼Œprogressï¼Œcanplayï¼Œcanplaythroughã€‚ï¼ˆè¿™äº›äº‹ä»¶åœ¨åŠ è½½è¿‡ç¨‹ä¸­æ˜¯æŒ‰ä»¥ä¸Šé¡ºåºè§¦å‘çš„ï¼‰<br>ä»¥ä¸Šè¿™äº›äº‹ä»¶å¯ä»¥é€šè¿‡äº‹ä»¶ç›‘å¬å¯¹å…¶åšç›¸åº”å¤„ç†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯¦è§£this</title>
    <link href="/2019/08/09/2019-08-09-%E8%AF%A6%E8%A7%A3this/"/>
    <url>/2019/08/09/2019-08-09-%E8%AF%A6%E8%A7%A3this/</url>
    
    <content type="html"><![CDATA[<p>å½’æ ¹ç»“åº•ï¼Œthisçš„æŒ‡å‘å°±æ˜¯ä¸€å¥è¯ï¼š<strong>è°æœ€ç»ˆè°ƒç”¨å‡½æ•°ï¼Œthiså°±æŒ‡å‘è°ï¼Œå’Œå®šä¹‰å‡½æ•°æ²¡å…³ç³»</strong></p><p>1.thisæŒ‡å‘çš„ï¼Œæ°¸è¿œåªå¯èƒ½æ˜¯å¯¹è±¡ï¼<br>2.thisæŒ‡å‘è°ï¼Œæ°¸è¿œä¸å–å†³äºthiså†™åœ¨å“ªï¼Œè€Œæ˜¯å–å†³äºå‡½æ•°åœ¨å“ªè°ƒç”¨ã€‚<br>3.thisæŒ‡å‘çš„å¯¹è±¡ï¼Œç§°ä¹‹ä¸ºå‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼Œå³å‡½æ•°è°ƒç”¨è€…ã€‚   </p><p>ä¸‹é¢çœ‹å‡ ç§æƒ…å†µ</p><p><strong>é€šè¿‡å‡½æ•°åï¼ˆï¼‰ç›´æ¥è°ƒç”¨ï¼šthisæŒ‡å‘<code>window</code></strong>  </p><blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span> ()&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">this</span> );<br>&gt;&#125;<br>&gt;<span class="hljs-title function_">func</span>();<span class="hljs-comment">//this --&gt; window</span><br></code></pre></td></tr></table></figure></blockquote><p><strong>é€šè¿‡    å¯¹è±¡.å‡½æ•°åï¼ˆï¼‰è°ƒç”¨çš„ï¼šthisæŒ‡å‘è¿™ä¸ªå¯¹è±¡</strong>  </p><blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>);<br>&gt;&#125;<br>&gt;<span class="hljs-comment">//ç‹­ä¹‰å¯¹è±¡</span><br>&gt;<span class="hljs-keyword">var</span> obj = &#123; &#125;;<br>&gt;obj.<span class="hljs-title function_">func</span>();<span class="hljs-comment">//this --&gt; obj</span><br><br>&gt;<span class="hljs-comment">//å¹¿ä¹‰å¯¹è±¡</span><br>&gt;<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;div&#x27;</span>).<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">&quot;red&quot;</span>;<br>&gt;&#125;;<span class="hljs-comment">//this --&gt; div</span><br><br></code></pre></td></tr></table></figure></blockquote><p><strong>å‡½æ•°ä½œä¸ºæ•°ç»„çš„ä¸€ä¸ªå…ƒç´ ï¼Œé€šè¿‡æ•°ç»„ä¸‹æ ‡è°ƒç”¨ï¼ŒthisæŒ‡å‘è¿™ä¸ªæ•°ç»„</strong>  </p><blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">this</span> );<br>&gt;&#125;<br>&gt;<span class="hljs-keyword">var</span> arr = [ func , <span class="hljs-number">2</span> , <span class="hljs-number">3</span> , <span class="hljs-number">4</span> ];<br>&gt;arr[<span class="hljs-number">0</span>]();<span class="hljs-comment">//this --&gt; arr</span><br></code></pre></td></tr></table></figure></blockquote><p><strong>å‡½æ•°ä½œä¸ºwindowå†…ç½®å‡½æ•°çš„å›è°ƒå‡½æ•°è°ƒç”¨ï¼šthisæŒ‡å‘<code>window</code>ï¼ˆsetIntervalã€serTimeoutç­‰ï¼‰</strong></p><blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span> () &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">this</span> );<br>&gt;&#125;<br>&gt;<span class="hljs-built_in">setTimeout</span>(func,<span class="hljs-number">1000</span>);<span class="hljs-comment">// this --&gt;window</span><br></code></pre></td></tr></table></figure></blockquote><p><strong>å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ï¼Œç”¨newå…³é”®å­—è°ƒç”¨çš„æ—¶å€™ï¼ŒthisæŒ‡å‘æ–°newå‡ºæ¥çš„å¯¹è±¡</strong>  </p><blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span> ()&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">this</span> );<br>&gt;&#125;<br>&gt;<span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title function_">func</span>(); <span class="hljs-comment">// this --&gt;newå‡ºæ¥çš„obj</span><br></code></pre></td></tr></table></figure></blockquote>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾</title>
    <link href="/2019/08/08/2019-08-08-%E4%BD%9C%E7%94%A8%E5%9F%9F/"/>
    <url>/2019/08/08/2019-08-08-%E4%BD%9C%E7%94%A8%E5%9F%9F/</url>
    
    <content type="html"><![CDATA[<h2 id="ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾çš„ç†è§£"><a href="#ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾çš„ç†è§£" class="headerlink" title="ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾çš„ç†è§£"></a>ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾çš„ç†è§£</h2><p>ä½œç”¨åŸŸï¼šå‡½æ•°ä½œç”¨åŸŸä¸å˜é‡ä½œç”¨åŸŸ  </p><blockquote><p>å‡½æ•°ä½œç”¨åŸŸçš„ç‰¹ç‚¹ï¼šå¯ä»¥è°ƒç”¨åˆ°å¤–é¢çš„å‡½æ•°ï¼Œä½†æ˜¯è°ƒç”¨ä¸åˆ°é‡Œé¢çš„å‡½æ•°<br>å˜é‡ä½œç”¨åŸŸçš„ç‰¹ç‚¹ï¼šå¯ä»¥è°ƒç”¨åˆ°å¤–é¢çš„å˜é‡ï¼Œä½†æ˜¯è°ƒç”¨ä¸åˆ°é‡Œé¢çš„å˜é‡</p></blockquote><hr><h2 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a><strong>å˜é‡ä½œç”¨åŸŸ</strong></h2><p>åœ¨JavaScriptä¸­å…¨å±€å˜é‡çš„ä½œç”¨åŸŸæ¯”è¾ƒç®€å•ï¼Œå®ƒçš„ä½œç”¨åŸŸæ˜¯å…¨å±€çš„ï¼Œåœ¨ä»£ç çš„ä»»ä½•åœ°æ–¹éƒ½æ˜¯æœ‰å®šä¹‰çš„ã€‚ç„¶è€Œå‡½æ•°çš„å‚æ•°å’Œå±€éƒ¨å˜é‡åªåœ¨å‡½æ•°ä½“å†…æœ‰å®šä¹‰ã€‚å¦å¤–<code>å±€éƒ¨å˜é‡çš„ä¼˜å…ˆçº§è¦é«˜äºåŒåçš„å…¨å±€å˜é‡</code>,ä¹Ÿå°±æ˜¯è¯´å½“å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡é‡åæ—¶ï¼Œ<code>å±€éƒ¨å˜é‡ä¼šè¦†ç›–å…¨å±€å˜é‡</code>ï¼ˆå¦‚ä¸‹é¢ä¾‹å­ï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> num = <span class="hljs-number">1</span>;<span class="hljs-comment">//å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> num = <span class="hljs-number">2</span>; <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªå±€éƒ¨å˜é‡</span><br><span class="hljs-keyword">return</span> num;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">foo</span>() );<span class="hljs-comment">//è¾“å‡º2</span><br></code></pre></td></tr></table></figure><p><em>æ³¨ï¼šå£°æ˜å±€éƒ¨å˜é‡çš„æ—¶å€™ä¸€å®šè¦<code>var</code>ï¼Œå¦åˆ™è§£é‡Šå™¨ä¼šå°†å˜é‡å½“åšå¯¹è±¡windowçš„å±æ€§ï¼Œç›¸å½“äºå…¨å±€å˜é‡</em></p><hr><h2 id="å‡½æ•°ä½œç”¨åŸŸ"><a href="#å‡½æ•°ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°ä½œç”¨åŸŸ"></a><strong>å‡½æ•°ä½œç”¨åŸŸ</strong></h2><p>åœ¨JavaScriptä¸­å˜é‡çš„ä½œç”¨åŸŸï¼Œå¹¶éå’ŒCã€Javaç­‰ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼Œåœ¨å˜é‡å£°æ˜çš„ä»£ç æ®µä¹‹å¤–æ˜¯ä¸å¯è§çš„ï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¸ºå—çº§ä½œç”¨åŸŸï¼Œç„¶è€Œåœ¨JavaScriptä¸­ä½¿ç”¨çš„æ˜¯å‡½æ•°ä½œç”¨åŸŸï¼ˆå˜é‡åœ¨å£°æ˜å®ƒä»¬çš„å‡½æ•°ä½“ä»¥åŠè¿™ä¸ªå‡½æ•°ä½“åµŒå¥—çš„ä»»æ„å‡½æ•°ä½“éƒ½æ˜¯æœ‰å®šä¹‰çš„ï¼‰ã€‚ï¼ˆå¦‚ä¸‹é¢çš„ä¾‹å­ï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);           <span class="hljs-comment">//è¾“å‡ºï¼šundefinedï¼Œè€ŒéæŠ¥é”™ï¼Œå› ä¸ºå˜é‡numåœ¨æ•´ä¸ªå‡½æ•°ä½“å†…éƒ½æ˜¯æœ‰å®šä¹‰çš„</span><br><span class="hljs-keyword">var</span> num = <span class="hljs-number">1</span>;                <span class="hljs-comment">//å£°æ˜num åœ¨æ•´ä¸ªå‡½æ•°ä½“funcå†…éƒ½æœ‰å®šä¹‰</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(num);           <span class="hljs-comment">//è¾“å‡ºï¼š1</span><br>&#125;<br><span class="hljs-title function_">func</span>();<br></code></pre></td></tr></table></figure><p><em>æ³¨ï¼šJavaScriptçš„å‡½æ•°ä½œç”¨åŸŸæ˜¯æŒ‡åœ¨åœ¨å‡½æ•°å†…å£°æ˜çš„æ‰€æœ‰å˜é‡åœ¨å‡½æ•°ä½“å†…å§‹ç»ˆæ˜¯å¯è§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å‡½æ•°ä½“å†…å˜é‡å£°æ˜ä¹‹å‰å°±å·²ç»å¯ç”¨äº†ã€‚</em></p><p><strong>ä½œä¸ºå±æ€§çš„å˜é‡:å½“å£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯å®šä¹‰äº†å…¨å±€å¯¹è±¡windowçš„ä¸€ä¸ªå±æ€§ã€‚</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> num = <span class="hljs-number">1</span>;            <span class="hljs-comment">//å£°æ˜å…¨å˜é‡num</span><br><span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">num</span>)       <span class="hljs-comment">//è¾“å‡ºï¼š1 å£°æ˜çš„å…¨å±€å˜é‡å®é™…ä¸Šå°±æ˜¯å£°æ˜äº†ä¸€ä¸ªwindowå¯¹è±¡çš„å±æ€§</span><br><br></code></pre></td></tr></table></figure><hr><h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a><strong>ä½œç”¨åŸŸé“¾</strong></h2><h3 id="1-ä»€ä¹ˆæ˜¯è‡ªç”±å˜é‡"><a href="#1-ä»€ä¹ˆæ˜¯è‡ªç”±å˜é‡" class="headerlink" title="1.ä»€ä¹ˆæ˜¯è‡ªç”±å˜é‡"></a>1.ä»€ä¹ˆæ˜¯è‡ªç”±å˜é‡</h3><p>é¦–å…ˆè®¤è¯†ä¸€ä¸‹ä»€ä¹ˆå«åš <strong>è‡ªç”±å˜é‡</strong> ã€‚å¦‚ä¸‹ä»£ç ä¸­ï¼Œ<code>console.log(a)</code>è¦å¾—åˆ°<code>a</code>å˜é‡ï¼Œä½†æ˜¯åœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­æ²¡æœ‰å®šä¹‰<code>a</code>ï¼ˆå¯å¯¹æ¯”ä¸€ä¸‹<code>b</code>ï¼‰ã€‚å½“å‰ä½œç”¨åŸŸæ²¡æœ‰å®šä¹‰çš„å˜é‡ï¼Œè¿™æˆä¸º è‡ªç”±å˜é‡ ã€‚è‡ªç”±å˜é‡çš„å€¼å¦‚ä½•å¾—åˆ° â€”â€” å‘çˆ¶çº§ä½œç”¨åŸŸå¯»æ‰¾ï¼ˆè¿™ç§è¯´æ³•ä¸ä¸¥è°¨ï¼‰ã€‚  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">200</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// è¿™é‡Œçš„aåœ¨è¿™é‡Œå°±æ˜¯ä¸€ä¸ªè‡ªç”±å˜é‡</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b)<br>&#125;<br><span class="hljs-title function_">fn</span>()<br></code></pre></td></tr></table></figure><h3 id="2-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸé“¾"><a href="#2-ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸé“¾" class="headerlink" title="2.ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸé“¾"></a>2.ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸé“¾</h3><p>å¦‚æœçˆ¶çº§ä¹Ÿæ²¡æœ‰å‘¢ï¼Ÿå†å±‚å±‚å¾€ä¸Šæ‰¾ï¼Œå¦‚æœæ‰¾åˆ°å…¨å±€å˜é‡è¿˜æ˜¯æ²¡æœ‰æ‰¾åˆ°ï¼Œé‚£å°±å®£å‘Šå¤±è´¥ï¼Œè¿™ç§ä¸€å±‚ä¸€å±‚çš„å…³ç³»å°±å«åšä½œç”¨åŸŸé“¾</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">F1</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">var</span> b = <span class="hljs-number">200</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">F2</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">var</span> c = <span class="hljs-number">300</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a) <span class="hljs-comment">// è‡ªç”±å˜é‡ï¼Œé¡ºä½œç”¨åŸŸé“¾å‘çˆ¶ä½œç”¨åŸŸæ‰¾</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b) <span class="hljs-comment">// è‡ªç”±å˜é‡ï¼Œé¡ºä½œç”¨åŸŸé“¾å‘çˆ¶ä½œç”¨åŸŸæ‰¾</span><br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(c) <span class="hljs-comment">// æœ¬ä½œç”¨åŸŸçš„å˜é‡</span><br>    &#125;<br>    <span class="hljs-title function_">F2</span>()<br>&#125;<br><span class="hljs-title function_">F1</span>()<br></code></pre></td></tr></table></figure><h3 id="3-å…³äºè‡ªç”±å˜é‡çš„å–å€¼"><a href="#3-å…³äºè‡ªç”±å˜é‡çš„å–å€¼" class="headerlink" title="3.å…³äºè‡ªç”±å˜é‡çš„å–å€¼"></a>3.å…³äºè‡ªç”±å˜é‡çš„å–å€¼</h3><p>è¿™é‡Œè¦çº æ­£ä¸€ä¸‹ç¬¬ä¸€ç‚¹æ—¶å€™è¯´åˆ°çš„è‡ªç”±å˜é‡æ˜¯å‘çˆ¶çº§ä½œç”¨åŸŸå¯»æ‰¾è€Œå¾—åˆ°çš„è¿™ä¸ªè¯´æ³•ï¼›å› ä¸ºåƒå¦‚ä¸‹çš„æ—¶å€™ä¼šäº§ç”Ÿæ­§ä¹‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> x = <span class="hljs-number">10</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x)<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">show</span>(<span class="hljs-params">f</span>) &#123;<br>  <span class="hljs-keyword">var</span> x = <span class="hljs-number">20</span><br>  (<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title function_">f</span>() <span class="hljs-comment">//10ï¼Œè€Œä¸æ˜¯20</span><br>  &#125;)()<br>&#125;<br><span class="hljs-title function_">show</span>(fn)<br></code></pre></td></tr></table></figure><p>åœ¨fnå‡½æ•°ä¸­ï¼Œå–è‡ªç”±å˜é‡<code>x</code>çš„å€¼æ—¶ï¼Œè¦åˆ°å“ªä¸ªä½œç”¨åŸŸä¸­å–ï¼Ÿâ€”è¦åˆ°åˆ›å»ºfnå‡½æ•°çš„é‚£ä¸ªä½œç”¨åŸŸä¸­å–ï¼Œ<strong>ä¸è®ºfnå‡½æ•°è¦åœ¨å“ªé‡Œè°ƒç”¨</strong><br>æ‰€ä»¥æ¢ä¸€ç§è¯´æ³•ï¼Œè‡ªç”±å˜é‡è¦åˆ°<strong>åˆ›å»ºè¿™ä¸ªå‡½æ•°çš„é‚£ä¸ªåŸŸ</strong>ä½œç”¨åŸŸä¸­å»å–å€¼ï¼›æ³¨æ„æ˜¯<code>åˆ›å»º</code>ï¼Œä¸æ˜¯<code>è°ƒç”¨</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">fn</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">var</span> b = <span class="hljs-number">20</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a + b) <span class="hljs-comment">//30</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> bar<br>&#125;<br><span class="hljs-keyword">var</span> x = <span class="hljs-title function_">fn</span>(),<br>  b = <span class="hljs-number">200</span><br><span class="hljs-title function_">x</span>() <span class="hljs-comment">//bar()</span><br></code></pre></td></tr></table></figure><p>fn()è¿”å›çš„æ˜¯bar()å‡½æ•°ï¼Œè¢«èµ‹å€¼ç»™äº†<code>x</code>,æ‰§è¡Œx()ï¼Œç›¸å½“äºæ‰§è¡Œbar()ï¼Œéœ€è¦å–<code>a</code>å’Œ<code>b</code>çš„å€¼ï¼Œ<code>b</code>çš„å€¼å¯ä»¥ç›´æ¥åœ¨fn()ä¸­å–å‡ºï¼Œè€Œaå–ä¸åˆ°ï¼Œåˆ™å†åˆ°åˆ›å»ºfn()çš„ä½œç”¨åŸŸä¸­å¯»æ‰¾ï¼Œå¾—åˆ°<code>a = 10</code>ï¼Œæ‰€ä»¥æœ€åç»“æœä¸º 30ã€‚</p><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Weekly Practice</title>
    <link href="/2019/08/08/2019-08-08-%E7%BB%83%E4%B9%A0/"/>
    <url>/2019/08/08/2019-08-08-%E7%BB%83%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="1-åˆ—è¡¨éš”è¡Œæ¢è‰²"><a href="#1-åˆ—è¡¨éš”è¡Œæ¢è‰²" class="headerlink" title="1. åˆ—è¡¨éš”è¡Œæ¢è‰²"></a>1. åˆ—è¡¨éš”è¡Œæ¢è‰²</h3><p>ç®€å•çš„å¾ªç¯å’ŒJSè·å–å…ƒç´ æ ·å¼ï¼ˆstyleï¼‰è¿ç”¨</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;lis.<span class="hljs-property">length</span>;i++)&#123;<br><span class="hljs-keyword">if</span>( i%<span class="hljs-number">2</span> )&#123;   <span class="hljs-comment">//å¶æ•°è¡Œ</span><br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&#x27;red&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;   <span class="hljs-comment">//å¥‡æ•°è¡Œ</span><br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&#x27;blue&#x27;</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åªè¦èƒ½åˆ¤æ–­å¥‡å¶è¡Œï¼Œåˆ«çš„å°±æ²¡å•¥éš¾çš„äº†ã€‚</p><hr><h3 id="ä¹ä¹ä¹˜æ³•è¡¨"><a href="#ä¹ä¹ä¹˜æ³•è¡¨" class="headerlink" title="ä¹ä¹ä¹˜æ³•è¡¨"></a>ä¹ä¹ä¹˜æ³•è¡¨</h3><p>åµŒå¥—å¾ªç¯ã€ä¿®æ”¹DOMå†…å®¹çš„ç»“åˆè®­ç»ƒï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨<code>document.write()</code>æ‰“å°åœ¨é¡µé¢ä¸Š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;elem&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> elem = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;elem&#x27;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">1</span>;i&lt;=<span class="hljs-number">9</span>;i++)&#123;<br><span class="hljs-keyword">for</span>( j=<span class="hljs-number">1</span>; j&lt;=i; j++ )&#123;<br>elem.<span class="hljs-property">innerHTML</span> +=  i +<span class="hljs-string">&#x27;*&#x27;</span>+ j +<span class="hljs-string">&#x27;=&#x27;</span> + i*j + <span class="hljs-string">&#x27; &#x27;</span>;<br>&#125;<br>elem.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†…å¾ªç¯ä¸­çš„<code>j &lt;= i</code>ç€å®å·§å¦™ï¼Œè®©ä»£ç å‘ˆæ¢¯å½¢æ‰“å°ï¼Œå¦‚æœè®©å˜é‡<code>j</code>å°äº9çš„è¯ï¼Œé‚£ä¹ˆè¾“å‡ºä¼šæ‰“å°ä¸¤é</p><hr><h3 id="Vå­—æ’åˆ—"><a href="#Vå­—æ’åˆ—" class="headerlink" title="Vå­—æ’åˆ—"></a>Vå­—æ’åˆ—</h3><p>å°±æ˜¯å¯¹æ¯ä¸€ä¸ªdivç»å¯¹å®šä½ï¼Œåˆ†åˆ«å®šä¹‰ä»–ä»¬çš„<code>top</code>å’Œ<code>left</code>,ä»è€Œå‘ˆVå­—æ’åˆ—</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;lis.<span class="hljs-property">length</span>;i++)&#123;<br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = i * <span class="hljs-number">50</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br><span class="hljs-keyword">if</span>( i &gt; <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(lis.<span class="hljs-property">length</span>/<span class="hljs-number">2</span>) )&#123;<br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = (lis.<span class="hljs-property">length</span> - i - <span class="hljs-number">1</span>) * <span class="hljs-number">50</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = i * <span class="hljs-number">50</span> + <span class="hljs-string">&#x27;px&#x27;</span>;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ä¸€ä¸‹å…³äºå­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™å¼•å·å’Œ+å·çš„ä½¿ç”¨æŠ€å·§</strong></p><hr><h3 id="æ±‚ç¬¬ä¸ƒä½çš„æ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#æ±‚ç¬¬ä¸ƒä½çš„æ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="æ±‚ç¬¬ä¸ƒä½çš„æ–æ³¢é‚£å¥‘æ•°åˆ—"></a>æ±‚ç¬¬ä¸ƒä½çš„æ–æ³¢é‚£å¥‘æ•°åˆ—</h3><p>è¿™é‡Œåªä½¿ç”¨å¾ªç¯æ¥å®ç°ï¼Œé€’å½’æ–¹æ³•åé¢ä¼šæåˆ°å¹¶å®ç°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> number = <span class="hljs-number">8</span>;<br><span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>; <br><span class="hljs-keyword">var</span> one = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">var</span> two = <span class="hljs-number">1</span>;   <br><br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">2</span>;i&lt;number;i++)&#123;<br>result = one + two;<br>one = two; <br>two = result;<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( result );<br></code></pre></td></tr></table></figure><p>å› ä¸ºå‰ä¸¤é¡¹æˆ‘ä»¬å®šä¹‰äº†ä¸º<code>one = 1</code>å’Œ<code>two = 1</code>ï¼Œæ‰€ä»¥å¾ªç¯ä»2å¼€å§‹ã€‚</p><hr><h3 id="é¢˜ç›®å¤ªé•¿â€¦â€¦"><a href="#é¢˜ç›®å¤ªé•¿â€¦â€¦" class="headerlink" title="é¢˜ç›®å¤ªé•¿â€¦â€¦"></a>é¢˜ç›®å¤ªé•¿â€¦â€¦</h3><p>å‡è®¾æŸäººæœ‰ 100,000  ç°é‡‘ã€‚ æ¯ç»è¿‡ä¸€æ¬¡è·¯å£éœ€è¦è¿›è¡Œä¸€æ¬¡äº¤è´¹ã€‚ äº¤è´¹è§„åˆ™ä¸ºå½“ä»–ç°é‡‘å¤§äº50,000  æ—¶æ¯æ¬¡éœ€è¦äº¤ 5% ï¼Œå¦‚æœç°é‡‘å°äºç­‰äº 50,000  æ—¶æ¯æ¬¡äº¤ 5,000 ã€‚ è¯·å†™ä¸€ç¨‹åºè®¡ç®—æ­¤äººå¯ä»¥ç»è¿‡å¤šå°‘æ¬¡è¿™ä¸ªè·¯å£ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> all = <span class="hljs-number">100000</span>;<br><span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">while</span>( all &gt;= <span class="hljs-number">5000</span> )&#123;<br><span class="hljs-keyword">if</span>( all &gt; <span class="hljs-number">50000</span> )&#123;<br>  all -= all * <span class="hljs-number">0.05</span>;<br>  count++;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>all -= <span class="hljs-number">5000</span>;<br>count++;<br>&#125;<br>&#125;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( count );   <span class="hljs-comment">//23</span><br></code></pre></td></tr></table></figure><p>æ²¡å•¥å¥½è¯´çš„â€¦â€¦æŒºç»å…¸çš„ä¸€é“é¢˜ï¼Œå„ç§è¯­è¨€çš„ç‰ˆæœ¬éƒ½æœ‰</p><hr><h3 id="æ‰¾å‡ºè™½æœ‰ä¸‰ä½æ•°ä¸­çš„æ°´ä»™èŠ±æ•°"><a href="#æ‰¾å‡ºè™½æœ‰ä¸‰ä½æ•°ä¸­çš„æ°´ä»™èŠ±æ•°" class="headerlink" title="æ‰¾å‡ºè™½æœ‰ä¸‰ä½æ•°ä¸­çš„æ°´ä»™èŠ±æ•°"></a>æ‰¾å‡ºè™½æœ‰ä¸‰ä½æ•°ä¸­çš„æ°´ä»™èŠ±æ•°</h3><p>æ‰¾å‡ºæ‰€æœ‰ä¸‰ä½æ•°ä¸­çš„æ°´ä»™èŠ±æ•°ï¼Œå³aÂ³ + bÂ³ + cÂ³ = abc  ï¼Œä¾‹å¦‚ 153å°±æ˜¯ä¸€ç»„æ°´ä»™èŠ±æ•°ï¼Œ1Â³ + 5Â³ + 3Â³ = 153</p><p>é¦–å…ˆéœ€è¦åˆ†ç¦»è¿™ä¸ªä¸‰ä½æ•°ï¼Œå‡è®¾ä¸‰ä½æ•°ä¸º123ï¼Œå¯ä»¥çœ‹æˆ 1 * 100 + 2 * 10  + 3,é‚£å°±å¥½åŠäº†ï¼Œåªéœ€è¦å¦‚ä¸‹æ“ä½œï¼Œä¸‰ä½æ•°å°±è¢«åˆ†ç¦»å‡ºæ¥äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//è€å¸ˆçš„åŠæ³•</span><br><span class="hljs-keyword">var</span> ge = number%<span class="hljs-number">10</span>;<br><span class="hljs-keyword">var</span> shi = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(number%<span class="hljs-number">100</span>/<span class="hljs-number">10</span>);<br><span class="hljs-keyword">var</span> bai = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(number/<span class="hljs-number">100</span>);<br><span class="hljs-comment">//æˆ‘çš„åŠæ³•</span><br><span class="hljs-keyword">var</span> ge = i % <span class="hljs-number">10</span>;<br><span class="hljs-keyword">var</span> shi = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>( i / <span class="hljs-number">10</span> % <span class="hljs-number">10</span>);<br><span class="hljs-keyword">var</span> bai = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>( i / <span class="hljs-number">100</span> % <span class="hljs-number">10</span>);<br><span class="hljs-comment">//å¤§åŒå°å¼‚ï¼Œå–œæ¬¢å“ªä¸ªç”¨å“ªä¸ª</span><br></code></pre></td></tr></table></figure><p>ç„¶åå¥—åˆ°å¾ªç¯é‡Œï¼Œè¿›è¡Œåˆ¤æ–­å°±å¥½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">for</span>( <span class="hljs-keyword">var</span> i = <span class="hljs-number">100</span>;i &lt; <span class="hljs-number">1000</span>; ++i )&#123;<br>   <span class="hljs-keyword">var</span> a = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>( i / <span class="hljs-number">100</span> % <span class="hljs-number">10</span>);<br>   <span class="hljs-keyword">var</span> b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>( i / <span class="hljs-number">10</span> % <span class="hljs-number">10</span>);<br>   <span class="hljs-keyword">var</span> c = i % <span class="hljs-number">10</span>;<br>   <span class="hljs-keyword">if</span>( i == <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(a,<span class="hljs-number">3</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(b,<span class="hljs-number">3</span>) + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(c,<span class="hljs-number">3</span>) )&#123;<br>   <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">write</span>( i + <span class="hljs-string">&#x27;&amp;nbsp;&#x27;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="8æœˆ7æ—¥"><a href="#8æœˆ7æ—¥" class="headerlink" title="8æœˆ7æ—¥"></a>8æœˆ7æ—¥</h2><p>ï¼ˆæ­¤æ—¥ç­”æ¡ˆå‡ä¸ºæ‘¸é±¼ç‹è‡ªå·±åšçš„ï¼Œå¯èƒ½ä¸å¤Ÿç®€å•æ˜äº†ï¼Œç­‰ä»¥åæ›´æ–°ä¼˜åŒ–ï¼‰</p><h3 id="1-é˜¶ä¹˜ã€å››åˆ™è¿ç®—è®¡ç®—å™¨"><a href="#1-é˜¶ä¹˜ã€å››åˆ™è¿ç®—è®¡ç®—å™¨" class="headerlink" title="1.é˜¶ä¹˜ã€å››åˆ™è¿ç®—è®¡ç®—å™¨"></a>1.é˜¶ä¹˜ã€å››åˆ™è¿ç®—è®¡ç®—å™¨</h3><p>è‡ªå·±çš„è§£æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//é˜¶ä¹˜</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">jc</span>(<span class="hljs-params"> m </span>)&#123;<br><span class="hljs-keyword">var</span> result = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>;i &lt;= m ; ++i)&#123;<br>result *= i;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( result );<br>&#125;<br><span class="hljs-title function_">jc</span>(<span class="hljs-number">3</span>);<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//å››åˆ™è¿ç®—è®¡ç®—å™¨</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">calc</span>(<span class="hljs-params"> a, b, f</span>)&#123;<br><span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">switch</span>(f)&#123;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;+&#x27;</span>:<br>result = a + b;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;-&#x27;</span>:<br>result = a - b;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;*&#x27;</span>:<br>result = a * b;<br><span class="hljs-keyword">break</span>;<br><span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;/&#x27;</span>:<br>result = a / b;<br><span class="hljs-keyword">break</span>;<br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( result );<br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="2-å®ç°åé€‰å…¨é€‰åŠŸèƒ½"><a href="#2-å®ç°åé€‰å…¨é€‰åŠŸèƒ½" class="headerlink" title="2. å®ç°åé€‰å…¨é€‰åŠŸèƒ½"></a>2. å®ç°åé€‰å…¨é€‰åŠŸèƒ½</h3><p>è‡ªå·±æ— èŠæŠŠå…¨é€‰ã€å…¨ä¸é€‰ã€åé€‰å’Œè”åŠ¨å…¨é€‰éƒ½å†™å‡ºæ¥äº†</p><p>é¡µé¢éƒ¨åˆ†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;allChoose&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">for</span>=<span class="hljs-string">&quot;allChoose&quot;</span>&gt;</span>å…¨é€‰<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;noChoose&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;å…¨ä¸é€‰&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;otherChoose&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;åé€‰&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;choose&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;choose&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;choose&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;checkbox&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;choose&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><p>jséƒ¨åˆ†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> qx = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;allChoose&#x27;</span>);<br><span class="hljs-keyword">var</span> cbs = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByClassName</span>(<span class="hljs-string">&#x27;choose&#x27;</span>);<br><span class="hljs-keyword">var</span> qbx = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;noChoose&#x27;</span>);<br><span class="hljs-keyword">var</span> fx = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;otherChoose&#x27;</span>);<br><span class="hljs-comment">//å…¨é€‰</span><br>qx.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">checked</span> == <span class="hljs-literal">true</span>) &#123;<span class="hljs-comment">//ç”¨äº†ä¸€ä¸‹thisï¼Œæ¯”è¾ƒæ–¹ä¾¿</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;cbs.<span class="hljs-property">length</span>;i++) &#123;<br>cbs[i].<span class="hljs-property">checked</span> = <span class="hljs-literal">true</span>;<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;cbs.<span class="hljs-property">length</span>;i++) &#123;<br>cbs[i].<span class="hljs-property">checked</span> = <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br>&#125;<br><span class="hljs-comment">//å…¨ä¸é€‰</span><br>qbx.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; cbs.<span class="hljs-property">length</span>; ++i)&#123;<br>cbs[i].<span class="hljs-property">checked</span> = <span class="hljs-literal">false</span>;<br>&#125;<br>qx.<span class="hljs-property">checked</span> = <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-comment">//åé€‰</span><br>fx.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; cbs.<span class="hljs-property">length</span>;++i)&#123;<br><span class="hljs-keyword">if</span>(!cbs[i].<span class="hljs-property">checked</span>)&#123;<br>cbs[i].<span class="hljs-property">checked</span> = <span class="hljs-number">1</span>;<br>n++<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>cbs[i].<span class="hljs-property">checked</span> = <span class="hljs-number">0</span>;<br>qx.<span class="hljs-property">checked</span> = <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br><span class="hljs-keyword">if</span>(n == cbs.<span class="hljs-property">length</span>)&#123;<br>qx.<span class="hljs-property">checked</span> = <span class="hljs-literal">true</span>;<br>&#125;<br><br>&#125;<br><span class="hljs-comment">//è”åŠ¨å…¨é€‰</span><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;cbs.<span class="hljs-property">length</span>;i++) &#123;<br>cbs[i].<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)<br>&#123;<br><span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>;           <br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; cbs.<span class="hljs-property">length</span>; ++i) &#123;<br><span class="hljs-keyword">if</span> (cbs[i].<span class="hljs-property">checked</span> == <span class="hljs-literal">true</span>) &#123;<br>n++;<br>&#125;<br>&#125;               <br><span class="hljs-keyword">if</span> (n == cbs.<span class="hljs-property">length</span>) &#123;<br>qx.<span class="hljs-property">checked</span> = <span class="hljs-literal">true</span>;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><br>qx.<span class="hljs-property">checked</span> = <span class="hljs-literal">false</span>;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é€»è¾‘å…¶å®å¾ˆç®€å•ï¼Œå³å…¨é€‰æ—¶è®©<code>checkbox</code>çš„<code>checked</code>å±æ€§ä¸ºçœŸï¼Œå…¨ä¸é€‰çš„æ—¶å€™ä¸ºå‡ï¼Œæ³¨æ„å¦‚æœä½¿ç”¨<code>checkbox</code>åˆ¶ä½œå…¨é€‰ï¼Œé‚£åªè¦ä¸æ˜¯å…¨é€‰ï¼Œå®ƒçš„çŠ¶æ€éƒ½æ˜¯å‡ï¼Œåªè¦æ‰€æœ‰<code>checkbox</code>çš„<code>checked</code>å±æ€§ä¸ºçœŸï¼Œé‚£å®ƒå°±æ˜¯çœŸï¼Œè”åŠ¨å…¨é€‰å°±æ˜¯åˆ¤æ–­ä¸€ä¸‹ä½ å‹¾é€‰çš„<code>checkbox</code>æ•°é‡å’Œè·å–æ—¶å€™çš„é›†åˆé•¿åº¦æ˜¯å¦ä¸€è‡´ï¼Œä¸€è‡´åˆ™å‹¾é€‰å…¨é€‰ï¼Œåä¹‹ä¸å‹¾é€‰ã€‚</p><hr><h3 id="3-çŒœæ•°å­—å°æ¸¸æˆ"><a href="#3-çŒœæ•°å­—å°æ¸¸æˆ" class="headerlink" title="3. çŒœæ•°å­—å°æ¸¸æˆ"></a>3. çŒœæ•°å­—å°æ¸¸æˆ</h3><p>æ¯•ç«Ÿç«‹å¿—æ‘¸é±¼ï¼Œæ‰€ä»¥å°±ç›´æ¥ä½¿ç”¨<code>prompt()</code>å†…ç½®å‡½æ•°å†™äº†ä¸€ä¸ªï¼Œçœ‹çœ‹å‘¨å›´éƒ½æ˜¯ç”¨<code>input</code>å†™çš„é¢ï¼Œæˆ‘å¥½åƒæ˜¯æœ‰ç‚¹â€¦â€¦emmmm</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-keyword">var</span> a=<span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*<span class="hljs-number">99</span>+<span class="hljs-number">1</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br><span class="hljs-keyword">var</span> b;<br>outer : <span class="hljs-keyword">for</span>( i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; ++i)&#123;<br>b=<span class="hljs-title class_">Number</span>(<span class="hljs-title function_">prompt</span>(<span class="hljs-string">&quot;è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—&quot;</span>));<br><span class="hljs-comment">//ç‚¹å‡»ç¡®å®šè¿”å›è¾“å‡ºå€¼ï¼Œç‚¹å‡»å–æ¶ˆè¿”å›nullå€¼</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">prompt</span>() ); <br><span class="hljs-keyword">if</span>(b == <span class="hljs-string">&#x27;&#x27;</span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;è¾“å…¥ä¸èƒ½ä¸ºç©º&#x27;</span>);<br>b=<span class="hljs-title class_">Number</span>(<span class="hljs-title function_">prompt</span>(<span class="hljs-string">&quot;è¯·é‡æ–°è¾“å…¥ä¸€ä¸ªæ•°å­—&quot;</span>));<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b &gt; a)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;çŒœå¤§äº†,çŒœäº†ï¼š&quot;</span>+ i +<span class="hljs-string">&quot;æ¬¡&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b &lt; a)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;çŒœå°äº†,çŒœäº†ï¼š&quot;</span>+ i +<span class="hljs-string">&quot;æ¬¡&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == a)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;æ­å–œçŒœä¸­äº†,ä½ ä¸€å…±çŒœäº†&quot;</span>+ i +<span class="hljs-string">&quot;æ¬¡,ä¸­å¥–æ•°å­—ä¸ºï¼š&quot;</span>+ a);<br><span class="hljs-keyword">break</span>;<br>&#125;<br><br>&#125;<br><span class="hljs-keyword">if</span>(i&gt;<span class="hljs-number">10</span>)&#123;<br><span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;è¯·é‡æ–°å¼€å§‹æ¸¸æˆï¼&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»è¿‡<code>console.log()</code>è¯æ˜è¿™é‡Œçš„<code>prompt()</code>çš„ç¡®å®šå–æ¶ˆæŒ‰é’®çš„è¿”å›å€¼å‡ä¸ºè¾“å…¥æ¡†çš„å†…å®¹ã€‚</p><h3 id="4-åˆ‡æ¢åˆ—è¡¨é¡¹-å¾€è¿”-åˆ—è¡¨éšæœºèƒŒæ™¯é¢œè‰²"><a href="#4-åˆ‡æ¢åˆ—è¡¨é¡¹-å¾€è¿”-åˆ—è¡¨éšæœºèƒŒæ™¯é¢œè‰²" class="headerlink" title="4. åˆ‡æ¢åˆ—è¡¨é¡¹(å¾€è¿”) + åˆ—è¡¨éšæœºèƒŒæ™¯é¢œè‰²"></a>4. åˆ‡æ¢åˆ—è¡¨é¡¹(å¾€è¿”) + åˆ—è¡¨éšæœºèƒŒæ™¯é¢œè‰²</h3><p>è¿™é‡Œæš‚æ—¶æä¾›è‡ªå·±çš„å†™æ³•ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯å½“<code>count == lis.length - 1</code>å³åˆ‡æ¢åˆ°æœ€åä¸€ä¸ª<code>li</code> çš„æ—¶å€™ï¼Œè®¾ç½®ä¸€ä¸ª<code>flag</code>ï¼Œå¹¶å°†å®ƒç½®ä¸€ä¸ªæ–°çŠ¶æ€ä»£è¡¨å‘ä¸Šï¼Œå¹¶è®©<code>count--</code>ï¼Œå½“å‘ä¸ŠçŠ¶æ€ä¸‹<code>count == 0</code>çš„æ—¶å€™å†å°†<code>flag</code>ç½®åŸçŠ¶æ€å³å‘ä¸‹åˆ‡æ¢ï¼Œå®ç°çš„æ—¶å€™æœ‰äº›éº»çƒ¦ï¼Œè¿˜åœ¨å¯»æ±‚ç®€ä¾¿æ“ä½œï¼Œè‡³äºéšæœºé¢œè‰²å°±å¾ˆç®€å•äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;button&#x27;</span>)[<span class="hljs-number">0</span>];<br><span class="hljs-keyword">var</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;li&#x27;</span>);<br><span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">var</span> flag = <span class="hljs-number">1</span>;<br>btn.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;i &lt; lis.<span class="hljs-property">length</span>;++i)&#123;<br>lis[i].<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br><br>&#125;<br>lis[count].<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">&#x27;rgb(&#x27;</span>+ <span class="hljs-title function_">getRandom</span>() +<span class="hljs-string">&#x27;,&#x27;</span>+ <span class="hljs-title function_">getRandom</span>() + <span class="hljs-string">&#x27;,&#x27;</span> + <span class="hljs-title function_">getRandom</span>() + <span class="hljs-string">&#x27;)&#x27;</span>;<br><span class="hljs-keyword">if</span>(count &lt; lis.<span class="hljs-property">length</span> - <span class="hljs-number">1</span> &amp;&amp; flag == <span class="hljs-number">1</span>)&#123;<span class="hljs-comment">//å‘ä¸‹åˆ‡æ¢li</span><br>count++;<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(count == lis.<span class="hljs-property">length</span> -<span class="hljs-number">1</span> &amp;&amp; flag == <span class="hljs-number">1</span>)&#123;<span class="hljs-comment">//åˆ‡æ¢åˆ°æœ€åä¸€ä¸ªliï¼Œæ›´æ”¹åˆ‡æ¢æ–¹å‘</span><br>flag = <span class="hljs-number">0</span>;<br>count--;<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(flag == <span class="hljs-number">0</span> &amp;&amp; count &lt; lis.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)&#123;<span class="hljs-comment">//æ–¹å‘æ˜¯å‘ä¸Šçš„æ—¶å€™</span><br>flag = <span class="hljs-number">0</span>;<br>count--; <br><span class="hljs-keyword">if</span>(count == <span class="hljs-number">0</span>)&#123;<span class="hljs-comment">//å¦‚æœåˆ°äº†ç¬¬ä¸€ä¸ªliï¼Œå˜æ›´flagçš„çŠ¶æ€</span><br>flag = <span class="hljs-number">1</span>;<br>&#125;<br>&#125;<br><br>&#125;<br><span class="hljs-comment">//éšæœºé¢œè‰²</span><br><span class="hljs-keyword">var</span> getRandom = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> a = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*<span class="hljs-number">255</span>);<br><span class="hljs-keyword">return</span> a;<br><br>&#125;<br></code></pre></td></tr></table></figure><hr><h3 id="5-å¾®ä¿¡èŠå¤©"><a href="#5-å¾®ä¿¡èŠå¤©" class="headerlink" title="5. å¾®ä¿¡èŠå¤©"></a>5. å¾®ä¿¡èŠå¤©</h3><p>å°±æ˜¯å®ç°ä¸€ä¸ªèŠå¤©æ¡†<br><img src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1565255508820&di=f075d7b5c32f4948e388d106509d89d4&imgtype=jpg&src=http://img3.imgtn.bdimg.com/it/u=1344723893,43652449&fm=214&gp=0.jpg"><br>å¤´åƒå¯ä»¥ç‚¹å‡»ï¼Œåˆ‡æ¢ç”¨æˆ·<br>éš¾ç‚¹ä¸æ˜¯å¾ˆå¤šï¼Œç»™æ¯ä¸ªç”¨æˆ·å³æ¯ä¸ªå¤´åƒä¸€ä¸ªç±»ï¼Œç”¨ä»¥åŒºåˆ†èŠå¤©è€…ï¼Œå›¾ç‰‡ç”¨ä¸€ä¸ªæ•°ç»„å­˜èµ·æ¥ï¼Œå½“<code>onclick</code>äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ï¼Œåˆ‡æ¢æ•°ç»„å…ƒç´ ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs css">*&#123;<span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span>; <span class="hljs-attribute">padding</span>:<span class="hljs-number">0</span>&#125;<br><span class="hljs-selector-tag">li</span>&#123;<span class="hljs-attribute">list-style</span>: none;&#125;<br><span class="hljs-selector-class">.container</span>&#123; <br><span class="hljs-attribute">width</span>:<span class="hljs-number">256px</span>; <br><span class="hljs-attribute">height</span>:<span class="hljs-number">540px</span>; <br><span class="hljs-attribute">margin</span>:<span class="hljs-number">20px</span> auto <span class="hljs-number">0</span>; <br><span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;../../iPhone.png&#x27;</span>);<br><span class="hljs-attribute">background-size</span>: cover; <br><span class="hljs-attribute">position</span>:relative;<br>&#125;<br><span class="hljs-selector-id">#name</span>&#123;<br><span class="hljs-attribute">width</span>:<span class="hljs-number">24px</span>; <br><span class="hljs-attribute">height</span>:<span class="hljs-number">28px</span>;<br><span class="hljs-attribute">border</span>:<span class="hljs-number">1px</span> solid darkgrey; <br><span class="hljs-attribute">border-radius</span>: <span class="hljs-number">8px</span>; <br><span class="hljs-attribute">padding</span>:<span class="hljs-number">1px</span>; <br><span class="hljs-attribute">cursor</span>:pointer;<br><span class="hljs-attribute">position</span>: absolute;<br><span class="hljs-attribute">left</span>: <span class="hljs-number">4px</span>;<br><span class="hljs-attribute">bottom</span>:<span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-selector-class">.main</span>&#123;<br><span class="hljs-attribute">bottom</span>:<span class="hljs-number">81px</span>; <br><span class="hljs-attribute">left</span>:<span class="hljs-number">22px</span>; <br><span class="hljs-attribute">border-top</span>:<span class="hljs-number">1px</span> solid darkgrey; <br><span class="hljs-attribute">position</span>:absolute;<br><span class="hljs-attribute">padding</span>:<span class="hljs-number">6px</span> <span class="hljs-number">4px</span> <span class="hljs-number">4px</span> <span class="hljs-number">7px</span>;<br><span class="hljs-attribute">width</span>: <span class="hljs-number">206px</span>;<br>&#125;<br><span class="hljs-selector-id">#import</span>&#123;<br><span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>; <br><span class="hljs-attribute">height</span>:<span class="hljs-number">18px</span>; <br><span class="hljs-attribute">line-height</span>:<span class="hljs-number">18px</span>; <br><span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#b8b8b8</span>; <br><span class="hljs-attribute">outline</span>:<span class="hljs-number">0</span>;<br><span class="hljs-attribute">padding</span>:<span class="hljs-number">5px</span> <span class="hljs-number">0</span>; <br><span class="hljs-attribute">bottom</span>:<span class="hljs-number">5px</span>; <br><span class="hljs-attribute">position</span>:relative; <br><span class="hljs-attribute">bottom</span>:-<span class="hljs-number">2px</span>;<br><span class="hljs-attribute">left</span>: <span class="hljs-number">30px</span>;<br><span class="hljs-attribute">width</span>: <span class="hljs-number">128px</span>;<br>&#125;<br><span class="hljs-selector-id">#enter</span>&#123;<br><span class="hljs-attribute">font</span>: <span class="hljs-number">18px</span> <span class="hljs-string">&#x27;Microsoft YaHei&#x27;</span>;<br><span class="hljs-attribute">bottom</span>: -<span class="hljs-number">5px</span>;<br><span class="hljs-attribute">left</span>: <span class="hljs-number">29px</span>;  <br><span class="hljs-attribute">position</span>: relative; <br><span class="hljs-attribute">cursor</span>:pointer;<br><span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;<br>&#125;<br><span class="hljs-selector-class">.content</span>&#123;<br><span class="hljs-attribute">width</span>: <span class="hljs-number">206px</span>;<br><span class="hljs-attribute">height</span>: <span class="hljs-number">336px</span>;<br><span class="hljs-attribute">top</span>: <span class="hljs-number">84px</span>; <br><span class="hljs-attribute">position</span>: relative;<br><span class="hljs-attribute">overflow</span>: auto;<br><span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">28px</span>;<br>&#125;<br><span class="hljs-selector-class">.content</span> <span class="hljs-selector-tag">li</span>&#123; <br><span class="hljs-attribute">line-height</span>:<span class="hljs-number">28px</span>;<br><span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">15px</span>;<br><span class="hljs-attribute">overflow</span>: hidden;<br><span class="hljs-attribute">position</span>: relative;<br>&#125;<br><span class="hljs-selector-id">#inHtml</span> <span class="hljs-selector-tag">img</span>&#123;<br><span class="hljs-attribute">width</span>:<span class="hljs-number">25px</span>; <br><span class="hljs-attribute">height</span>:<span class="hljs-number">25px</span>;<br><span class="hljs-attribute">position</span>: relative;<br>&#125;<br><span class="hljs-selector-class">.th</span>&#123;<br><span class="hljs-attribute">text-align</span>: right;<br>&#125;<br><span class="hljs-selector-class">.th</span> <span class="hljs-selector-tag">img</span>&#123;<br><span class="hljs-attribute">float</span><span class="hljs-selector-pseudo">:right</span>; <br><span class="hljs-attribute">margin-left</span>:<span class="hljs-number">15px</span>;<br>&#125;<br><span class="hljs-selector-class">.ds</span> <span class="hljs-selector-tag">img</span>&#123;    <br><span class="hljs-attribute">width</span>: <span class="hljs-number">25px</span>;<br><span class="hljs-attribute">height</span>: <span class="hljs-number">25px</span>;<br><span class="hljs-attribute">position</span>: relative;<br><span class="hljs-attribute">float</span>: left;<br><span class="hljs-attribute">margin-right</span>: <span class="hljs-number">15px</span>;<br>&#125;<br><span class="hljs-selector-class">.th</span> <span class="hljs-selector-tag">p</span>&#123;<br><span class="hljs-attribute">background</span>: forestgreen; <br><span class="hljs-attribute">text-align</span>: left;<br><span class="hljs-attribute">padding</span>: <span class="hljs-number">3px</span> <span class="hljs-number">5px</span>;<br><span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;<br><span class="hljs-attribute">color</span>: white; <br><span class="hljs-attribute">float</span><span class="hljs-selector-pseudo">:right</span>;<br><span class="hljs-attribute">max-width</span>: <span class="hljs-number">182px</span>;<br><span class="hljs-attribute">font</span>:<span class="hljs-number">14px</span> <span class="hljs-string">&#x27;Microsoft YaHei&#x27;</span>; <br>&#125;<br><span class="hljs-selector-class">.ds</span> <span class="hljs-selector-tag">p</span>&#123;<br><span class="hljs-attribute">background</span>: dimgrey;<br><span class="hljs-attribute">float</span>: left;<br><span class="hljs-attribute">text-align</span>: left;<br><span class="hljs-attribute">padding</span>: <span class="hljs-number">3px</span> <span class="hljs-number">4px</span>;<br><span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;<br><span class="hljs-attribute">color</span>: white;<br><span class="hljs-attribute">left</span>: <span class="hljs-number">32px</span>;<br><span class="hljs-attribute">max-width</span>: <span class="hljs-number">190px</span>; <br><span class="hljs-attribute">font</span>:<span class="hljs-number">14px</span> <span class="hljs-string">&#x27;Microsoft YaHei&#x27;</span>;<br>&#125;<br><span class="hljs-selector-class">.ds</span>&#123; <br><span class="hljs-attribute">text-align</span>: left;<br>&#125;<br><span class="hljs-selector-class">.sent1</span>&#123;<span class="hljs-attribute">width</span>:<span class="hljs-number">0</span>; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>; <span class="hljs-attribute">border</span>:solid <span class="hljs-number">8px</span>; <span class="hljs-attribute">border-color</span>: white white white forestgreen; <span class="hljs-attribute">position</span>: absolute;<span class="hljs-attribute">right</span>: <span class="hljs-number">24px</span>;<span class="hljs-attribute">top</span>: <span class="hljs-number">4px</span>;&#125;<br><span class="hljs-selector-class">.sent2</span>&#123;<span class="hljs-attribute">width</span>:<span class="hljs-number">0</span>; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>; <span class="hljs-attribute">border</span>:solid <span class="hljs-number">8px</span>; <span class="hljs-attribute">border-color</span>: white dimgrey white white ; <span class="hljs-attribute">position</span>: absolute;<span class="hljs-attribute">left</span>: <span class="hljs-number">24px</span>;<span class="hljs-attribute">top</span>: <span class="hljs-number">4px</span>;&#125;<br></code></pre></td></tr></table></figure><p>èŠå¤©æ¡†çš„ä¸‰è§’å¯ä»¥ç”¨è¾¹æ¡†å®ç°ï¼Œå…·ä½“ä¸è¯´äº†ï¼Œç™¾åº¦ä¸€ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;inHtml&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;name&#x27;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;../../qq1.gif&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&#x27;import&#x27;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;enter&quot;</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸è®¾ç½®<code>li</code>ï¼Œé€šè¿‡jsåŠ¨æ€ç”Ÿæˆ<code>li</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//ç»™ä¸¤ä¸ªå›¾ç‰‡å®šä¹‰ä¸ºä¸€ä¸ªæ•°ç»„</span><br><span class="hljs-keyword">var</span> arr = [<span class="hljs-string">&#x27;../../qq1.gif&#x27;</span>,<span class="hljs-string">&#x27;../../qq2.gif&#x27;</span>];<br><span class="hljs-comment">//å¾—åˆ°åç§°çš„å›¾æ ‡</span><br><span class="hljs-keyword">var</span> oName = $(<span class="hljs-string">&#x27;name&#x27;</span>);<br><span class="hljs-comment">//å¾—åˆ°è¾“å…¥å†…å®¹</span><br><span class="hljs-keyword">var</span> oGet = $(<span class="hljs-string">&#x27;import&#x27;</span>);<br><span class="hljs-comment">//æ˜¾ç¤ºè¾“å…¥å†…å®¹</span><br><span class="hljs-keyword">var</span> oWrite = $(<span class="hljs-string">&#x27;inHtml&#x27;</span>);<br><span class="hljs-comment">//é»˜è®¤æ˜¾ç¤ºåœŸè±ª</span><br><span class="hljs-keyword">var</span> onOff = <span class="hljs-literal">true</span>;<br>oName.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-keyword">if</span>(onOff)&#123;<br>oName.<span class="hljs-property">src</span> = arr[<span class="hljs-number">1</span>];<br>onOff = <span class="hljs-literal">false</span>;<br>oGet.<span class="hljs-title function_">focus</span>();<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>oName.<span class="hljs-property">src</span> = arr[<span class="hljs-number">0</span>];<br>onOff = <span class="hljs-literal">true</span>;<br>oGet.<span class="hljs-title function_">focus</span>();<br>&#125;<br>&#125;<br><span class="hljs-comment">//å‘é€äº‹ä»¶</span><br><span class="hljs-keyword">var</span> oSet = $(<span class="hljs-string">&#x27;enter&#x27;</span>);<br>oSet.<span class="hljs-property">onclick</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">if</span>(onOff)&#123;<br>oWrite.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">&#x27;&lt;li class=&quot;th&quot;&gt;&#x27;</span> + <span class="hljs-string">&#x27;&lt;img src=&#x27;</span>+arr[<span class="hljs-number">0</span>] + <span class="hljs-string">&quot; /&gt;&lt;p&gt;&quot;</span> + oGet.<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;&lt;span class=&quot;sent1&quot;&gt;&lt;/span&gt;&#x27;</span> +<span class="hljs-string">&quot;&lt;/p&gt;&lt;/li&gt;&quot;</span>;<br>&#125; <span class="hljs-keyword">else</span>&#123;<br>oWrite.<span class="hljs-property">innerHTML</span> += <span class="hljs-string">&#x27;&lt;li class=&quot;ds&quot;&gt;&#x27;</span> + <span class="hljs-string">&#x27;&lt;img src=&#x27;</span>+arr[<span class="hljs-number">1</span>] + <span class="hljs-string">&quot; /&gt;&lt;p&gt;&quot;</span> + oGet.<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;&lt;span class=&quot;sent2&quot;&gt;&lt;/span&gt;&#x27;</span> + <span class="hljs-string">&quot;&lt;/p&gt;&lt;/li&gt;&quot;</span>;<br>&#125;<br>oGet.<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>oGet.<span class="hljs-title function_">focus</span>();<br>&#125;<br><br><br><span class="hljs-comment">//è°ƒç”¨IDé€šé…ç¬¦</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">id</span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id);<br>&#125;<br><br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSå‡½æ•°</title>
    <link href="/2019/08/07/2019-08-07-JS%E5%87%BD%E6%95%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2019/08/07/2019-08-07-JS%E5%87%BD%E6%95%B0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="JSå‡½æ•°çš„å®šä¹‰"><a href="#JSå‡½æ•°çš„å®šä¹‰" class="headerlink" title="JSå‡½æ•°çš„å®šä¹‰"></a>JSå‡½æ•°çš„å®šä¹‰</h2><h3 id="å‡½æ•°çš„å®šä¹‰ï¼š"><a href="#å‡½æ•°çš„å®šä¹‰ï¼š" class="headerlink" title="å‡½æ•°çš„å®šä¹‰ï¼š"></a>å‡½æ•°çš„å®šä¹‰ï¼š</h3><p>å‡½æ•°æ˜¯è®¡ç®—æœºç¼–ç¨‹ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªè¯­æ³•ç»“æ„ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å‡½æ•°å‘¢ï¼Ÿå‡½æ•°æŒ‡ä¸€ç»„å¯ä»¥éšæ—¶éšåœ°è¿è¡Œçš„ä»£ç é›†åˆï¼Œå½“ä»–è¢«è°ƒç”¨æ—¶å¯é‡å¤çš„å»æ‰§è¡Œè¿™äº›ä»£ç é›†åˆã€‚<br>ç±»æ¯”æ•°å­¦ä¸­çš„å‡½æ•°ï¼š<br>æ•°å­¦ä¸­çš„å‡½æ•°æŒ‡ç»™å®šä¸€ä¸ªæ•°é›†A,å¯¹Aæ–½åŠ å¯¹åº”æ³•åˆ™f,è®°ä½œfï¼ˆAï¼‰,å¾—åˆ°å¦ä¸€æ•°é›†B,ä¹Ÿå°±æ˜¯B=fï¼ˆAï¼‰.é‚£ä¹ˆè¿™ä¸ªå…³ç³»å¼å°±å«å‡½æ•°å…³ç³»å¼,ç®€ç§°å‡½æ•°ã€‚</p><hr><h2 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h2><h3 id="å®šä¹‰å‡½æ•°"><a href="#å®šä¹‰å‡½æ•°" class="headerlink" title="å®šä¹‰å‡½æ•°"></a>å®šä¹‰å‡½æ•°</h3><p>JSä¸­åˆ›å»ºå‡½æ•°æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ol><li>å‡½æ•°å£°æ˜</li><li>å‡½æ•°è¡¨è¾¾å¼</li><li>å‡½æ•°å¯¹è±¡</li></ol><h4 id="1-å‡½æ•°å£°æ˜"><a href="#1-å‡½æ•°å£°æ˜" class="headerlink" title="1.å‡½æ•°å£°æ˜"></a>1.å‡½æ•°å£°æ˜</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<span class="hljs-comment">//è°ƒç”¨å‡½æ•°</span><br></code></pre></td></tr></table></figure><h4 id="2-å‡½æ•°è¡¨è¾¾å¼"><a href="#2-å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="2.å‡½æ•°è¡¨è¾¾å¼"></a>2.å‡½æ•°è¡¨è¾¾å¼</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br>&#125;<br><br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure><h4 id="3-å‡½æ•°å¯¹è±¡ï¼ˆäº†è§£ï¼‰"><a href="#3-å‡½æ•°å¯¹è±¡ï¼ˆäº†è§£ï¼‰" class="headerlink" title="3.å‡½æ•°å¯¹è±¡ï¼ˆäº†è§£ï¼‰"></a>3.å‡½æ•°å¯¹è±¡ï¼ˆäº†è§£ï¼‰</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>();<br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure><h3 id="å…³äºå‡½æ•°å£°æ˜åŠè§£æ"><a href="#å…³äºå‡½æ•°å£°æ˜åŠè§£æ" class="headerlink" title="å…³äºå‡½æ•°å£°æ˜åŠè§£æ"></a>å…³äºå‡½æ•°å£°æ˜åŠè§£æ</h3><h4 id="1-å‡½æ•°å£°æ˜ä¼šé¢„è§£æï¼ˆä»…åœ¨å½“å‰æ‰€åœ¨çš„scriptå—å†…ï¼‰"><a href="#1-å‡½æ•°å£°æ˜ä¼šé¢„è§£æï¼ˆä»…åœ¨å½“å‰æ‰€åœ¨çš„scriptå—å†…ï¼‰" class="headerlink" title="1.å‡½æ•°å£°æ˜ä¼šé¢„è§£æï¼ˆä»…åœ¨å½“å‰æ‰€åœ¨çš„scriptå—å†…ï¼‰"></a>1.å‡½æ•°å£°æ˜ä¼šé¢„è§£æï¼ˆä»…åœ¨å½“å‰æ‰€åœ¨çš„scriptå—å†…ï¼‰</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">foo</span>();<span class="hljs-comment">//æ§åˆ¶å°æ‰“å°123</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-å‡½æ•°è¡¨è¾¾å¼ä¸å…·å¤‡é¢„è§£æåŠŸèƒ½"><a href="#2-å‡½æ•°è¡¨è¾¾å¼ä¸å…·å¤‡é¢„è§£æåŠŸèƒ½" class="headerlink" title="2.å‡½æ•°è¡¨è¾¾å¼ä¸å…·å¤‡é¢„è§£æåŠŸèƒ½"></a>2.å‡½æ•°è¡¨è¾¾å¼ä¸å…·å¤‡é¢„è§£æåŠŸèƒ½</h4><h4 id="3-å˜é‡è§£æè¦é«˜äºå‡½æ•°çš„é¢„è§£æ"><a href="#3-å˜é‡è§£æè¦é«˜äºå‡½æ•°çš„é¢„è§£æ" class="headerlink" title="3.å˜é‡è§£æè¦é«˜äºå‡½æ•°çš„é¢„è§£æ"></a>3.å˜é‡è§£æè¦é«˜äºå‡½æ•°çš„é¢„è§£æ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a );<span class="hljs-comment">//æ§åˆ¶å°æ‰“å° f a ( )&#123; &#125;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params"></span>)&#123;<br><br>&#125;<br><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;   <span class="hljs-comment">// å˜é‡é¢„è§£æè¦é«˜äºå‡½æ•°çš„é¢„è§£æ</span><br></code></pre></td></tr></table></figure><h4 id="4-å‡½æ•°è¡¨è¾¾å¼å¯ç›´æ¥è°ƒç”¨æ‰§è¡Œ"><a href="#4-å‡½æ•°è¡¨è¾¾å¼å¯ç›´æ¥è°ƒç”¨æ‰§è¡Œ" class="headerlink" title="4.å‡½æ•°è¡¨è¾¾å¼å¯ç›´æ¥è°ƒç”¨æ‰§è¡Œ"></a>4.å‡½æ•°è¡¨è¾¾å¼å¯ç›´æ¥è°ƒç”¨æ‰§è¡Œ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> foo = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;  <span class="hljs-comment">//å‡½æ•°è¡¨è¾¾å¼å¯ç›´æ¥è°ƒç”¨æ‰§è¡Œ</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">456</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">789</span>);<br>&#125;();<br></code></pre></td></tr></table></figure><p>ä½†å‡½æ•°å£°æ˜æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨çš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;   <span class="hljs-comment">//å‡½æ•°å£°æ˜æ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨çš„</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">456</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">789</span>);<br>&#125;();<br></code></pre></td></tr></table></figure><h3 id="å…³äºå‡½æ•°å˜é‡çš„åŒºåŸŸæ€§"><a href="#å…³äºå‡½æ•°å˜é‡çš„åŒºåŸŸæ€§" class="headerlink" title="å…³äºå‡½æ•°å˜é‡çš„åŒºåŸŸæ€§"></a>å…³äºå‡½æ•°å˜é‡çš„åŒºåŸŸæ€§</h3><p>ç¨‹åºå¯»æ‰¾å‚æ•°çš„æ—¶å€™åªèƒ½å¤Ÿå¯»æ‰¾å’Œå®ƒåŒçº§æˆ–å¤–å±‚çš„å˜é‡ï¼Œæ— æ³•å‘å†…å±‚æ‰¾å˜é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> b = <span class="hljs-number">20</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">baz</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( b ); <br>&#125;<br><span class="hljs-title function_">foo</span>();<br><span class="hljs-title function_">baz</span>();<span class="hljs-comment">// =&gt;æŠ¥é”™ï¼Œæ‰¾ä¸åˆ°b </span><br><br><span class="hljs-keyword">var</span> b;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> b = <span class="hljs-number">20</span>;<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">baz</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( b ); <br>&#125;<br><span class="hljs-title function_">foo</span>();<span class="hljs-comment">// =&gt;bé‡æ–°èµ‹å€¼ b = 20;</span><br><span class="hljs-title function_">baz</span>();<span class="hljs-comment">// =&gt;æ‰“å° 20</span><br></code></pre></td></tr></table></figure><hr><h2 id="å˜é‡æå‡é—®é¢˜"><a href="#å˜é‡æå‡é—®é¢˜" class="headerlink" title="å˜é‡æå‡é—®é¢˜"></a>å˜é‡æå‡é—®é¢˜</h2><p>å…ˆç”©ä¸€é“ç»å…¸å˜é‡æå‡é¢˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// ??</span><br>    <span class="hljs-keyword">var</span> a = <span class="hljs-number">20</span>;<br>&#125;<br><span class="hljs-title function_">foo</span>();<br></code></pre></td></tr></table></figure><p>é—®æ§åˆ¶å°æ‰“å°çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p><p>æ€è€ƒ</p><p>ç­”æ¡ˆ   ï¼š   <code>undefined</code><br>ä½¿ç”¨<code>var</code>å…³é”®å­—å£°æ˜çš„å˜é‡åœ¨JavaScriptä¸­ä¼šè¢«æå‡ï¼Œå¹¶åœ¨å†…å­˜ä¸­åˆ†é…<code>undefined</code>ï¼Œä½†åˆå§‹åŒ–å´å‘ç”Ÿåœ¨ä½ ç»™å˜é‡èµ‹å€¼çš„åœ°æ–¹ï¼Œå¦å¤–<code>var</code>å£°æ˜çš„å˜é‡æ˜¯<code>å‡½æ•°ä½œç”¨åŸŸçš„</code>ï¼Œæ‰€ä»¥ä¸Šè¿°ä»£ç å—è§£æå¯ä»¥çœ‹åšä»¥ä¸‹è¿‡ç¨‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>; <span class="hljs-comment">// å…¨å±€ä½¿ç”¨åŸŸ</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-comment">// var a çš„å£°æ˜å°†è¢«æå‡åˆ°åˆ°å‡½æ•°çš„é¡¶éƒ¨ã€‚</span><br><span class="hljs-comment">// æ¯”å¦‚:var a</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">// æ‰“å° undefined</span><br><br><span class="hljs-comment">// å®é™…åˆå§‹åŒ–å€¼20åªå‘ç”Ÿåœ¨è¿™é‡Œ</span><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-number">20</span>; <span class="hljs-comment">// local scope</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¾¹çš„ä»£ç å—ç†è§£äº†ä¸‹è¾¹çš„ä»£ç å—ç†è§£èµ·æ¥å°±å¾ˆæ–¹ä¾¿äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">18</span>;<br><span class="hljs-title function_">f1</span>();<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f1</span>(<span class="hljs-params"></span>)&#123;<br>   <span class="hljs-keyword">var</span> b=<span class="hljs-number">9</span>;<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br>   <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);<br>   <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;123&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç­”æ¡ˆ ï¼š <code>undefined</code>        ,    <code>9</code><br>è§£æè¿‡ç¨‹ç›´æ¥ä»¥ä»£ç å½¢å¼å‘ˆç°ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒå®¹æ˜“ç†è§£</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//ç¬¬ä¸€æ­¥ï¼šé¢„è§£æ</span><br><span class="hljs-keyword">var</span> a;<br><span class="hljs-comment">//ç¬¬ä¸‰æ­¥ï¼šå½“æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå†æ¬¡è¿›è¡Œé¢„è§£æ(å±€éƒ¨ä½œç”¨åŸŸ)</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f1</span>(<span class="hljs-params"></span>)&#123;<br><span class="hljs-keyword">var</span> b;<br><span class="hljs-keyword">var</span> a;<br><span class="hljs-comment">//ç¬¬å››æ­¥ï¼šä¸€è¡Œä¸€è¡Œæ‰§è¡Œä»£ç </span><br>b=<span class="hljs-number">9</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(b);<br>a = <span class="hljs-string">&#x27;123&#x27;</span>;<br>&#125;<br><span class="hljs-comment">//ç¬¬äºŒæ­¥ï¼šä¸€è¡Œä¸€è¡Œæ‰§è¡Œä»£ç </span><br>a = <span class="hljs-number">18</span>;<br><span class="hljs-title function_">f1</span>();<br></code></pre></td></tr></table></figure><hr><h2 id="JSå‡½æ•°å‚æ•°"><a href="#JSå‡½æ•°å‚æ•°" class="headerlink" title="JSå‡½æ•°å‚æ•°"></a>JSå‡½æ•°å‚æ•°</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">n</span>)&#123;  <span class="hljs-comment">//å½¢å¼å‚æ•°ï¼šå½¢å‚   var n = 123</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n);<br>&#125;<br><br><span class="hljs-title function_">foo</span>(<span class="hljs-number">123</span>);  <span class="hljs-comment">//å®é™…å‚æ•°ï¼šå®å‚ */</span><br></code></pre></td></tr></table></figure><p>å®å‚çš„ä¸ªæ•°å’Œå½¢å‚çš„ä¸ªæ•°ä¸ä¸€å®šè¦ä¸€æ ·</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">n1,n2,n3</span>)&#123;  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n3);<br>&#125;<br><br><span class="hljs-title function_">foo</span>(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>);<br></code></pre></td></tr></table></figure><p><code>arguments</code>å¯¹è±¡ï¼šè¡¨ç¤ºå®å‚çš„é›†åˆ  </p><p><code>arguments.length</code>  : è·å–é›†åˆé•¿åº¦  </p><p>é€šè¿‡    <code>[]</code>    è·å–é›†åˆæ•°ç»„çš„ä¸‹æ ‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"> <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;  <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">arguments</span>[<span class="hljs-number">0</span>]); <br><span class="hljs-keyword">var</span> result = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-variable language_">arguments</span>.<span class="hljs-property">length</span>;i++)&#123;<br> result += <span class="hljs-variable language_">arguments</span>[i];    <br>&#125;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( result );<br>&#125;<br><br><span class="hljs-title function_">foo</span>(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><h2 id="å…³äºJSä¸­å‡½æ•°çš„å‚æ•°"><a href="#å…³äºJSä¸­å‡½æ•°çš„å‚æ•°" class="headerlink" title="å…³äºJSä¸­å‡½æ•°çš„å‚æ•°"></a>å…³äºJSä¸­å‡½æ•°çš„å‚æ•°</h2><p><a href="https://www.cnblogs.com/lcq1467/p/7101519.html">å¾—ç›Šäºæ­¤æ–‡çš„å¯å‘</a>  </p><p>å‡½æ•°çš„å‚æ•°å±äºå‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®åˆ°ï¼Œå³ä½¿å’Œå¤–éƒ¨å˜é‡åŒåï¼Œå®ƒä»¬ä¹Ÿæ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">a</span>)&#123;<br>a++;ã€€ã€€ã€€ã€€ã€€ã€€<span class="hljs-comment">//a(å½¢å‚)æ˜¯å±€éƒ¨å˜é‡</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br>&#125;<br><span class="hljs-title function_">test</span>(a);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">//ç»“æœæ˜¯ 101 100;</span><br></code></pre></td></tr></table></figure><p>ç±»ä¼¼äºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"> </span>)&#123;<br><span class="hljs-keyword">var</span> a=<span class="hljs-number">100</span>;   <span class="hljs-comment">//aæ˜¯å±€éƒ¨å˜é‡</span><br>a++;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br>&#125;<br><span class="hljs-title function_">test</span>( );<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a); <span class="hljs-comment">//ç»“æœ 101 100;</span><br></code></pre></td></tr></table></figure><p>å½“å‡½æ•°æ²¡æœ‰å®šä¹‰å‚æ•°æˆ–è€…å†…éƒ¨æ²¡æœ‰<code>var</code>å˜é‡ï¼Œå†…éƒ¨çš„å˜é‡é»˜è®¤ä¸ºå…¨å±€å˜é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a =<span class="hljs-number">100</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span> ()&#123;<br>a++;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<br>&#125;<br><span class="hljs-title function_">test</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a);<span class="hljs-comment">//æ§åˆ¶å°æ‰“å° 101101ï¼Œå› ä¸ºaæ˜¯å…¨å±€å˜é‡</span><br></code></pre></td></tr></table></figure><p>å½“å‡½æ•°å®šä¹‰äº†å‚æ•°ï¼Œä½†æ²¡æœ‰ä¼ å®å‚çš„æ—¶å€™ï¼Œå½¢å‚é»˜è®¤ä¸ºundefined</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = <span class="hljs-number">100</span>;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">a</span>)&#123;<br>a++;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a );<br>&#125;<br><span class="hljs-title function_">test</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a );<span class="hljs-comment">//ç¬¬ä¸€ä¸ªè¿”å›undefinedç¬¬äºŒä¸ªè¿”å›100</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å¦‚æœé€šè¿‡å¯¹è±¡ä¼ é€’å‚æ•°ï¼Œå‡½æ•°å†…éƒ¨å¯¹è±¡å±æ€§å€¼å‘ç”Ÿæ”¹å˜ï¼Œå¤–éƒ¨è¢«ä¼ é€’å¯¹è±¡çš„å±æ€§å€¼ä¹Ÿä¼šæ”¹å˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> a = &#123;x : <span class="hljs-number">100</span>&#125;;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">a</span>)&#123;<br>a.<span class="hljs-property">x</span>++;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a.<span class="hljs-property">x</span> );<br>&#125;<br><span class="hljs-title function_">test</span>(a);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( a.<span class="hljs-property">x</span> );<span class="hljs-comment">//ç¬¬ä¸€ä¸ªè¿”å›101ï¼Œç¬¬äºŒä¸ªè¿”å›101</span><br></code></pre></td></tr></table></figure><p><strong>æ€»ç»“ï¼š</strong><br><code>é€šè¿‡å€¼ä¼ é€’å‚æ•°</code>ï¼š    åœ¨å‡½æ•°ä¸­è°ƒç”¨çš„å‚æ•°æ˜¯å‡½æ•°å‚æ•°ï¼ˆå±äºå±€éƒ¨å˜é‡èŒƒç•´ï¼‰ï¼Œå¦‚æœå‡½æ•°ä¿®æ”¹å‚æ•°å€¼ï¼Œå°†ä¸ä¼šæ”¹å˜å¤–éƒ¨è¢«å¼•ç”¨çš„å®å‚å€¼<br><code>é€šè¿‡å¯¹è±¡ä¼ é€’å‚æ•°</code>ï¼šå¯¹è±¡å±æ€§çš„å˜é‡æ˜¯ç›¸å½“äºæŒ‡é’ˆï¼Œå› æ­¤å‡½æ•°ä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼æ—¶ï¼Œå¤–éƒ¨çš„å¯¹è±¡å±æ€§ä¹Ÿä¼šæ”¹å˜ã€‚<br>è¿™ä¹Ÿæ¶‰åŠåˆ°åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å€¼ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆundefinedã€nullã€booleanã€Numberï¼‰æ˜¯æŒ‰å€¼è®¿é—®çš„ï¼Œæ‰€ä»¥å±€éƒ¨å˜é‡ä¸å…¨å±€å˜é‡å³ä½¿åå­—ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡<br><code>æ€»è€Œè¨€ä¹‹</code><br>1.å‡½æ•°å‚æ•°æ˜¯è¢«å½“åšå˜é‡å¯¹å¾…çš„<br>2.å‚æ•°æ˜¯æŒ‰å€¼ä¼ é€’çš„<br>3.ä¼ é€’å‚æ•°çš„æ—¶å€™è¦ç¡®å®šä¼ é€’çš„æ•°æ®ç±»å‹</p><p>å¯¹è±¡å±äºå¼•ç”¨ç±»å‹ï¼Œå½“å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå°†è¿™ä¸ªå˜é‡èµ‹ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œç›¸å½“äºå¦ä¸€ä¸ªå˜é‡ä¹Ÿå˜ä¸ºäº†æŒ‡é’ˆï¼›ä¸¤ä¸ªå˜é‡éƒ½æŒ‡å‘åŒä¸€å¯¹è±¡ï¼›æ‰€ä»¥åœ¨å¼•ç”¨æ•°æ®ç±»å‹ç…§ç‰‡ä¸­ï¼Œå˜é‡ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆ^[æ³¨ï¼šJavaScripté«˜çº§ç¨‹åºè®¾è®¡ç¬¬å››ç«  å˜é‡ã€ä½œç”¨åŸŸå’Œå†…å­˜ æœ‰è¯¦ç»†ä»‹ç»]</p><hr><h2 id="return"><a href="#return" class="headerlink" title="return"></a>return</h2><p>è¿”å›å€¼<code>return</code> ï¼š è¡¨ç¤ºå‡½æ•°æ‰§è¡Œå®Œçš„è¿”å›å€¼ï¼Œå½“å‡½æ•°æ²¡æœ‰å†™<code>return</code>çš„æ—¶å€™ï¼Œå‡½æ•°è°ƒç”¨å®Œå°±ä¼šå˜æˆ<code>undefined</code>ç„¶å<code>return</code>;<br><strong><code>return</code> ç±»ä¼¼äºè·³å‡ºæ“ä½œï¼Œæ‰€ä»¥returnåçš„ä»£ç æ˜¯ä¸æ‰§è¡Œçš„</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>)&#123;<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">123</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-number">456</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">789</span>);<span class="hljs-comment">//returnåé¢çš„ä»£ç ä¸æ‰§è¡Œ</span><br>&#125;   <br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title function_">foo</span>() );<span class="hljs-comment">// æ§åˆ¶å°æ‰“å° 123 456</span><br><br></code></pre></td></tr></table></figure><hr><p><strong>å‡½æ•°ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾ä¼šå•å†™ä¸€ç¯‡</strong></p><hr><h2 id="å‡½æ•°ä¸äº‹ä»¶"><a href="#å‡½æ•°ä¸äº‹ä»¶" class="headerlink" title="å‡½æ•°ä¸äº‹ä»¶"></a>å‡½æ•°ä¸äº‹ä»¶</h2><h3 id="JSäº‹ä»¶"><a href="#JSäº‹ä»¶" class="headerlink" title="JSäº‹ä»¶"></a>JSäº‹ä»¶</h3><p>é¼ æ ‡ã€é”®ç›˜è§¦å‘çš„ä¸€äº›åŠŸèƒ½ï¼ˆä¸€äº›åŠŸèƒ½å°±æ˜¯è‡ªå·±å®šä¹‰çš„å‡½æ•°ï¼Œè·Ÿäº‹ä»¶å…³è”çš„å‡½æ•°å«åšäº‹ä»¶å‡½æ•°ï¼‰</p><h3 id="äº‹ä»¶å‡½æ•°"><a href="#äº‹ä»¶å‡½æ•°" class="headerlink" title="äº‹ä»¶å‡½æ•°"></a>äº‹ä»¶å‡½æ•°</h3><p><code>onclick</code> : ç‚¹å‡»ï¼ˆä¸åªæ˜¯é¼ æ ‡ï¼Œé”®ç›˜ä¹Ÿå¯ä»¥ï¼‰<br><code>ondbclick</code> : åŒå‡»<br><code>onmousedown</code> ï¼šé¼ æ ‡æŒ‰ä¸‹<br><code>onmouseup</code>ï¼šé¼ æ ‡æŠ¬èµ·<br><code>onmouseover</code>ï¼šé¼ æ ‡ç§»å…¥<br><code>onmouseout</code>ï¼šé¼ æ ‡ç§»å‡º<br><code>onmousemove</code>ï¼šé¼ æ ‡ç§»åŠ¨ï¼ˆè¿ç»­è§¦å‘ï¼‰  </p><hr><h2 id="ä»£ç ç®€åŒ–"><a href="#ä»£ç ç®€åŒ–" class="headerlink" title="ä»£ç ç®€åŒ–"></a>ä»£ç ç®€åŒ–</h2><p>ä¸¾ä¸ªæ —å­ï¼Œä»¥å‰æˆ‘ä»¬è·å–å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦ä¸‹è¾¹è¿™ä¹ˆå¤šçš„ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> elem1 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;elem1&#x27;</span>);<br><span class="hljs-keyword">var</span> elem2 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;elem2&#x27;</span>);<br><span class="hljs-keyword">var</span> elem3 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;elem3&#x27;</span>);<br><span class="hljs-keyword">var</span> elem4 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;elem4&#x27;</span>);<br></code></pre></td></tr></table></figure><p>è€Œå¦‚æœæˆ‘ä»¬æŠŠå®ƒå°è£…åˆ°ä¸€ä¸ªå‡½æ•°é‡Œï¼Œæ¯æ¬¡å–å…ƒç´ çš„æ—¶å€™è°ƒç”¨ï¼Œä¸æ˜¯æ–¹ä¾¿å¤šäº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> elem1 = $(<span class="hljs-string">&#x27;elem1&#x27;</span>);<br><span class="hljs-keyword">var</span> elem2 = $(<span class="hljs-string">&#x27;elem2&#x27;</span>);<br><span class="hljs-keyword">var</span> elem3 = $(<span class="hljs-string">&#x27;elem3&#x27;</span>);<br><span class="hljs-keyword">var</span> elem4 = $(<span class="hljs-string">&#x27;elem4&#x27;</span>);<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">$</span>(<span class="hljs-params">id</span>)&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(id);<br>&#125;<br></code></pre></td></tr></table></figure><hr><h2 id="å¸¸ç”¨å†…ç½®å‡½æ•°"><a href="#å¸¸ç”¨å†…ç½®å‡½æ•°" class="headerlink" title="å¸¸ç”¨å†…ç½®å‡½æ•°"></a>å¸¸ç”¨å†…ç½®å‡½æ•°</h2><h3 id="alert"><a href="#alert" class="headerlink" title="alert()"></a>alert()</h3><p>æç¤ºæ¡†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">alert</span>(<span class="hljs-number">123</span>);<br></code></pre></td></tr></table></figure><p><img src="/images/alert.png" alt="alert"></p><h3 id="confirm"><a href="#confirm" class="headerlink" title="confirm()"></a>confirm()</h3><p>ç¡®å®šå¯¹è¯æ¡†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">confirm</span>(<span class="hljs-string">&#x27;ä½ å¥½&#x27;</span>);<br></code></pre></td></tr></table></figure><p><img src="/images/confirm.png" alt="confirm"></p><h3 id="prompt"><a href="#prompt" class="headerlink" title="prompt();"></a>prompt();</h3><p>è¾“å…¥å¯¹è¯æ¡†ï¼Œè¿”å›å€¼å°±æ˜¯è¾“å…¥çš„å†…å®¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> result = <span class="hljs-title function_">prompt</span>(<span class="hljs-string">&#x27;æˆ‘å«ä»€ä¹ˆ&#x27;</span> , <span class="hljs-string">&#x27;è¯·è¾“å…¥åå­—&#x27;</span>);<br><span class="hljs-keyword">if</span>(result == <span class="hljs-string">&#x27;xiaoming&#x27;</span>)&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ·»åŠ å¥½å‹&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æ‹’ç»æ·»åŠ &#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/prompt.png" alt="enter description here"></p><h3 id="è½¬æ¢æ•°å­—"><a href="#è½¬æ¢æ•°å­—" class="headerlink" title="è½¬æ¢æ•°å­—"></a>è½¬æ¢æ•°å­—</h3><p>è¿™é‡Œç®€è¿°ä¸¤ç§æ–¹æ³•<code>parseInt()</code>ï¼Œ<code>parseFloat()</code></p><h4 id="parseInt"><a href="#parseInt" class="headerlink" title="parseInt()"></a>parseInt()</h4><p>å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;123px&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-built_in">parseInt</span>(str) );<span class="hljs-comment">//æ§åˆ¶å°æ‰“å°  123</span><br></code></pre></td></tr></table></figure><p><code>parseInt()</code>ä¼šä»å·¦è‡³å³æŒ¨ä¸ªè½¬æ¢ç›´åˆ°ä¸èƒ½è½¬æ¢ä¸ºæ­¢</p><h4 id="parseFloat"><a href="#parseFloat" class="headerlink" title="parseFloat()"></a>parseFloat()</h4><p>å°†å­—ç¬¦ä¸²è½¬æ¢æˆæµ®ç‚¹æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> str = <span class="hljs-string">&#x27;123.45&#x27;</span>;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-built_in">parseFloat</span>(str) );<br></code></pre></td></tr></table></figure><h3 id="isNaN"><a href="#isNaN" class="headerlink" title="isNaN()"></a>isNaN()</h3><p>åˆ¤æ–­æ˜¯å¦æ˜¯NaNï¼Œæ˜¯è¿”å›<code>true</code>ï¼Œä¸æ˜¯è¿”å›<code>false</code><br>ä½†æ˜¯å› ä¸ºJSå†å²åŸå› â€¦â€¦è¿˜æ˜¯æœ‰BUGçš„</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-built_in">isNaN</span>(<span class="hljs-string">&#x27;hello&#x27;</span>) );<span class="hljs-comment">//æ§åˆ¶å°æ‰“å° true </span><br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶ hello ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯NaNï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¼šè¿”å›trueå‘¢<br>çœ‹ä¸€çœ¼    w3cschoolå¯¹isNaNè¿”å›å€¼çš„å®šä¹‰ï¼š  </p><blockquote><p>å¦‚æœ x æ˜¯ç‰¹æ®Šçš„éæ•°å­—å€¼ NaNï¼ˆæˆ–è€…èƒ½è¢«è½¬æ¢ä¸ºè¿™æ ·çš„å€¼ï¼‰ï¼Œè¿”å›çš„å€¼å°±æ˜¯ trueã€‚å¦‚æœ x æ˜¯å…¶ä»–å€¼,åˆ™è¿”å› falseã€‚</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ç¨‹åºå†…éƒ¨ä¼šé¦–å…ˆæŠŠhelloè½¬æ¢æˆNumberç±»å‹ï¼Œè‡ªç„¶å°±å˜æˆäº†NaNï¼Œç„¶åå†è¿›è¡ŒisNaNçš„åˆ¤å®šã€‚<br>ES6æä¾›äº†ä¸€ç§æ›´ä¸ºä¸¥è°¨çš„åˆ¤æ–­æ˜¯å¦æ˜¯NaNçš„æ–¹æ³•ï¼š<code>Number.isNaN()</code></p><p>ç°åœ¨ç”¨è¿™ä¸ªæ–°æ–¹æ³•æ¥åˆ¤æ–­ä¸€ä¸‹helloæ˜¯ä¸æ˜¯NaN</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">isNaN</span>(<span class="hljs-string">&#x27;hello&#x27;</span>) );<span class="hljs-comment">//è¾“å‡ºfalse</span><br></code></pre></td></tr></table></figure><h3 id="isFinite"><a href="#isFinite" class="headerlink" title="isFinite()"></a>isFinite()</h3><p>åˆ¤æ–­æ˜¯å¦æ˜¯æ— é™æ•°å­—ï¼Œå¦‚æœæ˜¯æœ‰é™æ•°å­—è¿”å›<code>true</code>ï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å›<code>false</code></p><p>Infinityï¼šæ— é™å¤§</p><p>-Infinityï¼šæ— é™å°</p><hr><h2 id="Mathå¯¹è±¡"><a href="#Mathå¯¹è±¡" class="headerlink" title="Mathå¯¹è±¡"></a>Mathå¯¹è±¡</h2><p><code>Math.min()</code>ï¼šå–æœ€å°å€¼<br><code>Math.max()</code>ï¼šå–æœ€å¤§å€¼<br><code>Math.cell()</code>ï¼šå‘ä¸Šå–æ•´<br><code>Math.floor()</code>ï¼šå‘ä¸‹å–æ•´<br><code>Math.pow()</code>ï¼šå¹³æ–¹<br><code>Math.sqrt()</code>ï¼šå¼€å¹³æ–¹<br><code>Math.abs()</code>ï¼šå–ç»å¯¹å€¼<br><code>Math.PI</code>ï¼šÏ€å€¼<br><code>Math.random()</code>ï¼šéšæœºä¸€ä¸ª    [0,1)     åŒºé—´çš„æ•°<br><code>Math.round()</code>ï¼šå››èˆäº”å…¥</p><blockquote><p>å¦‚æœæˆ‘æƒ³è¦å¼€ä¸‰æ¬¡æ–¹æˆ–è€…å¤šæ¬¡æ–¹æ€ä¹ˆåŠ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&gt;<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">8</span>,<span class="hljs-number">1</span>/<span class="hljs-number">3</span>);<span class="hljs-comment">//å¼€8çš„ä¸‰æ¬¡æ–¹</span><br></code></pre></td></tr></table></figure><p>ä¸¾ä¸€åä¸‰</p></blockquote><h2 id="åˆæ¢thiså…³é”®å­—"><a href="#åˆæ¢thiså…³é”®å­—" class="headerlink" title="åˆæ¢thiså…³é”®å­—"></a>åˆæ¢thiså…³é”®å­—</h2><p>è¿™é‡Œåªä»‹ç»thisæœ€ç®€å•çš„æŒ‡å‘ï¼Œå³<code>this</code>ä¼šæŒ‡å‘å½“å‰äº‹ä»¶æ‰€æ“ä½œçš„å…ƒç´ </p><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå…¥JSï¼ˆä¸‰ï¼‰</title>
    <link href="/2019/08/06/2019-08-06-%E5%88%9D%E5%85%A5js%EF%BC%88%E4%B8%89%EF%BC%89/"/>
    <url>/2019/08/06/2019-08-06-%E5%88%9D%E5%85%A5js%EF%BC%88%E4%B8%89%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="é€»è¾‘è¿ç®—ç¬¦æ‰©å±•"><a href="#é€»è¾‘è¿ç®—ç¬¦æ‰©å±•" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦æ‰©å±•"></a>é€»è¾‘è¿ç®—ç¬¦æ‰©å±•</h2><p><strong>&amp;&amp; : å¦‚æœå·¦è¾¹è¿”å›çœŸï¼Œé‚£ä¹ˆå°±è¿”å›å³è¾¹çš„å€¼ï¼Œå¦‚æœå·¦è¾¹è¿”å›å‡ï¼Œå°±è¿”å›å·¦è¾¹çš„å€¼  (çŸ­è·¯è¿ç®—)</strong> </p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">console</span>.log( <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-number">2</span> );<br><span class="hljs-attribute">console</span>.log( <span class="hljs-number">1</span>&lt;<span class="hljs-number">2</span> &amp;&amp; <span class="hljs-number">5</span>&gt;<span class="hljs-number">4</span> );   <span class="hljs-number">1</span>&lt;<span class="hljs-number">2</span> -&gt; true  å…¬å¼æ•´ä½“å¾—åˆ° <span class="hljs-number">5</span>&gt;<span class="hljs-number">4</span> -&gt; true<br><span class="hljs-attribute">console</span>.log( <span class="hljs-number">1</span>&gt;<span class="hljs-number">2</span> &amp;&amp; <span class="hljs-number">5</span>&gt;<span class="hljs-number">4</span> );    <span class="hljs-number">1</span>&gt;<span class="hljs-number">2</span> -&gt; false å…¬å¼æ•´ä½“å¾—åˆ°  <span class="hljs-number">1</span>&gt;<span class="hljs-number">2</span> -&gt; false<br></code></pre></td></tr></table></figure><p><strong>|| : å¦‚æœå·¦è¾¹è¿”å›çœŸï¼Œé‚£ä¹ˆå°±è¿”å›å·¦è¾¹çš„å€¼ï¼Œå¦‚æœå·¦è¾¹è¿”å›å‡ï¼Œå°±è¿”å›å³è¾¹çš„å€¼  (çŸ­è·¯è¿ç®—)</strong> </p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-regexp">//console.log( 0 || 2 );</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">//</span>console.log( <span class="hljs-number">1</span>&lt;<span class="hljs-number">2</span> || <span class="hljs-number">5</span>&lt;<span class="hljs-number">4</span> );   <span class="hljs-number">1</span>&lt;<span class="hljs-number">2</span> -&gt; <span class="hljs-literal">true</span>  å…¬å¼æ•´ä½“å¾—åˆ°    <span class="hljs-number">1</span>&lt;<span class="hljs-number">2</span>  -&gt;  <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p><strong>&amp; | ä½è¿ç®— ï¼Œè·Ÿæ­£å¸¸çš„&amp;&amp; || åŠŸèƒ½ç±»ä¼¼ ï¼Œåªä¸è¿‡æ˜¯é’ˆå¯¹äºŒè¿›åˆ¶çš„</strong></p><h2 id="JSæ§åˆ¶æµç¨‹"><a href="#JSæ§åˆ¶æµç¨‹" class="headerlink" title="JSæ§åˆ¶æµç¨‹"></a>JSæ§åˆ¶æµç¨‹</h2><h3 id="é¡ºåºç»“æ„"><a href="#é¡ºåºç»“æ„" class="headerlink" title="é¡ºåºç»“æ„"></a>é¡ºåºç»“æ„</h3><p>&emsp;&emsp;é¡ºåºç»“æ„å°±æ˜¯ç¨‹åºä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³ä¸€å¥ä¸€å¥çš„å»æ‰§è¡Œï¼Œæ²¡å•¥å¥½è¯´çš„ã€‚  </p><h3 id="é€‰æ‹©ç»“æ„"><a href="#é€‰æ‹©ç»“æ„" class="headerlink" title="é€‰æ‹©ç»“æ„"></a>é€‰æ‹©ç»“æ„</h3><h4 id="emsp-1-ifåˆ¤æ–­"><a href="#emsp-1-ifåˆ¤æ–­" class="headerlink" title="&emsp; 1.ifåˆ¤æ–­"></a>&emsp; 1.ifåˆ¤æ–­</h4><ol><li>å•å‘é€‰æ‹© <figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arcade">   <span class="hljs-keyword">if</span>( <span class="hljs-number">5</span> &gt; <span class="hljs-number">3</span> )&#123;    <span class="hljs-comment">// å•å‘é€‰æ‹©</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;ifæ‰§è¡Œ&#x27;</span>);<br>&#125; <br></code></pre></td></tr></table></figure></li><li>åŒå‘é€‰æ‹© <figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">if</span>( <span class="hljs-number">5</span> &lt; <span class="hljs-number">3</span> )&#123;    <span class="hljs-comment">//åŒå‘é€‰æ‹©</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;ifæ‰§è¡Œ&#x27;</span>);<br>  &#125;   <br>  <span class="hljs-keyword">else</span>&#123;<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;elseæ‰§è¡Œ&#x27;</span>);<br>  &#125;<br></code></pre></td></tr></table></figure></li><li>å¤šå‘é€‰æ‹© <figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> <span class="hljs-built_in">day</span> = <span class="hljs-string">&#x27;æ˜ŸæœŸæ—¥&#x27;</span>;<br><br>  <span class="hljs-keyword">if</span>( <span class="hljs-built_in">day</span> == <span class="hljs-string">&#x27;æ˜ŸæœŸä¸€&#x27;</span> )&#123;     <span class="hljs-comment">//å¤šå‘é€‰æ‹©</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;ä¸Šè¯¾&#x27;</span>);<br>  &#125;   <br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( <span class="hljs-built_in">day</span> == <span class="hljs-string">&#x27;æ˜ŸæœŸå››&#x27;</span>)&#123;<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;ä¸Šè‡ªä¹ &#x27;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( <span class="hljs-built_in">day</span> == <span class="hljs-string">&#x27;æ˜ŸæœŸæ—¥&#x27;</span>)&#123;<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;ä¼‘æ¯&#x27;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span>&#123;<br><br>  &#125;<br></code></pre></td></tr></table></figure><h5 id="ifåˆ¤æ–­ä¸­çš„çœŸå‡å€¼"><a href="#ifåˆ¤æ–­ä¸­çš„çœŸå‡å€¼" class="headerlink" title="ifåˆ¤æ–­ä¸­çš„çœŸå‡å€¼"></a><strong>ifåˆ¤æ–­ä¸­çš„çœŸå‡å€¼</strong></h5>falseã€0ã€â€˜â€™ã€undefinedã€nullã€NaN å…­ä¸ªå€¼åœ¨ifåˆ¤æ–­ä¸­ä¸ºå‡å€¼ï¼Œå…¶ä½™æœªå£°æ˜çš„å‡ä¸ºçœŸå€¼  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-regexp">//</span>çœŸå‡å€¼(<span class="hljs-literal">false</span> <span class="hljs-number">0</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-literal">undefined</span> <span class="hljs-literal">null</span> <span class="hljs-literal">NaN</span>)<br><span class="hljs-regexp">//</span>ä¸€ä¸ªå€¼ä¹Ÿå¯ä»¥åšåˆ¤æ–­ï¼Œ<span class="hljs-literal">false</span> <span class="hljs-number">0</span> <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-literal">undefined</span> <span class="hljs-literal">null</span> <span class="hljs-literal">NaN</span> è¿™<span class="hljs-number">6</span>ä¸ªå€¼è¿”å›å‡ï¼Œå…¶ä»–å€¼éƒ½è¿”å›çœŸ<br>   <span class="hljs-keyword">if</span>( [] == <span class="hljs-literal">true</span> )&#123;   [] -&gt; <span class="hljs-number">0</span>    <span class="hljs-literal">true</span> -&gt; <span class="hljs-number">1</span>   <span class="hljs-number">0</span> == <span class="hljs-number">1</span>  <span class="hljs-literal">false</span><br>       console.log(<span class="hljs-string">&#x27;ifæ‰§è¡Œ&#x27;</span>);<br>   &#125;<br>   <span class="hljs-keyword">if</span>( [] )&#123;    [] -&gt; ä¸åœ¨<span class="hljs-number">6</span>ä¸ªå‡å€¼å†…  -&gt;  <span class="hljs-literal">true</span><br>       console.log(<span class="hljs-string">&#x27;ifæ‰§è¡Œ&#x27;</span>);<br>   &#125;<br></code></pre></td></tr></table></figure><h4 id="emsp-2-switchåˆ¤æ–­"><a href="#emsp-2-switchåˆ¤æ–­" class="headerlink" title="&emsp;2.switchåˆ¤æ–­"></a>&emsp;2.switchåˆ¤æ–­</h4>è¯­æ³•æ ¼å¼ï¼š<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> <span class="hljs-built_in">day</span> = <span class="hljs-string">&#x27;æ˜ŸæœŸæ—¥&#x27;</span>;<br><br>   switch( <span class="hljs-built_in">day</span> )&#123;<br>       case <span class="hljs-string">&#x27;æ˜ŸæœŸæ—¥&#x27;</span>:<br>           <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;æ‰§è¡Œ1&#x27;</span>);<br>           <span class="hljs-keyword">break</span>;<br>       case <span class="hljs-string">&#x27;æ˜ŸæœŸä¸€&#x27;</span>:<br>           <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;æ‰§è¡Œ2&#x27;</span>);<br>           <span class="hljs-keyword">break</span>;<br>       default:<br>           <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;æ‰§è¡Œ3&#x27;</span>);<br>   &#125;<br></code></pre></td></tr></table></figure></li></ol><p><strong>æ³¨æ„ï¼šswitchè¯­å¥ä¸­çš„åˆ¤æ–­æ˜¯ä¸¥æ ¼åˆ¤æ–­ï¼Œå³è¿ç”¨ <code>===</code>è¿›è¡Œåˆ¤æ–­</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">switch</span><span class="hljs-params">(<span class="hljs-number">1</span>)</span></span>&#123;<br>        case <span class="hljs-string">&#x27;1&#x27;</span>:<br>            cccc  <span class="hljs-comment">//ä¸æ‰§è¡Œ</span><br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="å¾ªç¯ç»“æ„"><a href="#å¾ªç¯ç»“æ„" class="headerlink" title="å¾ªç¯ç»“æ„"></a>å¾ªç¯ç»“æ„</h3><p>å¾ªç¯ç»“æ„çš„ç›®çš„å°±æ˜¯ä¸ºäº†èŠ‚çœé‡å¤ä»£ç çš„æ“ä½œ</p><h4 id="emsp-whileå¾ªç¯"><a href="#emsp-whileå¾ªç¯" class="headerlink" title="&emsp;whileå¾ªç¯"></a>&emsp;whileå¾ªç¯</h4><p>å››ä¸ªæ­¥éª¤ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> å®šä¹‰å˜é‡  <br><span class="hljs-bullet">2.</span> æ¡ä»¶åˆ¤æ–­(æ¡ä»¶ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œå¾ªç¯ç»“æŸ)  <br><span class="hljs-bullet">3.</span> 3.æ‰§è¡Œè¯­å¥  <br><span class="hljs-bullet">4.</span> 4.è‡ªå¢æˆ–è‡ªå‡<br></code></pre></td></tr></table></figure><p>ä»£ç ç»“æ„ï¼š</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> <span class="hljs-built_in">count</span> = <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">while</span>( <span class="hljs-built_in">count</span> &lt; <span class="hljs-number">5</span> )&#123;<br><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">123</span> );<br><br><span class="hljs-built_in">count</span>++;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>ä¸è¦å†™å‡ºæ­»å¾ªç¯ï¼Œè¦å†™å¾ªç¯ç»“æŸçš„æ¡ä»¶é€»è¾‘</strong></p><h4 id="emsp-forå¾ªç¯"><a href="#emsp-forå¾ªç¯" class="headerlink" title="&emsp;forå¾ªç¯"></a>&emsp;forå¾ªç¯</h4><p>å››ä¸ªæ‰§è¡Œæ­¥éª¤ ( whileå’Œforå¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œç­‰ä»·çš„ )</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-bullet">1.</span> å®šä¹‰å˜é‡   <br><span class="hljs-bullet">2.</span> æ¡ä»¶åˆ¤æ–­(æ¡ä»¶ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œå¾ªç¯ç»“æŸ)  <br><span class="hljs-bullet">3.</span> æ‰§è¡Œè¯­å¥  <br>4.è‡ªå¢æˆ–è‡ªå‡<br></code></pre></td></tr></table></figure><p>ä»£ç ç»“æ„ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(var i<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;5;i++)&#123;</span><br>       console.log(i)<span class="hljs-comment">;</span><br>   &#125;<br></code></pre></td></tr></table></figure><p>forå¾ªç¯å¯ä»¥è¿›è¡ŒåµŒå¥—</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">for</span>(var i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">3</span>;i++)&#123;<br><span class="hljs-built_in">for</span>(var j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">3</span>;j++)&#123;<br>console<span class="hljs-selector-class">.log</span>(i , j);<br>&#125;<br>   &#125;<br></code></pre></td></tr></table></figure><h5 id="emsp-å…³äºforå¾ªç¯çš„å¾ªç¯è·³å‡º"><a href="#emsp-å…³äºforå¾ªç¯çš„å¾ªç¯è·³å‡º" class="headerlink" title="&emsp;å…³äºforå¾ªç¯çš„å¾ªç¯è·³å‡º"></a>&emsp;å…³äºforå¾ªç¯çš„å¾ªç¯è·³å‡º</h5><p>å¾ªç¯è·³å‡ºå¯ä»¥ä½¿ç”¨ä¸¤ä¸ªè¯­å¥ï¼Œbreakå’Œcontinueï¼Œä¸‹é¢ç®€å•è®²ä¸€ä¸‹ä¸¤è€…çš„ä¸åŒã€‚</p><h6 id="emsp-emsp-breakè¯­å¥"><a href="#emsp-emsp-breakè¯­å¥" class="headerlink" title="&emsp;&emsp;breakè¯­å¥"></a>&emsp;&emsp;breakè¯­å¥</h6><p>breakè¯­å¥ä½¿ç”¨åç¨‹åºä¼šè·³å‡ºæ•´ä¸ªå¾ªç¯</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(var i<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;5;i++)&#123;</span><br>        console.log(i)<span class="hljs-comment">;</span><br>        if(i <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">2</span>)&#123;<br>            break<span class="hljs-comment">;</span><br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/break%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AF.png" alt="i = 2æ—¶è·³å‡ºå¾ªç¯ï¼Œæ•…åªæ‰“å° 0 1 2 "><br>å¦‚æœæŠŠifå’Œconsole.logæ¢ä¸€ä¸‹ä½ç½®</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(var i<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;5;i++)&#123;</span><br>            if(i <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">2</span>)&#123;<br>                            break<span class="hljs-comment">;</span><br>                        &#125;<br>            console.log(i)<span class="hljs-comment">;</span><br>        &#125;<br></code></pre></td></tr></table></figure><p><img src="/images/break%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AF_2.png"></p><h6 id="emsp-emsp-continueè¯­å¥"><a href="#emsp-emsp-continueè¯­å¥" class="headerlink" title="&emsp;&emsp;continueè¯­å¥"></a>&emsp;&emsp;continueè¯­å¥</h6><p>continueè¯­å¥ä½¿ç”¨ååªä¼šè·³å‡ºå½“å‰å¾ªç¯</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(var i<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;5;i++)&#123;</span><br>if(i <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">2</span>)&#123;<br>continue<span class="hljs-comment">;</span><br>&#125;<br>console.log(i)<span class="hljs-comment">;</span><br>   &#125;<br></code></pre></td></tr></table></figure><p><img src="/images/continue%E8%B7%B3%E5%87%BA.png" alt="i = 2æ—¶è·³å‡ºå½“å‰å¾ªç¯ï¼Œå¾ªç¯ç»§ç»­ï¼Œæ•…æ‰“å° 0 1 3 4"></p><p><strong>æ³¨æ„ï¼šåµŒå¥—å¾ªç¯çš„breaké»˜è®¤è·³å‡ºå½“å‰çš„å¾ªç¯ï¼Œè€Œä¸ä¼šè·³å‡ºæœ€å¤–å±‚å¾ªç¯</strong></p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs abnf">for(var i<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;5;i++)&#123;</span><br>for(var j<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;j&lt;3;j++)&#123;</span><br>if( j <span class="hljs-operator">=</span><span class="hljs-operator">=</span> <span class="hljs-number">1</span>)&#123;<br>console.log(j)<span class="hljs-comment">;</span><br>break<span class="hljs-comment">;</span><br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/images/break%E8%B7%B3%E5%87%BA%E5%B5%8C%E5%A5%97%E5%BE%AA%E7%8E%AF.png" alt="å†…å±‚å¾ªç¯è·³å‡ºï¼Œåªæ‰§è¡Œå¤–å±‚å¾ªç¯"><br>é‚£ä¹ˆå¦‚æœæƒ³è¦é€€å‡ºæœ€å¤–å±‚å¾ªç¯ï¼Œé‚£åº”è¯¥æ€ä¹ˆåŠå‘¢</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss">outer : <span class="hljs-built_in">for</span>(var i=<span class="hljs-number">0</span>;<span class="hljs-selector-tag">i</span>&lt;<span class="hljs-number">5</span>;<span class="hljs-selector-tag">i</span>++)&#123;   <span class="hljs-comment">//è·³å‡ºåˆ°æŒ‡å®šçš„æŸä¸€å±‚</span><br><span class="hljs-built_in">for</span>(var j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">3</span>;j++)&#123;<br><span class="hljs-built_in">if</span>( j == <span class="hljs-number">1</span>)&#123;<br>console<span class="hljs-selector-class">.log</span>(j);<br>break outer;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="emsp-do-whileå¾ªç¯"><a href="#emsp-do-whileå¾ªç¯" class="headerlink" title="&emsp;do-whileå¾ªç¯"></a>&emsp;do-whileå¾ªç¯</h4><p>å’Œwhileä¸åŒä¹‹å¤„:æ‰§è¡Œå¾ªç¯ä¹‹å‰å¿…å®šæ‰§è¡Œä¸€æ¬¡ã€‚</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">do</span>&#123;<br>        <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(i);<br>        i++;<br>    &#125;<br>    <span class="hljs-keyword">while</span>(i&lt;<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><hr><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DOM</title>
    <link href="/2019/08/06/2019-08-06-DOM/"/>
    <url>/2019/08/06/2019-08-06-DOM/</url>
    
    <content type="html"><![CDATA[<h1 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h1><ul><li><a href="#dom">DOM</a><ul><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AFdom">ä»€ä¹ˆæ˜¯DOM</a></li><li><a href="#window%E5%AF%B9%E8%B1%A1%E5%92%8Cdocument%E5%AF%B9%E8%B1%A1">windowå¯¹è±¡å’Œdocumentå¯¹è±¡</a></li><li><a href="#%E8%8E%B7%E5%8F%96html%E5%85%83%E7%B4%A0">è·å–HTMLå…ƒç´ </a><ul><li><a href="#1-getelementbyid">1. getElementById()</a></li><li><a href="#2-getelementsbytagname">2. getElementsByTagName()</a></li><li><a href="#3-getelementsbyclassname">3. getElementsByClassName()</a></li><li><a href="#4-queryselector">4. querySelector()</a></li><li><a href="#5-queryselectorall">5. querySelectorAll()</a></li></ul></li><li><a href="#%E6%93%8D%E4%BD%9Chtml%E5%85%83%E7%B4%A0%E7%9A%84%E5%B1%9E%E6%80%A7">æ“ä½œHTMLå…ƒç´ çš„å±æ€§</a></li><li><a href="#%E6%93%8D%E4%BD%9Chtml%E5%85%83%E7%B4%A0%E7%9A%84style">æ“ä½œHTMLå…ƒç´ çš„style</a></li><li><a href="#%E4%BF%AE%E6%94%B9dom%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9">ä¿®æ”¹DOMä¸­çš„å†…å®¹</a><ul><li><a href="#innerhtml%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E9%87%8C%E7%9A%84%E5%86%85%E5%AE%B9">innerHTMLï¼šè·å–å…ƒç´ é‡Œçš„å†…å®¹</a></li><li><a href="#innertext">innerText</a></li><li><a href="#documentwrite">document.write</a></li></ul></li></ul></li></ul><h2 id="ä»€ä¹ˆæ˜¯DOM"><a href="#ä»€ä¹ˆæ˜¯DOM" class="headerlink" title="ä»€ä¹ˆæ˜¯DOM"></a>ä»€ä¹ˆæ˜¯DOM</h2><p>JavaScriptåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸ºECMAScriptã€DOMã€BOMã€‚<br>å…¶ä¸­    DOM æ˜¯ æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDocument Object Modelï¼Œç®€ç§°DOMï¼‰ï¼Œæ˜¯W3Cç»„ç»‡æ¨èçš„å¤„ç†å¯æ‰©å±•æ ‡å¿—è¯­è¨€çš„æ ‡å‡†ç¼–ç¨‹æ¥å£ã€‚åœ¨ç½‘é¡µä¸Šï¼Œç»„ç»‡é¡µé¢ï¼ˆæˆ–æ–‡æ¡£ï¼‰çš„å¯¹è±¡è¢«ç»„ç»‡åœ¨ä¸€ä¸ªæ ‘å½¢ç»“æ„ä¸­ï¼Œç”¨æ¥è¡¨ç¤ºæ–‡æ¡£ä¸­å¯¹è±¡çš„æ ‡å‡†æ¨¡å‹ã€‚</p><h2 id="windowå¯¹è±¡å’Œdocumentå¯¹è±¡"><a href="#windowå¯¹è±¡å’Œdocumentå¯¹è±¡" class="headerlink" title="windowå¯¹è±¡å’Œdocumentå¯¹è±¡"></a>windowå¯¹è±¡å’Œdocumentå¯¹è±¡</h2><p>windowå¯¹è±¡æ˜¯åŒ…å«documentå¯¹è±¡çš„ã€‚windowå¯¹è±¡æ˜¯JSçš„æœ€å¤–å±‚å¯¹è±¡è€Œdocumentå¯¹è±¡æ˜¯DOMçš„æœ€å¤–å±‚å¯¹è±¡ã€‚</p><h2 id="è·å–HTMLå…ƒç´ "><a href="#è·å–HTMLå…ƒç´ " class="headerlink" title="è·å–HTMLå…ƒç´ "></a>è·å–HTMLå…ƒç´ </h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">document</span>.<span class="hljs-property">doctype</span> );   <span class="hljs-comment">//    &lt;!DOCTYPE html&gt;</span><br>   <br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span> );    <span class="hljs-comment">//  &lt;html&gt;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span> );     <span class="hljs-comment">// &lt;head&gt;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span> );     <span class="hljs-comment">// &lt;body&gt;</span><br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>( <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> );     <span class="hljs-comment">// &lt;title&gt;ä¸­çš„å†…å®¹ -&gt; Document</span><br><br><span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&#x27;nihao&#x27;</span>;     <span class="hljs-comment">// è¿˜å¯ä»¥è®¾ç½®</span><br><br> <span class="hljs-comment">//æ³¨ï¼š.çš„å«ä¹‰ï¼Œå°±æ˜¯è°è°è°ä¸‹çš„ï¼Œä¸‹ä¸€çº§çš„æ„æ€ã€‚</span><br><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šdocument.titleè·å–åˆ°çš„ä¸æ˜¯titleæ ‡ç­¾è€Œæ˜¯æ ‡ç­¾ä¸­çš„å†…å®¹ï¼</strong>  </p><p><strong>è·å–HTMLå…ƒç´ é€šå¸¸æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•</strong></p><p><strong>è·å–å…ƒç´ æ“ä½œçš„æ—¶å€™ï¼Œå°½é‡æ”¾åœ¨ä¸‹è¾¹ï¼Œè®©HTMLå…ƒç´ åŠ è½½å®Œï¼Œè¦ä¸ç„¶ä¼šè·å–ä¸åˆ°</strong></p><h3 id="1-getElementById"><a href="#1-getElementById" class="headerlink" title="1. getElementById()"></a>1. getElementById()</h3><p>é€šè¿‡idè·å–å…ƒç´ </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> elem = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;elem&#x27;</span>); <br></code></pre></td></tr></table></figure><h3 id="2-getElementsByTagName"><a href="#2-getElementsByTagName" class="headerlink" title="2. getElementsByTagName()"></a>2. getElementsByTagName()</h3><p><strong>æ³¨æ„Elementsæœ‰sï¼ä¸”è·å–åˆ°çš„ä¸ºä¸€ä¸ªé›†åˆ</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> lis = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">&#x27;li&#x27;</span>);<br></code></pre></td></tr></table></figure><h3 id="3-getElementsByClassName"><a href="#3-getElementsByClassName" class="headerlink" title="3. getElementsByClassName()"></a>3. getElementsByClassName()</h3><p><strong>æ³¨æ„Elementsæœ‰sï¼ä¸”è·å–åˆ°çš„ä¸ºä¸€ä¸ªé›†åˆ</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> boxs = <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">&#x27;box&#x27;</span>);  <br></code></pre></td></tr></table></figure><p><strong>getElementByIdçš„å‰è¾¹åªå¯ä»¥æ˜¯documentï¼Œè€ŒgetElementsByTagNameå’ŒgetElementsByClassNameä¸ä¸€å®š</strong></p><h3 id="4-querySelector"><a href="#4-querySelector" class="headerlink" title="4. querySelector()"></a>4. querySelector()</h3><p>ä»¿ç…§CSSé€‰æ‹©å™¨è€Œè¯ç”Ÿçš„ï¼Œå†™æ³•å’ŒCSSé€‰æ‹©å™¨ç±»ä¼¼</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> elem = <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelector</span>(<span class="hljs-string">&#x27;#elem&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="5-querySelectorAll"><a href="#5-querySelectorAll" class="headerlink" title="5. querySelectorAll()"></a>5. querySelectorAll()</h3><p>ä»¿ç…§CSSé€‰æ‹©å™¨è€Œè¯ç”Ÿçš„ï¼Œå†™æ³•å’ŒCSSé€‰æ‹©å™¨ç±»ä¼¼ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªé›†åˆã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> boxs = <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelectorAll</span>(<span class="hljs-string">&#x27;.box&#x27;</span>); <br><span class="hljs-keyword">var</span> lis = <span class="hljs-built_in">document</span>.<span class="hljs-built_in">querySelectorAll</span>(<span class="hljs-string">&#x27;ul li&#x27;</span>);  <br></code></pre></td></tr></table></figure><h2 id="æ“ä½œHTMLå…ƒç´ çš„å±æ€§"><a href="#æ“ä½œHTMLå…ƒç´ çš„å±æ€§" class="headerlink" title="æ“ä½œHTMLå…ƒç´ çš„å±æ€§"></a>æ“ä½œHTMLå…ƒç´ çš„å±æ€§</h2><p><strong>æ³¨ï¼šclasså…³é”®å­—è¢«JSä¸­çš„é¢å‘å¯¹è±¡ä¸­çš„ç±»æ‰€å ç”¨äº†ï¼Œç”¨classNameæ¥è·å–classæ ·å¼å±æ€§ï¼ŒåŒæ ·çš„ï¼Œforè¢«JSä¸­çš„å¾ªç¯å ç”¨äº†ï¼Œæ‰€ä»¥HTMLä¸­çš„forå±æ€§éœ€è¦å†™æˆhtmlFor</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( elem.id );<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( elem.title );<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( elem.zidingyi );   <span class="hljs-comment">// .çš„æ–¹å¼è·å–ä¸åˆ°è‡ªå®šä¹‰å±æ€§</span><br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( elem.className ); <br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( lab.htmlFor );<br></code></pre></td></tr></table></figure><h2 id="æ“ä½œHTMLå…ƒç´ çš„style"><a href="#æ“ä½œHTMLå…ƒç´ çš„style" class="headerlink" title="æ“ä½œHTMLå…ƒç´ çš„style"></a>æ“ä½œHTMLå…ƒç´ çš„style</h2><p>JSç§ä¸èƒ½å‡ºç°çŸ­çº¿- , çŸ­çº¿å»æ‰è½¬é©¼å³°å†™æ³•;</p><p>ä¾‹å¦‚CSSä¸­çš„<code>font-size:16px</code></p><p>åœ¨JSä¸­å°±åº”è¯¥å†™æˆ<code>fontSize:16px</code></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">var</span> <span class="hljs-built_in">elem</span> = document.getElementById(&#x27;<span class="hljs-built_in">elem</span>&#x27;);     <br><span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.<span class="hljs-built_in">background</span> = &#x27;red&#x27;;<br><span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.<span class="hljs-built_in">color</span> = &#x27;white&#x27;;<br><span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.<span class="hljs-built_in">width</span> = &#x27;100px&#x27;; <br>//cssTextå¯ä»¥ç®€åŒ–æ ·å¼çš„è®¾ç½®æ“ä½œ , æ³¨æ„ä¼šæŠŠ<span class="hljs-built_in">style</span>æ ·å¼è¿›è¡Œæ•´ä½“è¦†ç›–æ‰<br><span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.cssText = &#x27;<span class="hljs-built_in">width</span>:100px;<span class="hljs-built_in">background</span>:red;<span class="hljs-built_in">color</span>:white&#x27;;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•åªèƒ½æ”¹å˜å…ƒç´ çš„å†…è”æ ·å¼ï¼Œå¦‚æœå†™çš„å†…éƒ¨æ ·å¼æˆ–è€…å¤–éƒ¨æ ·å¼ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>è¿™é‡Œæä¾›ä¸€ç§æ–¹æ³•<code>getComputedStyle()</code>  å®ƒè·å–çš„æ˜¯å…ƒç´ çš„æœ€ç»ˆæ ·å¼ï¼Œå³ä¸ç®¡ä½ æ˜¯å“ªé‡Œçš„CSSï¼Œæˆ‘åªæŠ“ä½æœ€åå‘ˆç°åœ¨é¡µé¢ä¸Šçš„æ ·å¼ï¼ï¼ˆæŒºéœ¸é“çš„â€¦â€¦æˆ‘æ„Ÿè§‰ï¼‰</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">var</span> <span class="hljs-built_in">elem</span> = document.getElementById(&#x27;<span class="hljs-built_in">elem</span>&#x27;);<br>console.<span class="hljs-built_in">log</span>( getComputedStyle(<span class="hljs-built_in">elem</span>).<span class="hljs-built_in">color</span> );<br>console.<span class="hljs-built_in">log</span>( getComputedStyle(<span class="hljs-built_in">elem</span>).fontSize );<br></code></pre></td></tr></table></figure><p>åœ¨ä¸€äº›è€æµè§ˆå™¨é‡Œä¸æ”¯æŒè¿™ä¹ˆéœ¸é“çš„å®ƒï¼Œé‚£æ€ä¹ˆå…¼å®¹å•Š</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs maxima"><span class="hljs-built_in">var</span> <span class="hljs-built_in">elem</span> = document.getElementById(&#x27;<span class="hljs-built_in">elem</span>&#x27;);<br>console.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">elem</span>.currentStyle.fontSize );<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•è€ç‰ˆæœ¬é€‚ç”¨æ–°ç‰ˆæœ¬ä¸é€‚ç”¨â€¦â€¦æŒºæ°”äººçš„</p><h2 id="ä¿®æ”¹DOMä¸­çš„å†…å®¹"><a href="#ä¿®æ”¹DOMä¸­çš„å†…å®¹" class="headerlink" title="ä¿®æ”¹DOMä¸­çš„å†…å®¹"></a>ä¿®æ”¹DOMä¸­çš„å†…å®¹</h2><h3 id="innerHTMLï¼šè·å–å…ƒç´ é‡Œçš„å†…å®¹"><a href="#innerHTMLï¼šè·å–å…ƒç´ é‡Œçš„å†…å®¹" class="headerlink" title="innerHTMLï¼šè·å–å…ƒç´ é‡Œçš„å†…å®¹"></a>innerHTMLï¼šè·å–å…ƒç´ é‡Œçš„å†…å®¹</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( elem.innerHTML );   <span class="hljs-comment">// &#x27;&lt;h2&gt;hello&lt;/h2&gt;&#x27;</span><br>elem.innerHTML = <span class="hljs-string">&#x27;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½&lt;/p&gt;&#x27;</span>; <br></code></pre></td></tr></table></figure><p><img src="/images/inner%E6%8E%A7%E5%88%B6%E5%8F%B0_1.png" alt="enter description here"><br><strong>è¾“å‡ºäº†idä¸ºelemçš„divé‡Œå…¨éƒ¨å†…å®¹</strong><br><img src="D:\GitHub\moewang0321.github.io\images\inneré¡µé¢å˜åŒ–.png"><br><strong>innerHTMLè¯†åˆ«æ ‡ç­¾ï¼Œè‡ªåŠ¨å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºpæ ‡ç­¾</strong></p><h3 id="innerText"><a href="#innerText" class="headerlink" title="innerText"></a>innerText</h3><p>è·ŸinnerHTMLç”¨æ³•ç›¸ä¼¼ä½†æ˜¯ä¸ä¼šè·å–æ ‡ç­¾ï¼Œåªä¼šè·å–æ–‡æœ¬å†…å®¹<br>ä¸Šéƒ¨ä»£ç å¦‚æœå°†<code>innerHTML</code>å˜æˆ <code>innerText</code> é‚£é¡µé¢ä¸Šè¾“å‡ºçš„å°†ä¼šæ˜¯<code>&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½&lt;/p&gt;</code></p><h3 id="document-write"><a href="#document-write" class="headerlink" title="document.write"></a>document.write</h3><p>ä¸å¸¸ç”¨ï¼Œç›´æ¥å°†æ–‡æœ¬å†…å®¹è¾“å‡ºåˆ°é¡µé¢bodyä¸­ï¼Œäº†è§£å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå…¥JSï¼ˆäºŒï¼‰</title>
    <link href="/2019/08/05/2019-08-06-%E5%88%9D%E5%85%A5JS%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <url>/2019/08/05/2019-08-06-%E5%88%9D%E5%85%A5JS%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="åˆ¤æ–­ç±»å‹"><a href="#åˆ¤æ–­ç±»å‹" class="headerlink" title="åˆ¤æ–­ç±»å‹"></a>åˆ¤æ–­ç±»å‹</h2><p>&emsp;&emsp;typeofä»¥åŠè¿”å›ç±»å‹ï¼ˆéƒ½æ˜¯å­—ç¬¦ä¸²ï¼‰</p><h4 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h4><p>&emsp;&emsp;&emsp;&emsp;å¦‚ä½•åˆ¤æ–­ç±»å‹?<br>&emsp;&emsp;&emsp;&emsp;1.typeof<br>&emsp;&emsp;&emsp;&emsp;2.instanceof<br>&emsp;&emsp;&emsp;&emsp;3.Object.prototype.toString.call()  </p><p>&emsp;&emsp;&emsp;&emsp;NaNçš„ç±»å‹æ˜¯number</p><h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a><em>æ³¨æ„</em></h4><p>&emsp;&emsp;å¦‚ä¸‹å®šä¹‰å¹¶èµ‹å€¼a,é‚£ä¹ˆtypeofä¸€ä¸‹aï¼Œè¿”å›çš„æ˜¯ä»€ä¹ˆç±»å‹ï¼Ÿ</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-keyword">var</span> a = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;&#125;;<br><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">typeof</span> a);<br></code></pre></td></tr></table></figure><p><img src="../images/function.png" alt="ç»“æœ"><br>&emsp;&emsp;äº‹å®è¯æ˜è¿”å›çš„æ˜¯function</p><p>&emsp;&emsp;æ•´ç†ä¸€ä¸‹å„ä¸ªç±»å‹çš„typeof</p><figure class="highlight qml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs qml"><span class="hljs-comment">// Numbers</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-number">37</span> === <span class="hljs-string">&#x27;number&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-number">3.14</span> === <span class="hljs-string">&#x27;number&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Math</span>.LN2 === <span class="hljs-string">&#x27;number&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-literal">Infinity</span> === <span class="hljs-string">&#x27;number&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-literal">NaN</span> === <span class="hljs-string">&#x27;number&#x27;</span>; <span class="hljs-comment">// å°½ç®¡NaNæ˜¯&quot;Not-A-Number&quot;çš„ç¼©å†™</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">1</span>) === <span class="hljs-string">&#x27;number&#x27;</span>; <span class="hljs-comment">// ä½†ä¸è¦ä½¿ç”¨è¿™ç§å½¢å¼!</span><br><br><span class="hljs-comment">// Strings</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-string">&quot;&quot;</span> === <span class="hljs-string">&#x27;string&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-string">&quot;bla&quot;</span> === <span class="hljs-string">&#x27;string&#x27;</span>;<br><span class="hljs-keyword">typeof</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-number">1</span>) === <span class="hljs-string">&#x27;string&#x27;</span>; <span class="hljs-comment">// typeofæ€»æ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">&quot;abc&quot;</span>) === <span class="hljs-string">&#x27;string&#x27;</span>; <span class="hljs-comment">// ä½†ä¸è¦ä½¿ç”¨è¿™ç§å½¢å¼!</span><br><br><span class="hljs-comment">// Booleans</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-literal">true</span> === <span class="hljs-string">&#x27;boolean&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-literal">false</span> === <span class="hljs-string">&#x27;boolean&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Boolean</span>(<span class="hljs-literal">true</span>) === <span class="hljs-string">&#x27;boolean&#x27;</span>; <span class="hljs-comment">// ä½†ä¸è¦ä½¿ç”¨è¿™ç§å½¢å¼!</span><br><br><span class="hljs-comment">// Symbols</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span>() === <span class="hljs-string">&#x27;symbol&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">&#x27;foo&#x27;</span>) === <span class="hljs-string">&#x27;symbol&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span>.iterator === <span class="hljs-string">&#x27;symbol&#x27;</span>;<br><br><span class="hljs-comment">// Undefined</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-literal">undefined</span> === <span class="hljs-string">&#x27;undefined&#x27;</span>;<br><span class="hljs-keyword">typeof</span> declaredButUndefinedVariable === <span class="hljs-string">&#x27;undefined&#x27;</span>;<br><span class="hljs-keyword">typeof</span> undeclaredVariable === <span class="hljs-string">&#x27;undefined&#x27;</span>; <br><br><span class="hljs-comment">// Objects</span><br><span class="hljs-title">typeof</span> &#123;<span class="hljs-attribute">a</span>:<span class="hljs-number">1</span>&#125; === <span class="hljs-string">&#x27;object&#x27;</span>;<br><br><span class="hljs-comment">// ä½¿ç”¨Array.isArray æˆ–è€… Object.prototype.toString.call</span><br><span class="hljs-comment">// åŒºåˆ†æ•°ç»„,æ™®é€šå¯¹è±¡</span><br><span class="hljs-keyword">typeof</span> [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>] === <span class="hljs-string">&#x27;object&#x27;</span>;<br><br><span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>() === <span class="hljs-string">&#x27;object&#x27;</span>;<br><br><span class="hljs-comment">// ä¸‹é¢çš„å®¹æ˜“ä»¤äººè¿·æƒ‘ï¼Œä¸è¦ä½¿ç”¨ï¼</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Boolean</span>(<span class="hljs-literal">true</span>) === <span class="hljs-string">&#x27;object&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">1</span>) === <span class="hljs-string">&#x27;object&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">&quot;abc&quot;</span>) === <span class="hljs-string">&#x27;object&#x27;</span>;<br><br><span class="hljs-comment">// å‡½æ•°</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;&#125; === <span class="hljs-string">&#x27;function&#x27;</span>;<br><span class="hljs-keyword">typeof</span> class <span class="hljs-title">C</span>&#123;&#125; === <span class="hljs-string">&#x27;function&#x27;</span><br><span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Math</span>.sin === <span class="hljs-string">&#x27;function&#x27;</span>;<br><span class="hljs-keyword">typeof</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>() === <span class="hljs-string">&#x27;function&#x27;</span>;<br></code></pre></td></tr></table></figure><hr><h3 id="è½¬æ¢ç±»å‹"><a href="#è½¬æ¢ç±»å‹" class="headerlink" title="è½¬æ¢ç±»å‹"></a>è½¬æ¢ç±»å‹</h3><h4 id="1-æ˜¾å¼ç±»å‹è½¬æ¢"><a href="#1-æ˜¾å¼ç±»å‹è½¬æ¢" class="headerlink" title="1.æ˜¾å¼ç±»å‹è½¬æ¢"></a>1.æ˜¾å¼ç±»å‹è½¬æ¢</h4><p>&emsp;&emsp;è°ƒç”¨è½¬æ¢æ–¹æ³•ï¼Œä¸»åŠ¨è½¬æ¢<br>&emsp;&emsp;a.Number()<br>&emsp;&emsp;b.String()<br>&emsp;&emsp;c.Boolean()</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//æ˜¾å¼ç±»å‹è½¬æ¢</span><br>  <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;123&#x27;</span>;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">typeof</span> <span class="hljs-built_in">Number</span>(a) );<br><br>  <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;hello&#x27;</span>;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">typeof</span> <span class="hljs-built_in">Number</span>(a) );   <span class="hljs-comment">//NaN</span><br><br>  <span class="hljs-keyword">var</span> a = <span class="hljs-literal">true</span>;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">Number</span>(a) );  <span class="hljs-comment">// true -&gt; 1  , false -&gt; 0</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-number">123</span>;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">typeof</span> String(a) );   <span class="hljs-comment">// &#x27;123&#x27;</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-literal">true</span>;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( String(a) );   <span class="hljs-comment">// &#x27;true&#x27;</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;&#x27;</span>;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">Boolean</span>(a) );   <span class="hljs-comment">//åªè¦å­—ç¬¦ä¸²æœ‰å†…å®¹å°±è½¬æˆtrueï¼Œç©ºå­—ç¬¦ä¸²è½¬æˆfalse</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">Boolean</span>(a) );   <span class="hljs-comment">//åªè¦æ•°å­—ä¸ä¸º0ï¼Œå°±è½¬æˆtrueï¼Œ0ä¼šè½¬æˆfalse</span><br></code></pre></td></tr></table></figure><h4 id="2-éšå¼ç±»å‹è½¬æ¢"><a href="#2-éšå¼ç±»å‹è½¬æ¢" class="headerlink" title="2.éšå¼ç±»å‹è½¬æ¢"></a>2.éšå¼ç±»å‹è½¬æ¢</h4><p>&emsp;&emsp;è¢«åŠ¨è½¬æ¢ï¼Œç”±JSç¨‹åºè‡ªåŠ¨è¿›è¡Œè½¬æ¢ã€‚<br><strong>&emsp;&emsp;+ - * / == éšå¼ç±»å‹è½¬æ¢</strong><br><strong>&emsp;&emsp;+ æ•°å€¼ - è´Ÿæ•°å€¼</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//éšå¼ç±»å‹è½¬æ¢</span><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;1&#x27;</span>;<br>   <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>;<br><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( a + b );  <span class="hljs-comment">//éšå¼ç±»å‹è½¬æ¢  b -&gt; 2 -&gt; &#x27;2&#x27; ï¼Œç„¶ååœ¨è¿æ¥aå˜é‡</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( a - b );  <span class="hljs-comment">//éšå¼ç±»å‹è½¬æ¢  a -&gt; &#x27;1&#x27; -&gt; 1 , ç„¶ååœ¨ç›¸åŠ bå˜é‡</span><br></code></pre></td></tr></table></figure><hr><h3 id="æ¯”è¾ƒç±»å‹"><a href="#æ¯”è¾ƒç±»å‹" class="headerlink" title="æ¯”è¾ƒç±»å‹"></a>æ¯”è¾ƒç±»å‹</h3><p>æŒ‘ä¸€äº›é‡ç‚¹æ¥è¯´äº†ï¼Œå°±ä¸æŠŠçŸ¥è¯†ç‚¹ä¸€ä¸€ç½—åˆ—äº†ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹w3cSchool  </p><h4 id="å’Œ-ä¹‹é—´çš„åŒºåˆ«"><a href="#å’Œ-ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="== å’Œ = ä¹‹é—´çš„åŒºåˆ«"></a>== å’Œ = ä¹‹é—´çš„åŒºåˆ«</h4><p>&emsp;&emsp; ==è¿›è¡Œæ¯”è¾ƒï¼Œè€Œ=è¿›è¡Œèµ‹å€¼æ“ä½œ</p><h4 id="æ¯”è¾ƒæ—¶å€™çš„å‡ ç§æƒ…å†µ"><a href="#æ¯”è¾ƒæ—¶å€™çš„å‡ ç§æƒ…å†µ" class="headerlink" title="æ¯”è¾ƒæ—¶å€™çš„å‡ ç§æƒ…å†µ"></a>æ¯”è¾ƒæ—¶å€™çš„å‡ ç§æƒ…å†µ</h4><p><strong>1.å½“ä¸¤è¾¹éƒ½æ˜¯å­—ç¬¦ä¸²çš„æƒ…å†µä¸‹</strong><br>&emsp;&emsp;æŒ‰ä½è¿›è¡Œæ¯”è¾ƒï¼Œå­—ç¬¦çš„unicodeç¼–ç è¿›è¡Œæ¯”è¾ƒ</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//ä¸¤è¾¹éƒ½æ˜¯å­—ç¬¦ä¸²çš„æƒ…å†µ : æŒ‰ä½è¿›è¡Œæ¯”è¾ƒï¼Œå­—ç¬¦çš„unicodeç¼–ç è¿›è¡Œæ¯”è¾ƒ</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-string">&#x27;a&#x27;</span> &gt;= <span class="hljs-string">&#x27;b&#x27;</span> );<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-string">&#x27;a&#x27;</span>.charCodeAt() );  <span class="hljs-comment">//æŸ¥çœ‹å­—ç¬¦å¯¹åº”çš„unicodeç¼–ç </span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-string">&#x27;5&#x27;</span> &gt;= <span class="hljs-string">&#x27;12&#x27;</span> );   <span class="hljs-comment">// true</span><br></code></pre></td></tr></table></figure><p><strong>2.å½“ä¸¤è¾¹ä¸éƒ½æ˜¯å­—ç¬¦ä¸²çš„æƒ…å†µä¸‹</strong><br>&emsp;&emsp;ç›´æ¥çœ‹å¦‚ä¸‹ä»£ç å§</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//ä¸¤è¾¹ä¸éƒ½æ˜¯å­—ç¬¦ä¸²çš„æƒ…å†µ : æŠŠå…¶ä»–ç±»å‹è½¬æˆæ•°å­—ç±»å‹åï¼Œå†æ¯”è¾ƒ</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">5</span> &gt;= <span class="hljs-string">&#x27;12&#x27;</span> );  <span class="hljs-comment">//  5 &gt;= 12   // false</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">true</span> == <span class="hljs-number">1</span> );   <span class="hljs-comment">// true -&gt; 1  -&gt; 1==1   // true</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">true</span> == <span class="hljs-number">2</span> );   <span class="hljs-comment">// false</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹å­—ç¬¦å¯¹åº”çš„unicodeç¼–ç æ–¹æ³•ï¼šcharCodeAtï¼ˆï¼‰<br><strong>3.ç‰¹æ®Šç±»å‹çš„æ¯”è¾ƒ</strong><br>&emsp;&emsp;nullã€undefinedã€NaNçš„æ¯”è¾ƒ<br>&emsp;&emsp;è€è§„çŸ©ç›´æ¥ä¸Šä»£ç ï¼Œæ¸…æ™°æ˜äº†</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//ç‰¹æ®Šç±»å‹çš„æ¯”è¾ƒ </span><br>     <span class="hljs-literal">null</span>ä¸<span class="hljs-literal">undefined</span>æ¯”è¾ƒçš„æ—¶å€™ï¼Œè¿”å›<span class="hljs-literal">true</span>ã€‚é™¤äº†ä¸‹é¢ä¸‰ç§æƒ…å†µï¼Œè·Ÿå…¶ä»–ä»»ä½•å€¼æ¯”è¾ƒéƒ½æ˜¯<span class="hljs-literal">false</span><br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">null</span> == <span class="hljs-literal">null</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">undefined</span> == <span class="hljs-literal">undefined</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">null</span> == <span class="hljs-literal">undefined</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">null</span> == <span class="hljs-literal">false</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">null</span> == <span class="hljs-literal">true</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">undefined</span> == <span class="hljs-literal">false</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">undefined</span> == <span class="hljs-literal">true</span> );<br><br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">NaN</span> == <span class="hljs-literal">NaN</span> );  <span class="hljs-comment">//false</span><br>     <span class="hljs-comment">//ES6 :  Object.is() : ä¿®æ­£ä¸€äº›åˆ¤æ–­çš„</span><br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( Object.is(<span class="hljs-literal">NaN</span> , <span class="hljs-literal">NaN</span>) );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( +<span class="hljs-number">0</span> == <span class="hljs-number">-0</span> );<br>     <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( Object.is(+<span class="hljs-number">0</span> , <span class="hljs-number">-0</span>) );<br></code></pre></td></tr></table></figure><p><em>å…¶ä¸­ <code>Object.isï¼ˆï¼‰</code>æ˜¯ES6ä¸­ä¸ºäº†ä¿®æ­£å†å²é—ç•™é—®é¢˜è€Œæ¨å‡ºçš„ã€‚</em></p><hr><h3 id="JSè¿ç®—ç¬¦ï¼ˆäº”å¤§ç±»ï¼‰"><a href="#JSè¿ç®—ç¬¦ï¼ˆäº”å¤§ç±»ï¼‰" class="headerlink" title="JSè¿ç®—ç¬¦ï¼ˆäº”å¤§ç±»ï¼‰"></a>JSè¿ç®—ç¬¦ï¼ˆäº”å¤§ç±»ï¼‰</h3><p>å› ä¸ºè¿ç®—ç¬¦åŸºæœ¬ä¸Šä¸éœ€è¦è¯­è¨€èµ˜è¿°ï¼Œæ•…ç›´æ¥æ‰”ä¸Šå›¾å’Œä»£ç </p><h4 id="1-ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ10ç§ï¼‰"><a href="#1-ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ10ç§ï¼‰" class="headerlink" title="1.ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ10ç§ï¼‰"></a>1.ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ10ç§ï¼‰</h4><p><img src="../images/3%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6.png" alt="ç®—æœ¯è¿ç®—ç¬¦"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//ç®—æœ¯è¿ç®—ç¬¦(10ç§)</span><br>   <span class="hljs-comment">// + - / * %</span><br>   <span class="hljs-comment">// ++  --</span><br>   <span class="hljs-comment">// +   -</span><br>   <span class="hljs-comment">// **</span><br><br>   <span class="hljs-comment">//4%7 -&gt; 4  å½“è¢«é™¤æ•°å°äºé™¤æ•°çš„æ—¶å€™ï¼Œä½™æ•°å°±æ˜¯è¢«é™¤æ•°è‡ªèº«</span><br><br>   <span class="hljs-comment">//123ç§’</span><br>   <span class="hljs-comment">//123%60  , è½¬æ¢åå‰©ä½™çš„ç§’æ•°</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>   a++;<br>   ++a;<br><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( a++ );   <span class="hljs-comment">// å…ˆè¿”å›aï¼Œå†å¯¹a+1æ“ä½œ</span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( ++a );    <span class="hljs-comment">// å…ˆå¯¹a+1æ“ä½œï¼Œç„¶åå†è¿”å›a</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>   a++;<br>   ++a;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a)<br>   <span class="hljs-comment">//+ æ•°å€¼  -è´Ÿæ•°å€¼</span><br><br>   <span class="hljs-keyword">var</span> a = <span class="hljs-string">&#x27;123&#x27;</span>;<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-built_in">typeof</span> +a );<br><br>   <span class="hljs-comment">//æŒ‡æ•°è¿ç®—ç¬¦ , ä»å³å‘å·¦è®¡ç®—  (ES6)  </span><br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">2</span> ** <span class="hljs-number">2</span> ** <span class="hljs-number">3</span> );<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">2</span> * <span class="hljs-number">2</span> * <span class="hljs-number">2</span> );<br>   <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( Math.<span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>,<span class="hljs-number">5</span>) );<br></code></pre></td></tr></table></figure><h4 id="2-èµ‹å€¼è¿ç®—ç¬¦ï¼ˆç®€å•ã€å¤åˆï¼‰"><a href="#2-èµ‹å€¼è¿ç®—ç¬¦ï¼ˆç®€å•ã€å¤åˆï¼‰" class="headerlink" title="2.èµ‹å€¼è¿ç®—ç¬¦ï¼ˆç®€å•ã€å¤åˆï¼‰"></a>2.èµ‹å€¼è¿ç®—ç¬¦ï¼ˆç®€å•ã€å¤åˆï¼‰</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//èµ‹å€¼è¿ç®—ç¬¦(ç®€å•ä¸å¤åˆ)</span><br><br>      <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>      a = a + <span class="hljs-number">2</span>;   <span class="hljs-comment">//ç®€å•çš„èµ‹å€¼è¿ç®—ç¬¦</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a);<br><br>      <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>      a += <span class="hljs-number">2</span>;   <span class="hljs-comment">//å¤åˆçš„èµ‹å€¼è¿ç®—ç¬¦</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a);<br><br>      <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>;<br>      a = b + <span class="hljs-number">3</span>;<br><br>      a++;<br>      a += <span class="hljs-number">1</span>;<br><br>      <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;<br><br>      a = (a/=<span class="hljs-number">2</span>) + a;<br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(a);<br><br>      <span class="hljs-comment">//(1 + 2) * 3</span><br></code></pre></td></tr></table></figure><h4 id="3-æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ8ç§ï¼‰"><a href="#3-æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ8ç§ï¼‰" class="headerlink" title="3.æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ8ç§ï¼‰"></a>3.æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ8ç§ï¼‰</h4><p><img src="../images/4%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6.png" alt="æ¯”è¾ƒè¿ç®—ç¬¦"></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//æ¯”è¾ƒè¿ç®—ç¬¦(8ç§)</span><br><br>      <span class="hljs-comment">//== === !=  !==</span><br><br>      <span class="hljs-comment">//===è¡¨ç¤ºä¸¥æ ¼ç›¸ç­‰ï¼Œå€¼å’Œç±»å‹éƒ½è¦ç›¸ç­‰ï¼Œæ‰ç›¸ç­‰</span><br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">2</span> === <span class="hljs-string">&#x27;2&#x27;</span> );<br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">2</span> != <span class="hljs-number">3</span> );<br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">2</span> !== <span class="hljs-string">&#x27;2&#x27;</span> );<br></code></pre></td></tr></table></figure><h4 id="4-é€»è¾‘è¿ç®—ç¬¦"><a href="#4-é€»è¾‘è¿ç®—ç¬¦" class="headerlink" title="4.é€»è¾‘è¿ç®—ç¬¦"></a>4.é€»è¾‘è¿ç®—ç¬¦</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//é€»è¾‘è¿ç®—ç¬¦ : &amp;&amp;(ä¸) ||(æˆ–) !(é)</span><br><br>      <span class="hljs-comment">//&amp;&amp; : é€»è¾‘ä¸¤è¾¹éƒ½ä¸ºçœŸï¼Œç»“æœæ‰ä¸ºçœŸï¼Œé€»è¾‘ä¸¤è¾¹æœ‰ä¸€è¾¹ä¸ä¸ºçœŸï¼Œç»“æœå°±ä¸ºå‡ã€‚</span><br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">1</span> &lt; <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-number">5</span> &gt; <span class="hljs-number">4</span> );<br><br>      <span class="hljs-comment">//|| : é€»è¾‘ä¸¤è¾¹æœ‰ä¸€è¾¹ä¸ºçœŸï¼Œç»“æœå°±ä¸ºçœŸï¼Œé€»è¾‘ä¸¤è¾¹éƒ½ä¸ºå‡ï¼Œç»“æœæ‰ä¸ºå‡ã€‚</span><br><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">1</span> &gt; <span class="hljs-number">2</span> || <span class="hljs-number">5</span> &lt; <span class="hljs-number">4</span> );<br><br>      <span class="hljs-comment">//! : é€»è¾‘çš„å–åï¼ŒçœŸçš„å°±æ˜¯å˜æˆå‡çš„ï¼Œå‡çš„å°±ä¼šå˜æˆçœŸçš„</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( !(<span class="hljs-number">1</span> &gt; <span class="hljs-number">2</span>) );<br><br>      <span class="hljs-keyword">var</span> è‰ºæœ¯ç”Ÿ = <span class="hljs-string">&#x27;å°æ˜&#x27;</span>;<br>      <span class="hljs-keyword">var</span> é«˜è€ƒæˆç»© = <span class="hljs-number">300</span>;<br>      <span class="hljs-keyword">var</span> è‰ºè€ƒæˆç»© = <span class="hljs-number">200</span>;<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( è‰ºæœ¯ç”Ÿ , é«˜è€ƒæˆç»©&gt;<span class="hljs-number">200</span> &amp;&amp; è‰ºè€ƒæˆç»©&gt;<span class="hljs-number">100</span> );<br><br>      <span class="hljs-keyword">var</span> <span class="hljs-built_in">number</span> = <span class="hljs-number">70</span>;<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">3</span> &lt; <span class="hljs-built_in">number</span> &lt; <span class="hljs-number">10</span> );  <span class="hljs-comment">//âœ–</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-number">3</span> &lt; <span class="hljs-built_in">number</span> &amp;&amp; <span class="hljs-built_in">number</span> &lt; <span class="hljs-number">10</span> );  <span class="hljs-comment">//âœ”</span><br></code></pre></td></tr></table></figure><h4 id="5-æ¡ä»¶è¿ç®—ç¬¦"><a href="#5-æ¡ä»¶è¿ç®—ç¬¦" class="headerlink" title="5.æ¡ä»¶è¿ç®—ç¬¦"></a>5.æ¡ä»¶è¿ç®—ç¬¦</h4><p>ä¸‰ç›®è¿ç®—ç¬¦ï¼š<code>æ¡ä»¶ï¼Ÿè¾“å‡º1ï¼šè¾“å‡º2</code></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">//ä¸‰å…ƒè¿ç®—ï¼Œä¸‰ç›®è¿ç®—  ? :</span><br>      <span class="hljs-comment">//å½“æ¡ä»¶ä¸ºçœŸï¼Œå°±è¿”å›é—®å·åé¢çš„å†…å®¹ï¼Œå½“æ¡ä»¶ä¸ºå‡ï¼Œå°±è¿”å›å†’å·åé¢çš„å†…å®¹</span><br>      <span class="hljs-comment">//æ‰§è¡Œé¡ºåºä»å³å‘å·¦</span><br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">false</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span> );<br>      <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>( <span class="hljs-literal">false</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">4</span> );<br><br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆå…¥JSï¼ˆä¸€ï¼‰</title>
    <link href="/2019/08/05/2019-08-05-%E5%88%9D%E5%85%A5JS%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2019/08/05/2019-08-05-%E5%88%9D%E5%85%A5JS%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€JSå¼•å…¥æ–¹å¼"><a href="#ä¸€ã€JSå¼•å…¥æ–¹å¼" class="headerlink" title="ä¸€ã€JSå¼•å…¥æ–¹å¼"></a>ä¸€ã€JSå¼•å…¥æ–¹å¼</h2><p>å’ŒCSSå¼•å…¥æ–¹å¼ç›¸å¯¹æ¯”</p><h3 id="CSSå¼•å…¥æ–¹å¼ï¼š"><a href="#CSSå¼•å…¥æ–¹å¼ï¼š" class="headerlink" title="CSSå¼•å…¥æ–¹å¼ï¼š"></a>CSSå¼•å…¥æ–¹å¼ï¼š</h3><p>1.è¡Œé—´<br><code>&lt;div style=&quot;&quot;&gt;&lt;/div&gt;</code></p><p>2.å†…éƒ¨</p><p> 3.å¤–éƒ¨</p><h3 id="JSå¼•å…¥æ–¹å¼"><a href="#JSå¼•å…¥æ–¹å¼" class="headerlink" title="JSå¼•å…¥æ–¹å¼ :"></a>JSå¼•å…¥æ–¹å¼ :</h3><p>1.è¡Œé—´<br><code>&lt;div onclick=&quot;alert(123)&quot;&gt;aaa&lt;/div&gt;</code></p><p>2.å†…éƒ¨</p><p>3.å¤–éƒ¨<br><code>&lt;script src=&quot;base.js&quot;&gt;&lt;/script&gt;</code></p><hr><h2 id="JSå˜é‡"><a href="#JSå˜é‡" class="headerlink" title="JSå˜é‡"></a>JSå˜é‡</h2><p>&emsp;å˜é‡åï¼šè§„èŒƒ-&gt;ä¸èƒ½ç”¨å…³é”®å­—å’Œä¿ç•™å­—</p><p><em>&emsp;å…³é”®å­—ï¼šå·²æœ‰çš„è¯­æ³•ï¼ˆç±»ä¼¼ &nbsp; var &nbsp;ç­‰ï¼‰</em></p><p>&emsp;æ‰§è¡Œé¡ºåº(ä»ä¸Šåˆ°ä¸‹ï¼Œä»å·¦åˆ°å³)ä»¥åŠèµ‹å€¼æ—¶çš„æ‰§è¡Œé¡ºåº(ä»å³å‘å·¦)</p><p>&emsp;ä¸‰å…ƒå’ŒæŒ‡æ•°éƒ½æ˜¯ä»å³å‘å·¦æ‰§è¡Œçš„</p><hr><h2 id="JSæ•°æ®ç±»å‹"><a href="#JSæ•°æ®ç±»å‹" class="headerlink" title="JSæ•°æ®ç±»å‹"></a>JSæ•°æ®ç±»å‹</h2><p>ä»€ä¹ˆæ˜¯æ•°æ®ç±»å‹ï¼Ÿ<br>&emsp;&emsp;æ•°æ®ç±»å‹åœ¨æ•°æ®ç»“æ„ä¸­çš„å®šä¹‰æ˜¯ä¸€ç»„æ€§è´¨ç›¸åŒçš„å€¼çš„é›†åˆä»¥åŠå®šä¹‰åœ¨è¿™ä¸ªå€¼é›†åˆä¸Šçš„ä¸€ç»„æ“ä½œçš„æ€»ç§°ã€‚</p><h3 id="emsp-å…­ç§åˆ’åˆ†"><a href="#emsp-å…­ç§åˆ’åˆ†" class="headerlink" title="&emsp;å…­ç§åˆ’åˆ†"></a>&emsp;å…­ç§åˆ’åˆ†</h3><p>&emsp;&emsp;å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€å¯¹è±¡ã€nullã€undefined<br>&emsp;&emsp;&emsp;&emsp;åŸºæœ¬ç±»å‹ï¼šå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼<br>&emsp;&emsp;&emsp;&emsp;å¤åˆç±»å‹ï¼šå¯¹è±¡<br>&emsp;&emsp;&emsp;&emsp;ç‰¹æ®Šç±»å‹ï¼šnullã€undefined</p><h3 id="emsp-å…«ç§åˆ’åˆ†"><a href="#emsp-å…«ç§åˆ’åˆ†" class="headerlink" title="&emsp;å…«ç§åˆ’åˆ†"></a>&emsp;å…«ç§åˆ’åˆ†</h3><p>&emsp;&emsp;å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€<strong>å¯¹è±¡ï¼ˆç‹­éš˜çš„å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ï¼‰</strong>ã€nullã€undefined</p><p>&emsp;&emsp;<em>Symbol æ˜¯ES6ä¸­çš„ç¬¬ä¸ƒç§ç±»å‹</em></p><h3 id="emsp-emsp-æ‰©å±•"><a href="#emsp-emsp-æ‰©å±•" class="headerlink" title="&emsp;&emsp;æ‰©å±•"></a>&emsp;&emsp;æ‰©å±•</h3><p>&emsp;&emsp;å•å¼•å·è¿˜æ˜¯åŒå¼•å·ï¼Ÿ<br>&emsp;&emsp;&emsp;åœ¨JSä¸­å‡å¯ï¼Œä¿è¯æ˜¯è‹±æ–‡çŠ¶æ€ä¸‹çš„å¼•å·å³å¯ï¼Œæ¨èç”¨å•å¼•å·ï¼šå’ŒHTMLå±æ€§åŒºåˆ†  </p><h4 id="emsp-emsp-è½¬ä¹‰çš„ç”¨å¤„"><a href="#emsp-emsp-è½¬ä¹‰çš„ç”¨å¤„" class="headerlink" title="&emsp;&emsp;è½¬ä¹‰çš„ç”¨å¤„"></a>&emsp;&emsp;è½¬ä¹‰çš„ç”¨å¤„</h4><p>&emsp;&emsp; å¯ä»¥è¾“å‡ºä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦ä¸²  </p><h4 id="emsp-emsp-åŠ å·çš„ä¸¤ç§æ„ä¹‰ï¼Ÿ"><a href="#emsp-emsp-åŠ å·çš„ä¸¤ç§æ„ä¹‰ï¼Ÿ" class="headerlink" title="&emsp;&emsp; åŠ å·çš„ä¸¤ç§æ„ä¹‰ï¼Ÿ"></a>&emsp;&emsp; åŠ å·çš„ä¸¤ç§æ„ä¹‰ï¼Ÿ</h4><p>&emsp;&emsp; 1.è¿æ¥ï¼šå­—ç¬¦ä¸²æ“ä½œçš„æ—¶å€™<br>&emsp;&emsp; 2.ç›¸åŠ : æ•°å­—æ“ä½œçš„æ—¶å€™</p><h4 id="emsp-emsp-åµŒå¥—å¼•å·çš„æ—¶å€™çš„æ³¨æ„äº‹é¡¹"><a href="#emsp-emsp-åµŒå¥—å¼•å·çš„æ—¶å€™çš„æ³¨æ„äº‹é¡¹" class="headerlink" title="&emsp;&emsp; åµŒå¥—å¼•å·çš„æ—¶å€™çš„æ³¨æ„äº‹é¡¹"></a>&emsp;&emsp; <strong>åµŒå¥—å¼•å·çš„æ—¶å€™çš„æ³¨æ„äº‹é¡¹</strong></h4><p>&emsp;&emsp; å•å¼•å·å¥—åŒå¼•å·â€¦â€¦å³äº’ç›¸åµŒå¥—ï¼Œä¸å¯å•å¼•å·å¥—å•å¼•å·ï¼ŒåŒå¼•å·ä¹Ÿæ˜¯</p><hr><h2 id="undefinedå’Œnullçš„åŒºåˆ«ï¼Ÿ"><a href="#undefinedå’Œnullçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="undefinedå’Œnullçš„åŒºåˆ«ï¼Ÿ"></a>undefinedå’Œnullçš„åŒºåˆ«ï¼Ÿ</h2><p>&emsp;&emsp;1.nullè®¡ç®—çš„æ—¶å€™ï¼Œä¼šè½¬æˆ0ï¼›è€Œundefinedä¸ä¼šè½¬ã€‚<br>&emsp;&emsp;2.nullæ˜¯ä¸€ä¸ªä¸»åŠ¨è®¾è®¡æˆçš„ç©ºå€¼ï¼Œundefinedæ˜¯ä¸€ä¸ªè¢«åŠ¨çš„è®¾è®¡æˆæœªå®šä¹‰ã€‚<br>&emsp;&emsp;3.nullæ˜¯å…ˆæœ‰çš„ç±»å‹ï¼Œè€Œundefinedæ˜¯åæœ‰çš„ç±»å‹ï¼Œæ˜¯å¯¹nullçš„å®Œå–„è¡¥å……ã€‚</p><hr><h2 id="å­—ç¬¦ä¸²æ‹†è¡Œé—®é¢˜"><a href="#å­—ç¬¦ä¸²æ‹†è¡Œé—®é¢˜" class="headerlink" title="å­—ç¬¦ä¸²æ‹†è¡Œé—®é¢˜"></a>å­—ç¬¦ä¸²æ‹†è¡Œé—®é¢˜</h2><p>&emsp;&emsp; 1.ç”¨+è¿›è¡Œè¿æ¥  </p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-built_in">var</span> <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;&lt;ul&gt;&#x27;</span> +         <span class="hljs-comment">//è§£å†³æŠ˜è¡Œé—®é¢˜</span><br>          <span class="hljs-string">&#x27;&lt;li&gt;1&lt;/li&gt;&#x27;</span> +<br>          <span class="hljs-string">&#x27;&lt;li&gt;2&lt;/li&gt;&#x27;</span> +<br>          <span class="hljs-string">&#x27;&lt;/ul&gt;&#x27;</span>;<br></code></pre></td></tr></table></figure><p>&emsp;&emsp;2.ç”¨\è¿›è¡Œè¿æ¥  </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">var str = &#x27;<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>\<br>                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\<br>                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>\<br>               <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>&#x27;;<br></code></pre></td></tr></table></figure><p>&emsp;&emsp;&emsp;&emsp;<strong>æ³¨æ„</strong>ï¼š&nbsp; \ &nbsp; ç¬¦å·åä¸èƒ½æœ‰ä»»ä½•å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€‚<br>&emsp;&emsp;3.ES6 æ–°ç‰¹æ€§ ç”¨``è¿›è¡Œè¿æ¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">var str = `<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>        <br>                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>              <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>`;<br></code></pre></td></tr></table></figure><hr>]]></content>
    
    
    <categories>
      
      <category>study</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
